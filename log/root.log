[2016-10-19 17:43:48.914] [INFO] console - AutobahnJS debug enabled
[2016-10-19 17:43:55.144] [INFO] Server - starting...
[2016-10-19 17:43:55.148] [INFO] console - trying to create WAMP transport of type: websocket
[2016-10-19 17:43:55.324] [INFO] console - using WAMP transport type: websocket
[2016-10-19 17:43:55.793] [INFO] Server - connection.onclose() unreachable { reason: null,
  message: null,
  retry_delay: 1.4772763635066226,
  retry_count: 1,
  will_retry: true }
[2016-10-19 17:43:55.820] [INFO] console - retrying in 1.4772763635066226 s
[2016-10-19 17:43:55.826] [INFO] Server - connection.onclose() unreachable { reason: null,
  message: null,
  retry_delay: 2.439093219679459,
  retry_count: 2,
  will_retry: true }
[2016-10-19 17:43:55.831] [INFO] console - retrying in 2.439093219679459 s
[2016-10-19 17:43:58.273] [INFO] console - trying to create WAMP transport of type: websocket
[2016-10-19 17:43:58.281] [INFO] console - using WAMP transport type: websocket
[2016-10-19 17:43:58.296] [INFO] Server - connection.onclose() unreachable { reason: null,
  message: null,
  retry_delay: 3.790248805917762,
  retry_count: 3,
  will_retry: true }
[2016-10-19 17:43:58.298] [INFO] console - retrying in 3.790248805917762 s
[2016-10-19 17:43:58.299] [INFO] Server - connection.onclose() unreachable { reason: null,
  message: null,
  retry_delay: 5,
  retry_count: 4,
  will_retry: true }
[2016-10-19 17:43:58.308] [INFO] console - retrying in 5 s
[2016-10-19 17:44:03.314] [INFO] console - trying to create WAMP transport of type: websocket
[2016-10-19 17:44:03.317] [INFO] console - using WAMP transport type: websocket
[2016-10-19 17:44:03.321] [INFO] Server - connection.onclose() unreachable { reason: null,
  message: null,
  retry_delay: 5,
  retry_count: 5,
  will_retry: true }
[2016-10-19 17:44:03.323] [INFO] console - retrying in 5 s
[2016-10-19 17:44:03.324] [INFO] Server - connection.onclose() unreachable { reason: null,
  message: null,
  retry_delay: 5,
  retry_count: 6,
  will_retry: true }
[2016-10-19 17:44:03.326] [INFO] console - retrying in 5 s
[2016-10-19 17:44:08.330] [INFO] console - trying to create WAMP transport of type: websocket
[2016-10-19 17:44:08.333] [INFO] console - using WAMP transport type: websocket
[2016-10-19 17:44:08.336] [INFO] Server - connection.onclose() unreachable { reason: null,
  message: null,
  retry_delay: 5,
  retry_count: 7,
  will_retry: true }
[2016-10-19 17:44:08.338] [INFO] console - retrying in 5 s
[2016-10-19 17:44:08.339] [INFO] Server - connection.onclose() unreachable { reason: null,
  message: null,
  retry_delay: 5,
  retry_count: 8,
  will_retry: true }
[2016-10-19 17:44:08.341] [INFO] console - retrying in 5 s
[2016-10-19 17:44:13.343] [INFO] console - trying to create WAMP transport of type: websocket
[2016-10-19 17:44:13.347] [INFO] console - using WAMP transport type: websocket
[2016-10-19 17:44:13.364] [INFO] Server - connection.onclose() unreachable { reason: null,
  message: null,
  retry_delay: 5,
  retry_count: 9,
  will_retry: true }
[2016-10-19 17:44:13.367] [INFO] console - retrying in 5 s
[2016-10-19 17:44:13.367] [INFO] Server - connection.onclose() unreachable { reason: null,
  message: null,
  retry_delay: 5,
  retry_count: 10,
  will_retry: true }
[2016-10-19 17:44:13.369] [INFO] console - retrying in 5 s
[2016-10-19 17:44:18.375] [INFO] console - trying to create WAMP transport of type: websocket
[2016-10-19 17:44:18.380] [INFO] console - using WAMP transport type: websocket
[2016-10-19 17:44:18.383] [INFO] Server - connection.onclose() unreachable { reason: null,
  message: null,
  retry_delay: 5,
  retry_count: 11,
  will_retry: true }
[2016-10-19 17:44:18.385] [INFO] console - retrying in 5 s
[2016-10-19 17:44:18.386] [INFO] Server - connection.onclose() unreachable { reason: null,
  message: null,
  retry_delay: 5,
  retry_count: 12,
  will_retry: true }
[2016-10-19 17:44:18.401] [INFO] console - retrying in 5 s
[2016-10-19 17:44:23.410] [INFO] console - trying to create WAMP transport of type: websocket
[2016-10-19 17:44:23.414] [INFO] console - using WAMP transport type: websocket
[2016-10-19 17:44:23.422] [INFO] Server - connection.onclose() unreachable { reason: null,
  message: null,
  retry_delay: 5,
  retry_count: 13,
  will_retry: true }
[2016-10-19 17:44:23.432] [INFO] console - retrying in 5 s
[2016-10-19 17:44:23.433] [INFO] Server - connection.onclose() unreachable { reason: null,
  message: null,
  retry_delay: 5,
  retry_count: 14,
  will_retry: true }
[2016-10-19 17:44:23.436] [INFO] console - retrying in 5 s
[2016-10-19 17:44:28.442] [INFO] console - trying to create WAMP transport of type: websocket
[2016-10-19 17:44:28.446] [INFO] console - using WAMP transport type: websocket
[2016-10-19 17:44:28.450] [INFO] Server - connection.onclose() unreachable { reason: null,
  message: null,
  retry_delay: 5,
  retry_count: 15,
  will_retry: true }
[2016-10-19 17:44:28.452] [INFO] console - retrying in 5 s
[2016-10-19 17:44:28.452] [INFO] Server - connection.onclose() unreachable { reason: null,
  message: null,
  retry_delay: 5,
  retry_count: 16,
  will_retry: true }
[2016-10-19 17:44:28.454] [INFO] console - retrying in 5 s
[2016-10-19 17:44:33.460] [INFO] console - trying to create WAMP transport of type: websocket
[2016-10-19 17:44:33.462] [INFO] console - using WAMP transport type: websocket
[2016-10-19 17:44:33.466] [INFO] Server - connection.onclose() unreachable { reason: null,
  message: null,
  retry_delay: 5,
  retry_count: 17,
  will_retry: true }
[2016-10-19 17:44:33.468] [INFO] console - retrying in 5 s
[2016-10-19 17:44:33.469] [INFO] Server - connection.onclose() unreachable { reason: null,
  message: null,
  retry_delay: 5,
  retry_count: 18,
  will_retry: true }
[2016-10-19 17:44:33.472] [INFO] console - retrying in 5 s
[2016-10-19 17:44:38.475] [INFO] console - trying to create WAMP transport of type: websocket
[2016-10-19 17:44:38.484] [INFO] console - using WAMP transport type: websocket
[2016-10-19 17:44:38.490] [INFO] Server - connection.onclose() unreachable { reason: null,
  message: null,
  retry_delay: 5,
  retry_count: 19,
  will_retry: true }
[2016-10-19 17:44:38.493] [INFO] console - retrying in 5 s
[2016-10-19 17:44:38.494] [INFO] Server - connection.onclose() unreachable { reason: null,
  message: null,
  retry_delay: 5,
  retry_count: 20,
  will_retry: true }
[2016-10-19 17:44:38.496] [INFO] console - retrying in 5 s
[2016-10-19 17:44:43.502] [INFO] console - trying to create WAMP transport of type: websocket
[2016-10-19 17:44:43.505] [INFO] console - using WAMP transport type: websocket
[2016-10-19 17:44:43.507] [INFO] Server - connection.onclose() unreachable { reason: null,
  message: null,
  retry_delay: 5,
  retry_count: 21,
  will_retry: true }
[2016-10-19 17:44:43.509] [INFO] console - retrying in 5 s
[2016-10-19 17:44:43.511] [INFO] Server - connection.onclose() unreachable { reason: null,
  message: null,
  retry_delay: 5,
  retry_count: 22,
  will_retry: true }
[2016-10-19 17:44:43.518] [INFO] console - retrying in 5 s
[2016-10-19 17:44:48.522] [INFO] console - trying to create WAMP transport of type: websocket
[2016-10-19 17:44:48.527] [INFO] console - using WAMP transport type: websocket
[2016-10-19 17:44:48.531] [INFO] Server - connection.onclose() unreachable { reason: null,
  message: null,
  retry_delay: 5,
  retry_count: 23,
  will_retry: true }
[2016-10-19 17:44:48.533] [INFO] console - retrying in 5 s
[2016-10-19 17:44:48.535] [INFO] Server - connection.onclose() unreachable { reason: null,
  message: null,
  retry_delay: 5,
  retry_count: 24,
  will_retry: true }
[2016-10-19 17:44:48.537] [INFO] console - retrying in 5 s
[2016-10-19 17:44:53.542] [INFO] console - trying to create WAMP transport of type: websocket
[2016-10-19 17:44:53.544] [INFO] console - using WAMP transport type: websocket
[2016-10-19 17:44:53.548] [INFO] Server - connection.onclose() unreachable { reason: null,
  message: null,
  retry_delay: 5,
  retry_count: 25,
  will_retry: true }
[2016-10-19 17:44:53.551] [INFO] console - retrying in 5 s
[2016-10-19 17:44:53.552] [INFO] Server - connection.onclose() unreachable { reason: null,
  message: null,
  retry_delay: 5,
  retry_count: 26,
  will_retry: true }
[2016-10-19 17:44:53.557] [INFO] console - retrying in 5 s
[2016-10-19 17:44:58.564] [INFO] console - trying to create WAMP transport of type: websocket
[2016-10-19 17:44:58.567] [INFO] console - using WAMP transport type: websocket
[2016-10-19 17:44:58.569] [INFO] Server - connection.onclose() unreachable { reason: null,
  message: null,
  retry_delay: 5,
  retry_count: 27,
  will_retry: true }
[2016-10-19 17:44:58.571] [INFO] console - retrying in 5 s
[2016-10-19 17:44:58.571] [INFO] Server - connection.onclose() unreachable { reason: null,
  message: null,
  retry_delay: 5,
  retry_count: 28,
  will_retry: true }
[2016-10-19 17:44:58.573] [INFO] console - retrying in 5 s
[2016-10-19 17:45:03.578] [INFO] console - trying to create WAMP transport of type: websocket
[2016-10-19 17:45:03.582] [INFO] console - using WAMP transport type: websocket
[2016-10-19 17:45:03.584] [INFO] Server - connection.onclose() unreachable { reason: null,
  message: null,
  retry_delay: 5,
  retry_count: 29,
  will_retry: true }
[2016-10-19 17:45:03.589] [INFO] console - retrying in 5 s
[2016-10-19 17:45:03.590] [INFO] Server - connection.onclose() unreachable { reason: null,
  message: null,
  retry_delay: 5,
  retry_count: 30,
  will_retry: true }
[2016-10-19 17:45:03.599] [INFO] console - retrying in 5 s
[2016-10-19 17:45:08.605] [INFO] console - trying to create WAMP transport of type: websocket
[2016-10-19 17:45:08.607] [INFO] console - using WAMP transport type: websocket
[2016-10-19 17:45:08.611] [INFO] Server - connection.onclose() unreachable { reason: null,
  message: null,
  retry_delay: 5,
  retry_count: 31,
  will_retry: true }
[2016-10-19 17:45:08.612] [INFO] console - retrying in 5 s
[2016-10-19 17:45:08.613] [INFO] Server - connection.onclose() unreachable { reason: null,
  message: null,
  retry_delay: 5,
  retry_count: 32,
  will_retry: true }
[2016-10-19 17:45:08.614] [INFO] console - retrying in 5 s
[2016-10-19 17:45:13.616] [INFO] console - trying to create WAMP transport of type: websocket
[2016-10-19 17:45:13.622] [INFO] console - using WAMP transport type: websocket
[2016-10-19 17:45:13.626] [INFO] Server - connection.onclose() unreachable { reason: null,
  message: null,
  retry_delay: 5,
  retry_count: 33,
  will_retry: true }
[2016-10-19 17:45:13.628] [INFO] console - retrying in 5 s
[2016-10-19 17:45:13.629] [INFO] Server - connection.onclose() unreachable { reason: null,
  message: null,
  retry_delay: 5,
  retry_count: 34,
  will_retry: true }
[2016-10-19 17:45:13.632] [INFO] console - retrying in 5 s
[2016-10-19 17:45:18.638] [INFO] console - trying to create WAMP transport of type: websocket
[2016-10-19 17:45:18.645] [INFO] console - using WAMP transport type: websocket
[2016-10-19 17:45:18.648] [INFO] Server - connection.onclose() unreachable { reason: null,
  message: null,
  retry_delay: 5,
  retry_count: 35,
  will_retry: true }
[2016-10-19 17:45:18.652] [INFO] console - retrying in 5 s
[2016-10-19 17:45:18.654] [INFO] Server - connection.onclose() unreachable { reason: null,
  message: null,
  retry_delay: 5,
  retry_count: 36,
  will_retry: true }
[2016-10-19 17:45:18.658] [INFO] console - retrying in 5 s
[2016-10-19 17:45:23.664] [INFO] console - trying to create WAMP transport of type: websocket
[2016-10-19 17:45:23.667] [INFO] console - using WAMP transport type: websocket
[2016-10-19 17:45:23.669] [INFO] Server - connection.onclose() unreachable { reason: null,
  message: null,
  retry_delay: 5,
  retry_count: 37,
  will_retry: true }
[2016-10-19 17:45:23.672] [INFO] console - retrying in 5 s
[2016-10-19 17:45:23.672] [INFO] Server - connection.onclose() unreachable { reason: null,
  message: null,
  retry_delay: 5,
  retry_count: 38,
  will_retry: true }
[2016-10-19 17:45:23.675] [INFO] console - retrying in 5 s
[2016-10-19 17:45:28.681] [INFO] console - trying to create WAMP transport of type: websocket
[2016-10-19 17:45:28.687] [INFO] console - using WAMP transport type: websocket
[2016-10-19 17:45:28.692] [INFO] Server - connection.onclose() unreachable { reason: null,
  message: null,
  retry_delay: 5,
  retry_count: 39,
  will_retry: true }
[2016-10-19 17:45:28.695] [INFO] console - retrying in 5 s
[2016-10-19 17:45:28.697] [INFO] Server - connection.onclose() unreachable { reason: null,
  message: null,
  retry_delay: 5,
  retry_count: 40,
  will_retry: true }
[2016-10-19 17:45:28.699] [INFO] console - retrying in 5 s
[2016-10-19 17:45:33.703] [INFO] console - trying to create WAMP transport of type: websocket
[2016-10-19 17:45:33.707] [INFO] console - using WAMP transport type: websocket
[2016-10-19 17:45:33.710] [INFO] Server - connection.onclose() unreachable { reason: null,
  message: null,
  retry_delay: 5,
  retry_count: 41,
  will_retry: true }
[2016-10-19 17:45:33.715] [INFO] console - retrying in 5 s
[2016-10-19 17:45:33.717] [INFO] Server - connection.onclose() unreachable { reason: null,
  message: null,
  retry_delay: 5,
  retry_count: 42,
  will_retry: true }
[2016-10-19 17:45:33.720] [INFO] console - retrying in 5 s
[2016-10-19 17:45:38.727] [INFO] console - trying to create WAMP transport of type: websocket
[2016-10-19 17:45:38.748] [INFO] console - using WAMP transport type: websocket
[2016-10-19 17:45:38.766] [INFO] Server - connection.onclose() unreachable { reason: null,
  message: null,
  retry_delay: 5,
  retry_count: 43,
  will_retry: true }
[2016-10-19 17:45:38.773] [INFO] console - retrying in 5 s
[2016-10-19 17:45:38.776] [INFO] Server - connection.onclose() unreachable { reason: null,
  message: null,
  retry_delay: 5,
  retry_count: 44,
  will_retry: true }
[2016-10-19 17:45:38.790] [INFO] console - retrying in 5 s
[2016-10-19 17:45:43.801] [INFO] console - trying to create WAMP transport of type: websocket
[2016-10-19 17:45:43.807] [INFO] console - using WAMP transport type: websocket
[2016-10-19 17:45:43.815] [INFO] Server - connection.onclose() unreachable { reason: null,
  message: null,
  retry_delay: 5,
  retry_count: 45,
  will_retry: true }
[2016-10-19 17:45:43.821] [INFO] console - retrying in 5 s
[2016-10-19 17:45:43.823] [INFO] Server - connection.onclose() unreachable { reason: null,
  message: null,
  retry_delay: 5,
  retry_count: 46,
  will_retry: true }
[2016-10-19 17:45:43.829] [INFO] console - retrying in 5 s
[2016-10-19 17:45:48.833] [INFO] console - trying to create WAMP transport of type: websocket
[2016-10-19 17:45:48.839] [INFO] console - using WAMP transport type: websocket
[2016-10-19 17:45:48.875] [INFO] console - [ 1,
  'kopa',
  { roles: 
     { caller: [Object],
       callee: [Object],
       publisher: [Object],
       subscriber: [Object] },
    authmethods: [ 'ticket' ],
    authid: 'server' } ]
[2016-10-19 17:45:48.909] [INFO] console - [ 5, 'server', {} ]
[2016-10-19 17:45:48.935] [INFO] Server - connection.onopen()
[2016-10-19 17:45:48.939] [INFO] console - [ 64, 5566497709621248, {}, 'ru.kopa.model.create' ]
[2016-10-19 17:45:48.951] [DEBUG] Server - api:model.create registered
[2016-10-19 17:45:48.954] [INFO] console - [ 64, 1977156026499072, {}, 'ru.kopa.model.get' ]
[2016-10-19 17:45:48.964] [DEBUG] Server - api:model.get registered
[2016-10-19 17:45:48.966] [INFO] console - [ 64, 8439792570204160, {}, 'ru.kopa.model.save' ]
[2016-10-19 17:45:48.975] [DEBUG] Server - api:model.save registered
[2016-10-19 17:45:48.978] [INFO] console - [ 64, 2547297611153408, {}, 'ru.kopa.pingPong' ]
[2016-10-19 17:45:49.000] [DEBUG] Server - api:pingPong registered
[2016-10-19 17:45:49.003] [INFO] console - [ 64, 2259302186221568, {}, 'ru.kopa.discloseCaller' ]
[2016-10-19 17:45:49.013] [DEBUG] Server - api:discloseCaller registered
[2016-10-19 17:45:49.014] [INFO] console - [ 64, 2486045385949184, {}, 'ru.kopa.pingPongDatabase' ]
[2016-10-19 17:45:49.024] [DEBUG] Server - api:pingPongDatabase registered
[2016-10-19 17:45:49.025] [INFO] console - [ 64, 1604935745536000, {}, 'ru.kopa.error' ]
[2016-10-19 17:45:49.033] [DEBUG] Server - api:error registered
[2016-10-19 17:45:49.034] [INFO] console - [ 64, 1086293480046592, {}, 'ru.kopa.unitTest.cleanTempData' ]
[2016-10-19 17:45:49.047] [DEBUG] Server - api:unitTest.cleanTempData registered
[2016-10-19 17:45:49.048] [INFO] console - [ 64, 4073726628855808, {}, 'ru.kopa.model.Kopnik.setStarshina' ]
[2016-10-19 17:45:49.056] [DEBUG] Server - api:model.Kopnik.setStarshina registered
[2016-10-19 17:45:49.058] [INFO] console - [ 64, 580061931503616, {}, 'ru.kopa.model.Kopnik.vote' ]
[2016-10-19 17:45:49.071] [DEBUG] Server - api:model.Kopnik.vote registered
[2016-10-19 17:45:49.072] [INFO] console - [ 64, 4092977762795520, {}, 'ru.kopa.model.Kopa.invite' ]
[2016-10-19 17:45:49.085] [DEBUG] Server - api:model.Kopa.invite registered
[2016-10-19 17:45:49.086] [INFO] console - [ 64, 867838910791680, {}, 'ru.kopa.model.Kopa.getDialog' ]
[2016-10-19 17:45:49.103] [DEBUG] Server - api:model.Kopa.getDialog registered
[2016-10-19 17:45:49.104] [INFO] console - [ 64, 6645618512494592, {}, 'ru.kopa.model.Kopa.getResult' ]
[2016-10-19 17:45:49.115] [DEBUG] Server - api:model.Kopa.getResult registered
[2016-10-19 17:45:49.122] [INFO] console - [ 64, 6678754977906688, {}, 'ru.kopa.model.Zemla.setParent' ]
[2016-10-19 17:45:49.132] [DEBUG] Server - api:model.Zemla.setParent registered
[2016-10-19 17:45:49.133] [INFO] console - [ 64, 5829844350795776, {}, 'ru.kopa.model.Zemla.promiseKopi' ]
[2016-10-19 17:45:49.147] [DEBUG] Server - api:model.Zemla.promiseKopi registered
[2016-10-19 17:45:49.148] [INFO] console - [ 64,
  7006375873871872,
  {},
  'ru.kopa.model.Predlozhenie.getGolosa' ]
[2016-10-19 17:45:49.161] [DEBUG] Server - api:model.Predlozhenie.getGolosa registered
[2016-10-19 17:45:49.162] [INFO] console - [ 64, 6815387572240384, {}, 'ru.kopa.unitTest.orderProc' ]
[2016-10-19 17:45:49.170] [DEBUG] Server - api:unitTest.orderProc registered
[2016-10-19 17:45:49.171] [INFO] Server - started
[2016-10-19 17:47:43.640] [INFO] console - [ 70, 3, {}, [ undefined ] ]
[2016-10-19 17:47:43.729] [ERROR] console - unhandledRejection handler. Reason: { [SequelizeConnectionRefusedError: connect ECONNREFUSED 127.0.0.1:5432]
  name: 'SequelizeConnectionRefusedError',
  message: 'connect ECONNREFUSED 127.0.0.1:5432',
  parent: 
   { [Error: connect ECONNREFUSED 127.0.0.1:5432]
     code: 'ECONNREFUSED',
     errno: 'ECONNREFUSED',
     syscall: 'connect',
     address: '127.0.0.1',
     port: 5432 },
  original: 
   { [Error: connect ECONNREFUSED 127.0.0.1:5432]
     code: 'ECONNREFUSED',
     errno: 'ECONNREFUSED',
     syscall: 'connect',
     address: '127.0.0.1',
     port: 5432 },
  'error@context': {} }
SequelizeConnectionRefusedError: connect ECONNREFUSED 127.0.0.1:5432
    at /home/alexey2baranov/htdocs/kp-sequelizejs/node_modules/sequelize/lib/dialects/postgres/connection-manager.js:98:20
    at [object Object].<anonymous> (/home/alexey2baranov/htdocs/kp-sequelizejs/node_modules/pg/lib/client.js:185:5)
    at emitOne (events.js:77:13)
    at [object Object].emit (events.js:169:7)
    at Socket.<anonymous> (/home/alexey2baranov/htdocs/kp-sequelizejs/node_modules/pg/lib/connection.js:71:10)
    at emitOne (events.js:77:13)
    at Socket.emit (events.js:169:7)
    at emitErrorNT (net.js:1269:8)
    at asyncWrap (/home/alexey2baranov/htdocs/kp-sequelizejs/node_modules/async-listener/glue.js:188:31)
    at nextTickCallbackWith2Args (node.js:442:9)
    at process._tickDomainCallback [as _tickCallback] (node.js:397:17) wrappedPromise {
  _c: [],
  _a: [],
  _s: 2,
  _d: true,
  _v: 
   { [SequelizeConnectionRefusedError: connect ECONNREFUSED 127.0.0.1:5432]
     name: 'SequelizeConnectionRefusedError',
     message: 'connect ECONNREFUSED 127.0.0.1:5432',
     parent: 
      { [Error: connect ECONNREFUSED 127.0.0.1:5432]
        code: 'ECONNREFUSED',
        errno: 'ECONNREFUSED',
        syscall: 'connect',
        address: '127.0.0.1',
        port: 5432 },
     original: 
      { [Error: connect ECONNREFUSED 127.0.0.1:5432]
        code: 'ECONNREFUSED',
        errno: 'ECONNREFUSED',
        syscall: 'connect',
        address: '127.0.0.1',
        port: 5432 },
     'error@context': {} },
  _h: 0,
  _n: false,
  __asl_wrapper: [Function] }
[2016-10-19 17:48:04.519] [INFO] console - [ 70, 5, {}, [ undefined ] ]
[2016-10-19 17:48:04.542] [ERROR] console - unhandledRejection handler. Reason: { [SequelizeConnectionRefusedError: connect ECONNREFUSED 127.0.0.1:5432]
  name: 'SequelizeConnectionRefusedError',
  message: 'connect ECONNREFUSED 127.0.0.1:5432',
  parent: 
   { [Error: connect ECONNREFUSED 127.0.0.1:5432]
     code: 'ECONNREFUSED',
     errno: 'ECONNREFUSED',
     syscall: 'connect',
     address: '127.0.0.1',
     port: 5432 },
  original: 
   { [Error: connect ECONNREFUSED 127.0.0.1:5432]
     code: 'ECONNREFUSED',
     errno: 'ECONNREFUSED',
     syscall: 'connect',
     address: '127.0.0.1',
     port: 5432 },
  'error@context': {} }
SequelizeConnectionRefusedError: connect ECONNREFUSED 127.0.0.1:5432
    at /home/alexey2baranov/htdocs/kp-sequelizejs/node_modules/sequelize/lib/dialects/postgres/connection-manager.js:98:20
    at [object Object].<anonymous> (/home/alexey2baranov/htdocs/kp-sequelizejs/node_modules/pg/lib/client.js:185:5)
    at emitOne (events.js:77:13)
    at [object Object].emit (events.js:169:7)
    at Socket.<anonymous> (/home/alexey2baranov/htdocs/kp-sequelizejs/node_modules/pg/lib/connection.js:71:10)
    at emitOne (events.js:77:13)
    at Socket.emit (events.js:169:7)
    at emitErrorNT (net.js:1269:8)
    at asyncWrap (/home/alexey2baranov/htdocs/kp-sequelizejs/node_modules/async-listener/glue.js:188:31)
    at nextTickCallbackWith2Args (node.js:442:9)
    at process._tickDomainCallback [as _tickCallback] (node.js:397:17) wrappedPromise {
  _c: [],
  _a: [],
  _s: 2,
  _d: true,
  _v: 
   { [SequelizeConnectionRefusedError: connect ECONNREFUSED 127.0.0.1:5432]
     name: 'SequelizeConnectionRefusedError',
     message: 'connect ECONNREFUSED 127.0.0.1:5432',
     parent: 
      { [Error: connect ECONNREFUSED 127.0.0.1:5432]
        code: 'ECONNREFUSED',
        errno: 'ECONNREFUSED',
        syscall: 'connect',
        address: '127.0.0.1',
        port: 5432 },
     original: 
      { [Error: connect ECONNREFUSED 127.0.0.1:5432]
        code: 'ECONNREFUSED',
        errno: 'ECONNREFUSED',
        syscall: 'connect',
        address: '127.0.0.1',
        port: 5432 },
     'error@context': {} },
  _h: 0,
  _n: false,
  __asl_wrapper: [Function] }
[2016-10-19 17:48:04.628] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 2 }
[2016-10-19 17:48:04.663] [ERROR] Server - { [SequelizeConnectionRefusedError: connect ECONNREFUSED 127.0.0.1:5432]
  name: 'SequelizeConnectionRefusedError',
  message: 'connect ECONNREFUSED 127.0.0.1:5432',
  parent: 
   { [Error: connect ECONNREFUSED 127.0.0.1:5432]
     code: 'ECONNREFUSED',
     errno: 'ECONNREFUSED',
     syscall: 'connect',
     address: '127.0.0.1',
     port: 5432 },
  original: 
   { [Error: connect ECONNREFUSED 127.0.0.1:5432]
     code: 'ECONNREFUSED',
     errno: 'ECONNREFUSED',
     syscall: 'connect',
     address: '127.0.0.1',
     port: 5432 },
  'error@context': {} }
SequelizeConnectionRefusedError: connect ECONNREFUSED 127.0.0.1:5432
    at /home/alexey2baranov/htdocs/kp-sequelizejs/node_modules/sequelize/lib/dialects/postgres/connection-manager.js:98:20
    at [object Object].<anonymous> (/home/alexey2baranov/htdocs/kp-sequelizejs/node_modules/pg/lib/client.js:185:5)
    at emitOne (events.js:77:13)
    at [object Object].emit (events.js:169:7)
    at Socket.<anonymous> (/home/alexey2baranov/htdocs/kp-sequelizejs/node_modules/pg/lib/connection.js:71:10)
    at emitOne (events.js:77:13)
    at Socket.emit (events.js:169:7)
    at emitErrorNT (net.js:1269:8)
    at asyncWrap (/home/alexey2baranov/htdocs/kp-sequelizejs/node_modules/async-listener/glue.js:188:31)
    at nextTickCallbackWith2Args (node.js:442:9)
    at process._tickDomainCallback [as _tickCallback] (node.js:397:17)
[2016-10-19 17:48:04.679] [INFO] console - [ 8,
  68,
  6,
  {},
  'SequelizeConnectionRefusedError',
  [ 'connect ECONNREFUSED 127.0.0.1:5432' ],
  { stack: 
     [ 'SequelizeConnectionRefusedError: connect ECONNREFUSED 127.0.0.1:5432',
       '    at /home/alexey2baranov/htdocs/kp-sequelizejs/node_modules/sequelize/lib/dialects/postgres/connection-manager.js:98:20',
       '    at [object Object].<anonymous> (/home/alexey2baranov/htdocs/kp-sequelizejs/node_modules/pg/lib/client.js:185:5)',
       '    at emitOne (events.js:77:13)',
       '    at [object Object].emit (events.js:169:7)',
       '    at Socket.<anonymous> (/home/alexey2baranov/htdocs/kp-sequelizejs/node_modules/pg/lib/connection.js:71:10)',
       '    at emitOne (events.js:77:13)',
       '    at Socket.emit (events.js:169:7)',
       '    at emitErrorNT (net.js:1269:8)',
       '    at asyncWrap (/home/alexey2baranov/htdocs/kp-sequelizejs/node_modules/async-listener/glue.js:188:31)',
       '    at nextTickCallbackWith2Args (node.js:442:9)',
       '    at process._tickDomainCallback [as _tickCallback] (node.js:397:17)' ] } ]
[2016-10-19 17:48:05.080] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 2 }
[2016-10-19 17:48:05.114] [ERROR] Server - { [SequelizeConnectionRefusedError: connect ECONNREFUSED 127.0.0.1:5432]
  name: 'SequelizeConnectionRefusedError',
  message: 'connect ECONNREFUSED 127.0.0.1:5432',
  parent: 
   { [Error: connect ECONNREFUSED 127.0.0.1:5432]
     code: 'ECONNREFUSED',
     errno: 'ECONNREFUSED',
     syscall: 'connect',
     address: '127.0.0.1',
     port: 5432 },
  original: 
   { [Error: connect ECONNREFUSED 127.0.0.1:5432]
     code: 'ECONNREFUSED',
     errno: 'ECONNREFUSED',
     syscall: 'connect',
     address: '127.0.0.1',
     port: 5432 },
  'error@context': {} }
SequelizeConnectionRefusedError: connect ECONNREFUSED 127.0.0.1:5432
    at /home/alexey2baranov/htdocs/kp-sequelizejs/node_modules/sequelize/lib/dialects/postgres/connection-manager.js:98:20
    at [object Object].<anonymous> (/home/alexey2baranov/htdocs/kp-sequelizejs/node_modules/pg/lib/client.js:185:5)
    at emitOne (events.js:77:13)
    at [object Object].emit (events.js:169:7)
    at Socket.<anonymous> (/home/alexey2baranov/htdocs/kp-sequelizejs/node_modules/pg/lib/connection.js:71:10)
    at emitOne (events.js:77:13)
    at Socket.emit (events.js:169:7)
    at emitErrorNT (net.js:1269:8)
    at asyncWrap (/home/alexey2baranov/htdocs/kp-sequelizejs/node_modules/async-listener/glue.js:188:31)
    at nextTickCallbackWith2Args (node.js:442:9)
    at process._tickDomainCallback [as _tickCallback] (node.js:397:17)
[2016-10-19 17:48:05.169] [INFO] console - [ 8,
  68,
  7,
  {},
  'SequelizeConnectionRefusedError',
  [ 'connect ECONNREFUSED 127.0.0.1:5432' ],
  { stack: 
     [ 'SequelizeConnectionRefusedError: connect ECONNREFUSED 127.0.0.1:5432',
       '    at /home/alexey2baranov/htdocs/kp-sequelizejs/node_modules/sequelize/lib/dialects/postgres/connection-manager.js:98:20',
       '    at [object Object].<anonymous> (/home/alexey2baranov/htdocs/kp-sequelizejs/node_modules/pg/lib/client.js:185:5)',
       '    at emitOne (events.js:77:13)',
       '    at [object Object].emit (events.js:169:7)',
       '    at Socket.<anonymous> (/home/alexey2baranov/htdocs/kp-sequelizejs/node_modules/pg/lib/connection.js:71:10)',
       '    at emitOne (events.js:77:13)',
       '    at Socket.emit (events.js:169:7)',
       '    at emitErrorNT (net.js:1269:8)',
       '    at asyncWrap (/home/alexey2baranov/htdocs/kp-sequelizejs/node_modules/async-listener/glue.js:188:31)',
       '    at nextTickCallbackWith2Args (node.js:442:9)',
       '    at process._tickDomainCallback [as _tickCallback] (node.js:397:17)' ] } ]
[2016-10-19 17:48:05.233] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 4 }
[2016-10-19 17:48:05.293] [ERROR] Server - { [SequelizeConnectionRefusedError: connect ECONNREFUSED 127.0.0.1:5432]
  name: 'SequelizeConnectionRefusedError',
  message: 'connect ECONNREFUSED 127.0.0.1:5432',
  parent: 
   { [Error: connect ECONNREFUSED 127.0.0.1:5432]
     code: 'ECONNREFUSED',
     errno: 'ECONNREFUSED',
     syscall: 'connect',
     address: '127.0.0.1',
     port: 5432 },
  original: 
   { [Error: connect ECONNREFUSED 127.0.0.1:5432]
     code: 'ECONNREFUSED',
     errno: 'ECONNREFUSED',
     syscall: 'connect',
     address: '127.0.0.1',
     port: 5432 },
  'error@context': {} }
SequelizeConnectionRefusedError: connect ECONNREFUSED 127.0.0.1:5432
    at /home/alexey2baranov/htdocs/kp-sequelizejs/node_modules/sequelize/lib/dialects/postgres/connection-manager.js:98:20
    at [object Object].<anonymous> (/home/alexey2baranov/htdocs/kp-sequelizejs/node_modules/pg/lib/client.js:185:5)
    at emitOne (events.js:77:13)
    at [object Object].emit (events.js:169:7)
    at Socket.<anonymous> (/home/alexey2baranov/htdocs/kp-sequelizejs/node_modules/pg/lib/connection.js:71:10)
    at emitOne (events.js:77:13)
    at Socket.emit (events.js:169:7)
    at emitErrorNT (net.js:1269:8)
    at asyncWrap (/home/alexey2baranov/htdocs/kp-sequelizejs/node_modules/async-listener/glue.js:188:31)
    at nextTickCallbackWith2Args (node.js:442:9)
    at process._tickDomainCallback [as _tickCallback] (node.js:397:17)
[2016-10-19 17:48:05.347] [INFO] console - [ 8,
  68,
  8,
  {},
  'SequelizeConnectionRefusedError',
  [ 'connect ECONNREFUSED 127.0.0.1:5432' ],
  { stack: 
     [ 'SequelizeConnectionRefusedError: connect ECONNREFUSED 127.0.0.1:5432',
       '    at /home/alexey2baranov/htdocs/kp-sequelizejs/node_modules/sequelize/lib/dialects/postgres/connection-manager.js:98:20',
       '    at [object Object].<anonymous> (/home/alexey2baranov/htdocs/kp-sequelizejs/node_modules/pg/lib/client.js:185:5)',
       '    at emitOne (events.js:77:13)',
       '    at [object Object].emit (events.js:169:7)',
       '    at Socket.<anonymous> (/home/alexey2baranov/htdocs/kp-sequelizejs/node_modules/pg/lib/connection.js:71:10)',
       '    at emitOne (events.js:77:13)',
       '    at Socket.emit (events.js:169:7)',
       '    at emitErrorNT (net.js:1269:8)',
       '    at asyncWrap (/home/alexey2baranov/htdocs/kp-sequelizejs/node_modules/async-listener/glue.js:188:31)',
       '    at nextTickCallbackWith2Args (node.js:442:9)',
       '    at process._tickDomainCallback [as _tickCallback] (node.js:397:17)' ] } ]
[2016-10-19 17:48:05.432] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 2 }
[2016-10-19 17:48:05.491] [ERROR] Server - { [SequelizeConnectionRefusedError: connect ECONNREFUSED 127.0.0.1:5432]
  name: 'SequelizeConnectionRefusedError',
  message: 'connect ECONNREFUSED 127.0.0.1:5432',
  parent: 
   { [Error: connect ECONNREFUSED 127.0.0.1:5432]
     code: 'ECONNREFUSED',
     errno: 'ECONNREFUSED',
     syscall: 'connect',
     address: '127.0.0.1',
     port: 5432 },
  original: 
   { [Error: connect ECONNREFUSED 127.0.0.1:5432]
     code: 'ECONNREFUSED',
     errno: 'ECONNREFUSED',
     syscall: 'connect',
     address: '127.0.0.1',
     port: 5432 },
  'error@context': {} }
SequelizeConnectionRefusedError: connect ECONNREFUSED 127.0.0.1:5432
    at /home/alexey2baranov/htdocs/kp-sequelizejs/node_modules/sequelize/lib/dialects/postgres/connection-manager.js:98:20
    at [object Object].<anonymous> (/home/alexey2baranov/htdocs/kp-sequelizejs/node_modules/pg/lib/client.js:185:5)
    at emitOne (events.js:77:13)
    at [object Object].emit (events.js:169:7)
    at Socket.<anonymous> (/home/alexey2baranov/htdocs/kp-sequelizejs/node_modules/pg/lib/connection.js:71:10)
    at emitOne (events.js:77:13)
    at Socket.emit (events.js:169:7)
    at emitErrorNT (net.js:1269:8)
    at asyncWrap (/home/alexey2baranov/htdocs/kp-sequelizejs/node_modules/async-listener/glue.js:188:31)
    at nextTickCallbackWith2Args (node.js:442:9)
    at process._tickDomainCallback [as _tickCallback] (node.js:397:17)
[2016-10-19 17:48:05.539] [INFO] console - [ 8,
  68,
  9,
  {},
  'SequelizeConnectionRefusedError',
  [ 'connect ECONNREFUSED 127.0.0.1:5432' ],
  { stack: 
     [ 'SequelizeConnectionRefusedError: connect ECONNREFUSED 127.0.0.1:5432',
       '    at /home/alexey2baranov/htdocs/kp-sequelizejs/node_modules/sequelize/lib/dialects/postgres/connection-manager.js:98:20',
       '    at [object Object].<anonymous> (/home/alexey2baranov/htdocs/kp-sequelizejs/node_modules/pg/lib/client.js:185:5)',
       '    at emitOne (events.js:77:13)',
       '    at [object Object].emit (events.js:169:7)',
       '    at Socket.<anonymous> (/home/alexey2baranov/htdocs/kp-sequelizejs/node_modules/pg/lib/connection.js:71:10)',
       '    at emitOne (events.js:77:13)',
       '    at Socket.emit (events.js:169:7)',
       '    at emitErrorNT (net.js:1269:8)',
       '    at asyncWrap (/home/alexey2baranov/htdocs/kp-sequelizejs/node_modules/async-listener/glue.js:188:31)',
       '    at nextTickCallbackWith2Args (node.js:442:9)',
       '    at process._tickDomainCallback [as _tickCallback] (node.js:397:17)' ] } ]
[2016-10-19 17:48:54.670] [INFO] console - [ 70, 11, {}, [ undefined ] ]
[2016-10-19 17:48:54.702] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 2 }
[2016-10-19 17:48:54.978] [INFO] console - Executing (default): delete from "Kopnik"
                where
                    name like '%temp'
                    or name like 'temp%'
[2016-10-19 17:48:54.992] [INFO] console - Executing (824268ab-e7f9-4673-b947-b0801dd15bdf): START TRANSACTION;
[2016-10-19 17:48:54.995] [INFO] console - Executing (824268ab-e7f9-4673-b947-b0801dd15bdf): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:48:55.199] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 17:48:55.232] [INFO] console - Executing (default): update "Kopnik"
                set 
                    "voiskoSize"= case when id=2 then 1 ELSE 0 END
                where
                    id>1 
                    and id<=5
[2016-10-19 17:48:55.246] [INFO] console - Executing (824268ab-e7f9-4673-b947-b0801dd15bdf): COMMIT;
[2016-10-19 17:48:55.251] [INFO] console - [ 70,
  12,
  {},
  [ { fullName: 'Unit Test',
      fullPath: '/2/',
      id: '2',
      email: 'unittest2@domain.ru',
      name: 'Unit',
      surname: 'Test',
      patronymic: '1',
      voiskoSize: 2,
      birth: 1983,
      path: '/',
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: null,
      attachments: [] } ] ]
[2016-10-19 17:48:55.752] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 17:48:55.776] [INFO] console - Executing (30414672-f2f2-4339-93a1-335796bd6c39): START TRANSACTION;
[2016-10-19 17:48:55.779] [INFO] console - Executing (30414672-f2f2-4339-93a1-335796bd6c39): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:48:55.817] [INFO] console - Executing (30414672-f2f2-4339-93a1-335796bd6c39): INSERT INTO "Kopnik" ("id","name","surname","patronymic","voiskoSize","birth","path","created_at","updated_at","dom_id","starshina_id") VALUES (DEFAULT,'temp','temp','temp',0,1900,'/','2016-10-19 12:48:55.786 +00:00','2016-10-19 12:48:55.786 +00:00',2,NULL) RETURNING *;
[2016-10-19 17:48:55.853] [INFO] console - Executing (30414672-f2f2-4339-93a1-335796bd6c39): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 17:48:55.868] [INFO] console - Executing (30414672-f2f2-4339-93a1-335796bd6c39): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 17:48:55.876] [INFO] console - Executing (30414672-f2f2-4339-93a1-335796bd6c39): update "Zemla"
                                    set "obshinaSize"= "obshinaSize"+ 1
                                where
                                    '/1/' like path||id||'/%'
                                    or (
                                        true 
                                        and id= 2
                                    )
[2016-10-19 17:48:55.887] [INFO] console - Executing (30414672-f2f2-4339-93a1-335796bd6c39): COMMIT;
[2016-10-19 17:48:55.891] [INFO] console - [ 70, 13, {}, [ '7' ] ]
[2016-10-19 17:48:55.905] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 17:48:55.920] [INFO] console - Executing (default): select z.*
                                    from "Zemla" as z
                                where
                                    '/1/' like z.path||z.id||'/%'
[2016-10-19 17:48:55.943] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" IN ('1')) ORDER BY "Zemla"."path" desc;
[2016-10-19 17:48:55.953] [INFO] console - Executing (9ddac1d1-50ea-4ccd-ab7d-afce6513ce6d): START TRANSACTION;
[2016-10-19 17:48:55.961] [INFO] console - Executing (9ddac1d1-50ea-4ccd-ab7d-afce6513ce6d): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:48:55.966] [INFO] console - [ 16,
  7880499536068608,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id2.obshinaChange',
  [],
  { obshinaSize: 5 } ]
[2016-10-19 17:48:55.981] [INFO] console - [ 16,
  3094738651578368,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id1.obshinaChange',
  [],
  { obshinaSize: 7 } ]
[2016-10-19 17:48:56.033] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 7);
[2016-10-19 17:48:56.064] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 17:48:56.077] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 17:48:56.094] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 17:48:56.110] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 17:48:56.153] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='2',"updated_at"='2016-10-19 12:48:56.115 +00:00' WHERE "id" = '7'
[2016-10-19 17:48:56.168] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/', '/2/')
                                where
                                    id = '7'
                                    or path like '/7/'||'%'
[2016-10-19 17:48:56.191] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 17:48:56.198] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 17:48:56.230] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 17:48:56.257] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/2/7/'||'%'
[2016-10-19 17:48:56.263] [INFO] console - Executing (9ddac1d1-50ea-4ccd-ab7d-afce6513ce6d): COMMIT;
[2016-10-19 17:48:56.269] [INFO] console - [ 70, 14, {}, [ undefined ] ]
[2016-10-19 17:48:56.275] [INFO] console - [ 16,
  4452739348168704,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 2 } ]
[2016-10-19 17:48:56.316] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 17:48:56.326] [INFO] console - Executing (f3f51041-aa55-4575-af91-d867f369af42): START TRANSACTION;
[2016-10-19 17:48:56.332] [INFO] console - Executing (f3f51041-aa55-4575-af91-d867f369af42): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:48:56.353] [INFO] console - Executing (f3f51041-aa55-4575-af91-d867f369af42): INSERT INTO "Kopnik" ("id","name","surname","patronymic","voiskoSize","birth","path","created_at","updated_at","dom_id","starshina_id") VALUES (DEFAULT,'temp','temp','temp',0,1900,'/','2016-10-19 12:48:56.337 +00:00','2016-10-19 12:48:56.337 +00:00',2,NULL) RETURNING *;
[2016-10-19 17:48:56.424] [INFO] console - Executing (f3f51041-aa55-4575-af91-d867f369af42): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 17:48:56.437] [INFO] console - Executing (f3f51041-aa55-4575-af91-d867f369af42): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 17:48:56.487] [INFO] console - Executing (f3f51041-aa55-4575-af91-d867f369af42): update "Zemla"
                                    set "obshinaSize"= "obshinaSize"+ 1
                                where
                                    '/1/' like path||id||'/%'
                                    or (
                                        true 
                                        and id= 2
                                    )
[2016-10-19 17:48:56.500] [INFO] console - Executing (f3f51041-aa55-4575-af91-d867f369af42): COMMIT;
[2016-10-19 17:48:56.510] [INFO] console - [ 70, 15, {}, [ '8' ] ]
[2016-10-19 17:48:56.533] [INFO] console - Executing (f423e141-4aec-4bc7-8e6a-78d02e6e33fc): START TRANSACTION;
[2016-10-19 17:48:56.539] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 17:48:56.546] [INFO] console - Executing (f423e141-4aec-4bc7-8e6a-78d02e6e33fc): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:48:56.550] [INFO] console - Executing (default): select z.*
                                    from "Zemla" as z
                                where
                                    '/1/' like z.path||z.id||'/%'
[2016-10-19 17:48:56.563] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 8);
[2016-10-19 17:48:56.575] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" IN ('1')) ORDER BY "Zemla"."path" desc;
[2016-10-19 17:48:56.585] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 7);
[2016-10-19 17:48:56.602] [INFO] console - [ 16,
  4837933406224384,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id2.obshinaChange',
  [],
  { obshinaSize: 6 } ]
[2016-10-19 17:48:56.614] [INFO] console - [ 16,
  5361710818918400,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id1.obshinaChange',
  [],
  { obshinaSize: 8 } ]
[2016-10-19 17:48:56.630] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 17:48:56.643] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 17:48:56.650] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 17:48:56.749] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='7',"updated_at"='2016-10-19 12:48:56.668 +00:00' WHERE "id" = '8'
[2016-10-19 17:48:56.773] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/', '/2/7/')
                                where
                                    id = '8'
                                    or path like '/8/'||'%'
[2016-10-19 17:48:57.103] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/2/7/' like path||id||'/%'
[2016-10-19 17:48:57.129] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/7/' like k.path||k.id||'/%'
[2016-10-19 17:48:57.170] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('7', '2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 17:48:57.181] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/2/7/8/'||'%'
[2016-10-19 17:48:57.191] [INFO] console - Executing (f423e141-4aec-4bc7-8e6a-78d02e6e33fc): COMMIT;
[2016-10-19 17:48:57.196] [INFO] console - [ 70, 16, {}, [ undefined ] ]
[2016-10-19 17:48:57.203] [INFO] console - [ 16,
  550339493232640,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id7.voiskoChange',
  [],
  { voiskoSize: 1 } ]
[2016-10-19 17:48:57.215] [INFO] console - [ 16,
  4448297831890944,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 3 } ]
[2016-10-19 17:48:57.248] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 4 }
[2016-10-19 17:48:57.263] [INFO] console - Executing (63f5dd90-aab8-4d0e-b5dd-245a7e1fbb28): START TRANSACTION;
[2016-10-19 17:48:57.276] [INFO] console - Executing (63f5dd90-aab8-4d0e-b5dd-245a7e1fbb28): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:48:57.315] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 4);
[2016-10-19 17:48:57.361] [INFO] console - Executing (63f5dd90-aab8-4d0e-b5dd-245a7e1fbb28): COMMIT;
[2016-10-19 17:48:57.366] [INFO] console - [ 70,
  17,
  {},
  [ { fullName: 'Unit Test',
      fullPath: '/4/',
      id: '4',
      email: 'unittest4@domain.ru',
      name: 'Unit',
      surname: 'Test',
      patronymic: '4',
      voiskoSize: 0,
      birth: 1983,
      path: '/',
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: null,
      attachments: [] } ] ]
[2016-10-19 17:48:57.417] [INFO] console - Executing (2d7e5e4e-f1ce-4507-9861-afb4f0ab7d3e): START TRANSACTION;
[2016-10-19 17:48:57.422] [INFO] console - Executing (2d7e5e4e-f1ce-4507-9861-afb4f0ab7d3e): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:48:57.450] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 7);
[2016-10-19 17:48:57.466] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 4);
[2016-10-19 17:48:57.486] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 17:48:57.505] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 17:48:57.519] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-2
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 17:48:57.535] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='4',"updated_at"='2016-10-19 12:48:57.524 +00:00' WHERE "id" = '7'
[2016-10-19 17:48:57.545] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/2/', '/4/')
                                where
                                    id = '7'
                                    or path like '/2/7/'||'%'
[2016-10-19 17:48:57.558] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+2
                                where
                                    '/4/' like path||id||'/%'
[2016-10-19 17:48:57.565] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/4/' like k.path||k.id||'/%'
[2016-10-19 17:48:57.585] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('4')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 17:48:57.596] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/4/7/'||'%'
[2016-10-19 17:48:57.606] [INFO] console - Executing (2d7e5e4e-f1ce-4507-9861-afb4f0ab7d3e): COMMIT;
[2016-10-19 17:48:57.621] [INFO] console - [ 70, 18, {}, [ undefined ] ]
[2016-10-19 17:48:57.635] [INFO] console - [ 16,
  6002121080045568,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 1 } ]
[2016-10-19 17:48:57.648] [INFO] console - [ 16,
  4820590965817344,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id4.voiskoChange',
  [],
  { voiskoSize: 2 } ]
[2016-10-19 17:48:57.658] [INFO] console - [ 16,
  2439070416371712,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id8.starshinaChange',
  [],
  {} ]
[2016-10-19 17:48:57.678] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 8 }
[2016-10-19 17:48:57.685] [INFO] console - Executing (e95336af-e72d-446b-a437-496a5a9d2cae): START TRANSACTION;
[2016-10-19 17:48:57.688] [INFO] console - Executing (e95336af-e72d-446b-a437-496a5a9d2cae): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:48:57.710] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 8);
[2016-10-19 17:48:57.723] [INFO] console - Executing (e95336af-e72d-446b-a437-496a5a9d2cae): COMMIT;
[2016-10-19 17:48:57.726] [INFO] console - [ 70,
  19,
  {},
  [ { fullName: 'temp temp',
      fullPath: '/4/7/8/',
      id: '8',
      email: null,
      name: 'temp',
      surname: 'temp',
      patronymic: 'temp',
      voiskoSize: 0,
      birth: 1900,
      path: '/4/7/',
      note: null,
      created_at: Wed Oct 19 2016 17:48:56 GMT+0500 (YEKT),
      updated_at: Wed Oct 19 2016 17:48:56 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: '7',
      attachments: [] } ] ]
[2016-10-19 17:48:57.752] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 7 }
[2016-10-19 17:48:57.759] [INFO] console - Executing (5cec0e06-fa30-433b-ad14-e8ed9fc61fbc): START TRANSACTION;
[2016-10-19 17:48:57.762] [INFO] console - Executing (5cec0e06-fa30-433b-ad14-e8ed9fc61fbc): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:48:57.778] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 7);
[2016-10-19 17:48:57.790] [INFO] console - Executing (5cec0e06-fa30-433b-ad14-e8ed9fc61fbc): COMMIT;
[2016-10-19 17:48:57.793] [INFO] console - [ 70,
  20,
  {},
  [ { fullName: 'temp temp',
      fullPath: '/4/7/',
      id: '7',
      email: null,
      name: 'temp',
      surname: 'temp',
      patronymic: 'temp',
      voiskoSize: 1,
      birth: 1900,
      path: '/4/',
      note: null,
      created_at: Wed Oct 19 2016 17:48:55 GMT+0500 (YEKT),
      updated_at: Wed Oct 19 2016 17:48:57 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: '4',
      attachments: [] } ] ]
[2016-10-19 17:48:57.827] [DEBUG] Server - #promiseModel() [] { model: 'Kopa', id: 3 }
[2016-10-19 17:48:57.836] [INFO] console - Executing (e0fe2a6b-1f5b-4004-8a63-b462400de56d): START TRANSACTION;
[2016-10-19 17:48:57.839] [INFO] console - Executing (e0fe2a6b-1f5b-4004-8a63-b462400de56d): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:48:57.861] [INFO] console - Executing (default): SELECT "Kopa"."id", "Kopa"."question", "Kopa"."invited", "Kopa"."note", "Kopa"."created_at", "Kopa"."updated_at", "Kopa"."deleted_at", "Kopa"."place_id", "Kopa"."inviter_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopa" AS "Kopa" LEFT OUTER JOIN "File" AS "attachments" ON "Kopa"."id" = "attachments"."kopa_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopa"."deleted_at" IS NULL AND "Kopa"."id" = 3);
[2016-10-19 17:48:57.878] [INFO] console - Executing (e0fe2a6b-1f5b-4004-8a63-b462400de56d): COMMIT;
[2016-10-19 17:48:57.883] [INFO] console - [ 70,
  21,
  {},
  [ { id: '3',
      question: 'CHE',
      invited: Thu Sep 01 2016 00:00:00 GMT+0500 (YEKT),
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      place_id: '2',
      inviter_id: '2',
      attachments: [] } ] ]
[2016-10-19 17:48:57.918] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 17:48:57.926] [INFO] console - Executing (0541f2e4-0639-410d-90d8-95d82931f321): START TRANSACTION;
[2016-10-19 17:48:57.929] [INFO] console - Executing (0541f2e4-0639-410d-90d8-95d82931f321): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:48:57.944] [INFO] console - Executing (0541f2e4-0639-410d-90d8-95d82931f321): INSERT INTO "Predlozhenie" ("id","value","totalZa","totalProtiv","created_at","updated_at","author_id","place_id") VALUES (DEFAULT,'temp Wed Oct 19 2016 17:48:57 GMT+0500 (YEKT)',0,0,'2016-10-19 12:48:57.935 +00:00','2016-10-19 12:48:57.935 +00:00',2,3) RETURNING *;
[2016-10-19 17:48:57.956] [INFO] console - Executing (0541f2e4-0639-410d-90d8-95d82931f321): COMMIT;
[2016-10-19 17:48:57.963] [INFO] console - [ 70, 22, {}, [ '4' ] ]
[2016-10-19 17:48:57.972] [INFO] console - [ 16,
  8638368856408064,
  { acknowledge: true },
  'ru.kopa.model.Kopa.id3.predlozhenieAdd',
  [ '4' ] ]
[2016-10-19 17:48:57.993] [INFO] console - Executing (c99d7331-8839-4a64-bef6-669e3ffeb54b): START TRANSACTION;
[2016-10-19 17:48:57.998] [INFO] console - Executing (c99d7331-8839-4a64-bef6-669e3ffeb54b): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:48:58.014] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 17:48:58.045] [INFO] console - Executing (default): SELECT "id", "value", "totalZa", "totalProtiv", "state", "note", "created_at", "updated_at", "deleted_at", "author_id", "place_id" FROM "Predlozhenie" AS "Predlozhenie" WHERE ("Predlozhenie"."deleted_at" IS NULL AND "Predlozhenie"."id" = 4);
[2016-10-19 17:48:58.086] [INFO] console - Executing (default): SELECT "id", "question", "invited", "note", "created_at", "updated_at", "deleted_at", "place_id", "inviter_id" FROM "Kopa" AS "Kopa" WHERE ("Kopa"."deleted_at" IS NULL AND "Kopa"."id" = '3');
[2016-10-19 17:48:58.123] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 17:48:58.143] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 17:48:58.153] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 17:48:58.167] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 17:48:58.185] [INFO] console - Executing (default): SELECT "id", "value", "reason", "note", "created_at", "updated_at", "deleted_at", "subject_id", "owner_id", "parent_id" FROM "Golos" AS "Golos" WHERE ("Golos"."deleted_at" IS NULL AND ("Golos"."subject_id" = '4' AND "Golos"."owner_id" = '2')) LIMIT 1;
[2016-10-19 17:48:58.208] [INFO] console - Executing (default): INSERT INTO "Golos" ("id","value","created_at","updated_at","subject_id","owner_id") VALUES (DEFAULT,1,'2016-10-19 12:48:58.198 +00:00','2016-10-19 12:48:58.198 +00:00','4','2') RETURNING *;
[2016-10-19 17:48:58.220] [INFO] console - Executing (default): insert into "Golos" (subject_id, value, owner_id, parent_id, created_at, updated_at)
                            (
                                select 4, 1, k.id, 17, current_timestamp, current_timestamp
                                from 
                                    "Kopnik" k
                                     join "Zemla" d on d.id= k.dom_id
                                where
                                    k.path like '/2/%'
                                    and d.path||d.id||'/' like '/1/2/%' 
                            )
[2016-10-19 17:48:58.231] [INFO] console - Executing (default): select
                            (select count(*) from "Golos" g where subject_id= 4 and value=1) "za",
                            (select count(*) from "Golos" g where subject_id= 4 and value=-1) "protiv"
[2016-10-19 17:48:58.253] [INFO] console - Executing (default): UPDATE "Predlozhenie" SET "totalZa"=2,"updated_at"='2016-10-19 12:48:58.240 +00:00' WHERE "id" = '4'
[2016-10-19 17:48:58.265] [INFO] console - Executing (c99d7331-8839-4a64-bef6-669e3ffeb54b): COMMIT;
[2016-10-19 17:48:58.272] [INFO] console - [ 70, 23, {}, [ undefined ] ]
[2016-10-19 17:48:58.277] [INFO] console - [ 16,
  6509167711879168,
  { acknowledge: true },
  'ru.kopa.model.Predlozhenie.id4.rebalance',
  [],
  { totalZa: 2,
    totalProtiv: 0,
    GOLOS: '17',
    action: 'add',
    value: 1 } ]
[2016-10-19 17:48:58.289] [INFO] console - Executing (417ca94a-a72a-47f1-a2da-b1c67aacfe45): START TRANSACTION;
[2016-10-19 17:48:58.293] [INFO] console - Executing (417ca94a-a72a-47f1-a2da-b1c67aacfe45): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:48:58.305] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 17:48:58.308] [DEBUG] Server - #promiseModel() [] { model: 'Golos', id: 17 }
[2016-10-19 17:48:58.318] [INFO] console - Executing (709d3b80-103e-46d1-9dda-5771204fca08): START TRANSACTION;
[2016-10-19 17:48:58.324] [INFO] console - Executing (709d3b80-103e-46d1-9dda-5771204fca08): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:48:58.332] [INFO] console - Executing (default): SELECT "id", "value", "totalZa", "totalProtiv", "state", "note", "created_at", "updated_at", "deleted_at", "author_id", "place_id" FROM "Predlozhenie" AS "Predlozhenie" WHERE ("Predlozhenie"."deleted_at" IS NULL AND "Predlozhenie"."id" = 4);
[2016-10-19 17:48:58.371] [INFO] console - Executing (default): SELECT "Golos"."id", "Golos"."value", "Golos"."reason", "Golos"."note", "Golos"."created_at", "Golos"."updated_at", "Golos"."deleted_at", "Golos"."subject_id", "Golos"."owner_id", "Golos"."parent_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Golos" AS "Golos" LEFT OUTER JOIN "File" AS "attachments" ON "Golos"."id" = "attachments"."golos_id" AND "attachments"."deleted_at" IS NULL WHERE ("Golos"."deleted_at" IS NULL AND "Golos"."id" = 17);
[2016-10-19 17:48:58.427] [INFO] console - Executing (default): SELECT "id", "question", "invited", "note", "created_at", "updated_at", "deleted_at", "place_id", "inviter_id" FROM "Kopa" AS "Kopa" WHERE ("Kopa"."deleted_at" IS NULL AND "Kopa"."id" = '3');
[2016-10-19 17:48:58.442] [INFO] console - Executing (709d3b80-103e-46d1-9dda-5771204fca08): COMMIT;
[2016-10-19 17:48:58.456] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 17:48:58.466] [INFO] console - [ 70,
  25,
  {},
  [ { id: '17',
      value: 1,
      reason: null,
      note: null,
      created_at: Wed Oct 19 2016 17:48:58 GMT+0500 (YEKT),
      updated_at: Wed Oct 19 2016 17:48:58 GMT+0500 (YEKT),
      deleted_at: null,
      subject_id: '4',
      owner_id: '2',
      parent_id: null,
      attachments: [] } ] ]
[2016-10-19 17:48:58.509] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 17:48:58.520] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 17:48:58.537] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 17:48:58.553] [INFO] console - Executing (default): SELECT "id", "value", "reason", "note", "created_at", "updated_at", "deleted_at", "subject_id", "owner_id", "parent_id" FROM "Golos" AS "Golos" WHERE ("Golos"."deleted_at" IS NULL AND ("Golos"."subject_id" = '4' AND "Golos"."owner_id" = '2')) LIMIT 1;
[2016-10-19 17:48:58.577] [INFO] console - Executing (default): delete from "Golos" 
                            where
                                subject_id= 4
                                and (
                                    id= 17
                                    or parent_id = 17
                                )
[2016-10-19 17:48:58.589] [INFO] console - Executing (default): select
                            (select count(*) from "Golos" g where subject_id= 4 and value=1) "za",
                            (select count(*) from "Golos" g where subject_id= 4 and value=-1) "protiv"
[2016-10-19 17:48:58.625] [INFO] console - Executing (default): UPDATE "Predlozhenie" SET "totalZa"=0,"updated_at"='2016-10-19 12:48:58.598 +00:00' WHERE "id" = '4'
[2016-10-19 17:48:58.642] [INFO] console - Executing (417ca94a-a72a-47f1-a2da-b1c67aacfe45): COMMIT;
[2016-10-19 17:48:58.650] [INFO] console - [ 70, 24, {}, [ undefined ] ]
[2016-10-19 17:48:58.667] [INFO] console - [ 16,
  1008754388631552,
  { acknowledge: true },
  'ru.kopa.model.Predlozhenie.id4.rebalance',
  [],
  { totalZa: 0,
    totalProtiv: 0,
    GOLOS: '17',
    action: 'remove',
    value: 1 } ]
[2016-10-19 17:49:20.882] [INFO] console - [ 70, 27, {}, [ undefined ] ]
[2016-10-19 17:49:20.939] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 2 }
[2016-10-19 17:49:20.967] [INFO] console - Executing (default): delete from "Kopnik"
                where
                    name like '%temp'
                    or name like 'temp%'
[2016-10-19 17:49:20.999] [INFO] console - Executing (646c6c27-c8fb-4a5f-b94d-8d86f7c89695): START TRANSACTION;
[2016-10-19 17:49:21.011] [INFO] console - Executing (646c6c27-c8fb-4a5f-b94d-8d86f7c89695): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:49:21.088] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 17:49:21.114] [INFO] console - Executing (646c6c27-c8fb-4a5f-b94d-8d86f7c89695): COMMIT;
[2016-10-19 17:49:21.118] [INFO] console - [ 70,
  28,
  {},
  [ { fullName: 'Unit Test',
      fullPath: '/2/',
      id: '2',
      email: 'unittest2@domain.ru',
      name: 'Unit',
      surname: 'Test',
      patronymic: '1',
      voiskoSize: 1,
      birth: 1983,
      path: '/',
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: null,
      attachments: [] } ] ]
[2016-10-19 17:49:21.172] [INFO] console - Executing (default): update "Kopnik"
                set 
                    "voiskoSize"= case when id=2 then 1 ELSE 0 END
                where
                    id>1 
                    and id<=5
[2016-10-19 17:49:21.314] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 17:49:21.328] [INFO] console - Executing (9e8f677c-936c-4b0a-b426-6442e2adee7c): START TRANSACTION;
[2016-10-19 17:49:21.332] [INFO] console - Executing (9e8f677c-936c-4b0a-b426-6442e2adee7c): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:49:21.354] [INFO] console - Executing (9e8f677c-936c-4b0a-b426-6442e2adee7c): INSERT INTO "Kopnik" ("id","name","surname","patronymic","voiskoSize","birth","path","created_at","updated_at","dom_id","starshina_id") VALUES (DEFAULT,'temp','temp','temp',0,1900,'/','2016-10-19 12:49:21.337 +00:00','2016-10-19 12:49:21.337 +00:00',2,NULL) RETURNING *;
[2016-10-19 17:49:21.364] [INFO] console - Executing (9e8f677c-936c-4b0a-b426-6442e2adee7c): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 17:49:21.380] [INFO] console - Executing (9e8f677c-936c-4b0a-b426-6442e2adee7c): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 17:49:21.393] [INFO] console - Executing (9e8f677c-936c-4b0a-b426-6442e2adee7c): update "Zemla"
                                    set "obshinaSize"= "obshinaSize"+ 1
                                where
                                    '/1/' like path||id||'/%'
                                    or (
                                        true 
                                        and id= 2
                                    )
[2016-10-19 17:49:21.400] [INFO] console - Executing (9e8f677c-936c-4b0a-b426-6442e2adee7c): COMMIT;
[2016-10-19 17:49:21.407] [INFO] console - [ 70, 29, {}, [ '9' ] ]
[2016-10-19 17:49:21.426] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 17:49:21.441] [INFO] console - Executing (default): select z.*
                                    from "Zemla" as z
                                where
                                    '/1/' like z.path||z.id||'/%'
[2016-10-19 17:49:21.444] [INFO] console - Executing (be219ff5-42a1-4655-b538-d672a625be20): START TRANSACTION;
[2016-10-19 17:49:21.451] [INFO] console - Executing (be219ff5-42a1-4655-b538-d672a625be20): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:49:21.461] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" IN ('1')) ORDER BY "Zemla"."path" desc;
[2016-10-19 17:49:21.475] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 9);
[2016-10-19 17:49:21.476] [INFO] console - [ 16,
  8918081833271296,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id2.obshinaChange',
  [],
  { obshinaSize: 7 } ]
[2016-10-19 17:49:21.492] [INFO] console - [ 16,
  1333673917939712,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id1.obshinaChange',
  [],
  { obshinaSize: 9 } ]
[2016-10-19 17:49:21.504] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 17:49:21.515] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 17:49:21.531] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 17:49:21.538] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 17:49:21.560] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='2',"updated_at"='2016-10-19 12:49:21.542 +00:00' WHERE "id" = '9'
[2016-10-19 17:49:21.576] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/', '/2/')
                                where
                                    id = '9'
                                    or path like '/9/'||'%'
[2016-10-19 17:49:21.632] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 17:49:21.646] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 17:49:21.661] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 17:49:21.670] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/2/9/'||'%'
[2016-10-19 17:49:21.677] [INFO] console - Executing (be219ff5-42a1-4655-b538-d672a625be20): COMMIT;
[2016-10-19 17:49:21.681] [INFO] console - [ 70, 30, {}, [ undefined ] ]
[2016-10-19 17:49:21.687] [INFO] console - [ 16,
  1602276923801600,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 2 } ]
[2016-10-19 17:49:21.720] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 17:49:21.730] [INFO] console - Executing (eb933de5-95e0-4ed6-a1ae-ad8e257bf24f): START TRANSACTION;
[2016-10-19 17:49:21.733] [INFO] console - Executing (eb933de5-95e0-4ed6-a1ae-ad8e257bf24f): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:49:21.750] [INFO] console - Executing (eb933de5-95e0-4ed6-a1ae-ad8e257bf24f): INSERT INTO "Kopnik" ("id","name","surname","patronymic","voiskoSize","birth","path","created_at","updated_at","dom_id","starshina_id") VALUES (DEFAULT,'temp','temp','temp',0,1900,'/','2016-10-19 12:49:21.737 +00:00','2016-10-19 12:49:21.737 +00:00',2,NULL) RETURNING *;
[2016-10-19 17:49:21.759] [INFO] console - Executing (eb933de5-95e0-4ed6-a1ae-ad8e257bf24f): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 17:49:21.775] [INFO] console - Executing (eb933de5-95e0-4ed6-a1ae-ad8e257bf24f): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 17:49:21.799] [INFO] console - Executing (eb933de5-95e0-4ed6-a1ae-ad8e257bf24f): update "Zemla"
                                    set "obshinaSize"= "obshinaSize"+ 1
                                where
                                    '/1/' like path||id||'/%'
                                    or (
                                        true 
                                        and id= 2
                                    )
[2016-10-19 17:49:21.807] [INFO] console - Executing (eb933de5-95e0-4ed6-a1ae-ad8e257bf24f): COMMIT;
[2016-10-19 17:49:21.814] [INFO] console - [ 70, 31, {}, [ '10' ] ]
[2016-10-19 17:49:21.853] [INFO] console - Executing (573d603a-fbcc-4439-a029-cfaccafa4bb1): START TRANSACTION;
[2016-10-19 17:49:21.875] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 17:49:21.884] [INFO] console - Executing (573d603a-fbcc-4439-a029-cfaccafa4bb1): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:49:21.897] [INFO] console - Executing (default): select z.*
                                    from "Zemla" as z
                                where
                                    '/1/' like z.path||z.id||'/%'
[2016-10-19 17:49:21.913] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 10);
[2016-10-19 17:49:21.933] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" IN ('1')) ORDER BY "Zemla"."path" desc;
[2016-10-19 17:49:21.955] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 9);
[2016-10-19 17:49:21.956] [INFO] console - [ 16,
  7711269303877632,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id2.obshinaChange',
  [],
  { obshinaSize: 8 } ]
[2016-10-19 17:49:22.004] [INFO] console - [ 16,
  8721472688226304,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id1.obshinaChange',
  [],
  { obshinaSize: 10 } ]
[2016-10-19 17:49:22.039] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 17:49:22.061] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 17:49:22.075] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 17:49:22.093] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='9',"updated_at"='2016-10-19 12:49:22.079 +00:00' WHERE "id" = '10'
[2016-10-19 17:49:22.098] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/', '/2/9/')
                                where
                                    id = '10'
                                    or path like '/10/'||'%'
[2016-10-19 17:49:22.107] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/2/9/' like path||id||'/%'
[2016-10-19 17:49:22.112] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/9/' like k.path||k.id||'/%'
[2016-10-19 17:49:22.128] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('9', '2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 17:49:22.137] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/2/9/10/'||'%'
[2016-10-19 17:49:22.142] [INFO] console - Executing (573d603a-fbcc-4439-a029-cfaccafa4bb1): COMMIT;
[2016-10-19 17:49:22.146] [INFO] console - [ 70, 32, {}, [ undefined ] ]
[2016-10-19 17:49:22.157] [INFO] console - [ 16,
  5494273204027392,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id9.voiskoChange',
  [],
  { voiskoSize: 1 } ]
[2016-10-19 17:49:22.167] [INFO] console - [ 16,
  4306841477578752,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 3 } ]
[2016-10-19 17:49:22.200] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 4 }
[2016-10-19 17:49:22.205] [INFO] console - Executing (5c647f7c-5001-46a6-abdd-949f75b7aa4d): START TRANSACTION;
[2016-10-19 17:49:22.213] [INFO] console - Executing (5c647f7c-5001-46a6-abdd-949f75b7aa4d): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:49:22.234] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 4);
[2016-10-19 17:49:22.247] [INFO] console - Executing (5c647f7c-5001-46a6-abdd-949f75b7aa4d): COMMIT;
[2016-10-19 17:49:22.251] [INFO] console - [ 70,
  33,
  {},
  [ { fullName: 'Unit Test',
      fullPath: '/4/',
      id: '4',
      email: 'unittest4@domain.ru',
      name: 'Unit',
      surname: 'Test',
      patronymic: '4',
      voiskoSize: 0,
      birth: 1983,
      path: '/',
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: null,
      attachments: [] } ] ]
[2016-10-19 17:49:22.276] [INFO] console - Executing (9c191d27-47d4-458e-afaf-1122268ee733): START TRANSACTION;
[2016-10-19 17:49:22.281] [INFO] console - Executing (9c191d27-47d4-458e-afaf-1122268ee733): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:49:22.294] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 9);
[2016-10-19 17:49:22.314] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 4);
[2016-10-19 17:49:22.323] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 17:49:22.337] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 17:49:22.346] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-2
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 17:49:22.361] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='4',"updated_at"='2016-10-19 12:49:22.349 +00:00' WHERE "id" = '9'
[2016-10-19 17:49:22.369] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/2/', '/4/')
                                where
                                    id = '9'
                                    or path like '/2/9/'||'%'
[2016-10-19 17:49:22.377] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+2
                                where
                                    '/4/' like path||id||'/%'
[2016-10-19 17:49:22.384] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/4/' like k.path||k.id||'/%'
[2016-10-19 17:49:22.398] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('4')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 17:49:22.407] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/4/9/'||'%'
[2016-10-19 17:49:22.413] [INFO] console - Executing (9c191d27-47d4-458e-afaf-1122268ee733): COMMIT;
[2016-10-19 17:49:22.416] [INFO] console - [ 70, 34, {}, [ undefined ] ]
[2016-10-19 17:49:22.421] [INFO] console - [ 16,
  7377960596144128,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 1 } ]
[2016-10-19 17:49:22.471] [INFO] console - [ 16,
  4273353760178176,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id4.voiskoChange',
  [],
  { voiskoSize: 2 } ]
[2016-10-19 17:49:22.485] [INFO] console - [ 16,
  5079334565969920,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id10.starshinaChange',
  [],
  {} ]
[2016-10-19 17:49:22.502] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 10 }
[2016-10-19 17:49:22.517] [INFO] console - Executing (72fe7a6f-c076-4ea5-a36a-41b79e2b6f1d): START TRANSACTION;
[2016-10-19 17:49:22.521] [INFO] console - Executing (72fe7a6f-c076-4ea5-a36a-41b79e2b6f1d): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:49:22.561] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 10);
[2016-10-19 17:49:22.601] [INFO] console - Executing (72fe7a6f-c076-4ea5-a36a-41b79e2b6f1d): COMMIT;
[2016-10-19 17:49:22.612] [INFO] console - [ 70,
  35,
  {},
  [ { fullName: 'temp temp',
      fullPath: '/4/9/10/',
      id: '10',
      email: null,
      name: 'temp',
      surname: 'temp',
      patronymic: 'temp',
      voiskoSize: 0,
      birth: 1900,
      path: '/4/9/',
      note: null,
      created_at: Wed Oct 19 2016 17:49:21 GMT+0500 (YEKT),
      updated_at: Wed Oct 19 2016 17:49:22 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: '9',
      attachments: [] } ] ]
[2016-10-19 17:49:22.720] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 9 }
[2016-10-19 17:49:22.733] [INFO] console - Executing (959058b5-c09d-4441-b0e5-ef3e0f430d88): START TRANSACTION;
[2016-10-19 17:49:22.736] [INFO] console - Executing (959058b5-c09d-4441-b0e5-ef3e0f430d88): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:49:22.780] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 9);
[2016-10-19 17:49:22.800] [INFO] console - Executing (959058b5-c09d-4441-b0e5-ef3e0f430d88): COMMIT;
[2016-10-19 17:49:22.815] [INFO] console - [ 70,
  36,
  {},
  [ { fullName: 'temp temp',
      fullPath: '/4/9/',
      id: '9',
      email: null,
      name: 'temp',
      surname: 'temp',
      patronymic: 'temp',
      voiskoSize: 1,
      birth: 1900,
      path: '/4/',
      note: null,
      created_at: Wed Oct 19 2016 17:49:21 GMT+0500 (YEKT),
      updated_at: Wed Oct 19 2016 17:49:22 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: '4',
      attachments: [] } ] ]
[2016-10-19 17:49:22.848] [DEBUG] Server - #promiseModel() [] { model: 'Kopa', id: 3 }
[2016-10-19 17:49:22.855] [INFO] console - Executing (91a3719e-cedb-44a9-bece-3dd5a9ab3f7b): START TRANSACTION;
[2016-10-19 17:49:22.860] [INFO] console - Executing (91a3719e-cedb-44a9-bece-3dd5a9ab3f7b): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:49:22.878] [INFO] console - Executing (default): SELECT "Kopa"."id", "Kopa"."question", "Kopa"."invited", "Kopa"."note", "Kopa"."created_at", "Kopa"."updated_at", "Kopa"."deleted_at", "Kopa"."place_id", "Kopa"."inviter_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopa" AS "Kopa" LEFT OUTER JOIN "File" AS "attachments" ON "Kopa"."id" = "attachments"."kopa_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopa"."deleted_at" IS NULL AND "Kopa"."id" = 3);
[2016-10-19 17:49:22.890] [INFO] console - Executing (91a3719e-cedb-44a9-bece-3dd5a9ab3f7b): COMMIT;
[2016-10-19 17:49:22.893] [INFO] console - [ 70,
  37,
  {},
  [ { id: '3',
      question: 'CHE',
      invited: Thu Sep 01 2016 00:00:00 GMT+0500 (YEKT),
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      place_id: '2',
      inviter_id: '2',
      attachments: [] } ] ]
[2016-10-19 17:49:22.943] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 17:49:22.952] [INFO] console - Executing (5927a43f-3bd6-4889-85bd-bd37088cda16): START TRANSACTION;
[2016-10-19 17:49:22.958] [INFO] console - Executing (5927a43f-3bd6-4889-85bd-bd37088cda16): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:49:22.970] [INFO] console - Executing (5927a43f-3bd6-4889-85bd-bd37088cda16): INSERT INTO "Predlozhenie" ("id","value","totalZa","totalProtiv","created_at","updated_at","author_id","place_id") VALUES (DEFAULT,'temp Wed Oct 19 2016 17:49:22 GMT+0500 (YEKT)',0,0,'2016-10-19 12:49:22.962 +00:00','2016-10-19 12:49:22.962 +00:00',2,3) RETURNING *;
[2016-10-19 17:49:22.978] [INFO] console - Executing (5927a43f-3bd6-4889-85bd-bd37088cda16): COMMIT;
[2016-10-19 17:49:22.982] [INFO] console - [ 70, 38, {}, [ '5' ] ]
[2016-10-19 17:49:22.987] [INFO] console - [ 16,
  7256720889872384,
  { acknowledge: true },
  'ru.kopa.model.Kopa.id3.predlozhenieAdd',
  [ '5' ] ]
[2016-10-19 17:49:23.050] [INFO] console - Executing (77aecf37-4dce-4e8a-a1fa-d0afa264662d): START TRANSACTION;
[2016-10-19 17:49:23.053] [INFO] console - Executing (77aecf37-4dce-4e8a-a1fa-d0afa264662d): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:49:23.063] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 17:49:23.087] [INFO] console - Executing (default): SELECT "id", "value", "totalZa", "totalProtiv", "state", "note", "created_at", "updated_at", "deleted_at", "author_id", "place_id" FROM "Predlozhenie" AS "Predlozhenie" WHERE ("Predlozhenie"."deleted_at" IS NULL AND "Predlozhenie"."id" = 5);
[2016-10-19 17:49:23.103] [INFO] console - Executing (default): SELECT "id", "question", "invited", "note", "created_at", "updated_at", "deleted_at", "place_id", "inviter_id" FROM "Kopa" AS "Kopa" WHERE ("Kopa"."deleted_at" IS NULL AND "Kopa"."id" = '3');
[2016-10-19 17:49:23.116] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 17:49:23.144] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 17:49:23.158] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 17:49:23.168] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 17:49:23.201] [INFO] console - Executing (default): SELECT "id", "value", "reason", "note", "created_at", "updated_at", "deleted_at", "subject_id", "owner_id", "parent_id" FROM "Golos" AS "Golos" WHERE ("Golos"."deleted_at" IS NULL AND ("Golos"."subject_id" = '5' AND "Golos"."owner_id" = '2')) LIMIT 1;
[2016-10-19 17:49:23.223] [INFO] console - Executing (default): INSERT INTO "Golos" ("id","value","created_at","updated_at","subject_id","owner_id") VALUES (DEFAULT,1,'2016-10-19 12:49:23.210 +00:00','2016-10-19 12:49:23.210 +00:00','5','2') RETURNING *;
[2016-10-19 17:49:23.266] [INFO] console - Executing (default): insert into "Golos" (subject_id, value, owner_id, parent_id, created_at, updated_at)
                            (
                                select 5, 1, k.id, 19, current_timestamp, current_timestamp
                                from 
                                    "Kopnik" k
                                     join "Zemla" d on d.id= k.dom_id
                                where
                                    k.path like '/2/%'
                                    and d.path||d.id||'/' like '/1/2/%' 
                            )
[2016-10-19 17:49:23.292] [INFO] console - Executing (default): select
                            (select count(*) from "Golos" g where subject_id= 5 and value=1) "za",
                            (select count(*) from "Golos" g where subject_id= 5 and value=-1) "protiv"
[2016-10-19 17:49:23.309] [INFO] console - Executing (default): UPDATE "Predlozhenie" SET "totalZa"=2,"updated_at"='2016-10-19 12:49:23.297 +00:00' WHERE "id" = '5'
[2016-10-19 17:49:23.333] [INFO] console - Executing (77aecf37-4dce-4e8a-a1fa-d0afa264662d): COMMIT;
[2016-10-19 17:49:23.336] [INFO] console - [ 70, 39, {}, [ undefined ] ]
[2016-10-19 17:49:23.352] [INFO] console - [ 16,
  5384944050241536,
  { acknowledge: true },
  'ru.kopa.model.Predlozhenie.id5.rebalance',
  [],
  { totalZa: 2,
    totalProtiv: 0,
    GOLOS: '19',
    action: 'add',
    value: 1 } ]
[2016-10-19 17:49:23.377] [INFO] console - Executing (86da544d-5a91-4c3c-afdf-74244bb661d3): START TRANSACTION;
[2016-10-19 17:49:23.386] [INFO] console - Executing (86da544d-5a91-4c3c-afdf-74244bb661d3): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:49:23.388] [DEBUG] Server - #promiseModel() [] { model: 'Golos', id: 19 }
[2016-10-19 17:49:23.398] [INFO] console - Executing (6ff2a7c9-9253-4bcc-b9c7-e4cf3b1805a0): START TRANSACTION;
[2016-10-19 17:49:23.405] [INFO] console - Executing (6ff2a7c9-9253-4bcc-b9c7-e4cf3b1805a0): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:49:23.412] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 17:49:23.443] [INFO] console - Executing (default): SELECT "Golos"."id", "Golos"."value", "Golos"."reason", "Golos"."note", "Golos"."created_at", "Golos"."updated_at", "Golos"."deleted_at", "Golos"."subject_id", "Golos"."owner_id", "Golos"."parent_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Golos" AS "Golos" LEFT OUTER JOIN "File" AS "attachments" ON "Golos"."id" = "attachments"."golos_id" AND "attachments"."deleted_at" IS NULL WHERE ("Golos"."deleted_at" IS NULL AND "Golos"."id" = 19);
[2016-10-19 17:49:23.455] [INFO] console - Executing (default): SELECT "id", "value", "totalZa", "totalProtiv", "state", "note", "created_at", "updated_at", "deleted_at", "author_id", "place_id" FROM "Predlozhenie" AS "Predlozhenie" WHERE ("Predlozhenie"."deleted_at" IS NULL AND "Predlozhenie"."id" = 5);
[2016-10-19 17:49:23.461] [INFO] console - Executing (6ff2a7c9-9253-4bcc-b9c7-e4cf3b1805a0): COMMIT;
[2016-10-19 17:49:23.475] [INFO] console - Executing (default): SELECT "id", "question", "invited", "note", "created_at", "updated_at", "deleted_at", "place_id", "inviter_id" FROM "Kopa" AS "Kopa" WHERE ("Kopa"."deleted_at" IS NULL AND "Kopa"."id" = '3');
[2016-10-19 17:49:23.477] [INFO] console - [ 70,
  41,
  {},
  [ { id: '19',
      value: 1,
      reason: null,
      note: null,
      created_at: Wed Oct 19 2016 17:49:23 GMT+0500 (YEKT),
      updated_at: Wed Oct 19 2016 17:49:23 GMT+0500 (YEKT),
      deleted_at: null,
      subject_id: '5',
      owner_id: '2',
      parent_id: null,
      attachments: [] } ] ]
[2016-10-19 17:49:23.530] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 17:49:23.554] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 17:49:23.572] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 17:49:23.585] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 17:49:23.600] [INFO] console - Executing (default): SELECT "id", "value", "reason", "note", "created_at", "updated_at", "deleted_at", "subject_id", "owner_id", "parent_id" FROM "Golos" AS "Golos" WHERE ("Golos"."deleted_at" IS NULL AND ("Golos"."subject_id" = '5' AND "Golos"."owner_id" = '2')) LIMIT 1;
[2016-10-19 17:49:23.615] [INFO] console - Executing (default): delete from "Golos" 
                            where
                                subject_id= 5
                                and (
                                    id= 19
                                    or parent_id = 19
                                )
[2016-10-19 17:49:23.629] [INFO] console - Executing (default): select
                            (select count(*) from "Golos" g where subject_id= 5 and value=1) "za",
                            (select count(*) from "Golos" g where subject_id= 5 and value=-1) "protiv"
[2016-10-19 17:49:23.693] [INFO] console - Executing (default): UPDATE "Predlozhenie" SET "totalZa"=0,"updated_at"='2016-10-19 12:49:23.647 +00:00' WHERE "id" = '5'
[2016-10-19 17:49:23.716] [INFO] console - Executing (86da544d-5a91-4c3c-afdf-74244bb661d3): COMMIT;
[2016-10-19 17:49:23.725] [INFO] console - [ 70, 40, {}, [ undefined ] ]
[2016-10-19 17:49:23.737] [INFO] console - [ 16,
  5048206568194048,
  { acknowledge: true },
  'ru.kopa.model.Predlozhenie.id5.rebalance',
  [],
  { totalZa: 0,
    totalProtiv: 0,
    GOLOS: '19',
    action: 'remove',
    value: 1 } ]
[2016-10-19 17:50:31.185] [INFO] console - [ 70, 43, {}, [ undefined ] ]
[2016-10-19 17:50:31.232] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 2 }
[2016-10-19 17:50:31.283] [INFO] console - Executing (default): delete from "Kopnik"
                where
                    name like '%temp'
                    or name like 'temp%'
[2016-10-19 17:50:31.292] [INFO] console - Executing (6834472f-ecf7-4268-8e16-4205fcd436a9): START TRANSACTION;
[2016-10-19 17:50:31.297] [INFO] console - Executing (6834472f-ecf7-4268-8e16-4205fcd436a9): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:50:31.305] [INFO] console - Executing (default): update "Kopnik"
                set 
                    "voiskoSize"= case when id=2 then 1 ELSE 0 END
                where
                    id>1 
                    and id<=5
[2016-10-19 17:50:31.321] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 17:50:31.339] [INFO] console - Executing (6834472f-ecf7-4268-8e16-4205fcd436a9): COMMIT;
[2016-10-19 17:50:31.343] [INFO] console - [ 70,
  44,
  {},
  [ { fullName: 'Unit Test',
      fullPath: '/2/',
      id: '2',
      email: 'unittest2@domain.ru',
      name: 'Unit',
      surname: 'Test',
      patronymic: '1',
      voiskoSize: 1,
      birth: 1983,
      path: '/',
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: null,
      attachments: [] } ] ]
[2016-10-19 17:50:31.451] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 17:50:31.461] [INFO] console - Executing (326bbb73-457c-4426-9d56-bbda0116b597): START TRANSACTION;
[2016-10-19 17:50:31.466] [INFO] console - Executing (326bbb73-457c-4426-9d56-bbda0116b597): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:50:31.493] [INFO] console - Executing (326bbb73-457c-4426-9d56-bbda0116b597): INSERT INTO "Kopnik" ("id","name","surname","patronymic","voiskoSize","birth","path","created_at","updated_at","dom_id","starshina_id") VALUES (DEFAULT,'temp','temp','temp',0,1900,'/','2016-10-19 12:50:31.471 +00:00','2016-10-19 12:50:31.471 +00:00',2,NULL) RETURNING *;
[2016-10-19 17:50:31.503] [INFO] console - Executing (326bbb73-457c-4426-9d56-bbda0116b597): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 17:50:31.527] [INFO] console - Executing (326bbb73-457c-4426-9d56-bbda0116b597): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 17:50:31.550] [INFO] console - Executing (326bbb73-457c-4426-9d56-bbda0116b597): update "Zemla"
                                    set "obshinaSize"= "obshinaSize"+ 1
                                where
                                    '/1/' like path||id||'/%'
                                    or (
                                        true 
                                        and id= 2
                                    )
[2016-10-19 17:50:31.556] [INFO] console - Executing (326bbb73-457c-4426-9d56-bbda0116b597): COMMIT;
[2016-10-19 17:50:31.565] [INFO] console - [ 70, 45, {}, [ '11' ] ]
[2016-10-19 17:50:31.585] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 17:50:31.593] [INFO] console - Executing (512fa3c5-a3d9-4d38-bfff-38c6b04e1fd9): START TRANSACTION;
[2016-10-19 17:50:31.598] [INFO] console - Executing (default): select z.*
                                    from "Zemla" as z
                                where
                                    '/1/' like z.path||z.id||'/%'
[2016-10-19 17:50:31.600] [INFO] console - Executing (512fa3c5-a3d9-4d38-bfff-38c6b04e1fd9): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:50:31.617] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" IN ('1')) ORDER BY "Zemla"."path" desc;
[2016-10-19 17:50:31.619] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 11);
[2016-10-19 17:50:31.631] [INFO] console - [ 16,
  7225037534789632,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id2.obshinaChange',
  [],
  { obshinaSize: 9 } ]
[2016-10-19 17:50:31.643] [INFO] console - [ 16,
  5592249593233408,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id1.obshinaChange',
  [],
  { obshinaSize: 11 } ]
[2016-10-19 17:50:31.655] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 17:50:31.674] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 17:50:31.688] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 17:50:31.694] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 17:50:31.713] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='2',"updated_at"='2016-10-19 12:50:31.698 +00:00' WHERE "id" = '11'
[2016-10-19 17:50:31.719] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/', '/2/')
                                where
                                    id = '11'
                                    or path like '/11/'||'%'
[2016-10-19 17:50:31.724] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 17:50:31.733] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 17:50:31.746] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 17:50:31.759] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/2/11/'||'%'
[2016-10-19 17:50:31.765] [INFO] console - Executing (512fa3c5-a3d9-4d38-bfff-38c6b04e1fd9): COMMIT;
[2016-10-19 17:50:31.767] [INFO] console - [ 70, 46, {}, [ undefined ] ]
[2016-10-19 17:50:31.773] [INFO] console - [ 16,
  2458826970234880,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 2 } ]
[2016-10-19 17:50:31.797] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 17:50:31.810] [INFO] console - Executing (29b76ec6-7509-4c8e-9bd7-2b9d4c7621bf): START TRANSACTION;
[2016-10-19 17:50:31.813] [INFO] console - Executing (29b76ec6-7509-4c8e-9bd7-2b9d4c7621bf): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:50:31.828] [INFO] console - Executing (29b76ec6-7509-4c8e-9bd7-2b9d4c7621bf): INSERT INTO "Kopnik" ("id","name","surname","patronymic","voiskoSize","birth","path","created_at","updated_at","dom_id","starshina_id") VALUES (DEFAULT,'temp','temp','temp',0,1900,'/','2016-10-19 12:50:31.818 +00:00','2016-10-19 12:50:31.818 +00:00',2,NULL) RETURNING *;
[2016-10-19 17:50:31.838] [INFO] console - Executing (29b76ec6-7509-4c8e-9bd7-2b9d4c7621bf): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 17:50:31.853] [INFO] console - Executing (29b76ec6-7509-4c8e-9bd7-2b9d4c7621bf): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 17:50:31.862] [INFO] console - Executing (29b76ec6-7509-4c8e-9bd7-2b9d4c7621bf): update "Zemla"
                                    set "obshinaSize"= "obshinaSize"+ 1
                                where
                                    '/1/' like path||id||'/%'
                                    or (
                                        true 
                                        and id= 2
                                    )
[2016-10-19 17:50:31.869] [INFO] console - Executing (29b76ec6-7509-4c8e-9bd7-2b9d4c7621bf): COMMIT;
[2016-10-19 17:50:31.874] [INFO] console - [ 70, 47, {}, [ '12' ] ]
[2016-10-19 17:50:31.911] [INFO] console - Executing (50ebb8f7-fd67-4f17-812c-add770b926e1): START TRANSACTION;
[2016-10-19 17:50:31.928] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 17:50:31.950] [INFO] console - Executing (50ebb8f7-fd67-4f17-812c-add770b926e1): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:50:31.955] [INFO] console - Executing (default): select z.*
                                    from "Zemla" as z
                                where
                                    '/1/' like z.path||z.id||'/%'
[2016-10-19 17:50:31.966] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 12);
[2016-10-19 17:50:31.978] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" IN ('1')) ORDER BY "Zemla"."path" desc;
[2016-10-19 17:50:31.994] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 11);
[2016-10-19 17:50:32.001] [INFO] console - [ 16,
  6655666710118400,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id2.obshinaChange',
  [],
  { obshinaSize: 10 } ]
[2016-10-19 17:50:32.029] [INFO] console - [ 16,
  8700077197492224,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id1.obshinaChange',
  [],
  { obshinaSize: 12 } ]
[2016-10-19 17:50:32.039] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 17:50:32.057] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 17:50:32.065] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 17:50:32.099] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='11',"updated_at"='2016-10-19 12:50:32.068 +00:00' WHERE "id" = '12'
[2016-10-19 17:50:32.119] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/', '/2/11/')
                                where
                                    id = '12'
                                    or path like '/12/'||'%'
[2016-10-19 17:50:32.125] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/2/11/' like path||id||'/%'
[2016-10-19 17:50:32.132] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/11/' like k.path||k.id||'/%'
[2016-10-19 17:50:32.149] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('11', '2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 17:50:32.159] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/2/11/12/'||'%'
[2016-10-19 17:50:32.165] [INFO] console - Executing (50ebb8f7-fd67-4f17-812c-add770b926e1): COMMIT;
[2016-10-19 17:50:32.168] [INFO] console - [ 70, 48, {}, [ undefined ] ]
[2016-10-19 17:50:32.175] [INFO] console - [ 16,
  5657954342666240,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id11.voiskoChange',
  [],
  { voiskoSize: 1 } ]
[2016-10-19 17:50:32.184] [INFO] console - [ 16,
  2753054877155328,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 3 } ]
[2016-10-19 17:50:32.203] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 4 }
[2016-10-19 17:50:32.210] [INFO] console - Executing (8ae5e67d-7d60-4708-93a0-2aa4be3813bd): START TRANSACTION;
[2016-10-19 17:50:32.215] [INFO] console - Executing (8ae5e67d-7d60-4708-93a0-2aa4be3813bd): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:50:32.229] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 4);
[2016-10-19 17:50:32.245] [INFO] console - Executing (8ae5e67d-7d60-4708-93a0-2aa4be3813bd): COMMIT;
[2016-10-19 17:50:32.248] [INFO] console - [ 70,
  49,
  {},
  [ { fullName: 'Unit Test',
      fullPath: '/4/',
      id: '4',
      email: 'unittest4@domain.ru',
      name: 'Unit',
      surname: 'Test',
      patronymic: '4',
      voiskoSize: 0,
      birth: 1983,
      path: '/',
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: null,
      attachments: [] } ] ]
[2016-10-19 17:50:32.285] [INFO] console - Executing (0b938534-f02b-4aa0-821c-7973d8ed61d4): START TRANSACTION;
[2016-10-19 17:50:32.288] [INFO] console - Executing (0b938534-f02b-4aa0-821c-7973d8ed61d4): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:50:32.297] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 11);
[2016-10-19 17:50:32.310] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 4);
[2016-10-19 17:50:32.320] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 17:50:32.330] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 17:50:32.342] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-2
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 17:50:32.355] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='4',"updated_at"='2016-10-19 12:50:32.345 +00:00' WHERE "id" = '11'
[2016-10-19 17:50:32.360] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/2/', '/4/')
                                where
                                    id = '11'
                                    or path like '/2/11/'||'%'
[2016-10-19 17:50:32.365] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+2
                                where
                                    '/4/' like path||id||'/%'
[2016-10-19 17:50:32.372] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/4/' like k.path||k.id||'/%'
[2016-10-19 17:50:32.383] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('4')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 17:50:32.390] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/4/11/'||'%'
[2016-10-19 17:50:32.395] [INFO] console - Executing (0b938534-f02b-4aa0-821c-7973d8ed61d4): COMMIT;
[2016-10-19 17:50:32.402] [INFO] console - [ 70, 50, {}, [ undefined ] ]
[2016-10-19 17:50:32.407] [INFO] console - [ 16,
  8623691598397440,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 1 } ]
[2016-10-19 17:50:32.417] [INFO] console - [ 16,
  3159169754464256,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id4.voiskoChange',
  [],
  { voiskoSize: 2 } ]
[2016-10-19 17:50:32.431] [INFO] console - [ 16,
  8369085320527872,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id12.starshinaChange',
  [],
  {} ]
[2016-10-19 17:50:32.452] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 12 }
[2016-10-19 17:50:32.457] [INFO] console - Executing (f533aaed-0772-4104-b0df-c509f66f6166): START TRANSACTION;
[2016-10-19 17:50:32.459] [INFO] console - Executing (f533aaed-0772-4104-b0df-c509f66f6166): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:50:32.474] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 12);
[2016-10-19 17:50:32.483] [INFO] console - Executing (f533aaed-0772-4104-b0df-c509f66f6166): COMMIT;
[2016-10-19 17:50:32.486] [INFO] console - [ 70,
  51,
  {},
  [ { fullName: 'temp temp',
      fullPath: '/4/11/12/',
      id: '12',
      email: null,
      name: 'temp',
      surname: 'temp',
      patronymic: 'temp',
      voiskoSize: 0,
      birth: 1900,
      path: '/4/11/',
      note: null,
      created_at: Wed Oct 19 2016 17:50:31 GMT+0500 (YEKT),
      updated_at: Wed Oct 19 2016 17:50:32 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: '11',
      attachments: [] } ] ]
[2016-10-19 17:50:32.508] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 11 }
[2016-10-19 17:50:32.528] [INFO] console - Executing (ca3d0690-4908-4427-8aaf-987a1a15c9ce): START TRANSACTION;
[2016-10-19 17:50:32.532] [INFO] console - Executing (ca3d0690-4908-4427-8aaf-987a1a15c9ce): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:50:32.557] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 11);
[2016-10-19 17:50:32.574] [INFO] console - Executing (ca3d0690-4908-4427-8aaf-987a1a15c9ce): COMMIT;
[2016-10-19 17:50:32.577] [INFO] console - [ 70,
  52,
  {},
  [ { fullName: 'temp temp',
      fullPath: '/4/11/',
      id: '11',
      email: null,
      name: 'temp',
      surname: 'temp',
      patronymic: 'temp',
      voiskoSize: 1,
      birth: 1900,
      path: '/4/',
      note: null,
      created_at: Wed Oct 19 2016 17:50:31 GMT+0500 (YEKT),
      updated_at: Wed Oct 19 2016 17:50:32 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: '4',
      attachments: [] } ] ]
[2016-10-19 17:50:32.606] [DEBUG] Server - #promiseModel() [] { model: 'Kopa', id: 3 }
[2016-10-19 17:50:32.615] [INFO] console - Executing (59b86475-b232-41fa-a79e-069a6a4d3ea2): START TRANSACTION;
[2016-10-19 17:50:32.623] [INFO] console - Executing (59b86475-b232-41fa-a79e-069a6a4d3ea2): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:50:32.642] [INFO] console - Executing (default): SELECT "Kopa"."id", "Kopa"."question", "Kopa"."invited", "Kopa"."note", "Kopa"."created_at", "Kopa"."updated_at", "Kopa"."deleted_at", "Kopa"."place_id", "Kopa"."inviter_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopa" AS "Kopa" LEFT OUTER JOIN "File" AS "attachments" ON "Kopa"."id" = "attachments"."kopa_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopa"."deleted_at" IS NULL AND "Kopa"."id" = 3);
[2016-10-19 17:50:32.661] [INFO] console - Executing (59b86475-b232-41fa-a79e-069a6a4d3ea2): COMMIT;
[2016-10-19 17:50:32.672] [INFO] console - [ 70,
  53,
  {},
  [ { id: '3',
      question: 'CHE',
      invited: Thu Sep 01 2016 00:00:00 GMT+0500 (YEKT),
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      place_id: '2',
      inviter_id: '2',
      attachments: [] } ] ]
[2016-10-19 17:50:32.803] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 17:50:32.823] [INFO] console - Executing (60d5b5e5-cff8-4fca-aa2e-3a73bb8c7d1d): START TRANSACTION;
[2016-10-19 17:50:32.831] [INFO] console - Executing (60d5b5e5-cff8-4fca-aa2e-3a73bb8c7d1d): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:50:32.853] [INFO] console - Executing (60d5b5e5-cff8-4fca-aa2e-3a73bb8c7d1d): INSERT INTO "Predlozhenie" ("id","value","totalZa","totalProtiv","created_at","updated_at","author_id","place_id") VALUES (DEFAULT,'temp Wed Oct 19 2016 17:50:32 GMT+0500 (YEKT)',0,0,'2016-10-19 12:50:32.840 +00:00','2016-10-19 12:50:32.840 +00:00',2,3) RETURNING *;
[2016-10-19 17:50:32.862] [INFO] console - Executing (60d5b5e5-cff8-4fca-aa2e-3a73bb8c7d1d): COMMIT;
[2016-10-19 17:50:32.867] [INFO] console - [ 70, 54, {}, [ '6' ] ]
[2016-10-19 17:50:32.889] [INFO] console - [ 16,
  2389154878980096,
  { acknowledge: true },
  'ru.kopa.model.Kopa.id3.predlozhenieAdd',
  [ '6' ] ]
[2016-10-19 17:50:32.902] [INFO] console - Executing (73a23237-1526-4802-84f2-6f0ca3d46fa4): START TRANSACTION;
[2016-10-19 17:50:32.908] [INFO] console - Executing (73a23237-1526-4802-84f2-6f0ca3d46fa4): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:50:32.918] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 17:50:32.934] [INFO] console - Executing (default): SELECT "id", "value", "totalZa", "totalProtiv", "state", "note", "created_at", "updated_at", "deleted_at", "author_id", "place_id" FROM "Predlozhenie" AS "Predlozhenie" WHERE ("Predlozhenie"."deleted_at" IS NULL AND "Predlozhenie"."id" = 6);
[2016-10-19 17:50:32.949] [INFO] console - Executing (default): SELECT "id", "question", "invited", "note", "created_at", "updated_at", "deleted_at", "place_id", "inviter_id" FROM "Kopa" AS "Kopa" WHERE ("Kopa"."deleted_at" IS NULL AND "Kopa"."id" = '3');
[2016-10-19 17:50:32.963] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 17:50:32.975] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 17:50:32.985] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 17:50:33.000] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 17:50:33.014] [INFO] console - Executing (default): SELECT "id", "value", "reason", "note", "created_at", "updated_at", "deleted_at", "subject_id", "owner_id", "parent_id" FROM "Golos" AS "Golos" WHERE ("Golos"."deleted_at" IS NULL AND ("Golos"."subject_id" = '6' AND "Golos"."owner_id" = '2')) LIMIT 1;
[2016-10-19 17:50:33.032] [INFO] console - Executing (default): INSERT INTO "Golos" ("id","value","created_at","updated_at","subject_id","owner_id") VALUES (DEFAULT,1,'2016-10-19 12:50:33.022 +00:00','2016-10-19 12:50:33.022 +00:00','6','2') RETURNING *;
[2016-10-19 17:50:33.042] [INFO] console - Executing (default): insert into "Golos" (subject_id, value, owner_id, parent_id, created_at, updated_at)
                            (
                                select 6, 1, k.id, 21, current_timestamp, current_timestamp
                                from 
                                    "Kopnik" k
                                     join "Zemla" d on d.id= k.dom_id
                                where
                                    k.path like '/2/%'
                                    and d.path||d.id||'/' like '/1/2/%' 
                            )
[2016-10-19 17:50:33.053] [INFO] console - Executing (default): select
                            (select count(*) from "Golos" g where subject_id= 6 and value=1) "za",
                            (select count(*) from "Golos" g where subject_id= 6 and value=-1) "protiv"
[2016-10-19 17:50:33.071] [INFO] console - Executing (default): UPDATE "Predlozhenie" SET "totalZa"=2,"updated_at"='2016-10-19 12:50:33.060 +00:00' WHERE "id" = '6'
[2016-10-19 17:50:33.077] [INFO] console - Executing (73a23237-1526-4802-84f2-6f0ca3d46fa4): COMMIT;
[2016-10-19 17:50:33.080] [INFO] console - [ 70, 55, {}, [ undefined ] ]
[2016-10-19 17:50:33.085] [INFO] console - [ 16,
  4196896941801472,
  { acknowledge: true },
  'ru.kopa.model.Predlozhenie.id6.rebalance',
  [],
  { totalZa: 2,
    totalProtiv: 0,
    GOLOS: '21',
    action: 'add',
    value: 1 } ]
[2016-10-19 17:50:33.098] [INFO] console - Executing (2bbbde70-a63a-4556-835c-bacbebd035e1): START TRANSACTION;
[2016-10-19 17:50:33.102] [INFO] console - Executing (2bbbde70-a63a-4556-835c-bacbebd035e1): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:50:33.104] [DEBUG] Server - #promiseModel() [] { model: 'Golos', id: 21 }
[2016-10-19 17:50:33.111] [INFO] console - Executing (72f4428b-dfbf-4ee0-b11e-5f7e2a27d669): START TRANSACTION;
[2016-10-19 17:50:33.117] [INFO] console - Executing (72f4428b-dfbf-4ee0-b11e-5f7e2a27d669): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:50:33.126] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 17:50:33.155] [INFO] console - Executing (default): SELECT "Golos"."id", "Golos"."value", "Golos"."reason", "Golos"."note", "Golos"."created_at", "Golos"."updated_at", "Golos"."deleted_at", "Golos"."subject_id", "Golos"."owner_id", "Golos"."parent_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Golos" AS "Golos" LEFT OUTER JOIN "File" AS "attachments" ON "Golos"."id" = "attachments"."golos_id" AND "attachments"."deleted_at" IS NULL WHERE ("Golos"."deleted_at" IS NULL AND "Golos"."id" = 21);
[2016-10-19 17:50:33.170] [INFO] console - Executing (default): SELECT "id", "value", "totalZa", "totalProtiv", "state", "note", "created_at", "updated_at", "deleted_at", "author_id", "place_id" FROM "Predlozhenie" AS "Predlozhenie" WHERE ("Predlozhenie"."deleted_at" IS NULL AND "Predlozhenie"."id" = 6);
[2016-10-19 17:50:33.181] [INFO] console - Executing (72f4428b-dfbf-4ee0-b11e-5f7e2a27d669): COMMIT;
[2016-10-19 17:50:33.212] [INFO] console - Executing (default): SELECT "id", "question", "invited", "note", "created_at", "updated_at", "deleted_at", "place_id", "inviter_id" FROM "Kopa" AS "Kopa" WHERE ("Kopa"."deleted_at" IS NULL AND "Kopa"."id" = '3');
[2016-10-19 17:50:33.216] [INFO] console - [ 70,
  57,
  {},
  [ { id: '21',
      value: 1,
      reason: null,
      note: null,
      created_at: Wed Oct 19 2016 17:50:33 GMT+0500 (YEKT),
      updated_at: Wed Oct 19 2016 17:50:33 GMT+0500 (YEKT),
      deleted_at: null,
      subject_id: '6',
      owner_id: '2',
      parent_id: null,
      attachments: [] } ] ]
[2016-10-19 17:50:33.261] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 17:50:33.275] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 17:50:33.292] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 17:50:33.302] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 17:50:33.315] [INFO] console - Executing (default): SELECT "id", "value", "reason", "note", "created_at", "updated_at", "deleted_at", "subject_id", "owner_id", "parent_id" FROM "Golos" AS "Golos" WHERE ("Golos"."deleted_at" IS NULL AND ("Golos"."subject_id" = '6' AND "Golos"."owner_id" = '2')) LIMIT 1;
[2016-10-19 17:50:33.341] [INFO] console - Executing (default): delete from "Golos" 
                            where
                                subject_id= 6
                                and (
                                    id= 21
                                    or parent_id = 21
                                )
[2016-10-19 17:50:33.346] [INFO] console - Executing (default): select
                            (select count(*) from "Golos" g where subject_id= 6 and value=1) "za",
                            (select count(*) from "Golos" g where subject_id= 6 and value=-1) "protiv"
[2016-10-19 17:50:33.365] [INFO] console - Executing (default): UPDATE "Predlozhenie" SET "totalZa"=0,"updated_at"='2016-10-19 12:50:33.352 +00:00' WHERE "id" = '6'
[2016-10-19 17:50:33.375] [INFO] console - Executing (2bbbde70-a63a-4556-835c-bacbebd035e1): COMMIT;
[2016-10-19 17:50:33.383] [INFO] console - [ 70, 56, {}, [ undefined ] ]
[2016-10-19 17:50:33.389] [INFO] console - [ 16,
  5176615554252800,
  { acknowledge: true },
  'ru.kopa.model.Predlozhenie.id6.rebalance',
  [],
  { totalZa: 0,
    totalProtiv: 0,
    GOLOS: '21',
    action: 'remove',
    value: 1 } ]
[2016-10-19 17:51:47.057] [INFO] console - AutobahnJS debug enabled
[2016-10-19 17:51:49.173] [INFO] Server - starting...
[2016-10-19 17:51:49.175] [INFO] console - trying to create WAMP transport of type: websocket
[2016-10-19 17:51:49.294] [INFO] console - using WAMP transport type: websocket
[2016-10-19 17:51:49.579] [INFO] console - [ 1,
  'kopa',
  { roles: 
     { caller: [Object],
       callee: [Object],
       publisher: [Object],
       subscriber: [Object] },
    authmethods: [ 'ticket' ],
    authid: 'server' } ]
[2016-10-19 17:51:49.605] [INFO] console - [ 5, 'server', {} ]
[2016-10-19 17:51:49.678] [INFO] Server - connection.onopen()
[2016-10-19 17:51:49.679] [INFO] console - [ 64, 1632095734595584, {}, 'ru.kopa.model.create' ]
[2016-10-19 17:51:49.687] [DEBUG] Server - api:model.create registered
[2016-10-19 17:51:49.689] [INFO] console - [ 64, 4674093443973120, {}, 'ru.kopa.model.get' ]
[2016-10-19 17:51:49.697] [DEBUG] Server - api:model.get registered
[2016-10-19 17:51:49.699] [INFO] console - [ 64, 6880726108602368, {}, 'ru.kopa.model.save' ]
[2016-10-19 17:51:49.705] [DEBUG] Server - api:model.save registered
[2016-10-19 17:51:49.706] [INFO] console - [ 64, 8991135118655488, {}, 'ru.kopa.pingPong' ]
[2016-10-19 17:51:49.726] [DEBUG] Server - api:pingPong registered
[2016-10-19 17:51:49.727] [INFO] console - [ 64, 7674588139880448, {}, 'ru.kopa.discloseCaller' ]
[2016-10-19 17:51:49.733] [DEBUG] Server - api:discloseCaller registered
[2016-10-19 17:51:49.734] [INFO] console - [ 64, 6048566099312640, {}, 'ru.kopa.pingPongDatabase' ]
[2016-10-19 17:51:49.740] [DEBUG] Server - api:pingPongDatabase registered
[2016-10-19 17:51:49.741] [INFO] console - [ 64, 8388554170302464, {}, 'ru.kopa.error' ]
[2016-10-19 17:51:49.748] [DEBUG] Server - api:error registered
[2016-10-19 17:51:49.749] [INFO] console - [ 64, 87250266226688, {}, 'ru.kopa.unitTest.cleanTempData' ]
[2016-10-19 17:51:49.755] [DEBUG] Server - api:unitTest.cleanTempData registered
[2016-10-19 17:51:49.756] [INFO] console - [ 64, 2575909041209344, {}, 'ru.kopa.model.Kopnik.setStarshina' ]
[2016-10-19 17:51:49.762] [DEBUG] Server - api:model.Kopnik.setStarshina registered
[2016-10-19 17:51:49.763] [INFO] console - [ 64, 2667148119900160, {}, 'ru.kopa.model.Kopnik.loadDruzhina' ]
[2016-10-19 17:51:49.769] [DEBUG] Server - api:model.Kopnik.loadDruzhina registered
[2016-10-19 17:51:49.770] [INFO] console - [ 64, 2165004142903296, {}, 'ru.kopa.model.Kopnik.vote' ]
[2016-10-19 17:51:49.776] [DEBUG] Server - api:model.Kopnik.vote registered
[2016-10-19 17:51:49.777] [INFO] console - [ 64, 1582063461335040, {}, 'ru.kopa.model.Kopa.invite' ]
[2016-10-19 17:51:49.783] [DEBUG] Server - api:model.Kopa.invite registered
[2016-10-19 17:51:49.783] [INFO] console - [ 64, 1491547228995584, {}, 'ru.kopa.model.Kopa.getDialog' ]
[2016-10-19 17:51:49.790] [DEBUG] Server - api:model.Kopa.getDialog registered
[2016-10-19 17:51:49.791] [INFO] console - [ 64, 4376179163267072, {}, 'ru.kopa.model.Kopa.getResult' ]
[2016-10-19 17:51:49.800] [DEBUG] Server - api:model.Kopa.getResult registered
[2016-10-19 17:51:49.801] [INFO] console - [ 64, 3744024991105024, {}, 'ru.kopa.model.Zemla.setParent' ]
[2016-10-19 17:51:49.808] [DEBUG] Server - api:model.Zemla.setParent registered
[2016-10-19 17:51:49.810] [INFO] console - [ 64, 1786031969927168, {}, 'ru.kopa.model.Zemla.promiseKopi' ]
[2016-10-19 17:51:49.817] [DEBUG] Server - api:model.Zemla.promiseKopi registered
[2016-10-19 17:51:49.818] [INFO] console - [ 64,
  5271398689800192,
  {},
  'ru.kopa.model.Predlozhenie.getGolosa' ]
[2016-10-19 17:51:49.825] [DEBUG] Server - api:model.Predlozhenie.getGolosa registered
[2016-10-19 17:51:49.826] [INFO] console - [ 64, 5332264835612672, {}, 'ru.kopa.unitTest.orderProc' ]
[2016-10-19 17:51:49.832] [DEBUG] Server - api:unitTest.orderProc registered
[2016-10-19 17:51:49.839] [INFO] Server - started
[2016-10-19 17:52:20.237] [INFO] console - [ 70, 60, {}, [ undefined ] ]
[2016-10-19 17:52:20.288] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 2 }
[2016-10-19 17:52:20.454] [INFO] console - Executing (default): delete from "Kopnik"
                where
                    name like '%temp'
                    or name like 'temp%'
[2016-10-19 17:52:20.490] [INFO] console - Executing (f6f0c437-be04-42c2-8b82-4a0f9d82d933): START TRANSACTION;
[2016-10-19 17:52:20.523] [INFO] console - Executing (default): update "Kopnik"
                set 
                    "voiskoSize"= case when id=2 then 1 ELSE 0 END
                where
                    id>1 
                    and id<=5
[2016-10-19 17:52:20.528] [INFO] console - Executing (f6f0c437-be04-42c2-8b82-4a0f9d82d933): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:52:20.625] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 17:52:20.676] [INFO] console - Executing (f6f0c437-be04-42c2-8b82-4a0f9d82d933): COMMIT;
[2016-10-19 17:52:20.680] [INFO] console - [ 70,
  61,
  {},
  [ { fullName: 'Unit Test',
      fullPath: '/2/',
      id: '2',
      email: 'unittest2@domain.ru',
      name: 'Unit',
      surname: 'Test',
      patronymic: '1',
      voiskoSize: 1,
      birth: 1983,
      path: '/',
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: null,
      attachments: [] } ] ]
[2016-10-19 17:52:20.805] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 17:52:20.818] [INFO] console - Executing (5b7537bc-51e0-45d4-951d-41001f7758ef): START TRANSACTION;
[2016-10-19 17:52:20.821] [INFO] console - Executing (5b7537bc-51e0-45d4-951d-41001f7758ef): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:52:20.848] [INFO] console - Executing (5b7537bc-51e0-45d4-951d-41001f7758ef): INSERT INTO "Kopnik" ("id","name","surname","patronymic","voiskoSize","birth","path","created_at","updated_at","dom_id","starshina_id") VALUES (DEFAULT,'temp','temp','temp',0,1900,'/','2016-10-19 12:52:20.828 +00:00','2016-10-19 12:52:20.828 +00:00',2,NULL) RETURNING *;
[2016-10-19 17:52:20.858] [INFO] console - Executing (5b7537bc-51e0-45d4-951d-41001f7758ef): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 17:52:20.869] [INFO] console - Executing (5b7537bc-51e0-45d4-951d-41001f7758ef): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 17:52:20.878] [INFO] console - Executing (5b7537bc-51e0-45d4-951d-41001f7758ef): update "Zemla"
                                    set "obshinaSize"= "obshinaSize"+ 1
                                where
                                    '/1/' like path||id||'/%'
                                    or (
                                        true 
                                        and id= 2
                                    )
[2016-10-19 17:52:20.885] [INFO] console - Executing (5b7537bc-51e0-45d4-951d-41001f7758ef): COMMIT;
[2016-10-19 17:52:20.888] [INFO] console - [ 70, 62, {}, [ '13' ] ]
[2016-10-19 17:52:20.901] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 17:52:20.912] [INFO] console - Executing (default): select z.*
                                    from "Zemla" as z
                                where
                                    '/1/' like z.path||z.id||'/%'
[2016-10-19 17:52:20.915] [INFO] console - Executing (95074054-fd2e-4f2d-a898-b4707dce46a9): START TRANSACTION;
[2016-10-19 17:52:20.920] [INFO] console - Executing (95074054-fd2e-4f2d-a898-b4707dce46a9): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:52:20.933] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" IN ('1')) ORDER BY "Zemla"."path" desc;
[2016-10-19 17:52:20.943] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 13);
[2016-10-19 17:52:20.945] [INFO] console - [ 16,
  4792749530284032,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id2.obshinaChange',
  [],
  { obshinaSize: 11 } ]
[2016-10-19 17:52:20.984] [INFO] console - [ 16,
  1851145850978304,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id1.obshinaChange',
  [],
  { obshinaSize: 13 } ]
[2016-10-19 17:52:21.007] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 17:52:21.030] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 17:52:21.042] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 17:52:21.056] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 17:52:21.087] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='2',"updated_at"='2016-10-19 12:52:21.065 +00:00' WHERE "id" = '13'
[2016-10-19 17:52:21.096] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/', '/2/')
                                where
                                    id = '13'
                                    or path like '/13/'||'%'
[2016-10-19 17:52:21.108] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 17:52:21.112] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 17:52:21.128] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 17:52:21.141] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/2/13/'||'%'
[2016-10-19 17:52:21.146] [INFO] console - Executing (95074054-fd2e-4f2d-a898-b4707dce46a9): COMMIT;
[2016-10-19 17:52:21.149] [INFO] console - [ 70, 63, {}, [ undefined ] ]
[2016-10-19 17:52:21.157] [INFO] console - [ 16,
  6535122249580544,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 2 } ]
[2016-10-19 17:52:21.190] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 17:52:21.200] [INFO] console - Executing (69832acd-fcf4-485b-a1ea-35a46d15d190): START TRANSACTION;
[2016-10-19 17:52:21.203] [INFO] console - Executing (69832acd-fcf4-485b-a1ea-35a46d15d190): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:52:21.221] [INFO] console - Executing (69832acd-fcf4-485b-a1ea-35a46d15d190): INSERT INTO "Kopnik" ("id","name","surname","patronymic","voiskoSize","birth","path","created_at","updated_at","dom_id","starshina_id") VALUES (DEFAULT,'temp','temp','temp',0,1900,'/','2016-10-19 12:52:21.208 +00:00','2016-10-19 12:52:21.208 +00:00',2,NULL) RETURNING *;
[2016-10-19 17:52:21.232] [INFO] console - Executing (69832acd-fcf4-485b-a1ea-35a46d15d190): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 17:52:21.246] [INFO] console - Executing (69832acd-fcf4-485b-a1ea-35a46d15d190): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 17:52:21.253] [INFO] console - Executing (69832acd-fcf4-485b-a1ea-35a46d15d190): update "Zemla"
                                    set "obshinaSize"= "obshinaSize"+ 1
                                where
                                    '/1/' like path||id||'/%'
                                    or (
                                        true 
                                        and id= 2
                                    )
[2016-10-19 17:52:21.259] [INFO] console - Executing (69832acd-fcf4-485b-a1ea-35a46d15d190): COMMIT;
[2016-10-19 17:52:21.268] [INFO] console - [ 70, 64, {}, [ '14' ] ]
[2016-10-19 17:52:21.280] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 17:52:21.289] [INFO] console - Executing (default): select z.*
                                    from "Zemla" as z
                                where
                                    '/1/' like z.path||z.id||'/%'
[2016-10-19 17:52:21.292] [INFO] console - Executing (07c2828e-ce0d-4b5c-9413-76bd5f131b3f): START TRANSACTION;
[2016-10-19 17:52:21.299] [INFO] console - Executing (07c2828e-ce0d-4b5c-9413-76bd5f131b3f): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:52:21.309] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" IN ('1')) ORDER BY "Zemla"."path" desc;
[2016-10-19 17:52:21.326] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 14);
[2016-10-19 17:52:21.329] [INFO] console - [ 16,
  7052161181548544,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id2.obshinaChange',
  [],
  { obshinaSize: 12 } ]
[2016-10-19 17:52:21.347] [INFO] console - [ 16,
  4817907684999168,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id1.obshinaChange',
  [],
  { obshinaSize: 14 } ]
[2016-10-19 17:52:21.360] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 13);
[2016-10-19 17:52:21.371] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 17:52:21.403] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 17:52:21.421] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 17:52:21.450] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='13',"updated_at"='2016-10-19 12:52:21.430 +00:00' WHERE "id" = '14'
[2016-10-19 17:52:21.457] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/', '/2/13/')
                                where
                                    id = '14'
                                    or path like '/14/'||'%'
[2016-10-19 17:52:21.462] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/2/13/' like path||id||'/%'
[2016-10-19 17:52:21.468] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/13/' like k.path||k.id||'/%'
[2016-10-19 17:52:21.494] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('13', '2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 17:52:21.504] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/2/13/14/'||'%'
[2016-10-19 17:52:21.509] [INFO] console - Executing (07c2828e-ce0d-4b5c-9413-76bd5f131b3f): COMMIT;
[2016-10-19 17:52:21.513] [INFO] console - [ 70, 65, {}, [ undefined ] ]
[2016-10-19 17:52:21.522] [INFO] console - [ 16,
  4002300028780544,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id13.voiskoChange',
  [],
  { voiskoSize: 1 } ]
[2016-10-19 17:52:21.537] [INFO] console - [ 16,
  5231244260409344,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 3 } ]
[2016-10-19 17:52:21.561] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 4 }
[2016-10-19 17:52:21.570] [INFO] console - Executing (179b7932-70fb-41f2-b486-ddc47e5d31e7): START TRANSACTION;
[2016-10-19 17:52:21.573] [INFO] console - Executing (179b7932-70fb-41f2-b486-ddc47e5d31e7): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:52:21.605] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 4);
[2016-10-19 17:52:21.620] [INFO] console - Executing (179b7932-70fb-41f2-b486-ddc47e5d31e7): COMMIT;
[2016-10-19 17:52:21.622] [INFO] console - [ 70,
  66,
  {},
  [ { fullName: 'Unit Test',
      fullPath: '/4/',
      id: '4',
      email: 'unittest4@domain.ru',
      name: 'Unit',
      surname: 'Test',
      patronymic: '4',
      voiskoSize: 0,
      birth: 1983,
      path: '/',
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: null,
      attachments: [] } ] ]
[2016-10-19 17:52:21.677] [INFO] console - Executing (ca27a251-8834-43ac-953c-56ecf9310eec): START TRANSACTION;
[2016-10-19 17:52:21.683] [INFO] console - Executing (ca27a251-8834-43ac-953c-56ecf9310eec): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:52:21.696] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 13);
[2016-10-19 17:52:21.710] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 4);
[2016-10-19 17:52:21.720] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 17:52:21.737] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 17:52:21.746] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-2
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 17:52:21.797] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='4',"updated_at"='2016-10-19 12:52:21.777 +00:00' WHERE "id" = '13'
[2016-10-19 17:52:21.805] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/2/', '/4/')
                                where
                                    id = '13'
                                    or path like '/2/13/'||'%'
[2016-10-19 17:52:21.811] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+2
                                where
                                    '/4/' like path||id||'/%'
[2016-10-19 17:52:21.818] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/4/' like k.path||k.id||'/%'
[2016-10-19 17:52:21.834] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('4')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 17:52:21.844] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/4/13/'||'%'
[2016-10-19 17:52:21.849] [INFO] console - Executing (ca27a251-8834-43ac-953c-56ecf9310eec): COMMIT;
[2016-10-19 17:52:21.866] [INFO] console - [ 70, 67, {}, [ undefined ] ]
[2016-10-19 17:52:21.897] [INFO] console - [ 16,
  267676976939008,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 1 } ]
[2016-10-19 17:52:21.919] [INFO] console - [ 16,
  2272698686242816,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id4.voiskoChange',
  [],
  { voiskoSize: 2 } ]
[2016-10-19 17:52:21.939] [INFO] console - [ 16,
  6453281301725184,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id14.starshinaChange',
  [],
  {} ]
[2016-10-19 17:52:21.964] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 14 }
[2016-10-19 17:52:21.972] [INFO] console - Executing (f46bce46-08ed-4eae-9b18-fc71b599a27e): START TRANSACTION;
[2016-10-19 17:52:21.978] [INFO] console - Executing (f46bce46-08ed-4eae-9b18-fc71b599a27e): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:52:22.000] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 14);
[2016-10-19 17:52:22.014] [INFO] console - Executing (f46bce46-08ed-4eae-9b18-fc71b599a27e): COMMIT;
[2016-10-19 17:52:22.018] [INFO] console - [ 70,
  68,
  {},
  [ { fullName: 'temp temp',
      fullPath: '/4/13/14/',
      id: '14',
      email: null,
      name: 'temp',
      surname: 'temp',
      patronymic: 'temp',
      voiskoSize: 0,
      birth: 1900,
      path: '/4/13/',
      note: null,
      created_at: Wed Oct 19 2016 17:52:21 GMT+0500 (YEKT),
      updated_at: Wed Oct 19 2016 17:52:21 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: '13',
      attachments: [] } ] ]
[2016-10-19 17:52:22.054] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 13 }
[2016-10-19 17:52:22.070] [INFO] console - Executing (7fd8a0f8-32e0-4048-b688-d93715611bc2): START TRANSACTION;
[2016-10-19 17:52:22.077] [INFO] console - Executing (7fd8a0f8-32e0-4048-b688-d93715611bc2): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:52:22.106] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 13);
[2016-10-19 17:52:22.147] [INFO] console - Executing (7fd8a0f8-32e0-4048-b688-d93715611bc2): COMMIT;
[2016-10-19 17:52:22.161] [INFO] console - [ 70,
  69,
  {},
  [ { fullName: 'temp temp',
      fullPath: '/4/13/',
      id: '13',
      email: null,
      name: 'temp',
      surname: 'temp',
      patronymic: 'temp',
      voiskoSize: 1,
      birth: 1900,
      path: '/4/',
      note: null,
      created_at: Wed Oct 19 2016 17:52:20 GMT+0500 (YEKT),
      updated_at: Wed Oct 19 2016 17:52:21 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: '4',
      attachments: [] } ] ]
[2016-10-19 17:52:22.217] [DEBUG] Server - #promiseModel() [] { model: 'Kopa', id: 3 }
[2016-10-19 17:52:22.243] [INFO] console - Executing (1db125e5-fab3-4e65-8a76-4a6f1e110bd5): START TRANSACTION;
[2016-10-19 17:52:22.255] [INFO] console - Executing (1db125e5-fab3-4e65-8a76-4a6f1e110bd5): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:52:22.285] [INFO] console - Executing (default): SELECT "Kopa"."id", "Kopa"."question", "Kopa"."invited", "Kopa"."note", "Kopa"."created_at", "Kopa"."updated_at", "Kopa"."deleted_at", "Kopa"."place_id", "Kopa"."inviter_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopa" AS "Kopa" LEFT OUTER JOIN "File" AS "attachments" ON "Kopa"."id" = "attachments"."kopa_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopa"."deleted_at" IS NULL AND "Kopa"."id" = 3);
[2016-10-19 17:52:22.298] [INFO] console - Executing (1db125e5-fab3-4e65-8a76-4a6f1e110bd5): COMMIT;
[2016-10-19 17:52:22.300] [INFO] console - [ 70,
  70,
  {},
  [ { id: '3',
      question: 'CHE',
      invited: Thu Sep 01 2016 00:00:00 GMT+0500 (YEKT),
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      place_id: '2',
      inviter_id: '2',
      attachments: [] } ] ]
[2016-10-19 17:52:22.342] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 17:52:22.362] [INFO] console - Executing (b46d0451-a6bf-4c23-8478-02faf2cdf847): START TRANSACTION;
[2016-10-19 17:52:22.380] [INFO] console - Executing (b46d0451-a6bf-4c23-8478-02faf2cdf847): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:52:22.406] [INFO] console - Executing (b46d0451-a6bf-4c23-8478-02faf2cdf847): INSERT INTO "Predlozhenie" ("id","value","totalZa","totalProtiv","created_at","updated_at","author_id","place_id") VALUES (DEFAULT,'temp Wed Oct 19 2016 17:52:22 GMT+0500 (YEKT)',0,0,'2016-10-19 12:52:22.384 +00:00','2016-10-19 12:52:22.384 +00:00',2,3) RETURNING *;
[2016-10-19 17:52:22.414] [INFO] console - Executing (b46d0451-a6bf-4c23-8478-02faf2cdf847): COMMIT;
[2016-10-19 17:52:22.417] [INFO] console - [ 70, 71, {}, [ '7' ] ]
[2016-10-19 17:52:22.454] [INFO] console - [ 16,
  7156330169106432,
  { acknowledge: true },
  'ru.kopa.model.Kopa.id3.predlozhenieAdd',
  [ '7' ] ]
[2016-10-19 17:52:22.475] [INFO] console - Executing (d79d3c4d-7252-48b0-b418-61b123aa7160): START TRANSACTION;
[2016-10-19 17:52:22.482] [INFO] console - Executing (d79d3c4d-7252-48b0-b418-61b123aa7160): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:52:22.510] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 17:52:22.527] [INFO] console - Executing (default): SELECT "id", "value", "totalZa", "totalProtiv", "state", "note", "created_at", "updated_at", "deleted_at", "author_id", "place_id" FROM "Predlozhenie" AS "Predlozhenie" WHERE ("Predlozhenie"."deleted_at" IS NULL AND "Predlozhenie"."id" = 7);
[2016-10-19 17:52:22.544] [INFO] console - Executing (default): SELECT "id", "question", "invited", "note", "created_at", "updated_at", "deleted_at", "place_id", "inviter_id" FROM "Kopa" AS "Kopa" WHERE ("Kopa"."deleted_at" IS NULL AND "Kopa"."id" = '3');
[2016-10-19 17:52:22.555] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 17:52:22.570] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 17:52:22.582] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 17:52:22.599] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 17:52:22.617] [INFO] console - Executing (default): SELECT "id", "value", "reason", "note", "created_at", "updated_at", "deleted_at", "subject_id", "owner_id", "parent_id" FROM "Golos" AS "Golos" WHERE ("Golos"."deleted_at" IS NULL AND ("Golos"."subject_id" = '7' AND "Golos"."owner_id" = '2')) LIMIT 1;
[2016-10-19 17:52:22.633] [INFO] console - Executing (default): INSERT INTO "Golos" ("id","value","created_at","updated_at","subject_id","owner_id") VALUES (DEFAULT,1,'2016-10-19 12:52:22.622 +00:00','2016-10-19 12:52:22.622 +00:00','7','2') RETURNING *;
[2016-10-19 17:52:22.642] [INFO] console - Executing (default): insert into "Golos" (subject_id, value, owner_id, parent_id, created_at, updated_at)
                            (
                                select 7, 1, k.id, 23, current_timestamp, current_timestamp
                                from 
                                    "Kopnik" k
                                     join "Zemla" d on d.id= k.dom_id
                                where
                                    k.path like '/2/%'
                                    and d.path||d.id||'/' like '/1/2/%' 
                            )
[2016-10-19 17:52:22.652] [INFO] console - Executing (default): select
                            (select count(*) from "Golos" g where subject_id= 7 and value=1) "za",
                            (select count(*) from "Golos" g where subject_id= 7 and value=-1) "protiv"
[2016-10-19 17:52:22.673] [INFO] console - Executing (default): UPDATE "Predlozhenie" SET "totalZa"=2,"updated_at"='2016-10-19 12:52:22.657 +00:00' WHERE "id" = '7'
[2016-10-19 17:52:22.681] [INFO] console - Executing (d79d3c4d-7252-48b0-b418-61b123aa7160): COMMIT;
[2016-10-19 17:52:22.685] [INFO] console - [ 70, 72, {}, [ undefined ] ]
[2016-10-19 17:52:22.691] [INFO] console - [ 16,
  4259643872247808,
  { acknowledge: true },
  'ru.kopa.model.Predlozhenie.id7.rebalance',
  [],
  { totalZa: 2,
    totalProtiv: 0,
    GOLOS: '23',
    action: 'add',
    value: 1 } ]
[2016-10-19 17:52:22.703] [INFO] console - Executing (203c875e-6348-4128-bd6c-55efe3937759): START TRANSACTION;
[2016-10-19 17:52:22.706] [INFO] console - Executing (203c875e-6348-4128-bd6c-55efe3937759): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:52:22.712] [DEBUG] Server - #promiseModel() [] { model: 'Golos', id: 23 }
[2016-10-19 17:52:22.719] [INFO] console - Executing (e168f287-5b74-4305-969c-da0515bb2f96): START TRANSACTION;
[2016-10-19 17:52:22.726] [INFO] console - Executing (e168f287-5b74-4305-969c-da0515bb2f96): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:52:22.815] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 17:52:22.826] [INFO] console - Executing (default): SELECT "Golos"."id", "Golos"."value", "Golos"."reason", "Golos"."note", "Golos"."created_at", "Golos"."updated_at", "Golos"."deleted_at", "Golos"."subject_id", "Golos"."owner_id", "Golos"."parent_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Golos" AS "Golos" LEFT OUTER JOIN "File" AS "attachments" ON "Golos"."id" = "attachments"."golos_id" AND "attachments"."deleted_at" IS NULL WHERE ("Golos"."deleted_at" IS NULL AND "Golos"."id" = 23);
[2016-10-19 17:52:22.848] [INFO] console - Executing (default): SELECT "id", "value", "totalZa", "totalProtiv", "state", "note", "created_at", "updated_at", "deleted_at", "author_id", "place_id" FROM "Predlozhenie" AS "Predlozhenie" WHERE ("Predlozhenie"."deleted_at" IS NULL AND "Predlozhenie"."id" = 7);
[2016-10-19 17:52:22.858] [INFO] console - Executing (e168f287-5b74-4305-969c-da0515bb2f96): COMMIT;
[2016-10-19 17:52:22.872] [INFO] console - Executing (default): SELECT "id", "question", "invited", "note", "created_at", "updated_at", "deleted_at", "place_id", "inviter_id" FROM "Kopa" AS "Kopa" WHERE ("Kopa"."deleted_at" IS NULL AND "Kopa"."id" = '3');
[2016-10-19 17:52:22.873] [INFO] console - [ 70,
  74,
  {},
  [ { id: '23',
      value: 1,
      reason: null,
      note: null,
      created_at: Wed Oct 19 2016 17:52:22 GMT+0500 (YEKT),
      updated_at: Wed Oct 19 2016 17:52:22 GMT+0500 (YEKT),
      deleted_at: null,
      subject_id: '7',
      owner_id: '2',
      parent_id: null,
      attachments: [] } ] ]
[2016-10-19 17:52:22.921] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 17:52:22.948] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 17:52:22.960] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 17:52:22.975] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 17:52:22.989] [INFO] console - Executing (default): SELECT "id", "value", "reason", "note", "created_at", "updated_at", "deleted_at", "subject_id", "owner_id", "parent_id" FROM "Golos" AS "Golos" WHERE ("Golos"."deleted_at" IS NULL AND ("Golos"."subject_id" = '7' AND "Golos"."owner_id" = '2')) LIMIT 1;
[2016-10-19 17:52:22.997] [INFO] console - Executing (default): delete from "Golos" 
                            where
                                subject_id= 7
                                and (
                                    id= 23
                                    or parent_id = 23
                                )
[2016-10-19 17:52:23.009] [INFO] console - Executing (default): select
                            (select count(*) from "Golos" g where subject_id= 7 and value=1) "za",
                            (select count(*) from "Golos" g where subject_id= 7 and value=-1) "protiv"
[2016-10-19 17:52:23.034] [INFO] console - Executing (default): UPDATE "Predlozhenie" SET "totalZa"=0,"updated_at"='2016-10-19 12:52:23.013 +00:00' WHERE "id" = '7'
[2016-10-19 17:52:23.040] [INFO] console - Executing (203c875e-6348-4128-bd6c-55efe3937759): COMMIT;
[2016-10-19 17:52:23.044] [INFO] console - [ 70, 73, {}, [ undefined ] ]
[2016-10-19 17:52:23.049] [INFO] console - [ 16,
  8560737637105664,
  { acknowledge: true },
  'ru.kopa.model.Predlozhenie.id7.rebalance',
  [],
  { totalZa: 0,
    totalProtiv: 0,
    GOLOS: '23',
    action: 'remove',
    value: 1 } ]
[2016-10-19 17:52:51.679] [INFO] console - AutobahnJS debug enabled
[2016-10-19 17:52:54.529] [INFO] Server - starting...
[2016-10-19 17:52:54.534] [INFO] console - trying to create WAMP transport of type: websocket
[2016-10-19 17:52:54.664] [INFO] console - using WAMP transport type: websocket
[2016-10-19 17:52:55.180] [INFO] console - [ 1,
  'kopa',
  { roles: 
     { caller: [Object],
       callee: [Object],
       publisher: [Object],
       subscriber: [Object] },
    authmethods: [ 'ticket' ],
    authid: 'server' } ]
[2016-10-19 17:52:55.207] [INFO] console - [ 5, 'server', {} ]
[2016-10-19 17:52:55.406] [INFO] Server - connection.onopen()
[2016-10-19 17:52:55.409] [INFO] console - [ 64, 6591580444033024, {}, 'ru.kopa.model.create' ]
[2016-10-19 17:52:55.465] [DEBUG] Server - api:model.create registered
[2016-10-19 17:52:55.470] [INFO] console - [ 64, 1800909845692416, {}, 'ru.kopa.model.get' ]
[2016-10-19 17:52:55.493] [DEBUG] Server - api:model.get registered
[2016-10-19 17:52:55.511] [INFO] console - [ 64, 5005108819525632, {}, 'ru.kopa.model.save' ]
[2016-10-19 17:52:55.526] [DEBUG] Server - api:model.save registered
[2016-10-19 17:52:55.528] [INFO] console - [ 64, 5960824019484672, {}, 'ru.kopa.pingPong' ]
[2016-10-19 17:52:55.535] [DEBUG] Server - api:pingPong registered
[2016-10-19 17:52:55.537] [INFO] console - [ 64, 4376044891013120, {}, 'ru.kopa.discloseCaller' ]
[2016-10-19 17:52:55.546] [DEBUG] Server - api:discloseCaller registered
[2016-10-19 17:52:55.550] [INFO] console - [ 64, 2160865577009152, {}, 'ru.kopa.pingPongDatabase' ]
[2016-10-19 17:52:55.559] [DEBUG] Server - api:pingPongDatabase registered
[2016-10-19 17:52:55.560] [INFO] console - [ 64, 411048901345280, {}, 'ru.kopa.error' ]
[2016-10-19 17:52:55.570] [DEBUG] Server - api:error registered
[2016-10-19 17:52:55.571] [INFO] console - [ 64, 4807778963030016, {}, 'ru.kopa.unitTest.cleanTempData' ]
[2016-10-19 17:52:55.579] [DEBUG] Server - api:unitTest.cleanTempData registered
[2016-10-19 17:52:55.580] [INFO] console - [ 64, 5151175104004096, {}, 'ru.kopa.model.Kopnik.setStarshina' ]
[2016-10-19 17:52:55.587] [DEBUG] Server - api:model.Kopnik.setStarshina registered
[2016-10-19 17:52:55.587] [INFO] console - [ 64, 5078421801533440, {}, 'ru.kopa.model.Kopnik.loadDruzhina' ]
[2016-10-19 17:52:55.598] [DEBUG] Server - api:model.Kopnik.loadDruzhina registered
[2016-10-19 17:52:55.599] [INFO] console - [ 64, 962808537677824, {}, 'ru.kopa.model.Kopnik.vote' ]
[2016-10-19 17:52:55.605] [DEBUG] Server - api:model.Kopnik.vote registered
[2016-10-19 17:52:55.606] [INFO] console - [ 64, 1114221372768256, {}, 'ru.kopa.model.Kopa.invite' ]
[2016-10-19 17:52:55.615] [DEBUG] Server - api:model.Kopa.invite registered
[2016-10-19 17:52:55.616] [INFO] console - [ 64, 3298602914938880, {}, 'ru.kopa.model.Kopa.getDialog' ]
[2016-10-19 17:52:55.623] [DEBUG] Server - api:model.Kopa.getDialog registered
[2016-10-19 17:52:55.624] [INFO] console - [ 64, 2635542242000896, {}, 'ru.kopa.model.Kopa.getResult' ]
[2016-10-19 17:52:55.631] [DEBUG] Server - api:model.Kopa.getResult registered
[2016-10-19 17:52:55.632] [INFO] console - [ 64, 2215423214878720, {}, 'ru.kopa.model.Zemla.setParent' ]
[2016-10-19 17:52:55.639] [DEBUG] Server - api:model.Zemla.setParent registered
[2016-10-19 17:52:55.644] [INFO] console - [ 64, 4199581204086784, {}, 'ru.kopa.model.Zemla.promiseKopi' ]
[2016-10-19 17:52:55.653] [DEBUG] Server - api:model.Zemla.promiseKopi registered
[2016-10-19 17:52:55.657] [INFO] console - [ 64,
  6058659542990848,
  {},
  'ru.kopa.model.Predlozhenie.getGolosa' ]
[2016-10-19 17:52:55.669] [DEBUG] Server - api:model.Predlozhenie.getGolosa registered
[2016-10-19 17:52:55.670] [INFO] console - [ 64, 7828798521212928, {}, 'ru.kopa.unitTest.orderProc' ]
[2016-10-19 17:52:55.689] [DEBUG] Server - api:unitTest.orderProc registered
[2016-10-19 17:52:55.693] [INFO] Server - started
[2016-10-19 17:53:07.227] [INFO] console - [ 70, 77, {}, [ undefined ] ]
[2016-10-19 17:53:07.376] [INFO] console - Executing (default): delete from "Kopnik"
                where
                    name like '%temp'
                    or name like 'temp%'
[2016-10-19 17:53:08.511] [INFO] console - Executing (default): update "Kopnik"
                set 
                    "voiskoSize"= case when id=2 then 1 ELSE 0 END
                where
                    id>1 
                    and id<=5
[2016-10-19 17:53:15.539] [INFO] console - [ 70, 79, {}, [ undefined ] ]
[2016-10-19 17:53:15.557] [INFO] console - Executing (default): delete from "Kopnik"
                where
                    name like '%temp'
                    or name like 'temp%'
[2016-10-19 17:53:15.564] [INFO] console - Executing (default): update "Kopnik"
                set 
                    "voiskoSize"= case when id=2 then 1 ELSE 0 END
                where
                    id>1 
                    and id<=5
[2016-10-19 17:53:15.571] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 2 }
[2016-10-19 17:53:15.578] [INFO] console - Executing (c2ec37c9-6765-42a2-a608-5c64ced757e6): START TRANSACTION;
[2016-10-19 17:53:15.583] [INFO] console - Executing (c2ec37c9-6765-42a2-a608-5c64ced757e6): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:53:15.660] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 17:53:15.682] [INFO] console - Executing (c2ec37c9-6765-42a2-a608-5c64ced757e6): COMMIT;
[2016-10-19 17:53:15.688] [INFO] console - [ 70,
  80,
  {},
  [ { fullName: 'Unit Test',
      fullPath: '/2/',
      id: '2',
      email: 'unittest2@domain.ru',
      name: 'Unit',
      surname: 'Test',
      patronymic: '1',
      voiskoSize: 1,
      birth: 1983,
      path: '/',
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: null,
      attachments: [] } ] ]
[2016-10-19 17:53:15.763] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 17:53:15.775] [INFO] console - Executing (0e9c75af-4540-4ac9-a292-9ad07e01f8bd): START TRANSACTION;
[2016-10-19 17:53:15.777] [INFO] console - Executing (0e9c75af-4540-4ac9-a292-9ad07e01f8bd): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:53:15.801] [INFO] console - Executing (0e9c75af-4540-4ac9-a292-9ad07e01f8bd): INSERT INTO "Kopnik" ("id","name","surname","patronymic","voiskoSize","birth","path","created_at","updated_at","dom_id","starshina_id") VALUES (DEFAULT,'temp','temp','temp',0,1900,'/','2016-10-19 12:53:15.783 +00:00','2016-10-19 12:53:15.783 +00:00',2,NULL) RETURNING *;
[2016-10-19 17:53:15.817] [INFO] console - Executing (0e9c75af-4540-4ac9-a292-9ad07e01f8bd): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 17:53:15.834] [INFO] console - Executing (0e9c75af-4540-4ac9-a292-9ad07e01f8bd): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 17:53:15.857] [INFO] console - Executing (0e9c75af-4540-4ac9-a292-9ad07e01f8bd): update "Zemla"
                                    set "obshinaSize"= "obshinaSize"+ 1
                                where
                                    '/1/' like path||id||'/%'
                                    or (
                                        true 
                                        and id= 2
                                    )
[2016-10-19 17:53:15.862] [INFO] console - Executing (0e9c75af-4540-4ac9-a292-9ad07e01f8bd): COMMIT;
[2016-10-19 17:53:15.866] [INFO] console - [ 70, 81, {}, [ '15' ] ]
[2016-10-19 17:53:15.880] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 17:53:15.888] [INFO] console - Executing (default): select z.*
                                    from "Zemla" as z
                                where
                                    '/1/' like z.path||z.id||'/%'
[2016-10-19 17:53:15.907] [INFO] console - Executing (1029ded0-99af-40ff-a985-9f9dd27e4266): START TRANSACTION;
[2016-10-19 17:53:15.921] [INFO] console - Executing (1029ded0-99af-40ff-a985-9f9dd27e4266): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:53:15.935] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" IN ('1')) ORDER BY "Zemla"."path" desc;
[2016-10-19 17:53:15.943] [INFO] console - [ 16,
  38844908961792,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id2.obshinaChange',
  [],
  { obshinaSize: 13 } ]
[2016-10-19 17:53:15.954] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 15);
[2016-10-19 17:53:15.963] [INFO] console - [ 16,
  8619072275087360,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id1.obshinaChange',
  [],
  { obshinaSize: 15 } ]
[2016-10-19 17:53:15.973] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 17:53:15.998] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 17:53:16.014] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 17:53:16.020] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 17:53:16.038] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='2',"updated_at"='2016-10-19 12:53:16.023 +00:00' WHERE "id" = '15'
[2016-10-19 17:53:16.043] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/', '/2/')
                                where
                                    id = '15'
                                    or path like '/15/'||'%'
[2016-10-19 17:53:16.048] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 17:53:16.051] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 17:53:16.061] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 17:53:16.069] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/2/15/'||'%'
[2016-10-19 17:53:16.073] [INFO] console - Executing (1029ded0-99af-40ff-a985-9f9dd27e4266): COMMIT;
[2016-10-19 17:53:16.076] [INFO] console - [ 70, 82, {}, [ undefined ] ]
[2016-10-19 17:53:16.087] [INFO] console - [ 16,
  6685477593677824,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 2 } ]
[2016-10-19 17:53:16.103] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 17:53:16.112] [INFO] console - Executing (63a39c45-41dc-424a-8b52-3805d406029a): START TRANSACTION;
[2016-10-19 17:53:16.115] [INFO] console - Executing (63a39c45-41dc-424a-8b52-3805d406029a): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:53:16.130] [INFO] console - Executing (63a39c45-41dc-424a-8b52-3805d406029a): INSERT INTO "Kopnik" ("id","name","surname","patronymic","voiskoSize","birth","path","created_at","updated_at","dom_id","starshina_id") VALUES (DEFAULT,'temp','temp','temp',0,1900,'/','2016-10-19 12:53:16.119 +00:00','2016-10-19 12:53:16.119 +00:00',2,NULL) RETURNING *;
[2016-10-19 17:53:16.146] [INFO] console - Executing (63a39c45-41dc-424a-8b52-3805d406029a): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 17:53:16.155] [INFO] console - Executing (63a39c45-41dc-424a-8b52-3805d406029a): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 17:53:16.166] [INFO] console - Executing (63a39c45-41dc-424a-8b52-3805d406029a): update "Zemla"
                                    set "obshinaSize"= "obshinaSize"+ 1
                                where
                                    '/1/' like path||id||'/%'
                                    or (
                                        true 
                                        and id= 2
                                    )
[2016-10-19 17:53:16.177] [INFO] console - Executing (63a39c45-41dc-424a-8b52-3805d406029a): COMMIT;
[2016-10-19 17:53:16.179] [INFO] console - [ 70, 83, {}, [ '16' ] ]
[2016-10-19 17:53:16.229] [INFO] console - Executing (0df62e23-7290-4c5f-906f-ce0ff00ecc40): START TRANSACTION;
[2016-10-19 17:53:16.245] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 17:53:16.251] [INFO] console - Executing (0df62e23-7290-4c5f-906f-ce0ff00ecc40): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:53:16.259] [INFO] console - Executing (default): select z.*
                                    from "Zemla" as z
                                where
                                    '/1/' like z.path||z.id||'/%'
[2016-10-19 17:53:16.272] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 16);
[2016-10-19 17:53:16.289] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" IN ('1')) ORDER BY "Zemla"."path" desc;
[2016-10-19 17:53:16.308] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 15);
[2016-10-19 17:53:16.312] [INFO] console - [ 16,
  3245287277592576,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id2.obshinaChange',
  [],
  { obshinaSize: 14 } ]
[2016-10-19 17:53:16.324] [INFO] console - [ 16,
  7832110712750080,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id1.obshinaChange',
  [],
  { obshinaSize: 16 } ]
[2016-10-19 17:53:16.346] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 17:53:16.367] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 17:53:16.377] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 17:53:16.394] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='15',"updated_at"='2016-10-19 12:53:16.382 +00:00' WHERE "id" = '16'
[2016-10-19 17:53:16.400] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/', '/2/15/')
                                where
                                    id = '16'
                                    or path like '/16/'||'%'
[2016-10-19 17:53:16.404] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/2/15/' like path||id||'/%'
[2016-10-19 17:53:16.410] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/15/' like k.path||k.id||'/%'
[2016-10-19 17:53:16.425] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('15', '2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 17:53:16.445] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/2/15/16/'||'%'
[2016-10-19 17:53:16.450] [INFO] console - Executing (0df62e23-7290-4c5f-906f-ce0ff00ecc40): COMMIT;
[2016-10-19 17:53:16.457] [INFO] console - [ 70, 84, {}, [ undefined ] ]
[2016-10-19 17:53:16.467] [INFO] console - [ 16,
  6213317817270272,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id15.voiskoChange',
  [],
  { voiskoSize: 1 } ]
[2016-10-19 17:53:16.482] [INFO] console - [ 16,
  669502022877184,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 3 } ]
[2016-10-19 17:53:16.505] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 4 }
[2016-10-19 17:53:16.511] [INFO] console - Executing (522c30b1-4bb1-4c4c-b1aa-7b0e5ce4b636): START TRANSACTION;
[2016-10-19 17:53:16.515] [INFO] console - Executing (522c30b1-4bb1-4c4c-b1aa-7b0e5ce4b636): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:53:16.532] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 4);
[2016-10-19 17:53:16.545] [INFO] console - Executing (522c30b1-4bb1-4c4c-b1aa-7b0e5ce4b636): COMMIT;
[2016-10-19 17:53:16.547] [INFO] console - [ 70,
  85,
  {},
  [ { fullName: 'Unit Test',
      fullPath: '/4/',
      id: '4',
      email: 'unittest4@domain.ru',
      name: 'Unit',
      surname: 'Test',
      patronymic: '4',
      voiskoSize: 0,
      birth: 1983,
      path: '/',
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: null,
      attachments: [] } ] ]
[2016-10-19 17:53:16.577] [INFO] console - Executing (3d344588-ff6b-4731-bb57-e34717aac7e7): START TRANSACTION;
[2016-10-19 17:53:16.580] [INFO] console - Executing (3d344588-ff6b-4731-bb57-e34717aac7e7): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:53:16.587] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 15);
[2016-10-19 17:53:16.597] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 4);
[2016-10-19 17:53:16.604] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 17:53:16.615] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 17:53:16.623] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-2
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 17:53:16.641] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='4',"updated_at"='2016-10-19 12:53:16.626 +00:00' WHERE "id" = '15'
[2016-10-19 17:53:16.649] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/2/', '/4/')
                                where
                                    id = '15'
                                    or path like '/2/15/'||'%'
[2016-10-19 17:53:16.655] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+2
                                where
                                    '/4/' like path||id||'/%'
[2016-10-19 17:53:16.660] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/4/' like k.path||k.id||'/%'
[2016-10-19 17:53:16.673] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('4')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 17:53:16.682] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/4/15/'||'%'
[2016-10-19 17:53:16.688] [INFO] console - Executing (3d344588-ff6b-4731-bb57-e34717aac7e7): COMMIT;
[2016-10-19 17:53:16.692] [INFO] console - [ 70, 86, {}, [ undefined ] ]
[2016-10-19 17:53:16.699] [INFO] console - [ 16,
  7699852987203584,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 1 } ]
[2016-10-19 17:53:16.710] [INFO] console - [ 16,
  4180666914701312,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id4.voiskoChange',
  [],
  { voiskoSize: 2 } ]
[2016-10-19 17:53:16.719] [INFO] console - [ 16,
  8271260295364608,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id16.starshinaChange',
  [],
  {} ]
[2016-10-19 17:53:16.745] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 16 }
[2016-10-19 17:53:16.749] [INFO] console - Executing (4d406034-3401-41ad-afae-857b49b23a3f): START TRANSACTION;
[2016-10-19 17:53:16.752] [INFO] console - Executing (4d406034-3401-41ad-afae-857b49b23a3f): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:53:16.771] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 16);
[2016-10-19 17:53:16.784] [INFO] console - Executing (4d406034-3401-41ad-afae-857b49b23a3f): COMMIT;
[2016-10-19 17:53:16.788] [INFO] console - [ 70,
  87,
  {},
  [ { fullName: 'temp temp',
      fullPath: '/4/15/16/',
      id: '16',
      email: null,
      name: 'temp',
      surname: 'temp',
      patronymic: 'temp',
      voiskoSize: 0,
      birth: 1900,
      path: '/4/15/',
      note: null,
      created_at: Wed Oct 19 2016 17:53:16 GMT+0500 (YEKT),
      updated_at: Wed Oct 19 2016 17:53:16 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: '15',
      attachments: [] } ] ]
[2016-10-19 17:53:16.817] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 15 }
[2016-10-19 17:53:16.829] [INFO] console - Executing (56849bf1-113b-4c56-8220-a0205b65d056): START TRANSACTION;
[2016-10-19 17:53:16.835] [INFO] console - Executing (56849bf1-113b-4c56-8220-a0205b65d056): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:53:16.860] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 15);
[2016-10-19 17:53:16.874] [INFO] console - Executing (56849bf1-113b-4c56-8220-a0205b65d056): COMMIT;
[2016-10-19 17:53:16.879] [INFO] console - [ 70,
  88,
  {},
  [ { fullName: 'temp temp',
      fullPath: '/4/15/',
      id: '15',
      email: null,
      name: 'temp',
      surname: 'temp',
      patronymic: 'temp',
      voiskoSize: 1,
      birth: 1900,
      path: '/4/',
      note: null,
      created_at: Wed Oct 19 2016 17:53:15 GMT+0500 (YEKT),
      updated_at: Wed Oct 19 2016 17:53:16 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: '4',
      attachments: [] } ] ]
[2016-10-19 17:53:16.963] [DEBUG] Server - #promiseModel() [] { model: 'Kopa', id: 3 }
[2016-10-19 17:53:16.970] [INFO] console - Executing (91ccc70d-708f-4274-b881-cbab7cabfe29): START TRANSACTION;
[2016-10-19 17:53:16.974] [INFO] console - Executing (91ccc70d-708f-4274-b881-cbab7cabfe29): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:53:16.992] [INFO] console - Executing (default): SELECT "Kopa"."id", "Kopa"."question", "Kopa"."invited", "Kopa"."note", "Kopa"."created_at", "Kopa"."updated_at", "Kopa"."deleted_at", "Kopa"."place_id", "Kopa"."inviter_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopa" AS "Kopa" LEFT OUTER JOIN "File" AS "attachments" ON "Kopa"."id" = "attachments"."kopa_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopa"."deleted_at" IS NULL AND "Kopa"."id" = 3);
[2016-10-19 17:53:17.003] [INFO] console - Executing (91ccc70d-708f-4274-b881-cbab7cabfe29): COMMIT;
[2016-10-19 17:53:17.006] [INFO] console - [ 70,
  89,
  {},
  [ { id: '3',
      question: 'CHE',
      invited: Thu Sep 01 2016 00:00:00 GMT+0500 (YEKT),
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      place_id: '2',
      inviter_id: '2',
      attachments: [] } ] ]
[2016-10-19 17:53:17.033] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 17:53:17.039] [INFO] console - Executing (2d2aa1b9-cd54-464a-8cd7-2763fa1d6f29): START TRANSACTION;
[2016-10-19 17:53:17.042] [INFO] console - Executing (2d2aa1b9-cd54-464a-8cd7-2763fa1d6f29): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:53:17.056] [INFO] console - Executing (2d2aa1b9-cd54-464a-8cd7-2763fa1d6f29): INSERT INTO "Predlozhenie" ("id","value","totalZa","totalProtiv","created_at","updated_at","author_id","place_id") VALUES (DEFAULT,'temp Wed Oct 19 2016 17:53:17 GMT+0500 (YEKT)',0,0,'2016-10-19 12:53:17.046 +00:00','2016-10-19 12:53:17.046 +00:00',2,3) RETURNING *;
[2016-10-19 17:53:17.064] [INFO] console - Executing (2d2aa1b9-cd54-464a-8cd7-2763fa1d6f29): COMMIT;
[2016-10-19 17:53:17.066] [INFO] console - [ 70, 90, {}, [ '8' ] ]
[2016-10-19 17:53:17.077] [INFO] console - [ 16,
  6633680239853568,
  { acknowledge: true },
  'ru.kopa.model.Kopa.id3.predlozhenieAdd',
  [ '8' ] ]
[2016-10-19 17:53:17.107] [INFO] console - Executing (3b5a0f23-cda5-44ef-b92d-90e66c5b8c5b): START TRANSACTION;
[2016-10-19 17:53:17.111] [INFO] console - Executing (3b5a0f23-cda5-44ef-b92d-90e66c5b8c5b): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:53:17.125] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 17:53:17.146] [INFO] console - Executing (default): SELECT "id", "value", "totalZa", "totalProtiv", "state", "note", "created_at", "updated_at", "deleted_at", "author_id", "place_id" FROM "Predlozhenie" AS "Predlozhenie" WHERE ("Predlozhenie"."deleted_at" IS NULL AND "Predlozhenie"."id" = 8);
[2016-10-19 17:53:17.179] [INFO] console - Executing (default): SELECT "id", "question", "invited", "note", "created_at", "updated_at", "deleted_at", "place_id", "inviter_id" FROM "Kopa" AS "Kopa" WHERE ("Kopa"."deleted_at" IS NULL AND "Kopa"."id" = '3');
[2016-10-19 17:53:17.196] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 17:53:17.211] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 17:53:17.218] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 17:53:17.245] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 17:53:17.259] [INFO] console - Executing (default): SELECT "id", "value", "reason", "note", "created_at", "updated_at", "deleted_at", "subject_id", "owner_id", "parent_id" FROM "Golos" AS "Golos" WHERE ("Golos"."deleted_at" IS NULL AND ("Golos"."subject_id" = '8' AND "Golos"."owner_id" = '2')) LIMIT 1;
[2016-10-19 17:53:17.277] [INFO] console - Executing (default): INSERT INTO "Golos" ("id","value","created_at","updated_at","subject_id","owner_id") VALUES (DEFAULT,1,'2016-10-19 12:53:17.265 +00:00','2016-10-19 12:53:17.265 +00:00','8','2') RETURNING *;
[2016-10-19 17:53:17.285] [INFO] console - Executing (default): insert into "Golos" (subject_id, value, owner_id, parent_id, created_at, updated_at)
                            (
                                select 8, 1, k.id, 25, current_timestamp, current_timestamp
                                from 
                                    "Kopnik" k
                                     join "Zemla" d on d.id= k.dom_id
                                where
                                    k.path like '/2/%'
                                    and d.path||d.id||'/' like '/1/2/%' 
                            )
[2016-10-19 17:53:17.291] [INFO] console - Executing (default): select
                            (select count(*) from "Golos" g where subject_id= 8 and value=1) "za",
                            (select count(*) from "Golos" g where subject_id= 8 and value=-1) "protiv"
[2016-10-19 17:53:17.305] [INFO] console - Executing (default): UPDATE "Predlozhenie" SET "totalZa"=2,"updated_at"='2016-10-19 12:53:17.296 +00:00' WHERE "id" = '8'
[2016-10-19 17:53:17.311] [INFO] console - Executing (3b5a0f23-cda5-44ef-b92d-90e66c5b8c5b): COMMIT;
[2016-10-19 17:53:17.314] [INFO] console - [ 70, 91, {}, [ undefined ] ]
[2016-10-19 17:53:17.319] [INFO] console - [ 16,
  6015588759502848,
  { acknowledge: true },
  'ru.kopa.model.Predlozhenie.id8.rebalance',
  [],
  { totalZa: 2,
    totalProtiv: 0,
    GOLOS: '25',
    action: 'add',
    value: 1 } ]
[2016-10-19 17:53:17.331] [INFO] console - Executing (236753ad-d36a-4b14-8a14-4fd4e7381d9d): START TRANSACTION;
[2016-10-19 17:53:17.340] [INFO] console - Executing (236753ad-d36a-4b14-8a14-4fd4e7381d9d): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:53:17.351] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 17:53:17.362] [DEBUG] Server - #promiseModel() [] { model: 'Golos', id: 25 }
[2016-10-19 17:53:17.369] [INFO] console - Executing (28ddb1fd-9d83-4a33-8b7a-2ae7404b9866): START TRANSACTION;
[2016-10-19 17:53:17.386] [INFO] console - Executing (28ddb1fd-9d83-4a33-8b7a-2ae7404b9866): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:53:17.435] [INFO] console - Executing (default): SELECT "id", "value", "totalZa", "totalProtiv", "state", "note", "created_at", "updated_at", "deleted_at", "author_id", "place_id" FROM "Predlozhenie" AS "Predlozhenie" WHERE ("Predlozhenie"."deleted_at" IS NULL AND "Predlozhenie"."id" = 8);
[2016-10-19 17:53:17.445] [INFO] console - Executing (default): SELECT "Golos"."id", "Golos"."value", "Golos"."reason", "Golos"."note", "Golos"."created_at", "Golos"."updated_at", "Golos"."deleted_at", "Golos"."subject_id", "Golos"."owner_id", "Golos"."parent_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Golos" AS "Golos" LEFT OUTER JOIN "File" AS "attachments" ON "Golos"."id" = "attachments"."golos_id" AND "attachments"."deleted_at" IS NULL WHERE ("Golos"."deleted_at" IS NULL AND "Golos"."id" = 25);
[2016-10-19 17:53:17.460] [INFO] console - Executing (default): SELECT "id", "question", "invited", "note", "created_at", "updated_at", "deleted_at", "place_id", "inviter_id" FROM "Kopa" AS "Kopa" WHERE ("Kopa"."deleted_at" IS NULL AND "Kopa"."id" = '3');
[2016-10-19 17:53:17.480] [INFO] console - Executing (28ddb1fd-9d83-4a33-8b7a-2ae7404b9866): COMMIT;
[2016-10-19 17:53:17.487] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 17:53:17.497] [INFO] console - [ 70,
  93,
  {},
  [ { id: '25',
      value: 1,
      reason: null,
      note: null,
      created_at: Wed Oct 19 2016 17:53:17 GMT+0500 (YEKT),
      updated_at: Wed Oct 19 2016 17:53:17 GMT+0500 (YEKT),
      deleted_at: null,
      subject_id: '8',
      owner_id: '2',
      parent_id: null,
      attachments: [] } ] ]
[2016-10-19 17:53:17.522] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 17:53:17.531] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 17:53:17.545] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 17:53:17.575] [INFO] console - Executing (default): SELECT "id", "value", "reason", "note", "created_at", "updated_at", "deleted_at", "subject_id", "owner_id", "parent_id" FROM "Golos" AS "Golos" WHERE ("Golos"."deleted_at" IS NULL AND ("Golos"."subject_id" = '8' AND "Golos"."owner_id" = '2')) LIMIT 1;
[2016-10-19 17:53:17.586] [INFO] console - Executing (default): delete from "Golos" 
                            where
                                subject_id= 8
                                and (
                                    id= 25
                                    or parent_id = 25
                                )
[2016-10-19 17:53:17.606] [INFO] console - Executing (default): select
                            (select count(*) from "Golos" g where subject_id= 8 and value=1) "za",
                            (select count(*) from "Golos" g where subject_id= 8 and value=-1) "protiv"
[2016-10-19 17:53:17.642] [INFO] console - Executing (default): UPDATE "Predlozhenie" SET "totalZa"=0,"updated_at"='2016-10-19 12:53:17.622 +00:00' WHERE "id" = '8'
[2016-10-19 17:53:17.656] [INFO] console - Executing (236753ad-d36a-4b14-8a14-4fd4e7381d9d): COMMIT;
[2016-10-19 17:53:17.665] [INFO] console - [ 70, 92, {}, [ undefined ] ]
[2016-10-19 17:53:17.675] [INFO] console - [ 16,
  7484866409005056,
  { acknowledge: true },
  'ru.kopa.model.Predlozhenie.id8.rebalance',
  [],
  { totalZa: 0,
    totalProtiv: 0,
    GOLOS: '25',
    action: 'remove',
    value: 1 } ]
[2016-10-19 17:53:40.083] [INFO] console - [ 70, 95, {}, [ undefined ] ]
[2016-10-19 17:53:40.150] [INFO] console - Executing (default): delete from "Kopnik"
                where
                    name like '%temp'
                    or name like 'temp%'
[2016-10-19 17:53:40.160] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 2 }
[2016-10-19 17:53:40.176] [INFO] console - Executing (46543de0-063c-4cb9-9ac4-62d6de860c3d): START TRANSACTION;
[2016-10-19 17:53:40.182] [INFO] console - Executing (46543de0-063c-4cb9-9ac4-62d6de860c3d): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:53:40.252] [INFO] console - Executing (default): update "Kopnik"
                set 
                    "voiskoSize"= case when id=2 then 1 ELSE 0 END
                where
                    id>1 
                    and id<=5
[2016-10-19 17:53:40.262] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 17:53:40.290] [INFO] console - Executing (46543de0-063c-4cb9-9ac4-62d6de860c3d): COMMIT;
[2016-10-19 17:53:40.302] [INFO] console - [ 70,
  96,
  {},
  [ { fullName: 'Unit Test',
      fullPath: '/2/',
      id: '2',
      email: 'unittest2@domain.ru',
      name: 'Unit',
      surname: 'Test',
      patronymic: '1',
      voiskoSize: 1,
      birth: 1983,
      path: '/',
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: null,
      attachments: [] } ] ]
[2016-10-19 17:53:40.386] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 17:53:40.396] [INFO] console - Executing (1a56e0ea-632c-464b-84e8-12e051503967): START TRANSACTION;
[2016-10-19 17:53:40.399] [INFO] console - Executing (1a56e0ea-632c-464b-84e8-12e051503967): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:53:40.417] [INFO] console - Executing (1a56e0ea-632c-464b-84e8-12e051503967): INSERT INTO "Kopnik" ("id","name","surname","patronymic","voiskoSize","birth","path","created_at","updated_at","dom_id","starshina_id") VALUES (DEFAULT,'temp','temp','temp',0,1900,'/','2016-10-19 12:53:40.403 +00:00','2016-10-19 12:53:40.403 +00:00',2,NULL) RETURNING *;
[2016-10-19 17:53:40.423] [INFO] console - Executing (1a56e0ea-632c-464b-84e8-12e051503967): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 17:53:40.434] [INFO] console - Executing (1a56e0ea-632c-464b-84e8-12e051503967): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 17:53:40.445] [INFO] console - Executing (1a56e0ea-632c-464b-84e8-12e051503967): update "Zemla"
                                    set "obshinaSize"= "obshinaSize"+ 1
                                where
                                    '/1/' like path||id||'/%'
                                    or (
                                        true 
                                        and id= 2
                                    )
[2016-10-19 17:53:40.450] [INFO] console - Executing (1a56e0ea-632c-464b-84e8-12e051503967): COMMIT;
[2016-10-19 17:53:40.453] [INFO] console - [ 70, 97, {}, [ '17' ] ]
[2016-10-19 17:53:40.467] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 17:53:40.477] [INFO] console - Executing (default): select z.*
                                    from "Zemla" as z
                                where
                                    '/1/' like z.path||z.id||'/%'
[2016-10-19 17:53:40.479] [INFO] console - Executing (e01062bb-f674-4c96-9682-2bea9ddd2ca0): START TRANSACTION;
[2016-10-19 17:53:40.482] [INFO] console - Executing (e01062bb-f674-4c96-9682-2bea9ddd2ca0): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:53:40.503] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" IN ('1')) ORDER BY "Zemla"."path" desc;
[2016-10-19 17:53:40.505] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 17);
[2016-10-19 17:53:40.511] [INFO] console - [ 16,
  7791294084546560,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id2.obshinaChange',
  [],
  { obshinaSize: 15 } ]
[2016-10-19 17:53:40.522] [INFO] console - [ 16,
  3576132559437824,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id1.obshinaChange',
  [],
  { obshinaSize: 17 } ]
[2016-10-19 17:53:40.539] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 17:53:40.546] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 17:53:40.556] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 17:53:40.562] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 17:53:40.574] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='2',"updated_at"='2016-10-19 12:53:40.564 +00:00' WHERE "id" = '17'
[2016-10-19 17:53:40.579] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/', '/2/')
                                where
                                    id = '17'
                                    or path like '/17/'||'%'
[2016-10-19 17:53:40.586] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 17:53:40.589] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 17:53:40.600] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 17:53:40.607] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/2/17/'||'%'
[2016-10-19 17:53:40.613] [INFO] console - Executing (e01062bb-f674-4c96-9682-2bea9ddd2ca0): COMMIT;
[2016-10-19 17:53:40.617] [INFO] console - [ 70, 98, {}, [ undefined ] ]
[2016-10-19 17:53:40.625] [INFO] console - [ 16,
  4990244659134464,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 2 } ]
[2016-10-19 17:53:40.671] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 17:53:40.680] [INFO] console - Executing (68166c2c-de96-49e0-957e-f4e36f4f8d9f): START TRANSACTION;
[2016-10-19 17:53:40.683] [INFO] console - Executing (68166c2c-de96-49e0-957e-f4e36f4f8d9f): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:53:40.696] [INFO] console - Executing (68166c2c-de96-49e0-957e-f4e36f4f8d9f): INSERT INTO "Kopnik" ("id","name","surname","patronymic","voiskoSize","birth","path","created_at","updated_at","dom_id","starshina_id") VALUES (DEFAULT,'temp','temp','temp',0,1900,'/','2016-10-19 12:53:40.686 +00:00','2016-10-19 12:53:40.686 +00:00',2,NULL) RETURNING *;
[2016-10-19 17:53:40.703] [INFO] console - Executing (68166c2c-de96-49e0-957e-f4e36f4f8d9f): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 17:53:40.712] [INFO] console - Executing (68166c2c-de96-49e0-957e-f4e36f4f8d9f): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 17:53:40.719] [INFO] console - Executing (68166c2c-de96-49e0-957e-f4e36f4f8d9f): update "Zemla"
                                    set "obshinaSize"= "obshinaSize"+ 1
                                where
                                    '/1/' like path||id||'/%'
                                    or (
                                        true 
                                        and id= 2
                                    )
[2016-10-19 17:53:40.726] [INFO] console - Executing (68166c2c-de96-49e0-957e-f4e36f4f8d9f): COMMIT;
[2016-10-19 17:53:40.729] [INFO] console - [ 70, 99, {}, [ '18' ] ]
[2016-10-19 17:53:40.741] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 17:53:40.750] [INFO] console - Executing (default): select z.*
                                    from "Zemla" as z
                                where
                                    '/1/' like z.path||z.id||'/%'
[2016-10-19 17:53:40.763] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" IN ('1')) ORDER BY "Zemla"."path" desc;
[2016-10-19 17:53:40.769] [INFO] console - [ 16,
  3692114563039232,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id2.obshinaChange',
  [],
  { obshinaSize: 16 } ]
[2016-10-19 17:53:40.788] [INFO] console - [ 16,
  8561728082149376,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id1.obshinaChange',
  [],
  { obshinaSize: 18 } ]
[2016-10-19 17:53:40.807] [INFO] console - Executing (a66041d0-9050-47a0-91ce-c2b5242bf03d): START TRANSACTION;
[2016-10-19 17:53:40.810] [INFO] console - Executing (a66041d0-9050-47a0-91ce-c2b5242bf03d): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:53:40.821] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 18);
[2016-10-19 17:53:40.846] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 17);
[2016-10-19 17:53:40.855] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 17:53:40.866] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 17:53:40.872] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 17:53:40.884] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='17',"updated_at"='2016-10-19 12:53:40.875 +00:00' WHERE "id" = '18'
[2016-10-19 17:53:40.890] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/', '/2/17/')
                                where
                                    id = '18'
                                    or path like '/18/'||'%'
[2016-10-19 17:53:40.897] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/2/17/' like path||id||'/%'
[2016-10-19 17:53:40.901] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/17/' like k.path||k.id||'/%'
[2016-10-19 17:53:40.913] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('17', '2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 17:53:40.924] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/2/17/18/'||'%'
[2016-10-19 17:53:40.928] [INFO] console - Executing (a66041d0-9050-47a0-91ce-c2b5242bf03d): COMMIT;
[2016-10-19 17:53:40.935] [INFO] console - [ 70, 100, {}, [ undefined ] ]
[2016-10-19 17:53:40.943] [INFO] console - [ 16,
  856816967745536,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id17.voiskoChange',
  [],
  { voiskoSize: 1 } ]
[2016-10-19 17:53:40.953] [INFO] console - [ 16,
  3067507162218496,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 3 } ]
[2016-10-19 17:53:40.971] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 4 }
[2016-10-19 17:53:40.977] [INFO] console - Executing (4e281a66-b5b9-40a6-957c-3bc8ec60f506): START TRANSACTION;
[2016-10-19 17:53:40.980] [INFO] console - Executing (4e281a66-b5b9-40a6-957c-3bc8ec60f506): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:53:41.003] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 4);
[2016-10-19 17:53:41.016] [INFO] console - Executing (4e281a66-b5b9-40a6-957c-3bc8ec60f506): COMMIT;
[2016-10-19 17:53:41.019] [INFO] console - [ 70,
  101,
  {},
  [ { fullName: 'Unit Test',
      fullPath: '/4/',
      id: '4',
      email: 'unittest4@domain.ru',
      name: 'Unit',
      surname: 'Test',
      patronymic: '4',
      voiskoSize: 0,
      birth: 1983,
      path: '/',
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: null,
      attachments: [] } ] ]
[2016-10-19 17:53:41.047] [INFO] console - Executing (329a7d03-e35a-4636-8779-2cb1cfa7d741): START TRANSACTION;
[2016-10-19 17:53:41.050] [INFO] console - Executing (329a7d03-e35a-4636-8779-2cb1cfa7d741): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:53:41.058] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 17);
[2016-10-19 17:53:41.071] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 4);
[2016-10-19 17:53:41.078] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 17:53:41.091] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 17:53:41.098] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-2
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 17:53:41.129] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='4',"updated_at"='2016-10-19 12:53:41.101 +00:00' WHERE "id" = '17'
[2016-10-19 17:53:41.135] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/2/', '/4/')
                                where
                                    id = '17'
                                    or path like '/2/17/'||'%'
[2016-10-19 17:53:41.142] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+2
                                where
                                    '/4/' like path||id||'/%'
[2016-10-19 17:53:41.147] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/4/' like k.path||k.id||'/%'
[2016-10-19 17:53:41.157] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('4')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 17:53:41.163] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/4/17/'||'%'
[2016-10-19 17:53:41.166] [INFO] console - Executing (329a7d03-e35a-4636-8779-2cb1cfa7d741): COMMIT;
[2016-10-19 17:53:41.169] [INFO] console - [ 70, 102, {}, [ undefined ] ]
[2016-10-19 17:53:41.174] [INFO] console - [ 16,
  1997152188366848,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 1 } ]
[2016-10-19 17:53:41.185] [INFO] console - [ 16,
  7995826898993152,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id4.voiskoChange',
  [],
  { voiskoSize: 2 } ]
[2016-10-19 17:53:41.194] [INFO] console - [ 16,
  5198666044276736,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id18.starshinaChange',
  [],
  {} ]
[2016-10-19 17:53:41.240] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 18 }
[2016-10-19 17:53:41.246] [INFO] console - Executing (3f7da225-9f3e-4517-b484-e4f4953707f1): START TRANSACTION;
[2016-10-19 17:53:41.249] [INFO] console - Executing (3f7da225-9f3e-4517-b484-e4f4953707f1): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:53:41.272] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 18);
[2016-10-19 17:53:41.285] [INFO] console - Executing (3f7da225-9f3e-4517-b484-e4f4953707f1): COMMIT;
[2016-10-19 17:53:41.288] [INFO] console - [ 70,
  103,
  {},
  [ { fullName: 'temp temp',
      fullPath: '/4/17/18/',
      id: '18',
      email: null,
      name: 'temp',
      surname: 'temp',
      patronymic: 'temp',
      voiskoSize: 0,
      birth: 1900,
      path: '/4/17/',
      note: null,
      created_at: Wed Oct 19 2016 17:53:40 GMT+0500 (YEKT),
      updated_at: Wed Oct 19 2016 17:53:40 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: '17',
      attachments: [] } ] ]
[2016-10-19 17:53:41.308] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 17 }
[2016-10-19 17:53:41.320] [INFO] console - Executing (8b5b14ef-bc4e-47f2-be33-e108f208a0e8): START TRANSACTION;
[2016-10-19 17:53:41.377] [INFO] console - Executing (8b5b14ef-bc4e-47f2-be33-e108f208a0e8): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:53:41.418] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 17);
[2016-10-19 17:53:41.440] [INFO] console - Executing (8b5b14ef-bc4e-47f2-be33-e108f208a0e8): COMMIT;
[2016-10-19 17:53:41.442] [INFO] console - [ 70,
  104,
  {},
  [ { fullName: 'temp temp',
      fullPath: '/4/17/',
      id: '17',
      email: null,
      name: 'temp',
      surname: 'temp',
      patronymic: 'temp',
      voiskoSize: 1,
      birth: 1900,
      path: '/4/',
      note: null,
      created_at: Wed Oct 19 2016 17:53:40 GMT+0500 (YEKT),
      updated_at: Wed Oct 19 2016 17:53:41 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: '4',
      attachments: [] } ] ]
[2016-10-19 17:53:41.465] [DEBUG] Server - #promiseModel() [] { model: 'Kopa', id: 3 }
[2016-10-19 17:53:41.471] [INFO] console - Executing (96eaab61-2c4c-4568-a421-bd60a64eda41): START TRANSACTION;
[2016-10-19 17:53:41.476] [INFO] console - Executing (96eaab61-2c4c-4568-a421-bd60a64eda41): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:53:41.489] [INFO] console - Executing (default): SELECT "Kopa"."id", "Kopa"."question", "Kopa"."invited", "Kopa"."note", "Kopa"."created_at", "Kopa"."updated_at", "Kopa"."deleted_at", "Kopa"."place_id", "Kopa"."inviter_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopa" AS "Kopa" LEFT OUTER JOIN "File" AS "attachments" ON "Kopa"."id" = "attachments"."kopa_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopa"."deleted_at" IS NULL AND "Kopa"."id" = 3);
[2016-10-19 17:53:41.502] [INFO] console - Executing (96eaab61-2c4c-4568-a421-bd60a64eda41): COMMIT;
[2016-10-19 17:53:41.506] [INFO] console - [ 70,
  105,
  {},
  [ { id: '3',
      question: 'CHE',
      invited: Thu Sep 01 2016 00:00:00 GMT+0500 (YEKT),
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      place_id: '2',
      inviter_id: '2',
      attachments: [] } ] ]
[2016-10-19 17:53:41.535] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 17:53:41.543] [INFO] console - Executing (1fc97502-85c5-4784-8ee0-07a4682c37db): START TRANSACTION;
[2016-10-19 17:53:41.545] [INFO] console - Executing (1fc97502-85c5-4784-8ee0-07a4682c37db): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:53:41.558] [INFO] console - Executing (1fc97502-85c5-4784-8ee0-07a4682c37db): INSERT INTO "Predlozhenie" ("id","value","totalZa","totalProtiv","created_at","updated_at","author_id","place_id") VALUES (DEFAULT,'temp Wed Oct 19 2016 17:53:41 GMT+0500 (YEKT)',0,0,'2016-10-19 12:53:41.549 +00:00','2016-10-19 12:53:41.549 +00:00',2,3) RETURNING *;
[2016-10-19 17:53:41.566] [INFO] console - Executing (1fc97502-85c5-4784-8ee0-07a4682c37db): COMMIT;
[2016-10-19 17:53:41.569] [INFO] console - [ 70, 106, {}, [ '9' ] ]
[2016-10-19 17:53:41.575] [INFO] console - [ 16,
  4795278932574208,
  { acknowledge: true },
  'ru.kopa.model.Kopa.id3.predlozhenieAdd',
  [ '9' ] ]
[2016-10-19 17:53:41.594] [INFO] console - Executing (fd16959b-7b9c-4d18-8eea-1d0968fd6042): START TRANSACTION;
[2016-10-19 17:53:41.597] [INFO] console - Executing (fd16959b-7b9c-4d18-8eea-1d0968fd6042): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:53:41.609] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 17:53:41.623] [INFO] console - Executing (default): SELECT "id", "value", "totalZa", "totalProtiv", "state", "note", "created_at", "updated_at", "deleted_at", "author_id", "place_id" FROM "Predlozhenie" AS "Predlozhenie" WHERE ("Predlozhenie"."deleted_at" IS NULL AND "Predlozhenie"."id" = 9);
[2016-10-19 17:53:41.636] [INFO] console - Executing (default): SELECT "id", "question", "invited", "note", "created_at", "updated_at", "deleted_at", "place_id", "inviter_id" FROM "Kopa" AS "Kopa" WHERE ("Kopa"."deleted_at" IS NULL AND "Kopa"."id" = '3');
[2016-10-19 17:53:41.651] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 17:53:41.664] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 17:53:41.671] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 17:53:41.682] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 17:53:41.694] [INFO] console - Executing (default): SELECT "id", "value", "reason", "note", "created_at", "updated_at", "deleted_at", "subject_id", "owner_id", "parent_id" FROM "Golos" AS "Golos" WHERE ("Golos"."deleted_at" IS NULL AND ("Golos"."subject_id" = '9' AND "Golos"."owner_id" = '2')) LIMIT 1;
[2016-10-19 17:53:41.709] [INFO] console - Executing (default): INSERT INTO "Golos" ("id","value","created_at","updated_at","subject_id","owner_id") VALUES (DEFAULT,1,'2016-10-19 12:53:41.700 +00:00','2016-10-19 12:53:41.700 +00:00','9','2') RETURNING *;
[2016-10-19 17:53:41.723] [INFO] console - Executing (default): insert into "Golos" (subject_id, value, owner_id, parent_id, created_at, updated_at)
                            (
                                select 9, 1, k.id, 27, current_timestamp, current_timestamp
                                from 
                                    "Kopnik" k
                                     join "Zemla" d on d.id= k.dom_id
                                where
                                    k.path like '/2/%'
                                    and d.path||d.id||'/' like '/1/2/%' 
                            )
[2016-10-19 17:53:41.728] [INFO] console - Executing (default): select
                            (select count(*) from "Golos" g where subject_id= 9 and value=1) "za",
                            (select count(*) from "Golos" g where subject_id= 9 and value=-1) "protiv"
[2016-10-19 17:53:41.741] [INFO] console - Executing (default): UPDATE "Predlozhenie" SET "totalZa"=2,"updated_at"='2016-10-19 12:53:41.733 +00:00' WHERE "id" = '9'
[2016-10-19 17:53:41.747] [INFO] console - Executing (fd16959b-7b9c-4d18-8eea-1d0968fd6042): COMMIT;
[2016-10-19 17:53:41.751] [INFO] console - [ 70, 107, {}, [ undefined ] ]
[2016-10-19 17:53:41.759] [INFO] console - [ 16,
  6923867545141248,
  { acknowledge: true },
  'ru.kopa.model.Predlozhenie.id9.rebalance',
  [],
  { totalZa: 2,
    totalProtiv: 0,
    GOLOS: '27',
    action: 'add',
    value: 1 } ]
[2016-10-19 17:53:41.782] [INFO] console - Executing (df0b1882-c2c5-43ab-9e33-0b88abe79bca): START TRANSACTION;
[2016-10-19 17:53:41.786] [DEBUG] Server - #promiseModel() [] { model: 'Golos', id: 27 }
[2016-10-19 17:53:41.797] [INFO] console - Executing (0c40bff5-4ea6-43ac-a0e7-c315116cb2e6): START TRANSACTION;
[2016-10-19 17:53:41.799] [INFO] console - Executing (df0b1882-c2c5-43ab-9e33-0b88abe79bca): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:53:41.804] [INFO] console - Executing (0c40bff5-4ea6-43ac-a0e7-c315116cb2e6): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:53:41.824] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 17:53:41.845] [INFO] console - Executing (default): SELECT "Golos"."id", "Golos"."value", "Golos"."reason", "Golos"."note", "Golos"."created_at", "Golos"."updated_at", "Golos"."deleted_at", "Golos"."subject_id", "Golos"."owner_id", "Golos"."parent_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Golos" AS "Golos" LEFT OUTER JOIN "File" AS "attachments" ON "Golos"."id" = "attachments"."golos_id" AND "attachments"."deleted_at" IS NULL WHERE ("Golos"."deleted_at" IS NULL AND "Golos"."id" = 27);
[2016-10-19 17:53:41.862] [INFO] console - Executing (default): SELECT "id", "value", "totalZa", "totalProtiv", "state", "note", "created_at", "updated_at", "deleted_at", "author_id", "place_id" FROM "Predlozhenie" AS "Predlozhenie" WHERE ("Predlozhenie"."deleted_at" IS NULL AND "Predlozhenie"."id" = 9);
[2016-10-19 17:53:41.868] [INFO] console - Executing (0c40bff5-4ea6-43ac-a0e7-c315116cb2e6): COMMIT;
[2016-10-19 17:53:41.877] [INFO] console - Executing (default): SELECT "id", "question", "invited", "note", "created_at", "updated_at", "deleted_at", "place_id", "inviter_id" FROM "Kopa" AS "Kopa" WHERE ("Kopa"."deleted_at" IS NULL AND "Kopa"."id" = '3');
[2016-10-19 17:53:41.879] [INFO] console - [ 70,
  109,
  {},
  [ { id: '27',
      value: 1,
      reason: null,
      note: null,
      created_at: Wed Oct 19 2016 17:53:41 GMT+0500 (YEKT),
      updated_at: Wed Oct 19 2016 17:53:41 GMT+0500 (YEKT),
      deleted_at: null,
      subject_id: '9',
      owner_id: '2',
      parent_id: null,
      attachments: [] } ] ]
[2016-10-19 17:53:41.900] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 17:53:41.915] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 17:53:41.925] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 17:53:41.945] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 17:53:41.962] [INFO] console - Executing (default): SELECT "id", "value", "reason", "note", "created_at", "updated_at", "deleted_at", "subject_id", "owner_id", "parent_id" FROM "Golos" AS "Golos" WHERE ("Golos"."deleted_at" IS NULL AND ("Golos"."subject_id" = '9' AND "Golos"."owner_id" = '2')) LIMIT 1;
[2016-10-19 17:53:41.976] [INFO] console - Executing (default): delete from "Golos" 
                            where
                                subject_id= 9
                                and (
                                    id= 27
                                    or parent_id = 27
                                )
[2016-10-19 17:53:41.986] [INFO] console - Executing (default): select
                            (select count(*) from "Golos" g where subject_id= 9 and value=1) "za",
                            (select count(*) from "Golos" g where subject_id= 9 and value=-1) "protiv"
[2016-10-19 17:53:42.021] [INFO] console - Executing (default): UPDATE "Predlozhenie" SET "totalZa"=0,"updated_at"='2016-10-19 12:53:42.001 +00:00' WHERE "id" = '9'
[2016-10-19 17:53:42.046] [INFO] console - Executing (df0b1882-c2c5-43ab-9e33-0b88abe79bca): COMMIT;
[2016-10-19 17:53:42.051] [INFO] console - [ 70, 108, {}, [ undefined ] ]
[2016-10-19 17:53:42.062] [INFO] console - [ 16,
  7862717102686208,
  { acknowledge: true },
  'ru.kopa.model.Predlozhenie.id9.rebalance',
  [],
  { totalZa: 0,
    totalProtiv: 0,
    GOLOS: '27',
    action: 'remove',
    value: 1 } ]
[2016-10-19 17:53:51.733] [INFO] console - AutobahnJS debug enabled
[2016-10-19 17:53:52.960] [INFO] Server - starting...
[2016-10-19 17:53:52.965] [INFO] console - trying to create WAMP transport of type: websocket
[2016-10-19 17:53:53.048] [INFO] console - using WAMP transport type: websocket
[2016-10-19 17:53:53.316] [INFO] console - [ 1,
  'kopa',
  { roles: 
     { caller: [Object],
       callee: [Object],
       publisher: [Object],
       subscriber: [Object] },
    authmethods: [ 'ticket' ],
    authid: 'server' } ]
[2016-10-19 17:53:53.367] [INFO] console - [ 5, 'server', {} ]
[2016-10-19 17:53:53.412] [INFO] Server - connection.onopen()
[2016-10-19 17:53:53.415] [INFO] console - [ 64, 3221156005937152, {}, 'ru.kopa.model.create' ]
[2016-10-19 17:53:53.422] [DEBUG] Server - api:model.create registered
[2016-10-19 17:53:53.427] [INFO] console - [ 64, 2816922217349120, {}, 'ru.kopa.model.get' ]
[2016-10-19 17:53:53.435] [DEBUG] Server - api:model.get registered
[2016-10-19 17:53:53.435] [INFO] console - [ 64, 2024533491974144, {}, 'ru.kopa.model.save' ]
[2016-10-19 17:53:53.440] [DEBUG] Server - api:model.save registered
[2016-10-19 17:53:53.442] [INFO] console - [ 64, 475755429494784, {}, 'ru.kopa.pingPong' ]
[2016-10-19 17:53:53.452] [DEBUG] Server - api:pingPong registered
[2016-10-19 17:53:53.453] [INFO] console - [ 64, 3315587509911552, {}, 'ru.kopa.discloseCaller' ]
[2016-10-19 17:53:53.458] [DEBUG] Server - api:discloseCaller registered
[2016-10-19 17:53:53.459] [INFO] console - [ 64, 6396239125938176, {}, 'ru.kopa.pingPongDatabase' ]
[2016-10-19 17:53:53.463] [DEBUG] Server - api:pingPongDatabase registered
[2016-10-19 17:53:53.464] [INFO] console - [ 64, 7666820989321216, {}, 'ru.kopa.error' ]
[2016-10-19 17:53:53.471] [DEBUG] Server - api:error registered
[2016-10-19 17:53:53.472] [INFO] console - [ 64, 8212105914220544, {}, 'ru.kopa.unitTest.cleanTempData' ]
[2016-10-19 17:53:53.479] [DEBUG] Server - api:unitTest.cleanTempData registered
[2016-10-19 17:53:53.480] [INFO] console - [ 64, 1458673066967040, {}, 'ru.kopa.model.Kopnik.setStarshina' ]
[2016-10-19 17:53:53.489] [DEBUG] Server - api:model.Kopnik.setStarshina registered
[2016-10-19 17:53:53.495] [INFO] console - [ 64, 5885139223576576, {}, 'ru.kopa.model.Kopnik.getDruzhina' ]
[2016-10-19 17:53:53.502] [DEBUG] Server - api:model.Kopnik.getDruzhina registered
[2016-10-19 17:53:53.503] [INFO] console - [ 64, 7215233850408960, {}, 'ru.kopa.model.Kopnik.vote' ]
[2016-10-19 17:53:53.511] [DEBUG] Server - api:model.Kopnik.vote registered
[2016-10-19 17:53:53.511] [INFO] console - [ 64, 8708911607578624, {}, 'ru.kopa.model.Kopa.invite' ]
[2016-10-19 17:53:53.515] [DEBUG] Server - api:model.Kopa.invite registered
[2016-10-19 17:53:53.516] [INFO] console - [ 64, 143627116347392, {}, 'ru.kopa.model.Kopa.getDialog' ]
[2016-10-19 17:53:53.522] [DEBUG] Server - api:model.Kopa.getDialog registered
[2016-10-19 17:53:53.525] [INFO] console - [ 64, 2183998056955904, {}, 'ru.kopa.model.Kopa.getResult' ]
[2016-10-19 17:53:53.529] [DEBUG] Server - api:model.Kopa.getResult registered
[2016-10-19 17:53:53.530] [INFO] console - [ 64, 2900269591429120, {}, 'ru.kopa.model.Zemla.setParent' ]
[2016-10-19 17:53:53.534] [DEBUG] Server - api:model.Zemla.setParent registered
[2016-10-19 17:53:53.535] [INFO] console - [ 64, 5020545686962176, {}, 'ru.kopa.model.Zemla.promiseKopi' ]
[2016-10-19 17:53:53.544] [DEBUG] Server - api:model.Zemla.promiseKopi registered
[2016-10-19 17:53:53.547] [INFO] console - [ 64,
  1473033275441152,
  {},
  'ru.kopa.model.Predlozhenie.getGolosa' ]
[2016-10-19 17:53:53.550] [DEBUG] Server - api:model.Predlozhenie.getGolosa registered
[2016-10-19 17:53:53.551] [INFO] console - [ 64, 2413155649060864, {}, 'ru.kopa.unitTest.orderProc' ]
[2016-10-19 17:53:53.570] [DEBUG] Server - api:unitTest.orderProc registered
[2016-10-19 17:53:53.572] [INFO] Server - started
[2016-10-19 17:54:05.589] [INFO] console - [ 70, 112, {}, [ undefined ] ]
[2016-10-19 17:54:05.621] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 2 }
[2016-10-19 17:54:05.719] [INFO] console - Executing (default): delete from "Kopnik"
                where
                    name like '%temp'
                    or name like 'temp%'
[2016-10-19 17:54:05.723] [INFO] console - Executing (386b4de8-7531-4052-936a-892ace0451dc): START TRANSACTION;
[2016-10-19 17:54:05.727] [INFO] console - Executing (386b4de8-7531-4052-936a-892ace0451dc): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:54:05.766] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 17:54:05.793] [INFO] console - Executing (default): update "Kopnik"
                set 
                    "voiskoSize"= case when id=2 then 1 ELSE 0 END
                where
                    id>1 
                    and id<=5
[2016-10-19 17:54:05.817] [INFO] console - Executing (386b4de8-7531-4052-936a-892ace0451dc): COMMIT;
[2016-10-19 17:54:05.825] [INFO] console - [ 70,
  113,
  {},
  [ { fullName: 'Unit Test',
      fullPath: '/2/',
      id: '2',
      email: 'unittest2@domain.ru',
      name: 'Unit',
      surname: 'Test',
      patronymic: '1',
      voiskoSize: 1,
      birth: 1983,
      path: '/',
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: null,
      attachments: [] } ] ]
[2016-10-19 17:54:05.895] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."starshina_id" = 2) ORDER BY "Kopnik"."surname" asc, "Kopnik"."name" asc, "Kopnik"."patronymic" asc;
[2016-10-19 17:54:05.912] [INFO] console - [ 70, 114, {}, [ [ [Object], [Object] ] ] ]
[2016-10-19 17:54:06.113] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 17:54:06.120] [INFO] console - Executing (549b75dc-7acc-4cd7-9ddb-035ddb69a0cc): START TRANSACTION;
[2016-10-19 17:54:06.121] [INFO] console - Executing (549b75dc-7acc-4cd7-9ddb-035ddb69a0cc): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:54:06.163] [INFO] console - Executing (549b75dc-7acc-4cd7-9ddb-035ddb69a0cc): INSERT INTO "Kopnik" ("id","name","surname","patronymic","voiskoSize","birth","path","created_at","updated_at","dom_id","starshina_id") VALUES (DEFAULT,'temp','temp','temp',0,1900,'/','2016-10-19 12:54:06.129 +00:00','2016-10-19 12:54:06.129 +00:00',2,NULL) RETURNING *;
[2016-10-19 17:54:06.172] [INFO] console - Executing (549b75dc-7acc-4cd7-9ddb-035ddb69a0cc): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 17:54:06.187] [INFO] console - Executing (549b75dc-7acc-4cd7-9ddb-035ddb69a0cc): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 17:54:06.199] [INFO] console - Executing (549b75dc-7acc-4cd7-9ddb-035ddb69a0cc): update "Zemla"
                                    set "obshinaSize"= "obshinaSize"+ 1
                                where
                                    '/1/' like path||id||'/%'
                                    or (
                                        true 
                                        and id= 2
                                    )
[2016-10-19 17:54:06.217] [INFO] console - Executing (549b75dc-7acc-4cd7-9ddb-035ddb69a0cc): COMMIT;
[2016-10-19 17:54:06.221] [INFO] console - [ 70, 115, {}, [ '19' ] ]
[2016-10-19 17:54:06.229] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 17:54:06.245] [INFO] console - Executing (default): select z.*
                                    from "Zemla" as z
                                where
                                    '/1/' like z.path||z.id||'/%'
[2016-10-19 17:54:06.252] [INFO] console - Executing (689d2656-0ef5-4669-a7a6-186cfc206926): START TRANSACTION;
[2016-10-19 17:54:06.264] [INFO] console - Executing (689d2656-0ef5-4669-a7a6-186cfc206926): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:54:06.283] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" IN ('1')) ORDER BY "Zemla"."path" desc;
[2016-10-19 17:54:06.290] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 19);
[2016-10-19 17:54:06.299] [INFO] console - [ 16,
  4538248655273984,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id2.obshinaChange',
  [],
  { obshinaSize: 17 } ]
[2016-10-19 17:54:06.326] [INFO] console - [ 16,
  7241937610342400,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id1.obshinaChange',
  [],
  { obshinaSize: 19 } ]
[2016-10-19 17:54:06.354] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 17:54:06.360] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 17:54:06.371] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 17:54:06.383] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 17:54:06.424] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='2',"updated_at"='2016-10-19 12:54:06.389 +00:00' WHERE "id" = '19'
[2016-10-19 17:54:06.434] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/', '/2/')
                                where
                                    id = '19'
                                    or path like '/19/'||'%'
[2016-10-19 17:54:06.439] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 17:54:06.446] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 17:54:06.458] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 17:54:06.463] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/2/19/'||'%'
[2016-10-19 17:54:06.466] [INFO] console - Executing (689d2656-0ef5-4669-a7a6-186cfc206926): COMMIT;
[2016-10-19 17:54:06.469] [INFO] console - [ 70, 116, {}, [ undefined ] ]
[2016-10-19 17:54:06.474] [INFO] console - [ 16,
  1141077478211584,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 2 } ]
[2016-10-19 17:54:06.484] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 17:54:06.490] [INFO] console - Executing (71c6b134-a838-4121-8af1-109046bdaa13): START TRANSACTION;
[2016-10-19 17:54:06.494] [INFO] console - Executing (71c6b134-a838-4121-8af1-109046bdaa13): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:54:06.509] [INFO] console - Executing (71c6b134-a838-4121-8af1-109046bdaa13): INSERT INTO "Kopnik" ("id","name","surname","patronymic","voiskoSize","birth","path","created_at","updated_at","dom_id","starshina_id") VALUES (DEFAULT,'temp','temp','temp',0,1900,'/','2016-10-19 12:54:06.501 +00:00','2016-10-19 12:54:06.501 +00:00',2,NULL) RETURNING *;
[2016-10-19 17:54:06.513] [INFO] console - Executing (71c6b134-a838-4121-8af1-109046bdaa13): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 17:54:06.518] [INFO] console - Executing (71c6b134-a838-4121-8af1-109046bdaa13): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 17:54:06.522] [INFO] console - Executing (71c6b134-a838-4121-8af1-109046bdaa13): update "Zemla"
                                    set "obshinaSize"= "obshinaSize"+ 1
                                where
                                    '/1/' like path||id||'/%'
                                    or (
                                        true 
                                        and id= 2
                                    )
[2016-10-19 17:54:06.527] [INFO] console - Executing (71c6b134-a838-4121-8af1-109046bdaa13): COMMIT;
[2016-10-19 17:54:06.531] [INFO] console - [ 70, 117, {}, [ '20' ] ]
[2016-10-19 17:54:06.550] [INFO] console - Executing (d23f0903-16f9-4cfd-b2bb-b6679a22cfa0): START TRANSACTION;
[2016-10-19 17:54:06.556] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 17:54:06.560] [INFO] console - Executing (d23f0903-16f9-4cfd-b2bb-b6679a22cfa0): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:54:06.563] [INFO] console - Executing (default): select z.*
                                    from "Zemla" as z
                                where
                                    '/1/' like z.path||z.id||'/%'
[2016-10-19 17:54:06.569] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 20);
[2016-10-19 17:54:06.579] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" IN ('1')) ORDER BY "Zemla"."path" desc;
[2016-10-19 17:54:06.586] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 19);
[2016-10-19 17:54:06.586] [INFO] console - [ 16,
  4534534932529152,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id2.obshinaChange',
  [],
  { obshinaSize: 18 } ]
[2016-10-19 17:54:06.592] [INFO] console - [ 16,
  589979113750528,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id1.obshinaChange',
  [],
  { obshinaSize: 20 } ]
[2016-10-19 17:54:06.601] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 17:54:06.607] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 17:54:06.612] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 17:54:06.623] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='19',"updated_at"='2016-10-19 12:54:06.615 +00:00' WHERE "id" = '20'
[2016-10-19 17:54:06.633] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/', '/2/19/')
                                where
                                    id = '20'
                                    or path like '/20/'||'%'
[2016-10-19 17:54:06.641] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/2/19/' like path||id||'/%'
[2016-10-19 17:54:06.645] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/19/' like k.path||k.id||'/%'
[2016-10-19 17:54:06.652] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('19', '2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 17:54:06.658] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/2/19/20/'||'%'
[2016-10-19 17:54:06.661] [INFO] console - Executing (d23f0903-16f9-4cfd-b2bb-b6679a22cfa0): COMMIT;
[2016-10-19 17:54:06.663] [INFO] console - [ 70, 118, {}, [ undefined ] ]
[2016-10-19 17:54:06.666] [INFO] console - [ 16,
  6986569521037312,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id19.voiskoChange',
  [],
  { voiskoSize: 1 } ]
[2016-10-19 17:54:06.671] [INFO] console - [ 16,
  6422588054044672,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 3 } ]
[2016-10-19 17:54:06.702] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 4 }
[2016-10-19 17:54:06.705] [INFO] console - Executing (f8e3da3f-cbd1-4e16-97c7-5eaf88b24e75): START TRANSACTION;
[2016-10-19 17:54:06.713] [INFO] console - Executing (f8e3da3f-cbd1-4e16-97c7-5eaf88b24e75): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:54:06.749] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 4);
[2016-10-19 17:54:06.790] [INFO] console - Executing (f8e3da3f-cbd1-4e16-97c7-5eaf88b24e75): COMMIT;
[2016-10-19 17:54:06.793] [INFO] console - [ 70,
  119,
  {},
  [ { fullName: 'Unit Test',
      fullPath: '/4/',
      id: '4',
      email: 'unittest4@domain.ru',
      name: 'Unit',
      surname: 'Test',
      patronymic: '4',
      voiskoSize: 0,
      birth: 1983,
      path: '/',
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: null,
      attachments: [] } ] ]
[2016-10-19 17:54:06.879] [INFO] console - Executing (544e59d7-37ff-4055-a386-e11288634674): START TRANSACTION;
[2016-10-19 17:54:06.882] [INFO] console - Executing (544e59d7-37ff-4055-a386-e11288634674): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:54:06.886] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 19);
[2016-10-19 17:54:06.894] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 4);
[2016-10-19 17:54:06.907] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 17:54:06.920] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 17:54:06.930] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-2
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 17:54:06.946] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='4',"updated_at"='2016-10-19 12:54:06.937 +00:00' WHERE "id" = '19'
[2016-10-19 17:54:06.967] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/2/', '/4/')
                                where
                                    id = '19'
                                    or path like '/2/19/'||'%'
[2016-10-19 17:54:06.972] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+2
                                where
                                    '/4/' like path||id||'/%'
[2016-10-19 17:54:07.007] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/4/' like k.path||k.id||'/%'
[2016-10-19 17:54:07.040] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('4')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 17:54:07.045] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/4/19/'||'%'
[2016-10-19 17:54:07.053] [INFO] console - Executing (544e59d7-37ff-4055-a386-e11288634674): COMMIT;
[2016-10-19 17:54:07.055] [INFO] console - [ 70, 120, {}, [ undefined ] ]
[2016-10-19 17:54:07.058] [INFO] console - [ 16,
  8243655777189888,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 1 } ]
[2016-10-19 17:54:07.068] [INFO] console - [ 16,
  2288949143797760,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id4.voiskoChange',
  [],
  { voiskoSize: 2 } ]
[2016-10-19 17:54:07.076] [INFO] console - [ 16,
  1404044685869056,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id20.starshinaChange',
  [],
  {} ]
[2016-10-19 17:54:07.086] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 20 }
[2016-10-19 17:54:07.089] [INFO] console - Executing (6b3e3bdb-6e99-44b0-a5fd-9b2db791d353): START TRANSACTION;
[2016-10-19 17:54:07.092] [INFO] console - Executing (6b3e3bdb-6e99-44b0-a5fd-9b2db791d353): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:54:07.100] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 20);
[2016-10-19 17:54:07.119] [INFO] console - Executing (6b3e3bdb-6e99-44b0-a5fd-9b2db791d353): COMMIT;
[2016-10-19 17:54:07.121] [INFO] console - [ 70,
  121,
  {},
  [ { fullName: 'temp temp',
      fullPath: '/4/19/20/',
      id: '20',
      email: null,
      name: 'temp',
      surname: 'temp',
      patronymic: 'temp',
      voiskoSize: 0,
      birth: 1900,
      path: '/4/19/',
      note: null,
      created_at: Wed Oct 19 2016 17:54:06 GMT+0500 (YEKT),
      updated_at: Wed Oct 19 2016 17:54:06 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: '19',
      attachments: [] } ] ]
[2016-10-19 17:54:07.139] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 19 }
[2016-10-19 17:54:07.142] [INFO] console - Executing (eb23fc39-56f8-4d64-ad41-9bcdd2fe9c61): START TRANSACTION;
[2016-10-19 17:54:07.144] [INFO] console - Executing (eb23fc39-56f8-4d64-ad41-9bcdd2fe9c61): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:54:07.152] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 19);
[2016-10-19 17:54:07.163] [INFO] console - Executing (eb23fc39-56f8-4d64-ad41-9bcdd2fe9c61): COMMIT;
[2016-10-19 17:54:07.166] [INFO] console - [ 70,
  122,
  {},
  [ { fullName: 'temp temp',
      fullPath: '/4/19/',
      id: '19',
      email: null,
      name: 'temp',
      surname: 'temp',
      patronymic: 'temp',
      voiskoSize: 1,
      birth: 1900,
      path: '/4/',
      note: null,
      created_at: Wed Oct 19 2016 17:54:06 GMT+0500 (YEKT),
      updated_at: Wed Oct 19 2016 17:54:06 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: '4',
      attachments: [] } ] ]
[2016-10-19 17:54:07.181] [DEBUG] Server - #promiseModel() [] { model: 'Kopa', id: 3 }
[2016-10-19 17:54:07.185] [INFO] console - Executing (4b2d8771-23eb-4c7c-9eff-79b277aaa947): START TRANSACTION;
[2016-10-19 17:54:07.189] [INFO] console - Executing (4b2d8771-23eb-4c7c-9eff-79b277aaa947): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:54:07.222] [INFO] console - Executing (default): SELECT "Kopa"."id", "Kopa"."question", "Kopa"."invited", "Kopa"."note", "Kopa"."created_at", "Kopa"."updated_at", "Kopa"."deleted_at", "Kopa"."place_id", "Kopa"."inviter_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopa" AS "Kopa" LEFT OUTER JOIN "File" AS "attachments" ON "Kopa"."id" = "attachments"."kopa_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopa"."deleted_at" IS NULL AND "Kopa"."id" = 3);
[2016-10-19 17:54:07.241] [INFO] console - Executing (4b2d8771-23eb-4c7c-9eff-79b277aaa947): COMMIT;
[2016-10-19 17:54:07.244] [INFO] console - [ 70,
  123,
  {},
  [ { id: '3',
      question: 'CHE',
      invited: Thu Sep 01 2016 00:00:00 GMT+0500 (YEKT),
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      place_id: '2',
      inviter_id: '2',
      attachments: [] } ] ]
[2016-10-19 17:54:07.293] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 17:54:07.297] [INFO] console - Executing (28efe1ef-a162-4010-af12-9865bb79538b): START TRANSACTION;
[2016-10-19 17:54:07.298] [INFO] console - Executing (28efe1ef-a162-4010-af12-9865bb79538b): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:54:07.321] [INFO] console - Executing (28efe1ef-a162-4010-af12-9865bb79538b): INSERT INTO "Predlozhenie" ("id","value","totalZa","totalProtiv","created_at","updated_at","author_id","place_id") VALUES (DEFAULT,'temp Wed Oct 19 2016 17:54:07 GMT+0500 (YEKT)',0,0,'2016-10-19 12:54:07.309 +00:00','2016-10-19 12:54:07.309 +00:00',2,3) RETURNING *;
[2016-10-19 17:54:07.336] [INFO] console - Executing (28efe1ef-a162-4010-af12-9865bb79538b): COMMIT;
[2016-10-19 17:54:07.338] [INFO] console - [ 70, 124, {}, [ '10' ] ]
[2016-10-19 17:54:07.340] [INFO] console - [ 16,
  8707477031878656,
  { acknowledge: true },
  'ru.kopa.model.Kopa.id3.predlozhenieAdd',
  [ '10' ] ]
[2016-10-19 17:54:07.371] [INFO] console - Executing (6735a658-d5a2-4328-9d35-7c467c5d7f38): START TRANSACTION;
[2016-10-19 17:54:07.372] [INFO] console - Executing (6735a658-d5a2-4328-9d35-7c467c5d7f38): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:54:07.379] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 17:54:07.390] [INFO] console - Executing (default): SELECT "id", "value", "totalZa", "totalProtiv", "state", "note", "created_at", "updated_at", "deleted_at", "author_id", "place_id" FROM "Predlozhenie" AS "Predlozhenie" WHERE ("Predlozhenie"."deleted_at" IS NULL AND "Predlozhenie"."id" = 10);
[2016-10-19 17:54:07.421] [INFO] console - Executing (default): SELECT "id", "question", "invited", "note", "created_at", "updated_at", "deleted_at", "place_id", "inviter_id" FROM "Kopa" AS "Kopa" WHERE ("Kopa"."deleted_at" IS NULL AND "Kopa"."id" = '3');
[2016-10-19 17:54:07.442] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 17:54:07.453] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 17:54:07.457] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 17:54:07.476] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 17:54:07.484] [INFO] console - Executing (default): SELECT "id", "value", "reason", "note", "created_at", "updated_at", "deleted_at", "subject_id", "owner_id", "parent_id" FROM "Golos" AS "Golos" WHERE ("Golos"."deleted_at" IS NULL AND ("Golos"."subject_id" = '10' AND "Golos"."owner_id" = '2')) LIMIT 1;
[2016-10-19 17:54:07.499] [INFO] console - Executing (default): INSERT INTO "Golos" ("id","value","created_at","updated_at","subject_id","owner_id") VALUES (DEFAULT,1,'2016-10-19 12:54:07.489 +00:00','2016-10-19 12:54:07.489 +00:00','10','2') RETURNING *;
[2016-10-19 17:54:07.514] [INFO] console - Executing (default): insert into "Golos" (subject_id, value, owner_id, parent_id, created_at, updated_at)
                            (
                                select 10, 1, k.id, 29, current_timestamp, current_timestamp
                                from 
                                    "Kopnik" k
                                     join "Zemla" d on d.id= k.dom_id
                                where
                                    k.path like '/2/%'
                                    and d.path||d.id||'/' like '/1/2/%' 
                            )
[2016-10-19 17:54:07.516] [INFO] console - Executing (default): select
                            (select count(*) from "Golos" g where subject_id= 10 and value=1) "za",
                            (select count(*) from "Golos" g where subject_id= 10 and value=-1) "protiv"
[2016-10-19 17:54:07.524] [INFO] console - Executing (default): UPDATE "Predlozhenie" SET "totalZa"=2,"updated_at"='2016-10-19 12:54:07.519 +00:00' WHERE "id" = '10'
[2016-10-19 17:54:07.530] [INFO] console - Executing (6735a658-d5a2-4328-9d35-7c467c5d7f38): COMMIT;
[2016-10-19 17:54:07.531] [INFO] console - [ 70, 125, {}, [ undefined ] ]
[2016-10-19 17:54:07.534] [INFO] console - [ 16,
  6305145201623040,
  { acknowledge: true },
  'ru.kopa.model.Predlozhenie.id10.rebalance',
  [],
  { totalZa: 2,
    totalProtiv: 0,
    GOLOS: '29',
    action: 'add',
    value: 1 } ]
[2016-10-19 17:54:07.545] [INFO] console - Executing (d9eb899c-ea95-4bd6-95f2-89a32c77cea5): START TRANSACTION;
[2016-10-19 17:54:07.546] [INFO] console - Executing (d9eb899c-ea95-4bd6-95f2-89a32c77cea5): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:54:07.549] [DEBUG] Server - #promiseModel() [] { model: 'Golos', id: 29 }
[2016-10-19 17:54:07.552] [INFO] console - Executing (057a8471-fc44-4b83-ba24-cecb5ef5d087): START TRANSACTION;
[2016-10-19 17:54:07.555] [INFO] console - Executing (057a8471-fc44-4b83-ba24-cecb5ef5d087): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:54:07.558] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 17:54:07.583] [INFO] console - Executing (default): SELECT "Golos"."id", "Golos"."value", "Golos"."reason", "Golos"."note", "Golos"."created_at", "Golos"."updated_at", "Golos"."deleted_at", "Golos"."subject_id", "Golos"."owner_id", "Golos"."parent_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Golos" AS "Golos" LEFT OUTER JOIN "File" AS "attachments" ON "Golos"."id" = "attachments"."golos_id" AND "attachments"."deleted_at" IS NULL WHERE ("Golos"."deleted_at" IS NULL AND "Golos"."id" = 29);
[2016-10-19 17:54:07.623] [INFO] console - Executing (default): SELECT "id", "value", "totalZa", "totalProtiv", "state", "note", "created_at", "updated_at", "deleted_at", "author_id", "place_id" FROM "Predlozhenie" AS "Predlozhenie" WHERE ("Predlozhenie"."deleted_at" IS NULL AND "Predlozhenie"."id" = 10);
[2016-10-19 17:54:07.626] [INFO] console - Executing (057a8471-fc44-4b83-ba24-cecb5ef5d087): COMMIT;
[2016-10-19 17:54:07.674] [INFO] console - Executing (default): SELECT "id", "question", "invited", "note", "created_at", "updated_at", "deleted_at", "place_id", "inviter_id" FROM "Kopa" AS "Kopa" WHERE ("Kopa"."deleted_at" IS NULL AND "Kopa"."id" = '3');
[2016-10-19 17:54:07.683] [INFO] console - [ 70,
  127,
  {},
  [ { id: '29',
      value: 1,
      reason: null,
      note: null,
      created_at: Wed Oct 19 2016 17:54:07 GMT+0500 (YEKT),
      updated_at: Wed Oct 19 2016 17:54:07 GMT+0500 (YEKT),
      deleted_at: null,
      subject_id: '10',
      owner_id: '2',
      parent_id: null,
      attachments: [] } ] ]
[2016-10-19 17:54:07.750] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 17:54:07.759] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 17:54:07.763] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 17:54:07.782] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 17:54:07.803] [INFO] console - Executing (default): SELECT "id", "value", "reason", "note", "created_at", "updated_at", "deleted_at", "subject_id", "owner_id", "parent_id" FROM "Golos" AS "Golos" WHERE ("Golos"."deleted_at" IS NULL AND ("Golos"."subject_id" = '10' AND "Golos"."owner_id" = '2')) LIMIT 1;
[2016-10-19 17:54:07.819] [INFO] console - Executing (default): delete from "Golos" 
                            where
                                subject_id= 10
                                and (
                                    id= 29
                                    or parent_id = 29
                                )
[2016-10-19 17:54:07.907] [INFO] console - Executing (default): select
                            (select count(*) from "Golos" g where subject_id= 10 and value=1) "za",
                            (select count(*) from "Golos" g where subject_id= 10 and value=-1) "protiv"
[2016-10-19 17:54:07.933] [INFO] console - Executing (default): UPDATE "Predlozhenie" SET "totalZa"=0,"updated_at"='2016-10-19 12:54:07.912 +00:00' WHERE "id" = '10'
[2016-10-19 17:54:07.945] [INFO] console - Executing (d9eb899c-ea95-4bd6-95f2-89a32c77cea5): COMMIT;
[2016-10-19 17:54:07.947] [INFO] console - [ 70, 126, {}, [ undefined ] ]
[2016-10-19 17:54:07.967] [INFO] console - [ 16,
  7062791764574208,
  { acknowledge: true },
  'ru.kopa.model.Predlozhenie.id10.rebalance',
  [],
  { totalZa: 0,
    totalProtiv: 0,
    GOLOS: '29',
    action: 'remove',
    value: 1 } ]
[2016-10-19 17:54:56.005] [INFO] console - [ 70, 129, {}, [ undefined ] ]
[2016-10-19 17:54:56.030] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 2 }
[2016-10-19 17:54:56.091] [INFO] console - Executing (default): delete from "Kopnik"
                where
                    name like '%temp'
                    or name like 'temp%'
[2016-10-19 17:54:56.101] [INFO] console - Executing (c47ba0e3-b745-453d-a846-83ef4439e598): START TRANSACTION;
[2016-10-19 17:54:56.103] [INFO] console - Executing (c47ba0e3-b745-453d-a846-83ef4439e598): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:54:56.146] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 17:54:56.154] [INFO] console - Executing (default): update "Kopnik"
                set 
                    "voiskoSize"= case when id=2 then 1 ELSE 0 END
                where
                    id>1 
                    and id<=5
[2016-10-19 17:54:56.173] [INFO] console - Executing (c47ba0e3-b745-453d-a846-83ef4439e598): COMMIT;
[2016-10-19 17:54:56.189] [INFO] console - [ 70,
  130,
  {},
  [ { fullName: 'Unit Test',
      fullPath: '/2/',
      id: '2',
      email: 'unittest2@domain.ru',
      name: 'Unit',
      surname: 'Test',
      patronymic: '1',
      voiskoSize: 1,
      birth: 1983,
      path: '/',
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: null,
      attachments: [] } ] ]
[2016-10-19 17:55:05.413] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."starshina_id" = 2) ORDER BY "Kopnik"."surname" asc, "Kopnik"."name" asc, "Kopnik"."patronymic" asc;
[2016-10-19 17:55:05.419] [INFO] console - [ 70, 131, {}, [ [ [Object], [Object] ] ] ]
[2016-10-19 17:56:37.950] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 17:56:37.962] [INFO] console - Executing (40d29a76-4e50-4694-82fb-fe9500bfa78e): START TRANSACTION;
[2016-10-19 17:56:37.964] [INFO] console - Executing (40d29a76-4e50-4694-82fb-fe9500bfa78e): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:56:37.977] [INFO] console - Executing (40d29a76-4e50-4694-82fb-fe9500bfa78e): INSERT INTO "Kopnik" ("id","name","surname","patronymic","voiskoSize","birth","path","created_at","updated_at","dom_id","starshina_id") VALUES (DEFAULT,'temp','temp','temp',0,1900,'/','2016-10-19 12:56:37.968 +00:00','2016-10-19 12:56:37.968 +00:00',2,NULL) RETURNING *;
[2016-10-19 17:56:37.987] [INFO] console - Executing (40d29a76-4e50-4694-82fb-fe9500bfa78e): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 17:56:37.993] [INFO] console - Executing (40d29a76-4e50-4694-82fb-fe9500bfa78e): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 17:56:38.002] [INFO] console - Executing (40d29a76-4e50-4694-82fb-fe9500bfa78e): update "Zemla"
                                    set "obshinaSize"= "obshinaSize"+ 1
                                where
                                    '/1/' like path||id||'/%'
                                    or (
                                        true 
                                        and id= 2
                                    )
[2016-10-19 17:56:38.006] [INFO] console - Executing (40d29a76-4e50-4694-82fb-fe9500bfa78e): COMMIT;
[2016-10-19 17:56:38.009] [INFO] console - [ 70, 132, {}, [ '21' ] ]
[2016-10-19 17:56:38.018] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 17:56:38.027] [INFO] console - Executing (default): select z.*
                                    from "Zemla" as z
                                where
                                    '/1/' like z.path||z.id||'/%'
[2016-10-19 17:56:38.036] [INFO] console - Executing (f8d10bc6-f4f2-4937-84a0-ab54b87ec278): START TRANSACTION;
[2016-10-19 17:56:38.039] [INFO] console - Executing (f8d10bc6-f4f2-4937-84a0-ab54b87ec278): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:56:38.092] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" IN ('1')) ORDER BY "Zemla"."path" desc;
[2016-10-19 17:56:38.095] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 21);
[2016-10-19 17:56:38.123] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 17:56:38.140] [INFO] console - [ 16,
  1373572962451456,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id2.obshinaChange',
  [],
  { obshinaSize: 19 } ]
[2016-10-19 17:56:38.148] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 17:56:38.150] [INFO] console - [ 16,
  5575041613824000,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id1.obshinaChange',
  [],
  { obshinaSize: 21 } ]
[2016-10-19 17:56:38.162] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 17:56:38.173] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 17:56:38.203] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='2',"updated_at"='2016-10-19 12:56:38.178 +00:00' WHERE "id" = '21'
[2016-10-19 17:56:38.217] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/', '/2/')
                                where
                                    id = '21'
                                    or path like '/21/'||'%'
[2016-10-19 17:56:38.244] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 17:56:38.248] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 17:56:38.259] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 17:56:38.266] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/2/21/'||'%'
[2016-10-19 17:56:38.272] [INFO] console - Executing (f8d10bc6-f4f2-4937-84a0-ab54b87ec278): COMMIT;
[2016-10-19 17:56:38.275] [INFO] console - [ 70, 133, {}, [ undefined ] ]
[2016-10-19 17:56:38.277] [INFO] console - [ 16,
  6660757336883200,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 2 } ]
[2016-10-19 17:56:38.313] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 17:56:38.325] [INFO] console - Executing (444a742e-c89e-43aa-89e8-9421745e94bc): START TRANSACTION;
[2016-10-19 17:56:38.328] [INFO] console - Executing (444a742e-c89e-43aa-89e8-9421745e94bc): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:56:38.350] [INFO] console - Executing (444a742e-c89e-43aa-89e8-9421745e94bc): INSERT INTO "Kopnik" ("id","name","surname","patronymic","voiskoSize","birth","path","created_at","updated_at","dom_id","starshina_id") VALUES (DEFAULT,'temp','temp','temp',0,1900,'/','2016-10-19 12:56:38.331 +00:00','2016-10-19 12:56:38.331 +00:00',2,NULL) RETURNING *;
[2016-10-19 17:56:38.358] [INFO] console - Executing (444a742e-c89e-43aa-89e8-9421745e94bc): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 17:56:38.394] [INFO] console - Executing (444a742e-c89e-43aa-89e8-9421745e94bc): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 17:56:38.414] [INFO] console - Executing (444a742e-c89e-43aa-89e8-9421745e94bc): update "Zemla"
                                    set "obshinaSize"= "obshinaSize"+ 1
                                where
                                    '/1/' like path||id||'/%'
                                    or (
                                        true 
                                        and id= 2
                                    )
[2016-10-19 17:56:38.420] [INFO] console - Executing (444a742e-c89e-43aa-89e8-9421745e94bc): COMMIT;
[2016-10-19 17:56:38.422] [INFO] console - [ 70, 134, {}, [ '22' ] ]
[2016-10-19 17:56:38.451] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 17:56:38.464] [INFO] console - Executing (default): select z.*
                                    from "Zemla" as z
                                where
                                    '/1/' like z.path||z.id||'/%'
[2016-10-19 17:56:38.468] [INFO] console - Executing (99c5ba8f-0669-427b-adb5-b33849619823): START TRANSACTION;
[2016-10-19 17:56:38.473] [INFO] console - Executing (99c5ba8f-0669-427b-adb5-b33849619823): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:56:38.477] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" IN ('1')) ORDER BY "Zemla"."path" desc;
[2016-10-19 17:56:38.482] [INFO] console - [ 16,
  6294809830490112,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id2.obshinaChange',
  [],
  { obshinaSize: 20 } ]
[2016-10-19 17:56:38.502] [INFO] console - [ 16,
  4896145478254592,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id1.obshinaChange',
  [],
  { obshinaSize: 22 } ]
[2016-10-19 17:56:38.514] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 22);
[2016-10-19 17:56:38.525] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 21);
[2016-10-19 17:56:38.542] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 17:56:38.550] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 17:56:38.554] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 17:56:38.567] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='21',"updated_at"='2016-10-19 12:56:38.557 +00:00' WHERE "id" = '22'
[2016-10-19 17:56:38.572] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/', '/2/21/')
                                where
                                    id = '22'
                                    or path like '/22/'||'%'
[2016-10-19 17:56:38.611] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/2/21/' like path||id||'/%'
[2016-10-19 17:56:38.615] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/21/' like k.path||k.id||'/%'
[2016-10-19 17:56:38.624] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('21', '2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 17:56:38.629] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/2/21/22/'||'%'
[2016-10-19 17:56:38.633] [INFO] console - Executing (99c5ba8f-0669-427b-adb5-b33849619823): COMMIT;
[2016-10-19 17:56:38.635] [INFO] console - [ 70, 135, {}, [ undefined ] ]
[2016-10-19 17:56:38.640] [INFO] console - [ 16,
  1886719706136576,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id21.voiskoChange',
  [],
  { voiskoSize: 1 } ]
[2016-10-19 17:56:38.647] [INFO] console - [ 16,
  3576376930074624,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 3 } ]
[2016-10-19 17:56:38.661] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 4 }
[2016-10-19 17:56:38.664] [INFO] console - Executing (bdf3f3fc-9f17-42a8-9b7b-3c6a6f7ccf2b): START TRANSACTION;
[2016-10-19 17:56:38.666] [INFO] console - Executing (bdf3f3fc-9f17-42a8-9b7b-3c6a6f7ccf2b): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:56:38.678] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 4);
[2016-10-19 17:56:38.686] [INFO] console - Executing (bdf3f3fc-9f17-42a8-9b7b-3c6a6f7ccf2b): COMMIT;
[2016-10-19 17:56:38.688] [INFO] console - [ 70,
  136,
  {},
  [ { fullName: 'Unit Test',
      fullPath: '/4/',
      id: '4',
      email: 'unittest4@domain.ru',
      name: 'Unit',
      surname: 'Test',
      patronymic: '4',
      voiskoSize: 0,
      birth: 1983,
      path: '/',
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: null,
      attachments: [] } ] ]
[2016-10-19 17:56:38.758] [INFO] console - Executing (236ceb12-145f-4fcd-b4ba-9e73f0e43d34): START TRANSACTION;
[2016-10-19 17:56:38.762] [INFO] console - Executing (236ceb12-145f-4fcd-b4ba-9e73f0e43d34): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:56:38.777] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 21);
[2016-10-19 17:56:38.801] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 4);
[2016-10-19 17:56:38.813] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 17:56:38.823] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 17:56:38.833] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-2
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 17:56:38.845] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='4',"updated_at"='2016-10-19 12:56:38.835 +00:00' WHERE "id" = '21'
[2016-10-19 17:56:38.851] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/2/', '/4/')
                                where
                                    id = '21'
                                    or path like '/2/21/'||'%'
[2016-10-19 17:56:38.856] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+2
                                where
                                    '/4/' like path||id||'/%'
[2016-10-19 17:56:38.861] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/4/' like k.path||k.id||'/%'
[2016-10-19 17:56:38.883] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('4')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 17:56:38.898] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/4/21/'||'%'
[2016-10-19 17:56:38.908] [INFO] console - Executing (236ceb12-145f-4fcd-b4ba-9e73f0e43d34): COMMIT;
[2016-10-19 17:56:38.912] [INFO] console - [ 70, 137, {}, [ undefined ] ]
[2016-10-19 17:56:38.929] [INFO] console - [ 16,
  5666099968344064,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 1 } ]
[2016-10-19 17:56:38.941] [INFO] console - [ 16,
  6242670311636992,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id4.voiskoChange',
  [],
  { voiskoSize: 2 } ]
[2016-10-19 17:56:38.983] [INFO] console - [ 16,
  8412706224734208,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id22.starshinaChange',
  [],
  {} ]
[2016-10-19 17:56:39.072] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 22 }
[2016-10-19 17:56:39.077] [INFO] console - Executing (efa5ef0b-6cc3-4e96-b2c1-be5e969791de): START TRANSACTION;
[2016-10-19 17:56:39.082] [INFO] console - Executing (efa5ef0b-6cc3-4e96-b2c1-be5e969791de): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:56:39.111] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 22);
[2016-10-19 17:56:39.155] [INFO] console - Executing (efa5ef0b-6cc3-4e96-b2c1-be5e969791de): COMMIT;
[2016-10-19 17:56:39.164] [INFO] console - [ 70,
  138,
  {},
  [ { fullName: 'temp temp',
      fullPath: '/4/21/22/',
      id: '22',
      email: null,
      name: 'temp',
      surname: 'temp',
      patronymic: 'temp',
      voiskoSize: 0,
      birth: 1900,
      path: '/4/21/',
      note: null,
      created_at: Wed Oct 19 2016 17:56:38 GMT+0500 (YEKT),
      updated_at: Wed Oct 19 2016 17:56:38 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: '21',
      attachments: [] } ] ]
[2016-10-19 17:56:39.226] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 21 }
[2016-10-19 17:56:39.235] [INFO] console - Executing (6b921264-0053-4643-8303-5bef2997cce3): START TRANSACTION;
[2016-10-19 17:56:39.241] [INFO] console - Executing (6b921264-0053-4643-8303-5bef2997cce3): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:56:39.269] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 21);
[2016-10-19 17:56:39.277] [INFO] console - Executing (6b921264-0053-4643-8303-5bef2997cce3): COMMIT;
[2016-10-19 17:56:39.288] [INFO] console - [ 70,
  139,
  {},
  [ { fullName: 'temp temp',
      fullPath: '/4/21/',
      id: '21',
      email: null,
      name: 'temp',
      surname: 'temp',
      patronymic: 'temp',
      voiskoSize: 1,
      birth: 1900,
      path: '/4/',
      note: null,
      created_at: Wed Oct 19 2016 17:56:37 GMT+0500 (YEKT),
      updated_at: Wed Oct 19 2016 17:56:38 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: '4',
      attachments: [] } ] ]
[2016-10-19 17:56:39.347] [DEBUG] Server - #promiseModel() [] { model: 'Kopa', id: 3 }
[2016-10-19 17:56:39.362] [INFO] console - Executing (776017f8-d87d-4ec5-92b6-810ad302ae2b): START TRANSACTION;
[2016-10-19 17:56:39.364] [INFO] console - Executing (776017f8-d87d-4ec5-92b6-810ad302ae2b): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:56:39.405] [INFO] console - Executing (default): SELECT "Kopa"."id", "Kopa"."question", "Kopa"."invited", "Kopa"."note", "Kopa"."created_at", "Kopa"."updated_at", "Kopa"."deleted_at", "Kopa"."place_id", "Kopa"."inviter_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopa" AS "Kopa" LEFT OUTER JOIN "File" AS "attachments" ON "Kopa"."id" = "attachments"."kopa_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopa"."deleted_at" IS NULL AND "Kopa"."id" = 3);
[2016-10-19 17:56:39.413] [INFO] console - Executing (776017f8-d87d-4ec5-92b6-810ad302ae2b): COMMIT;
[2016-10-19 17:56:39.415] [INFO] console - [ 70,
  140,
  {},
  [ { id: '3',
      question: 'CHE',
      invited: Thu Sep 01 2016 00:00:00 GMT+0500 (YEKT),
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      place_id: '2',
      inviter_id: '2',
      attachments: [] } ] ]
[2016-10-19 17:56:39.446] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 17:56:39.451] [INFO] console - Executing (c8374721-5b3e-430c-93c0-73c8ee225e45): START TRANSACTION;
[2016-10-19 17:56:39.453] [INFO] console - Executing (c8374721-5b3e-430c-93c0-73c8ee225e45): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:56:39.469] [INFO] console - Executing (c8374721-5b3e-430c-93c0-73c8ee225e45): INSERT INTO "Predlozhenie" ("id","value","totalZa","totalProtiv","created_at","updated_at","author_id","place_id") VALUES (DEFAULT,'temp Wed Oct 19 2016 17:56:39 GMT+0500 (YEKT)',0,0,'2016-10-19 12:56:39.456 +00:00','2016-10-19 12:56:39.456 +00:00',2,3) RETURNING *;
[2016-10-19 17:56:39.475] [INFO] console - Executing (c8374721-5b3e-430c-93c0-73c8ee225e45): COMMIT;
[2016-10-19 17:56:39.481] [INFO] console - [ 70, 141, {}, [ '11' ] ]
[2016-10-19 17:56:39.487] [INFO] console - [ 16,
  6722012063989760,
  { acknowledge: true },
  'ru.kopa.model.Kopa.id3.predlozhenieAdd',
  [ '11' ] ]
[2016-10-19 17:56:39.563] [INFO] console - Executing (fc910095-8eb8-4e7a-afc1-515e15a1490c): START TRANSACTION;
[2016-10-19 17:56:39.567] [INFO] console - Executing (fc910095-8eb8-4e7a-afc1-515e15a1490c): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:56:39.585] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 17:56:39.610] [INFO] console - Executing (default): SELECT "id", "value", "totalZa", "totalProtiv", "state", "note", "created_at", "updated_at", "deleted_at", "author_id", "place_id" FROM "Predlozhenie" AS "Predlozhenie" WHERE ("Predlozhenie"."deleted_at" IS NULL AND "Predlozhenie"."id" = 11);
[2016-10-19 17:56:39.621] [INFO] console - Executing (default): SELECT "id", "question", "invited", "note", "created_at", "updated_at", "deleted_at", "place_id", "inviter_id" FROM "Kopa" AS "Kopa" WHERE ("Kopa"."deleted_at" IS NULL AND "Kopa"."id" = '3');
[2016-10-19 17:56:39.630] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 17:56:39.643] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 17:56:39.658] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 17:56:39.667] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 17:56:39.672] [INFO] console - Executing (default): SELECT "id", "value", "reason", "note", "created_at", "updated_at", "deleted_at", "subject_id", "owner_id", "parent_id" FROM "Golos" AS "Golos" WHERE ("Golos"."deleted_at" IS NULL AND ("Golos"."subject_id" = '11' AND "Golos"."owner_id" = '2')) LIMIT 1;
[2016-10-19 17:56:39.684] [INFO] console - Executing (default): INSERT INTO "Golos" ("id","value","created_at","updated_at","subject_id","owner_id") VALUES (DEFAULT,1,'2016-10-19 12:56:39.675 +00:00','2016-10-19 12:56:39.675 +00:00','11','2') RETURNING *;
[2016-10-19 17:56:39.703] [INFO] console - Executing (default): insert into "Golos" (subject_id, value, owner_id, parent_id, created_at, updated_at)
                            (
                                select 11, 1, k.id, 31, current_timestamp, current_timestamp
                                from 
                                    "Kopnik" k
                                     join "Zemla" d on d.id= k.dom_id
                                where
                                    k.path like '/2/%'
                                    and d.path||d.id||'/' like '/1/2/%' 
                            )
[2016-10-19 17:56:39.712] [INFO] console - Executing (default): select
                            (select count(*) from "Golos" g where subject_id= 11 and value=1) "za",
                            (select count(*) from "Golos" g where subject_id= 11 and value=-1) "protiv"
[2016-10-19 17:56:39.729] [INFO] console - Executing (default): UPDATE "Predlozhenie" SET "totalZa"=2,"updated_at"='2016-10-19 12:56:39.717 +00:00' WHERE "id" = '11'
[2016-10-19 17:56:39.744] [INFO] console - Executing (fc910095-8eb8-4e7a-afc1-515e15a1490c): COMMIT;
[2016-10-19 17:56:39.746] [INFO] console - [ 70, 142, {}, [ undefined ] ]
[2016-10-19 17:56:39.749] [INFO] console - [ 16,
  7223349237252096,
  { acknowledge: true },
  'ru.kopa.model.Predlozhenie.id11.rebalance',
  [],
  { totalZa: 2,
    totalProtiv: 0,
    GOLOS: '31',
    action: 'add',
    value: 1 } ]
[2016-10-19 17:56:39.784] [INFO] console - Executing (e784e73d-25e9-4677-9e6b-1aa5bcb43583): START TRANSACTION;
[2016-10-19 17:56:39.788] [INFO] console - Executing (e784e73d-25e9-4677-9e6b-1aa5bcb43583): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:56:39.799] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 17:56:39.810] [DEBUG] Server - #promiseModel() [] { model: 'Golos', id: 31 }
[2016-10-19 17:56:39.819] [INFO] console - Executing (fa031f7c-242d-45b6-9319-c70320d2df8c): START TRANSACTION;
[2016-10-19 17:56:39.828] [INFO] console - Executing (fa031f7c-242d-45b6-9319-c70320d2df8c): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:56:39.845] [INFO] console - Executing (default): SELECT "id", "value", "totalZa", "totalProtiv", "state", "note", "created_at", "updated_at", "deleted_at", "author_id", "place_id" FROM "Predlozhenie" AS "Predlozhenie" WHERE ("Predlozhenie"."deleted_at" IS NULL AND "Predlozhenie"."id" = 11);
[2016-10-19 17:56:39.890] [INFO] console - Executing (default): SELECT "Golos"."id", "Golos"."value", "Golos"."reason", "Golos"."note", "Golos"."created_at", "Golos"."updated_at", "Golos"."deleted_at", "Golos"."subject_id", "Golos"."owner_id", "Golos"."parent_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Golos" AS "Golos" LEFT OUTER JOIN "File" AS "attachments" ON "Golos"."id" = "attachments"."golos_id" AND "attachments"."deleted_at" IS NULL WHERE ("Golos"."deleted_at" IS NULL AND "Golos"."id" = 31);
[2016-10-19 17:56:39.893] [INFO] console - Executing (default): SELECT "id", "question", "invited", "note", "created_at", "updated_at", "deleted_at", "place_id", "inviter_id" FROM "Kopa" AS "Kopa" WHERE ("Kopa"."deleted_at" IS NULL AND "Kopa"."id" = '3');
[2016-10-19 17:56:39.912] [INFO] console - Executing (fa031f7c-242d-45b6-9319-c70320d2df8c): COMMIT;
[2016-10-19 17:56:39.931] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 17:56:39.943] [INFO] console - [ 70,
  144,
  {},
  [ { id: '31',
      value: 1,
      reason: null,
      note: null,
      created_at: Wed Oct 19 2016 17:56:39 GMT+0500 (YEKT),
      updated_at: Wed Oct 19 2016 17:56:39 GMT+0500 (YEKT),
      deleted_at: null,
      subject_id: '11',
      owner_id: '2',
      parent_id: null,
      attachments: [] } ] ]
[2016-10-19 17:56:39.971] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 17:56:39.988] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 17:56:39.999] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 17:56:40.011] [INFO] console - Executing (default): SELECT "id", "value", "reason", "note", "created_at", "updated_at", "deleted_at", "subject_id", "owner_id", "parent_id" FROM "Golos" AS "Golos" WHERE ("Golos"."deleted_at" IS NULL AND ("Golos"."subject_id" = '11' AND "Golos"."owner_id" = '2')) LIMIT 1;
[2016-10-19 17:56:40.030] [INFO] console - Executing (default): delete from "Golos" 
                            where
                                subject_id= 11
                                and (
                                    id= 31
                                    or parent_id = 31
                                )
[2016-10-19 17:56:40.054] [INFO] console - Executing (default): select
                            (select count(*) from "Golos" g where subject_id= 11 and value=1) "za",
                            (select count(*) from "Golos" g where subject_id= 11 and value=-1) "protiv"
[2016-10-19 17:56:40.071] [INFO] console - Executing (default): UPDATE "Predlozhenie" SET "totalZa"=0,"updated_at"='2016-10-19 12:56:40.058 +00:00' WHERE "id" = '11'
[2016-10-19 17:56:40.080] [INFO] console - Executing (e784e73d-25e9-4677-9e6b-1aa5bcb43583): COMMIT;
[2016-10-19 17:56:40.089] [INFO] console - [ 70, 143, {}, [ undefined ] ]
[2016-10-19 17:56:40.093] [INFO] console - [ 16,
  6009338650951680,
  { acknowledge: true },
  'ru.kopa.model.Predlozhenie.id11.rebalance',
  [],
  { totalZa: 0,
    totalProtiv: 0,
    GOLOS: '31',
    action: 'remove',
    value: 1 } ]
[2016-10-19 17:57:32.266] [INFO] console - [ 70, 146, {}, [ undefined ] ]
[2016-10-19 17:57:32.315] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 2 }
[2016-10-19 17:57:32.348] [INFO] console - Executing (default): delete from "Kopnik"
                where
                    name like '%temp'
                    or name like 'temp%'
[2016-10-19 17:57:32.371] [INFO] console - Executing (860bdd0e-6d98-46ad-bc7e-1fd365212bc1): START TRANSACTION;
[2016-10-19 17:57:32.376] [INFO] console - Executing (default): update "Kopnik"
                set 
                    "voiskoSize"= case when id=2 then 1 ELSE 0 END
                where
                    id>1 
                    and id<=5
[2016-10-19 17:57:32.379] [INFO] console - Executing (860bdd0e-6d98-46ad-bc7e-1fd365212bc1): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:57:32.402] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 17:57:32.447] [INFO] console - Executing (860bdd0e-6d98-46ad-bc7e-1fd365212bc1): COMMIT;
[2016-10-19 17:57:32.465] [INFO] console - [ 70,
  147,
  {},
  [ { fullName: 'Unit Test',
      fullPath: '/2/',
      id: '2',
      email: 'unittest2@domain.ru',
      name: 'Unit',
      surname: 'Test',
      patronymic: '1',
      voiskoSize: 1,
      birth: 1983,
      path: '/',
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: null,
      attachments: [] } ] ]
[2016-10-19 17:57:32.656] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."starshina_id" = 2) ORDER BY "Kopnik"."surname" asc, "Kopnik"."name" asc, "Kopnik"."patronymic" asc;
[2016-10-19 17:57:32.663] [INFO] console - [ 70, 148, {}, [ [ [Object], [Object] ] ] ]
[2016-10-19 17:58:23.419] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 17:58:23.450] [INFO] console - Executing (985911d3-9e43-4142-98c8-37c560f5b08e): START TRANSACTION;
[2016-10-19 17:58:23.452] [INFO] console - Executing (985911d3-9e43-4142-98c8-37c560f5b08e): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:58:23.467] [INFO] console - Executing (985911d3-9e43-4142-98c8-37c560f5b08e): INSERT INTO "Kopnik" ("id","name","surname","patronymic","voiskoSize","birth","path","created_at","updated_at","dom_id","starshina_id") VALUES (DEFAULT,'temp','temp','temp',0,1900,'/','2016-10-19 12:58:23.454 +00:00','2016-10-19 12:58:23.454 +00:00',2,NULL) RETURNING *;
[2016-10-19 17:58:23.471] [INFO] console - Executing (985911d3-9e43-4142-98c8-37c560f5b08e): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 17:58:23.481] [INFO] console - Executing (985911d3-9e43-4142-98c8-37c560f5b08e): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 17:58:23.486] [INFO] console - Executing (985911d3-9e43-4142-98c8-37c560f5b08e): update "Zemla"
                                    set "obshinaSize"= "obshinaSize"+ 1
                                where
                                    '/1/' like path||id||'/%'
                                    or (
                                        true 
                                        and id= 2
                                    )
[2016-10-19 17:58:23.489] [INFO] console - Executing (985911d3-9e43-4142-98c8-37c560f5b08e): COMMIT;
[2016-10-19 17:58:23.500] [INFO] console - [ 70, 149, {}, [ '23' ] ]
[2016-10-19 17:58:23.507] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 17:58:23.512] [INFO] console - Executing (default): select z.*
                                    from "Zemla" as z
                                where
                                    '/1/' like z.path||z.id||'/%'
[2016-10-19 17:58:23.525] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" IN ('1')) ORDER BY "Zemla"."path" desc;
[2016-10-19 17:58:23.534] [INFO] console - [ 16,
  7776221018456064,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id2.obshinaChange',
  [],
  { obshinaSize: 21 } ]
[2016-10-19 17:58:23.635] [INFO] console - [ 16,
  492843219025920,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id1.obshinaChange',
  [],
  { obshinaSize: 23 } ]
[2016-10-19 17:58:23.643] [INFO] console - Executing (7bcb3fb0-de11-4512-96a1-1d2c47dcadff): START TRANSACTION;
[2016-10-19 17:58:23.646] [INFO] console - Executing (7bcb3fb0-de11-4512-96a1-1d2c47dcadff): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:58:23.696] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 23);
[2016-10-19 17:58:23.714] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 17:58:23.723] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 17:58:23.748] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 17:58:23.752] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 17:58:23.764] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='2',"updated_at"='2016-10-19 12:58:23.753 +00:00' WHERE "id" = '23'
[2016-10-19 17:58:23.769] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/', '/2/')
                                where
                                    id = '23'
                                    or path like '/23/'||'%'
[2016-10-19 17:58:23.776] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 17:58:23.779] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 17:58:23.789] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 17:58:23.794] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/2/23/'||'%'
[2016-10-19 17:58:23.797] [INFO] console - Executing (7bcb3fb0-de11-4512-96a1-1d2c47dcadff): COMMIT;
[2016-10-19 17:58:23.800] [INFO] console - [ 70, 150, {}, [ undefined ] ]
[2016-10-19 17:58:23.803] [INFO] console - [ 16,
  8917404641918976,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 2 } ]
[2016-10-19 17:58:23.823] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 17:58:23.830] [INFO] console - Executing (a545b3ac-cf1d-4cfd-a18f-a4b7806235e0): START TRANSACTION;
[2016-10-19 17:58:23.832] [INFO] console - Executing (a545b3ac-cf1d-4cfd-a18f-a4b7806235e0): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:58:23.844] [INFO] console - Executing (a545b3ac-cf1d-4cfd-a18f-a4b7806235e0): INSERT INTO "Kopnik" ("id","name","surname","patronymic","voiskoSize","birth","path","created_at","updated_at","dom_id","starshina_id") VALUES (DEFAULT,'temp','temp','temp',0,1900,'/','2016-10-19 12:58:23.835 +00:00','2016-10-19 12:58:23.835 +00:00',2,NULL) RETURNING *;
[2016-10-19 17:58:23.852] [INFO] console - Executing (a545b3ac-cf1d-4cfd-a18f-a4b7806235e0): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 17:58:23.858] [INFO] console - Executing (a545b3ac-cf1d-4cfd-a18f-a4b7806235e0): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 17:58:23.864] [INFO] console - Executing (a545b3ac-cf1d-4cfd-a18f-a4b7806235e0): update "Zemla"
                                    set "obshinaSize"= "obshinaSize"+ 1
                                where
                                    '/1/' like path||id||'/%'
                                    or (
                                        true 
                                        and id= 2
                                    )
[2016-10-19 17:58:23.869] [INFO] console - Executing (a545b3ac-cf1d-4cfd-a18f-a4b7806235e0): COMMIT;
[2016-10-19 17:58:23.871] [INFO] console - [ 70, 151, {}, [ '24' ] ]
[2016-10-19 17:58:23.885] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 17:58:23.892] [INFO] console - Executing (0f629b2d-670a-4d2b-a95e-fda230eb981c): START TRANSACTION;
[2016-10-19 17:58:23.896] [INFO] console - Executing (default): select z.*
                                    from "Zemla" as z
                                where
                                    '/1/' like z.path||z.id||'/%'
[2016-10-19 17:58:23.898] [INFO] console - Executing (0f629b2d-670a-4d2b-a95e-fda230eb981c): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:58:23.910] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" IN ('1')) ORDER BY "Zemla"."path" desc;
[2016-10-19 17:58:23.935] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 24);
[2016-10-19 17:58:23.937] [INFO] console - [ 16,
  3507967806668800,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id2.obshinaChange',
  [],
  { obshinaSize: 22 } ]
[2016-10-19 17:58:23.952] [INFO] console - [ 16,
  8334836009795584,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id1.obshinaChange',
  [],
  { obshinaSize: 24 } ]
[2016-10-19 17:58:23.981] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 23);
[2016-10-19 17:58:23.988] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 17:58:24.000] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 17:58:24.011] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 17:58:24.027] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='23',"updated_at"='2016-10-19 12:58:24.013 +00:00' WHERE "id" = '24'
[2016-10-19 17:58:24.032] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/', '/2/23/')
                                where
                                    id = '24'
                                    or path like '/24/'||'%'
[2016-10-19 17:58:24.037] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/2/23/' like path||id||'/%'
[2016-10-19 17:58:24.043] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/23/' like k.path||k.id||'/%'
[2016-10-19 17:58:24.051] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('23', '2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 17:58:24.058] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/2/23/24/'||'%'
[2016-10-19 17:58:24.061] [INFO] console - Executing (0f629b2d-670a-4d2b-a95e-fda230eb981c): COMMIT;
[2016-10-19 17:58:24.064] [INFO] console - [ 70, 152, {}, [ undefined ] ]
[2016-10-19 17:58:24.068] [INFO] console - [ 16,
  660188323381248,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id23.voiskoChange',
  [],
  { voiskoSize: 1 } ]
[2016-10-19 17:58:24.075] [INFO] console - [ 16,
  6906460919300096,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 3 } ]
[2016-10-19 17:58:24.091] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 4 }
[2016-10-19 17:58:24.100] [INFO] console - Executing (a09f1930-e256-4000-92ce-a7083bb435c4): START TRANSACTION;
[2016-10-19 17:58:24.102] [INFO] console - Executing (a09f1930-e256-4000-92ce-a7083bb435c4): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:58:24.115] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 4);
[2016-10-19 17:58:24.126] [INFO] console - Executing (a09f1930-e256-4000-92ce-a7083bb435c4): COMMIT;
[2016-10-19 17:58:24.130] [INFO] console - [ 70,
  153,
  {},
  [ { fullName: 'Unit Test',
      fullPath: '/4/',
      id: '4',
      email: 'unittest4@domain.ru',
      name: 'Unit',
      surname: 'Test',
      patronymic: '4',
      voiskoSize: 0,
      birth: 1983,
      path: '/',
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: null,
      attachments: [] } ] ]
[2016-10-19 17:58:24.151] [INFO] console - Executing (4b961b71-ab7b-4101-ac40-04c444236012): START TRANSACTION;
[2016-10-19 17:58:24.155] [INFO] console - Executing (4b961b71-ab7b-4101-ac40-04c444236012): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:58:24.161] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 23);
[2016-10-19 17:58:24.169] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 4);
[2016-10-19 17:58:24.174] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 17:58:24.190] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 17:58:24.194] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-2
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 17:58:24.216] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='4',"updated_at"='2016-10-19 12:58:24.198 +00:00' WHERE "id" = '23'
[2016-10-19 17:58:24.227] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/2/', '/4/')
                                where
                                    id = '23'
                                    or path like '/2/23/'||'%'
[2016-10-19 17:58:24.232] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+2
                                where
                                    '/4/' like path||id||'/%'
[2016-10-19 17:58:24.235] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/4/' like k.path||k.id||'/%'
[2016-10-19 17:58:24.242] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('4')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 17:58:24.247] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/4/23/'||'%'
[2016-10-19 17:58:24.262] [INFO] console - Executing (4b961b71-ab7b-4101-ac40-04c444236012): COMMIT;
[2016-10-19 17:58:24.264] [INFO] console - [ 70, 154, {}, [ undefined ] ]
[2016-10-19 17:58:24.273] [INFO] console - [ 16,
  8009660900573184,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 1 } ]
[2016-10-19 17:58:24.290] [INFO] console - [ 16,
  4075355056898048,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id4.voiskoChange',
  [],
  { voiskoSize: 2 } ]
[2016-10-19 17:58:24.303] [INFO] console - [ 16,
  1938207820218368,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id24.starshinaChange',
  [],
  {} ]
[2016-10-19 17:58:24.319] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 24 }
[2016-10-19 17:58:24.323] [INFO] console - Executing (c089869f-b9a4-45ae-ab67-a0eae42a4645): START TRANSACTION;
[2016-10-19 17:58:24.331] [INFO] console - Executing (c089869f-b9a4-45ae-ab67-a0eae42a4645): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:58:24.346] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 24);
[2016-10-19 17:58:24.359] [INFO] console - Executing (c089869f-b9a4-45ae-ab67-a0eae42a4645): COMMIT;
[2016-10-19 17:58:24.361] [INFO] console - [ 70,
  155,
  {},
  [ { fullName: 'temp temp',
      fullPath: '/4/23/24/',
      id: '24',
      email: null,
      name: 'temp',
      surname: 'temp',
      patronymic: 'temp',
      voiskoSize: 0,
      birth: 1900,
      path: '/4/23/',
      note: null,
      created_at: Wed Oct 19 2016 17:58:23 GMT+0500 (YEKT),
      updated_at: Wed Oct 19 2016 17:58:24 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: '23',
      attachments: [] } ] ]
[2016-10-19 17:58:24.377] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 23 }
[2016-10-19 17:58:24.381] [INFO] console - Executing (2ee605c5-d5e7-450c-913b-c912ee2f32ff): START TRANSACTION;
[2016-10-19 17:58:24.383] [INFO] console - Executing (2ee605c5-d5e7-450c-913b-c912ee2f32ff): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:58:24.390] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 23);
[2016-10-19 17:58:24.399] [INFO] console - Executing (2ee605c5-d5e7-450c-913b-c912ee2f32ff): COMMIT;
[2016-10-19 17:58:24.401] [INFO] console - [ 70,
  156,
  {},
  [ { fullName: 'temp temp',
      fullPath: '/4/23/',
      id: '23',
      email: null,
      name: 'temp',
      surname: 'temp',
      patronymic: 'temp',
      voiskoSize: 1,
      birth: 1900,
      path: '/4/',
      note: null,
      created_at: Wed Oct 19 2016 17:58:23 GMT+0500 (YEKT),
      updated_at: Wed Oct 19 2016 17:58:24 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: '4',
      attachments: [] } ] ]
[2016-10-19 17:58:24.423] [DEBUG] Server - #promiseModel() [] { model: 'Kopa', id: 3 }
[2016-10-19 17:58:24.439] [INFO] console - Executing (12362800-aae1-475d-8df2-f462e45e4751): START TRANSACTION;
[2016-10-19 17:58:24.442] [INFO] console - Executing (12362800-aae1-475d-8df2-f462e45e4751): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:58:24.454] [INFO] console - Executing (default): SELECT "Kopa"."id", "Kopa"."question", "Kopa"."invited", "Kopa"."note", "Kopa"."created_at", "Kopa"."updated_at", "Kopa"."deleted_at", "Kopa"."place_id", "Kopa"."inviter_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopa" AS "Kopa" LEFT OUTER JOIN "File" AS "attachments" ON "Kopa"."id" = "attachments"."kopa_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopa"."deleted_at" IS NULL AND "Kopa"."id" = 3);
[2016-10-19 17:58:24.462] [INFO] console - Executing (12362800-aae1-475d-8df2-f462e45e4751): COMMIT;
[2016-10-19 17:58:24.464] [INFO] console - [ 70,
  157,
  {},
  [ { id: '3',
      question: 'CHE',
      invited: Thu Sep 01 2016 00:00:00 GMT+0500 (YEKT),
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      place_id: '2',
      inviter_id: '2',
      attachments: [] } ] ]
[2016-10-19 17:58:24.494] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 17:58:24.504] [INFO] console - Executing (f877608d-6398-473d-9717-c1772a695ea6): START TRANSACTION;
[2016-10-19 17:58:24.507] [INFO] console - Executing (f877608d-6398-473d-9717-c1772a695ea6): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:58:24.523] [INFO] console - Executing (f877608d-6398-473d-9717-c1772a695ea6): INSERT INTO "Predlozhenie" ("id","value","totalZa","totalProtiv","created_at","updated_at","author_id","place_id") VALUES (DEFAULT,'temp Wed Oct 19 2016 17:58:24 GMT+0500 (YEKT)',0,0,'2016-10-19 12:58:24.511 +00:00','2016-10-19 12:58:24.511 +00:00',2,3) RETURNING *;
[2016-10-19 17:58:24.534] [INFO] console - Executing (f877608d-6398-473d-9717-c1772a695ea6): COMMIT;
[2016-10-19 17:58:24.536] [INFO] console - [ 70, 158, {}, [ '12' ] ]
[2016-10-19 17:58:24.556] [INFO] console - [ 16,
  1904188896313344,
  { acknowledge: true },
  'ru.kopa.model.Kopa.id3.predlozhenieAdd',
  [ '12' ] ]
[2016-10-19 17:58:24.564] [INFO] console - Executing (6f7b99fd-465e-4f98-99c3-ec580e2bc011): START TRANSACTION;
[2016-10-19 17:58:24.566] [INFO] console - Executing (6f7b99fd-465e-4f98-99c3-ec580e2bc011): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:58:24.630] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 17:58:24.649] [INFO] console - Executing (default): SELECT "id", "value", "totalZa", "totalProtiv", "state", "note", "created_at", "updated_at", "deleted_at", "author_id", "place_id" FROM "Predlozhenie" AS "Predlozhenie" WHERE ("Predlozhenie"."deleted_at" IS NULL AND "Predlozhenie"."id" = 12);
[2016-10-19 17:58:24.663] [INFO] console - Executing (default): SELECT "id", "question", "invited", "note", "created_at", "updated_at", "deleted_at", "place_id", "inviter_id" FROM "Kopa" AS "Kopa" WHERE ("Kopa"."deleted_at" IS NULL AND "Kopa"."id" = '3');
[2016-10-19 17:58:24.673] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 17:58:24.698] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 17:58:24.708] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 17:58:24.715] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 17:58:24.723] [INFO] console - Executing (default): SELECT "id", "value", "reason", "note", "created_at", "updated_at", "deleted_at", "subject_id", "owner_id", "parent_id" FROM "Golos" AS "Golos" WHERE ("Golos"."deleted_at" IS NULL AND ("Golos"."subject_id" = '12' AND "Golos"."owner_id" = '2')) LIMIT 1;
[2016-10-19 17:58:24.740] [INFO] console - Executing (default): INSERT INTO "Golos" ("id","value","created_at","updated_at","subject_id","owner_id") VALUES (DEFAULT,1,'2016-10-19 12:58:24.727 +00:00','2016-10-19 12:58:24.727 +00:00','12','2') RETURNING *;
[2016-10-19 17:58:24.746] [INFO] console - Executing (default): insert into "Golos" (subject_id, value, owner_id, parent_id, created_at, updated_at)
                            (
                                select 12, 1, k.id, 33, current_timestamp, current_timestamp
                                from 
                                    "Kopnik" k
                                     join "Zemla" d on d.id= k.dom_id
                                where
                                    k.path like '/2/%'
                                    and d.path||d.id||'/' like '/1/2/%' 
                            )
[2016-10-19 17:58:24.752] [INFO] console - Executing (default): select
                            (select count(*) from "Golos" g where subject_id= 12 and value=1) "za",
                            (select count(*) from "Golos" g where subject_id= 12 and value=-1) "protiv"
[2016-10-19 17:58:24.766] [INFO] console - Executing (default): UPDATE "Predlozhenie" SET "totalZa"=2,"updated_at"='2016-10-19 12:58:24.754 +00:00' WHERE "id" = '12'
[2016-10-19 17:58:24.771] [INFO] console - Executing (6f7b99fd-465e-4f98-99c3-ec580e2bc011): COMMIT;
[2016-10-19 17:58:24.776] [INFO] console - [ 70, 159, {}, [ undefined ] ]
[2016-10-19 17:58:24.786] [INFO] console - [ 16,
  951916257345536,
  { acknowledge: true },
  'ru.kopa.model.Predlozhenie.id12.rebalance',
  [],
  { totalZa: 2,
    totalProtiv: 0,
    GOLOS: '33',
    action: 'add',
    value: 1 } ]
[2016-10-19 17:58:24.798] [INFO] console - Executing (aaf17cf6-1a25-472f-8da8-7db5cde6e761): START TRANSACTION;
[2016-10-19 17:58:24.800] [DEBUG] Server - #promiseModel() [] { model: 'Golos', id: 33 }
[2016-10-19 17:58:24.802] [INFO] console - Executing (9f37907a-92e3-4440-8aa6-b23a3102e4f6): START TRANSACTION;
[2016-10-19 17:58:24.803] [INFO] console - Executing (aaf17cf6-1a25-472f-8da8-7db5cde6e761): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:58:24.806] [INFO] console - Executing (9f37907a-92e3-4440-8aa6-b23a3102e4f6): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 17:58:24.813] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 17:58:24.869] [INFO] console - Executing (default): SELECT "Golos"."id", "Golos"."value", "Golos"."reason", "Golos"."note", "Golos"."created_at", "Golos"."updated_at", "Golos"."deleted_at", "Golos"."subject_id", "Golos"."owner_id", "Golos"."parent_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Golos" AS "Golos" LEFT OUTER JOIN "File" AS "attachments" ON "Golos"."id" = "attachments"."golos_id" AND "attachments"."deleted_at" IS NULL WHERE ("Golos"."deleted_at" IS NULL AND "Golos"."id" = 33);
[2016-10-19 17:58:24.922] [INFO] console - Executing (default): SELECT "id", "value", "totalZa", "totalProtiv", "state", "note", "created_at", "updated_at", "deleted_at", "author_id", "place_id" FROM "Predlozhenie" AS "Predlozhenie" WHERE ("Predlozhenie"."deleted_at" IS NULL AND "Predlozhenie"."id" = 12);
[2016-10-19 17:58:24.933] [INFO] console - Executing (9f37907a-92e3-4440-8aa6-b23a3102e4f6): COMMIT;
[2016-10-19 17:58:24.952] [INFO] console - Executing (default): SELECT "id", "question", "invited", "note", "created_at", "updated_at", "deleted_at", "place_id", "inviter_id" FROM "Kopa" AS "Kopa" WHERE ("Kopa"."deleted_at" IS NULL AND "Kopa"."id" = '3');
[2016-10-19 17:58:24.953] [INFO] console - [ 70,
  161,
  {},
  [ { id: '33',
      value: 1,
      reason: null,
      note: null,
      created_at: Wed Oct 19 2016 17:58:24 GMT+0500 (YEKT),
      updated_at: Wed Oct 19 2016 17:58:24 GMT+0500 (YEKT),
      deleted_at: null,
      subject_id: '12',
      owner_id: '2',
      parent_id: null,
      attachments: [] } ] ]
[2016-10-19 17:58:25.020] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 17:58:25.037] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 17:58:25.044] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 17:58:25.049] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 17:58:25.056] [INFO] console - Executing (default): SELECT "id", "value", "reason", "note", "created_at", "updated_at", "deleted_at", "subject_id", "owner_id", "parent_id" FROM "Golos" AS "Golos" WHERE ("Golos"."deleted_at" IS NULL AND ("Golos"."subject_id" = '12' AND "Golos"."owner_id" = '2')) LIMIT 1;
[2016-10-19 17:58:25.062] [INFO] console - Executing (default): delete from "Golos" 
                            where
                                subject_id= 12
                                and (
                                    id= 33
                                    or parent_id = 33
                                )
[2016-10-19 17:58:25.068] [INFO] console - Executing (default): select
                            (select count(*) from "Golos" g where subject_id= 12 and value=1) "za",
                            (select count(*) from "Golos" g where subject_id= 12 and value=-1) "protiv"
[2016-10-19 17:58:25.077] [INFO] console - Executing (default): UPDATE "Predlozhenie" SET "totalZa"=0,"updated_at"='2016-10-19 12:58:25.070 +00:00' WHERE "id" = '12'
[2016-10-19 17:58:25.080] [INFO] console - Executing (aaf17cf6-1a25-472f-8da8-7db5cde6e761): COMMIT;
[2016-10-19 17:58:25.083] [INFO] console - [ 70, 160, {}, [ undefined ] ]
[2016-10-19 17:58:25.085] [INFO] console - [ 16,
  798645530132480,
  { acknowledge: true },
  'ru.kopa.model.Predlozhenie.id12.rebalance',
  [],
  { totalZa: 0,
    totalProtiv: 0,
    GOLOS: '33',
    action: 'remove',
    value: 1 } ]
[2016-10-19 18:00:12.834] [INFO] console - AutobahnJS debug enabled
[2016-10-19 18:00:14.723] [INFO] Server - starting...
[2016-10-19 18:00:14.725] [INFO] console - trying to create WAMP transport of type: websocket
[2016-10-19 18:00:14.814] [INFO] console - using WAMP transport type: websocket
[2016-10-19 18:00:15.113] [INFO] console - [ 1,
  'kopa',
  { roles: 
     { caller: [Object],
       callee: [Object],
       publisher: [Object],
       subscriber: [Object] },
    authmethods: [ 'ticket' ],
    authid: 'server' } ]
[2016-10-19 18:00:15.137] [INFO] console - [ 5, 'server', {} ]
[2016-10-19 18:00:15.157] [INFO] Server - connection.onopen()
[2016-10-19 18:00:15.158] [INFO] console - [ 64, 5068615776731136, {}, 'ru.kopa.model.create' ]
[2016-10-19 18:00:15.171] [DEBUG] Server - api:model.create registered
[2016-10-19 18:00:15.174] [INFO] console - [ 64, 959407101837312, {}, 'ru.kopa.model.get' ]
[2016-10-19 18:00:15.183] [DEBUG] Server - api:model.get registered
[2016-10-19 18:00:15.184] [INFO] console - [ 64, 1529601387921408, {}, 'ru.kopa.model.save' ]
[2016-10-19 18:00:15.190] [DEBUG] Server - api:model.save registered
[2016-10-19 18:00:15.190] [INFO] console - [ 64, 3830875135410176, {}, 'ru.kopa.pingPong' ]
[2016-10-19 18:00:15.197] [DEBUG] Server - api:pingPong registered
[2016-10-19 18:00:15.198] [INFO] console - [ 64, 4782002144280576, {}, 'ru.kopa.discloseCaller' ]
[2016-10-19 18:00:15.206] [DEBUG] Server - api:discloseCaller registered
[2016-10-19 18:00:15.207] [INFO] console - [ 64, 7538229995634688, {}, 'ru.kopa.pingPongDatabase' ]
[2016-10-19 18:00:15.216] [DEBUG] Server - api:pingPongDatabase registered
[2016-10-19 18:00:15.217] [INFO] console - [ 64, 7281333304819712, {}, 'ru.kopa.error' ]
[2016-10-19 18:00:15.229] [DEBUG] Server - api:error registered
[2016-10-19 18:00:15.231] [INFO] console - [ 64, 6469321989554176, {}, 'ru.kopa.unitTest.cleanTempData' ]
[2016-10-19 18:00:15.239] [DEBUG] Server - api:unitTest.cleanTempData registered
[2016-10-19 18:00:15.241] [INFO] console - [ 64, 5804951336910848, {}, 'ru.kopa.model.Kopnik.setStarshina' ]
[2016-10-19 18:00:15.249] [DEBUG] Server - api:model.Kopnik.setStarshina registered
[2016-10-19 18:00:15.251] [INFO] console - [ 64, 6379739832909824, {}, 'ru.kopa.model.Kopnik.getDruzhina' ]
[2016-10-19 18:00:15.258] [DEBUG] Server - api:model.Kopnik.getDruzhina registered
[2016-10-19 18:00:15.259] [INFO] console - [ 64, 612875202723840, {}, 'ru.kopa.model.Kopnik.vote' ]
[2016-10-19 18:00:15.265] [DEBUG] Server - api:model.Kopnik.vote registered
[2016-10-19 18:00:15.268] [INFO] console - [ 64, 8640027162574848, {}, 'ru.kopa.model.Kopa.invite' ]
[2016-10-19 18:00:15.273] [DEBUG] Server - api:model.Kopa.invite registered
[2016-10-19 18:00:15.274] [INFO] console - [ 64, 227755885068288, {}, 'ru.kopa.model.Kopa.getDialog' ]
[2016-10-19 18:00:15.283] [DEBUG] Server - api:model.Kopa.getDialog registered
[2016-10-19 18:00:15.284] [INFO] console - [ 64, 5206715494563840, {}, 'ru.kopa.model.Kopa.getResult' ]
[2016-10-19 18:00:15.292] [DEBUG] Server - api:model.Kopa.getResult registered
[2016-10-19 18:00:15.293] [INFO] console - [ 64, 4771870303846400, {}, 'ru.kopa.model.Zemla.setParent' ]
[2016-10-19 18:00:15.300] [DEBUG] Server - api:model.Zemla.setParent registered
[2016-10-19 18:00:15.301] [INFO] console - [ 64, 3251187178536960, {}, 'ru.kopa.model.Zemla.promiseKopi' ]
[2016-10-19 18:00:15.309] [DEBUG] Server - api:model.Zemla.promiseKopi registered
[2016-10-19 18:00:15.310] [INFO] console - [ 64,
  174276858609664,
  {},
  'ru.kopa.model.Predlozhenie.getGolosa' ]
[2016-10-19 18:00:15.316] [DEBUG] Server - api:model.Predlozhenie.getGolosa registered
[2016-10-19 18:00:15.317] [INFO] console - [ 64, 3265002830036992, {}, 'ru.kopa.unitTest.orderProc' ]
[2016-10-19 18:00:15.327] [DEBUG] Server - api:unitTest.orderProc registered
[2016-10-19 18:00:15.334] [INFO] Server - started
[2016-10-19 18:00:26.984] [INFO] console - [ 70, 164, {}, [ undefined ] ]
[2016-10-19 18:00:27.099] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 2 }
[2016-10-19 18:00:27.239] [INFO] console - Executing (default): delete from "Kopnik"
                where
                    name like '%temp'
                    or name like 'temp%'
[2016-10-19 18:00:27.248] [INFO] console - Executing (5caee700-6c15-4f93-968a-03c45a8858bc): START TRANSACTION;
[2016-10-19 18:00:27.258] [INFO] console - Executing (5caee700-6c15-4f93-968a-03c45a8858bc): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 18:00:27.270] [INFO] console - Executing (default): update "Kopnik"
                set 
                    "voiskoSize"= case when id=2 then 1 ELSE 0 END
                where
                    id>1 
                    and id<=5
[2016-10-19 18:00:27.297] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 18:00:27.327] [INFO] console - Executing (5caee700-6c15-4f93-968a-03c45a8858bc): COMMIT;
[2016-10-19 18:00:27.338] [INFO] console - [ 70,
  165,
  {},
  [ { fullName: 'Unit Test',
      fullPath: '/2/',
      id: '2',
      email: 'unittest2@domain.ru',
      name: 'Unit',
      surname: 'Test',
      patronymic: '1',
      voiskoSize: 1,
      birth: 1983,
      path: '/',
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: null,
      attachments: [] } ] ]
[2016-10-19 18:00:27.496] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."starshina_id" = 2) ORDER BY "Kopnik"."surname" asc, "Kopnik"."name" asc, "Kopnik"."patronymic" asc;
[2016-10-19 18:00:27.527] [INFO] console - [ 70, 166, {}, [ [ [Object], [Object] ] ] ]
[2016-10-19 18:00:27.707] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 18:00:27.719] [INFO] console - Executing (4f8738f7-9eef-4f8e-b770-1857c4a2fd9f): START TRANSACTION;
[2016-10-19 18:00:27.722] [INFO] console - Executing (4f8738f7-9eef-4f8e-b770-1857c4a2fd9f): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 18:00:27.756] [INFO] console - Executing (4f8738f7-9eef-4f8e-b770-1857c4a2fd9f): INSERT INTO "Kopnik" ("id","name","surname","patronymic","voiskoSize","birth","path","created_at","updated_at","dom_id","starshina_id") VALUES (DEFAULT,'temp','temp','temp',0,1900,'/','2016-10-19 13:00:27.729 +00:00','2016-10-19 13:00:27.729 +00:00',2,NULL) RETURNING *;
[2016-10-19 18:00:27.779] [INFO] console - Executing (4f8738f7-9eef-4f8e-b770-1857c4a2fd9f): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 18:00:27.806] [INFO] console - Executing (4f8738f7-9eef-4f8e-b770-1857c4a2fd9f): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 18:00:27.823] [INFO] console - Executing (4f8738f7-9eef-4f8e-b770-1857c4a2fd9f): update "Zemla"
                                    set "obshinaSize"= "obshinaSize"+ 1
                                where
                                    '/1/' like path||id||'/%'
                                    or (
                                        true 
                                        and id= 2
                                    )
[2016-10-19 18:00:27.837] [INFO] console - Executing (4f8738f7-9eef-4f8e-b770-1857c4a2fd9f): COMMIT;
[2016-10-19 18:00:27.866] [INFO] console - [ 70, 167, {}, [ '25' ] ]
[2016-10-19 18:00:27.887] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 18:00:27.897] [INFO] console - Executing (4969fbb0-a3a5-4012-8bc1-97ac9096e813): START TRANSACTION;
[2016-10-19 18:00:27.903] [INFO] console - Executing (default): select z.*
                                    from "Zemla" as z
                                where
                                    '/1/' like z.path||z.id||'/%'
[2016-10-19 18:00:27.906] [INFO] console - Executing (4969fbb0-a3a5-4012-8bc1-97ac9096e813): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 18:00:27.945] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" IN ('1')) ORDER BY "Zemla"."path" desc;
[2016-10-19 18:00:27.952] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 25);
[2016-10-19 18:00:27.970] [INFO] console - [ 16,
  1012867937599488,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id2.obshinaChange',
  [],
  { obshinaSize: 23 } ]
[2016-10-19 18:00:27.983] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 18:00:27.987] [INFO] console - [ 16,
  5343341749207040,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id1.obshinaChange',
  [],
  { obshinaSize: 25 } ]
[2016-10-19 18:00:28.018] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 18:00:28.030] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 18:00:28.038] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 18:00:28.056] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='2',"updated_at"='2016-10-19 13:00:28.041 +00:00' WHERE "id" = '25'
[2016-10-19 18:00:28.063] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/', '/2/')
                                where
                                    id = '25'
                                    or path like '/25/'||'%'
[2016-10-19 18:00:28.069] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 18:00:28.075] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 18:00:28.087] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 18:00:28.097] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/2/25/'||'%'
[2016-10-19 18:00:28.112] [INFO] console - Executing (4969fbb0-a3a5-4012-8bc1-97ac9096e813): COMMIT;
[2016-10-19 18:00:28.115] [INFO] console - [ 70, 168, {}, [ undefined ] ]
[2016-10-19 18:00:28.130] [INFO] console - [ 16,
  8947931468005376,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 2 } ]
[2016-10-19 18:00:28.163] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 18:00:28.181] [INFO] console - Executing (090f32e2-a989-44d0-9e10-5be125fc5ddb): START TRANSACTION;
[2016-10-19 18:00:28.223] [INFO] console - Executing (090f32e2-a989-44d0-9e10-5be125fc5ddb): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 18:00:28.295] [INFO] console - Executing (090f32e2-a989-44d0-9e10-5be125fc5ddb): INSERT INTO "Kopnik" ("id","name","surname","patronymic","voiskoSize","birth","path","created_at","updated_at","dom_id","starshina_id") VALUES (DEFAULT,'temp','temp','temp',0,1900,'/','2016-10-19 13:00:28.231 +00:00','2016-10-19 13:00:28.231 +00:00',2,NULL) RETURNING *;
[2016-10-19 18:00:28.304] [INFO] console - Executing (090f32e2-a989-44d0-9e10-5be125fc5ddb): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 18:00:28.314] [INFO] console - Executing (090f32e2-a989-44d0-9e10-5be125fc5ddb): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 18:00:28.322] [INFO] console - Executing (090f32e2-a989-44d0-9e10-5be125fc5ddb): update "Zemla"
                                    set "obshinaSize"= "obshinaSize"+ 1
                                where
                                    '/1/' like path||id||'/%'
                                    or (
                                        true 
                                        and id= 2
                                    )
[2016-10-19 18:00:28.329] [INFO] console - Executing (090f32e2-a989-44d0-9e10-5be125fc5ddb): COMMIT;
[2016-10-19 18:00:28.332] [INFO] console - [ 70, 169, {}, [ '26' ] ]
[2016-10-19 18:00:28.349] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 18:00:28.365] [INFO] console - Executing (fa887d06-f30f-4c56-8e24-946346a09994): START TRANSACTION;
[2016-10-19 18:00:28.370] [INFO] console - Executing (default): select z.*
                                    from "Zemla" as z
                                where
                                    '/1/' like z.path||z.id||'/%'
[2016-10-19 18:00:28.375] [INFO] console - Executing (fa887d06-f30f-4c56-8e24-946346a09994): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 18:00:28.396] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" IN ('1')) ORDER BY "Zemla"."path" desc;
[2016-10-19 18:00:28.399] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 26);
[2016-10-19 18:00:28.413] [INFO] console - [ 16,
  6652597584789504,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id2.obshinaChange',
  [],
  { obshinaSize: 24 } ]
[2016-10-19 18:00:28.458] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 25);
[2016-10-19 18:00:28.461] [INFO] console - [ 16,
  8099628215959552,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id1.obshinaChange',
  [],
  { obshinaSize: 26 } ]
[2016-10-19 18:00:28.473] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 18:00:28.485] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 18:00:28.493] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 18:00:28.526] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='25',"updated_at"='2016-10-19 13:00:28.500 +00:00' WHERE "id" = '26'
[2016-10-19 18:00:28.560] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/', '/2/25/')
                                where
                                    id = '26'
                                    or path like '/26/'||'%'
[2016-10-19 18:00:28.568] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/2/25/' like path||id||'/%'
[2016-10-19 18:00:28.631] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/25/' like k.path||k.id||'/%'
[2016-10-19 18:00:28.647] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('25', '2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 18:00:28.656] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/2/25/26/'||'%'
[2016-10-19 18:00:28.662] [INFO] console - Executing (fa887d06-f30f-4c56-8e24-946346a09994): COMMIT;
[2016-10-19 18:00:28.666] [INFO] console - [ 70, 170, {}, [ undefined ] ]
[2016-10-19 18:00:28.671] [INFO] console - [ 16,
  8999797323202560,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id25.voiskoChange',
  [],
  { voiskoSize: 1 } ]
[2016-10-19 18:00:28.715] [INFO] console - [ 16,
  2219652119789568,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 3 } ]
[2016-10-19 18:00:28.742] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 4 }
[2016-10-19 18:00:28.749] [INFO] console - Executing (4bbc1318-02ed-4c40-9658-490ff3d7e71e): START TRANSACTION;
[2016-10-19 18:00:28.753] [INFO] console - Executing (4bbc1318-02ed-4c40-9658-490ff3d7e71e): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 18:00:28.774] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 4);
[2016-10-19 18:00:28.788] [INFO] console - Executing (4bbc1318-02ed-4c40-9658-490ff3d7e71e): COMMIT;
[2016-10-19 18:00:28.794] [INFO] console - [ 70,
  171,
  {},
  [ { fullName: 'Unit Test',
      fullPath: '/4/',
      id: '4',
      email: 'unittest4@domain.ru',
      name: 'Unit',
      surname: 'Test',
      patronymic: '4',
      voiskoSize: 0,
      birth: 1983,
      path: '/',
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: null,
      attachments: [] } ] ]
[2016-10-19 18:00:28.827] [INFO] console - Executing (fd28fa0d-56b5-4dc9-84dd-7a0cfddb844b): START TRANSACTION;
[2016-10-19 18:00:28.831] [INFO] console - Executing (fd28fa0d-56b5-4dc9-84dd-7a0cfddb844b): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 18:00:28.857] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 25);
[2016-10-19 18:00:28.899] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 4);
[2016-10-19 18:00:28.920] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 18:00:28.945] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 18:00:28.969] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-2
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 18:00:28.990] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='4',"updated_at"='2016-10-19 13:00:28.973 +00:00' WHERE "id" = '25'
[2016-10-19 18:00:29.017] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/2/', '/4/')
                                where
                                    id = '25'
                                    or path like '/2/25/'||'%'
[2016-10-19 18:00:29.035] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+2
                                where
                                    '/4/' like path||id||'/%'
[2016-10-19 18:00:29.078] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/4/' like k.path||k.id||'/%'
[2016-10-19 18:00:29.116] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('4')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 18:00:29.148] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/4/25/'||'%'
[2016-10-19 18:00:29.172] [INFO] console - Executing (fd28fa0d-56b5-4dc9-84dd-7a0cfddb844b): COMMIT;
[2016-10-19 18:00:29.184] [INFO] console - [ 70, 172, {}, [ undefined ] ]
[2016-10-19 18:00:29.214] [INFO] console - [ 16,
  1309219552755712,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 1 } ]
[2016-10-19 18:00:29.239] [INFO] console - [ 16,
  2102767218851840,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id4.voiskoChange',
  [],
  { voiskoSize: 2 } ]
[2016-10-19 18:00:29.262] [INFO] console - [ 16,
  7354546210734080,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id26.starshinaChange',
  [],
  {} ]
[2016-10-19 18:00:29.286] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 26 }
[2016-10-19 18:00:29.295] [INFO] console - Executing (cd55401b-c3dc-4a77-a106-12b3fec9d907): START TRANSACTION;
[2016-10-19 18:00:29.299] [INFO] console - Executing (cd55401b-c3dc-4a77-a106-12b3fec9d907): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 18:00:29.317] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 26);
[2016-10-19 18:00:29.352] [INFO] console - Executing (cd55401b-c3dc-4a77-a106-12b3fec9d907): COMMIT;
[2016-10-19 18:00:29.359] [INFO] console - [ 70,
  173,
  {},
  [ { fullName: 'temp temp',
      fullPath: '/4/25/26/',
      id: '26',
      email: null,
      name: 'temp',
      surname: 'temp',
      patronymic: 'temp',
      voiskoSize: 0,
      birth: 1900,
      path: '/4/25/',
      note: null,
      created_at: Wed Oct 19 2016 18:00:28 GMT+0500 (YEKT),
      updated_at: Wed Oct 19 2016 18:00:28 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: '25',
      attachments: [] } ] ]
[2016-10-19 18:00:29.406] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 25 }
[2016-10-19 18:00:29.417] [INFO] console - Executing (be320e31-58c0-45b8-b334-b0892537188e): START TRANSACTION;
[2016-10-19 18:00:29.421] [INFO] console - Executing (be320e31-58c0-45b8-b334-b0892537188e): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 18:00:29.474] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 25);
[2016-10-19 18:00:29.492] [INFO] console - Executing (be320e31-58c0-45b8-b334-b0892537188e): COMMIT;
[2016-10-19 18:00:29.495] [INFO] console - [ 70,
  174,
  {},
  [ { fullName: 'temp temp',
      fullPath: '/4/25/',
      id: '25',
      email: null,
      name: 'temp',
      surname: 'temp',
      patronymic: 'temp',
      voiskoSize: 1,
      birth: 1900,
      path: '/4/',
      note: null,
      created_at: Wed Oct 19 2016 18:00:27 GMT+0500 (YEKT),
      updated_at: Wed Oct 19 2016 18:00:28 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: '4',
      attachments: [] } ] ]
[2016-10-19 18:00:29.522] [DEBUG] Server - #promiseModel() [] { model: 'Kopa', id: 3 }
[2016-10-19 18:00:29.546] [INFO] console - Executing (076dfd07-9725-4f80-9f1e-13c87ba673bb): START TRANSACTION;
[2016-10-19 18:00:29.549] [INFO] console - Executing (076dfd07-9725-4f80-9f1e-13c87ba673bb): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 18:00:29.584] [INFO] console - Executing (default): SELECT "Kopa"."id", "Kopa"."question", "Kopa"."invited", "Kopa"."note", "Kopa"."created_at", "Kopa"."updated_at", "Kopa"."deleted_at", "Kopa"."place_id", "Kopa"."inviter_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopa" AS "Kopa" LEFT OUTER JOIN "File" AS "attachments" ON "Kopa"."id" = "attachments"."kopa_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopa"."deleted_at" IS NULL AND "Kopa"."id" = 3);
[2016-10-19 18:00:29.610] [INFO] console - Executing (076dfd07-9725-4f80-9f1e-13c87ba673bb): COMMIT;
[2016-10-19 18:00:29.617] [INFO] console - [ 70,
  175,
  {},
  [ { id: '3',
      question: 'CHE',
      invited: Thu Sep 01 2016 00:00:00 GMT+0500 (YEKT),
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      place_id: '2',
      inviter_id: '2',
      attachments: [] } ] ]
[2016-10-19 18:00:29.663] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 18:00:29.677] [INFO] console - Executing (501caf5d-c32c-44c0-896a-b3c335dbf431): START TRANSACTION;
[2016-10-19 18:00:29.680] [INFO] console - Executing (501caf5d-c32c-44c0-896a-b3c335dbf431): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 18:00:29.702] [INFO] console - Executing (501caf5d-c32c-44c0-896a-b3c335dbf431): INSERT INTO "Predlozhenie" ("id","value","totalZa","totalProtiv","created_at","updated_at","author_id","place_id") VALUES (DEFAULT,'temp Wed Oct 19 2016 18:00:29 GMT+0500 (YEKT)',0,0,'2016-10-19 13:00:29.688 +00:00','2016-10-19 13:00:29.688 +00:00',2,3) RETURNING *;
[2016-10-19 18:00:29.711] [INFO] console - Executing (501caf5d-c32c-44c0-896a-b3c335dbf431): COMMIT;
[2016-10-19 18:00:29.715] [INFO] console - [ 70, 176, {}, [ '13' ] ]
[2016-10-19 18:00:29.719] [INFO] console - [ 16,
  7229239015243776,
  { acknowledge: true },
  'ru.kopa.model.Kopa.id3.predlozhenieAdd',
  [ '13' ] ]
[2016-10-19 18:00:29.923] [INFO] console - Executing (033168e6-d06c-46ab-9d07-85cc65b60084): START TRANSACTION;
[2016-10-19 18:00:29.932] [INFO] console - Executing (033168e6-d06c-46ab-9d07-85cc65b60084): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 18:00:29.950] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 18:00:29.966] [INFO] console - Executing (default): SELECT "id", "value", "totalZa", "totalProtiv", "state", "note", "created_at", "updated_at", "deleted_at", "author_id", "place_id" FROM "Predlozhenie" AS "Predlozhenie" WHERE ("Predlozhenie"."deleted_at" IS NULL AND "Predlozhenie"."id" = 13);
[2016-10-19 18:00:29.982] [INFO] console - Executing (default): SELECT "id", "question", "invited", "note", "created_at", "updated_at", "deleted_at", "place_id", "inviter_id" FROM "Kopa" AS "Kopa" WHERE ("Kopa"."deleted_at" IS NULL AND "Kopa"."id" = '3');
[2016-10-19 18:00:29.995] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 18:00:30.014] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 18:00:30.021] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 18:00:30.032] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 18:00:30.046] [INFO] console - Executing (default): SELECT "id", "value", "reason", "note", "created_at", "updated_at", "deleted_at", "subject_id", "owner_id", "parent_id" FROM "Golos" AS "Golos" WHERE ("Golos"."deleted_at" IS NULL AND ("Golos"."subject_id" = '13' AND "Golos"."owner_id" = '2')) LIMIT 1;
[2016-10-19 18:00:30.062] [INFO] console - Executing (default): INSERT INTO "Golos" ("id","value","created_at","updated_at","subject_id","owner_id") VALUES (DEFAULT,1,'2016-10-19 13:00:30.052 +00:00','2016-10-19 13:00:30.052 +00:00','13','2') RETURNING *;
[2016-10-19 18:00:30.076] [INFO] console - Executing (default): insert into "Golos" (subject_id, value, owner_id, parent_id, created_at, updated_at)
                            (
                                select 13, 1, k.id, 35, current_timestamp, current_timestamp
                                from 
                                    "Kopnik" k
                                     join "Zemla" d on d.id= k.dom_id
                                where
                                    k.path like '/2/%'
                                    and d.path||d.id||'/' like '/1/2/%' 
                            )
[2016-10-19 18:00:30.084] [INFO] console - Executing (default): select
                            (select count(*) from "Golos" g where subject_id= 13 and value=1) "za",
                            (select count(*) from "Golos" g where subject_id= 13 and value=-1) "protiv"
[2016-10-19 18:00:30.101] [INFO] console - Executing (default): UPDATE "Predlozhenie" SET "totalZa"=2,"updated_at"='2016-10-19 13:00:30.089 +00:00' WHERE "id" = '13'
[2016-10-19 18:00:30.116] [INFO] console - Executing (033168e6-d06c-46ab-9d07-85cc65b60084): COMMIT;
[2016-10-19 18:00:30.124] [INFO] console - [ 70, 177, {}, [ undefined ] ]
[2016-10-19 18:00:30.132] [INFO] console - [ 16,
  1056610206089216,
  { acknowledge: true },
  'ru.kopa.model.Predlozhenie.id13.rebalance',
  [],
  { totalZa: 2,
    totalProtiv: 0,
    GOLOS: '35',
    action: 'add',
    value: 1 } ]
[2016-10-19 18:00:30.349] [DEBUG] Server - #promiseModel() [] { model: 'Golos', id: 35 }
[2016-10-19 18:00:30.360] [INFO] console - Executing (0943bf89-65f0-47a0-b2f1-3b1a089ddc29): START TRANSACTION;
[2016-10-19 18:00:30.362] [INFO] console - Executing (df845358-8936-4be3-a068-66cd9ee791b2): START TRANSACTION;
[2016-10-19 18:00:30.366] [INFO] console - Executing (0943bf89-65f0-47a0-b2f1-3b1a089ddc29): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 18:00:30.372] [INFO] console - Executing (df845358-8936-4be3-a068-66cd9ee791b2): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 18:00:30.389] [INFO] console - Executing (default): SELECT "Golos"."id", "Golos"."value", "Golos"."reason", "Golos"."note", "Golos"."created_at", "Golos"."updated_at", "Golos"."deleted_at", "Golos"."subject_id", "Golos"."owner_id", "Golos"."parent_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Golos" AS "Golos" LEFT OUTER JOIN "File" AS "attachments" ON "Golos"."id" = "attachments"."golos_id" AND "attachments"."deleted_at" IS NULL WHERE ("Golos"."deleted_at" IS NULL AND "Golos"."id" = 35);
[2016-10-19 18:00:30.431] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 18:00:30.447] [INFO] console - Executing (0943bf89-65f0-47a0-b2f1-3b1a089ddc29): COMMIT;
[2016-10-19 18:00:30.464] [INFO] console - Executing (default): SELECT "id", "value", "totalZa", "totalProtiv", "state", "note", "created_at", "updated_at", "deleted_at", "author_id", "place_id" FROM "Predlozhenie" AS "Predlozhenie" WHERE ("Predlozhenie"."deleted_at" IS NULL AND "Predlozhenie"."id" = 13);
[2016-10-19 18:00:30.470] [INFO] console - [ 70,
  178,
  {},
  [ { id: '35',
      value: 1,
      reason: null,
      note: null,
      created_at: Wed Oct 19 2016 18:00:30 GMT+0500 (YEKT),
      updated_at: Wed Oct 19 2016 18:00:30 GMT+0500 (YEKT),
      deleted_at: null,
      subject_id: '13',
      owner_id: '2',
      parent_id: null,
      attachments: [] } ] ]
[2016-10-19 18:00:30.495] [INFO] console - Executing (default): SELECT "id", "question", "invited", "note", "created_at", "updated_at", "deleted_at", "place_id", "inviter_id" FROM "Kopa" AS "Kopa" WHERE ("Kopa"."deleted_at" IS NULL AND "Kopa"."id" = '3');
[2016-10-19 18:00:30.510] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 18:00:30.525] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 18:00:30.534] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 18:00:30.548] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 18:00:30.589] [INFO] console - Executing (default): SELECT "id", "value", "reason", "note", "created_at", "updated_at", "deleted_at", "subject_id", "owner_id", "parent_id" FROM "Golos" AS "Golos" WHERE ("Golos"."deleted_at" IS NULL AND ("Golos"."subject_id" = '13' AND "Golos"."owner_id" = '2')) LIMIT 1;
[2016-10-19 18:00:30.614] [INFO] console - Executing (default): delete from "Golos" 
                            where
                                subject_id= 13
                                and (
                                    id= 35
                                    or parent_id = 35
                                )
[2016-10-19 18:00:30.629] [INFO] console - Executing (default): select
                            (select count(*) from "Golos" g where subject_id= 13 and value=1) "za",
                            (select count(*) from "Golos" g where subject_id= 13 and value=-1) "protiv"
[2016-10-19 18:00:30.667] [INFO] console - Executing (default): UPDATE "Predlozhenie" SET "totalZa"=0,"updated_at"='2016-10-19 13:00:30.646 +00:00' WHERE "id" = '13'
[2016-10-19 18:00:30.674] [INFO] console - Executing (df845358-8936-4be3-a068-66cd9ee791b2): COMMIT;
[2016-10-19 18:00:30.678] [INFO] console - [ 70, 179, {}, [ undefined ] ]
[2016-10-19 18:00:30.688] [INFO] console - [ 16,
  1630869164916736,
  { acknowledge: true },
  'ru.kopa.model.Predlozhenie.id13.rebalance',
  [],
  { totalZa: 0,
    totalProtiv: 0,
    GOLOS: '35',
    action: 'remove',
    value: 1 } ]
[2016-10-19 18:00:54.733] [INFO] console - [ 70, 181, {}, [ undefined ] ]
[2016-10-19 18:00:54.772] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 2 }
[2016-10-19 18:00:54.905] [INFO] console - Executing (default): delete from "Kopnik"
                where
                    name like '%temp'
                    or name like 'temp%'
[2016-10-19 18:00:54.914] [INFO] console - Executing (00695d1e-04f5-4c16-b52d-91217127d9e5): START TRANSACTION;
[2016-10-19 18:00:54.929] [INFO] console - Executing (00695d1e-04f5-4c16-b52d-91217127d9e5): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 18:00:54.960] [INFO] console - Executing (default): update "Kopnik"
                set 
                    "voiskoSize"= case when id=2 then 1 ELSE 0 END
                where
                    id>1 
                    and id<=5
[2016-10-19 18:00:55.062] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 18:00:55.131] [INFO] console - Executing (00695d1e-04f5-4c16-b52d-91217127d9e5): COMMIT;
[2016-10-19 18:00:55.157] [INFO] console - [ 70,
  182,
  {},
  [ { fullName: 'Unit Test',
      fullPath: '/2/',
      id: '2',
      email: 'unittest2@domain.ru',
      name: 'Unit',
      surname: 'Test',
      patronymic: '1',
      voiskoSize: 1,
      birth: 1983,
      path: '/',
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: null,
      attachments: [] } ] ]
[2016-10-19 18:00:55.270] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."starshina_id" = 2) ORDER BY "Kopnik"."surname" asc, "Kopnik"."name" asc, "Kopnik"."patronymic" asc;
[2016-10-19 18:00:55.283] [INFO] console - [ 70, 183, {}, [ [ [Object], [Object] ] ] ]
[2016-10-19 18:00:55.413] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 18:00:55.429] [INFO] console - Executing (d087ba1b-b3c4-4059-a700-362b4538e74f): START TRANSACTION;
[2016-10-19 18:00:55.445] [INFO] console - Executing (d087ba1b-b3c4-4059-a700-362b4538e74f): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 18:00:55.520] [INFO] console - Executing (d087ba1b-b3c4-4059-a700-362b4538e74f): INSERT INTO "Kopnik" ("id","name","surname","patronymic","voiskoSize","birth","path","created_at","updated_at","dom_id","starshina_id") VALUES (DEFAULT,'temp','temp','temp',0,1900,'/','2016-10-19 13:00:55.468 +00:00','2016-10-19 13:00:55.468 +00:00',2,NULL) RETURNING *;
[2016-10-19 18:00:55.553] [INFO] console - Executing (d087ba1b-b3c4-4059-a700-362b4538e74f): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 18:00:55.593] [INFO] console - Executing (d087ba1b-b3c4-4059-a700-362b4538e74f): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 18:00:55.602] [INFO] console - Executing (d087ba1b-b3c4-4059-a700-362b4538e74f): update "Zemla"
                                    set "obshinaSize"= "obshinaSize"+ 1
                                where
                                    '/1/' like path||id||'/%'
                                    or (
                                        true 
                                        and id= 2
                                    )
[2016-10-19 18:00:55.609] [INFO] console - Executing (d087ba1b-b3c4-4059-a700-362b4538e74f): COMMIT;
[2016-10-19 18:00:55.612] [INFO] console - [ 70, 184, {}, [ '27' ] ]
[2016-10-19 18:00:55.642] [INFO] console - Executing (b9e27bf6-d05a-460b-81d2-21ebfe5de447): START TRANSACTION;
[2016-10-19 18:00:55.651] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 18:00:55.709] [INFO] console - Executing (b9e27bf6-d05a-460b-81d2-21ebfe5de447): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 18:00:55.725] [INFO] console - Executing (default): select z.*
                                    from "Zemla" as z
                                where
                                    '/1/' like z.path||z.id||'/%'
[2016-10-19 18:00:55.735] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 27);
[2016-10-19 18:00:55.756] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" IN ('1')) ORDER BY "Zemla"."path" desc;
[2016-10-19 18:00:55.760] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 18:00:55.770] [INFO] console - [ 16,
  8133656480579584,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id2.obshinaChange',
  [],
  { obshinaSize: 25 } ]
[2016-10-19 18:00:55.780] [INFO] console - [ 16,
  6873535041503232,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id1.obshinaChange',
  [],
  { obshinaSize: 27 } ]
[2016-10-19 18:00:55.789] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 18:00:55.804] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 18:00:55.813] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 18:00:55.831] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='2',"updated_at"='2016-10-19 13:00:55.818 +00:00' WHERE "id" = '27'
[2016-10-19 18:00:55.860] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/', '/2/')
                                where
                                    id = '27'
                                    or path like '/27/'||'%'
[2016-10-19 18:00:55.885] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 18:00:56.012] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 18:00:56.193] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 18:00:56.210] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/2/27/'||'%'
[2016-10-19 18:00:56.357] [INFO] console - Executing (b9e27bf6-d05a-460b-81d2-21ebfe5de447): COMMIT;
[2016-10-19 18:00:56.377] [INFO] console - [ 70, 185, {}, [ undefined ] ]
[2016-10-19 18:00:56.419] [INFO] console - [ 16,
  5401455575957504,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 2 } ]
[2016-10-19 18:00:56.570] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 18:00:56.635] [INFO] console - Executing (9e6dd9a0-41ad-4f6c-8a34-7eb07a16b284): START TRANSACTION;
[2016-10-19 18:00:56.656] [INFO] console - Executing (9e6dd9a0-41ad-4f6c-8a34-7eb07a16b284): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 18:00:56.704] [INFO] console - Executing (9e6dd9a0-41ad-4f6c-8a34-7eb07a16b284): INSERT INTO "Kopnik" ("id","name","surname","patronymic","voiskoSize","birth","path","created_at","updated_at","dom_id","starshina_id") VALUES (DEFAULT,'temp','temp','temp',0,1900,'/','2016-10-19 13:00:56.671 +00:00','2016-10-19 13:00:56.671 +00:00',2,NULL) RETURNING *;
[2016-10-19 18:00:56.714] [INFO] console - Executing (9e6dd9a0-41ad-4f6c-8a34-7eb07a16b284): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 18:00:56.730] [INFO] console - Executing (9e6dd9a0-41ad-4f6c-8a34-7eb07a16b284): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 18:00:56.758] [INFO] console - Executing (9e6dd9a0-41ad-4f6c-8a34-7eb07a16b284): update "Zemla"
                                    set "obshinaSize"= "obshinaSize"+ 1
                                where
                                    '/1/' like path||id||'/%'
                                    or (
                                        true 
                                        and id= 2
                                    )
[2016-10-19 18:00:56.781] [INFO] console - Executing (9e6dd9a0-41ad-4f6c-8a34-7eb07a16b284): COMMIT;
[2016-10-19 18:00:56.799] [INFO] console - [ 70, 186, {}, [ '28' ] ]
[2016-10-19 18:00:56.833] [INFO] console - Executing (92737345-c7d0-4148-8bf8-08d1fa069fbb): START TRANSACTION;
[2016-10-19 18:00:56.845] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 18:00:56.888] [INFO] console - Executing (92737345-c7d0-4148-8bf8-08d1fa069fbb): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 18:00:56.905] [INFO] console - Executing (default): select z.*
                                    from "Zemla" as z
                                where
                                    '/1/' like z.path||z.id||'/%'
[2016-10-19 18:00:56.974] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 28);
[2016-10-19 18:00:57.017] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" IN ('1')) ORDER BY "Zemla"."path" desc;
[2016-10-19 18:00:57.039] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 27);
[2016-10-19 18:00:57.042] [INFO] console - [ 16,
  8008721527472128,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id2.obshinaChange',
  [],
  { obshinaSize: 26 } ]
[2016-10-19 18:00:57.079] [INFO] console - [ 16,
  1621821008904192,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id1.obshinaChange',
  [],
  { obshinaSize: 28 } ]
[2016-10-19 18:00:57.115] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 18:00:57.167] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 18:00:57.176] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 18:00:57.196] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='27',"updated_at"='2016-10-19 13:00:57.181 +00:00' WHERE "id" = '28'
[2016-10-19 18:00:57.214] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/', '/2/27/')
                                where
                                    id = '28'
                                    or path like '/28/'||'%'
[2016-10-19 18:00:57.228] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/2/27/' like path||id||'/%'
[2016-10-19 18:00:57.236] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/27/' like k.path||k.id||'/%'
[2016-10-19 18:00:57.295] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('27', '2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 18:00:57.315] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/2/27/28/'||'%'
[2016-10-19 18:00:57.326] [INFO] console - Executing (92737345-c7d0-4148-8bf8-08d1fa069fbb): COMMIT;
[2016-10-19 18:00:57.334] [INFO] console - [ 70, 187, {}, [ undefined ] ]
[2016-10-19 18:00:57.343] [INFO] console - [ 16,
  2407055468003328,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id27.voiskoChange',
  [],
  { voiskoSize: 1 } ]
[2016-10-19 18:00:57.360] [INFO] console - [ 16,
  3140195803201536,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 3 } ]
[2016-10-19 18:00:57.384] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 4 }
[2016-10-19 18:00:57.394] [INFO] console - Executing (d2c8a23b-515f-4a1e-ac92-95e39b7167e5): START TRANSACTION;
[2016-10-19 18:00:57.398] [INFO] console - Executing (d2c8a23b-515f-4a1e-ac92-95e39b7167e5): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 18:00:57.417] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 4);
[2016-10-19 18:00:57.429] [INFO] console - Executing (d2c8a23b-515f-4a1e-ac92-95e39b7167e5): COMMIT;
[2016-10-19 18:00:57.431] [INFO] console - [ 70,
  188,
  {},
  [ { fullName: 'Unit Test',
      fullPath: '/4/',
      id: '4',
      email: 'unittest4@domain.ru',
      name: 'Unit',
      surname: 'Test',
      patronymic: '4',
      voiskoSize: 0,
      birth: 1983,
      path: '/',
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: null,
      attachments: [] } ] ]
[2016-10-19 18:00:57.468] [INFO] console - Executing (9bc055e3-34f6-4569-bddc-ae33ecd66706): START TRANSACTION;
[2016-10-19 18:00:57.473] [INFO] console - Executing (9bc055e3-34f6-4569-bddc-ae33ecd66706): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 18:00:57.486] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 27);
[2016-10-19 18:00:57.501] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 4);
[2016-10-19 18:00:57.513] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 18:00:57.533] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 18:00:57.542] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-2
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 18:00:57.555] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='4',"updated_at"='2016-10-19 13:00:57.545 +00:00' WHERE "id" = '27'
[2016-10-19 18:00:57.584] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/2/', '/4/')
                                where
                                    id = '27'
                                    or path like '/2/27/'||'%'
[2016-10-19 18:00:57.597] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+2
                                where
                                    '/4/' like path||id||'/%'
[2016-10-19 18:00:57.605] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/4/' like k.path||k.id||'/%'
[2016-10-19 18:00:57.641] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('4')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 18:00:57.653] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/4/27/'||'%'
[2016-10-19 18:00:57.660] [INFO] console - Executing (9bc055e3-34f6-4569-bddc-ae33ecd66706): COMMIT;
[2016-10-19 18:00:57.666] [INFO] console - [ 70, 189, {}, [ undefined ] ]
[2016-10-19 18:00:57.671] [INFO] console - [ 16,
  6258347806294016,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 1 } ]
[2016-10-19 18:00:57.693] [INFO] console - [ 16,
  3889023869255680,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id4.voiskoChange',
  [],
  { voiskoSize: 2 } ]
[2016-10-19 18:00:57.721] [INFO] console - [ 16,
  7374395563573248,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id28.starshinaChange',
  [],
  {} ]
[2016-10-19 18:00:57.745] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 28 }
[2016-10-19 18:00:57.753] [INFO] console - Executing (00d7e7ec-5e98-46d1-92c4-ac1e24ced64b): START TRANSACTION;
[2016-10-19 18:00:57.760] [INFO] console - Executing (00d7e7ec-5e98-46d1-92c4-ac1e24ced64b): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 18:00:57.785] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 28);
[2016-10-19 18:00:57.802] [INFO] console - Executing (00d7e7ec-5e98-46d1-92c4-ac1e24ced64b): COMMIT;
[2016-10-19 18:00:57.805] [INFO] console - [ 70,
  190,
  {},
  [ { fullName: 'temp temp',
      fullPath: '/4/27/28/',
      id: '28',
      email: null,
      name: 'temp',
      surname: 'temp',
      patronymic: 'temp',
      voiskoSize: 0,
      birth: 1900,
      path: '/4/27/',
      note: null,
      created_at: Wed Oct 19 2016 18:00:56 GMT+0500 (YEKT),
      updated_at: Wed Oct 19 2016 18:00:57 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: '27',
      attachments: [] } ] ]
[2016-10-19 18:00:57.843] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 27 }
[2016-10-19 18:00:57.849] [INFO] console - Executing (5caf5ddd-6f25-4257-aa47-70c504006d2f): START TRANSACTION;
[2016-10-19 18:00:57.854] [INFO] console - Executing (5caf5ddd-6f25-4257-aa47-70c504006d2f): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 18:00:57.874] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 27);
[2016-10-19 18:00:57.892] [INFO] console - Executing (5caf5ddd-6f25-4257-aa47-70c504006d2f): COMMIT;
[2016-10-19 18:00:57.895] [INFO] console - [ 70,
  191,
  {},
  [ { fullName: 'temp temp',
      fullPath: '/4/27/',
      id: '27',
      email: null,
      name: 'temp',
      surname: 'temp',
      patronymic: 'temp',
      voiskoSize: 1,
      birth: 1900,
      path: '/4/',
      note: null,
      created_at: Wed Oct 19 2016 18:00:55 GMT+0500 (YEKT),
      updated_at: Wed Oct 19 2016 18:00:57 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: '4',
      attachments: [] } ] ]
[2016-10-19 18:00:57.921] [DEBUG] Server - #promiseModel() [] { model: 'Kopa', id: 3 }
[2016-10-19 18:00:57.926] [INFO] console - Executing (0758a576-e7b4-4272-b4b8-a6dbba470183): START TRANSACTION;
[2016-10-19 18:00:57.932] [INFO] console - Executing (0758a576-e7b4-4272-b4b8-a6dbba470183): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 18:00:57.947] [INFO] console - Executing (default): SELECT "Kopa"."id", "Kopa"."question", "Kopa"."invited", "Kopa"."note", "Kopa"."created_at", "Kopa"."updated_at", "Kopa"."deleted_at", "Kopa"."place_id", "Kopa"."inviter_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopa" AS "Kopa" LEFT OUTER JOIN "File" AS "attachments" ON "Kopa"."id" = "attachments"."kopa_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopa"."deleted_at" IS NULL AND "Kopa"."id" = 3);
[2016-10-19 18:00:57.960] [INFO] console - Executing (0758a576-e7b4-4272-b4b8-a6dbba470183): COMMIT;
[2016-10-19 18:00:57.966] [INFO] console - [ 70,
  192,
  {},
  [ { id: '3',
      question: 'CHE',
      invited: Thu Sep 01 2016 00:00:00 GMT+0500 (YEKT),
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      place_id: '2',
      inviter_id: '2',
      attachments: [] } ] ]
[2016-10-19 18:00:58.031] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 18:00:58.041] [INFO] console - Executing (03d73d31-f785-45bb-8708-b55abcf62d5e): START TRANSACTION;
[2016-10-19 18:00:58.050] [INFO] console - Executing (03d73d31-f785-45bb-8708-b55abcf62d5e): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 18:00:58.109] [INFO] console - Executing (03d73d31-f785-45bb-8708-b55abcf62d5e): INSERT INTO "Predlozhenie" ("id","value","totalZa","totalProtiv","created_at","updated_at","author_id","place_id") VALUES (DEFAULT,'temp Wed Oct 19 2016 18:00:57 GMT+0500 (YEKT)',0,0,'2016-10-19 13:00:58.054 +00:00','2016-10-19 13:00:58.054 +00:00',2,3) RETURNING *;
[2016-10-19 18:00:58.119] [INFO] console - Executing (03d73d31-f785-45bb-8708-b55abcf62d5e): COMMIT;
[2016-10-19 18:00:58.126] [INFO] console - [ 70, 193, {}, [ '14' ] ]
[2016-10-19 18:00:58.133] [INFO] console - [ 16,
  5808269702463488,
  { acknowledge: true },
  'ru.kopa.model.Kopa.id3.predlozhenieAdd',
  [ '14' ] ]
[2016-10-19 18:00:58.171] [INFO] console - Executing (4c6fd095-fb9e-42c8-afeb-3b7cf4485975): START TRANSACTION;
[2016-10-19 18:00:58.176] [INFO] console - Executing (4c6fd095-fb9e-42c8-afeb-3b7cf4485975): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 18:00:58.200] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 18:00:58.237] [INFO] console - Executing (default): SELECT "id", "value", "totalZa", "totalProtiv", "state", "note", "created_at", "updated_at", "deleted_at", "author_id", "place_id" FROM "Predlozhenie" AS "Predlozhenie" WHERE ("Predlozhenie"."deleted_at" IS NULL AND "Predlozhenie"."id" = 14);
[2016-10-19 18:00:58.255] [INFO] console - Executing (default): SELECT "id", "question", "invited", "note", "created_at", "updated_at", "deleted_at", "place_id", "inviter_id" FROM "Kopa" AS "Kopa" WHERE ("Kopa"."deleted_at" IS NULL AND "Kopa"."id" = '3');
[2016-10-19 18:00:58.271] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 18:00:58.294] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 18:00:58.301] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 18:00:58.312] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 18:00:58.323] [INFO] console - Executing (default): SELECT "id", "value", "reason", "note", "created_at", "updated_at", "deleted_at", "subject_id", "owner_id", "parent_id" FROM "Golos" AS "Golos" WHERE ("Golos"."deleted_at" IS NULL AND ("Golos"."subject_id" = '14' AND "Golos"."owner_id" = '2')) LIMIT 1;
[2016-10-19 18:00:58.350] [INFO] console - Executing (default): INSERT INTO "Golos" ("id","value","created_at","updated_at","subject_id","owner_id") VALUES (DEFAULT,1,'2016-10-19 13:00:58.330 +00:00','2016-10-19 13:00:58.330 +00:00','14','2') RETURNING *;
[2016-10-19 18:00:58.362] [INFO] console - Executing (default): insert into "Golos" (subject_id, value, owner_id, parent_id, created_at, updated_at)
                            (
                                select 14, 1, k.id, 37, current_timestamp, current_timestamp
                                from 
                                    "Kopnik" k
                                     join "Zemla" d on d.id= k.dom_id
                                where
                                    k.path like '/2/%'
                                    and d.path||d.id||'/' like '/1/2/%' 
                            )
[2016-10-19 18:00:58.368] [INFO] console - Executing (default): select
                            (select count(*) from "Golos" g where subject_id= 14 and value=1) "za",
                            (select count(*) from "Golos" g where subject_id= 14 and value=-1) "protiv"
[2016-10-19 18:00:58.388] [INFO] console - Executing (default): UPDATE "Predlozhenie" SET "totalZa"=2,"updated_at"='2016-10-19 13:00:58.374 +00:00' WHERE "id" = '14'
[2016-10-19 18:00:58.406] [INFO] console - Executing (4c6fd095-fb9e-42c8-afeb-3b7cf4485975): COMMIT;
[2016-10-19 18:00:58.411] [INFO] console - [ 70, 194, {}, [ undefined ] ]
[2016-10-19 18:00:58.417] [INFO] console - [ 16,
  5143536794075136,
  { acknowledge: true },
  'ru.kopa.model.Predlozhenie.id14.rebalance',
  [],
  { totalZa: 2,
    totalProtiv: 0,
    GOLOS: '37',
    action: 'add',
    value: 1 } ]
[2016-10-19 18:00:58.431] [INFO] console - Executing (d5ec49dc-f476-40ca-99fd-28002e650c14): START TRANSACTION;
[2016-10-19 18:00:58.438] [INFO] console - Executing (d5ec49dc-f476-40ca-99fd-28002e650c14): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 18:00:58.443] [DEBUG] Server - #promiseModel() [] { model: 'Golos', id: 37 }
[2016-10-19 18:00:58.462] [INFO] console - Executing (bcf284e7-9f12-4016-9d29-fe1090cd934a): START TRANSACTION;
[2016-10-19 18:00:58.493] [INFO] console - Executing (bcf284e7-9f12-4016-9d29-fe1090cd934a): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 18:00:58.511] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 18:00:58.553] [INFO] console - Executing (default): SELECT "Golos"."id", "Golos"."value", "Golos"."reason", "Golos"."note", "Golos"."created_at", "Golos"."updated_at", "Golos"."deleted_at", "Golos"."subject_id", "Golos"."owner_id", "Golos"."parent_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Golos" AS "Golos" LEFT OUTER JOIN "File" AS "attachments" ON "Golos"."id" = "attachments"."golos_id" AND "attachments"."deleted_at" IS NULL WHERE ("Golos"."deleted_at" IS NULL AND "Golos"."id" = 37);
[2016-10-19 18:00:58.556] [INFO] console - Executing (default): SELECT "id", "value", "totalZa", "totalProtiv", "state", "note", "created_at", "updated_at", "deleted_at", "author_id", "place_id" FROM "Predlozhenie" AS "Predlozhenie" WHERE ("Predlozhenie"."deleted_at" IS NULL AND "Predlozhenie"."id" = 14);
[2016-10-19 18:00:58.574] [INFO] console - Executing (bcf284e7-9f12-4016-9d29-fe1090cd934a): COMMIT;
[2016-10-19 18:00:58.581] [INFO] console - Executing (default): SELECT "id", "question", "invited", "note", "created_at", "updated_at", "deleted_at", "place_id", "inviter_id" FROM "Kopa" AS "Kopa" WHERE ("Kopa"."deleted_at" IS NULL AND "Kopa"."id" = '3');
[2016-10-19 18:00:58.590] [INFO] console - [ 70,
  196,
  {},
  [ { id: '37',
      value: 1,
      reason: null,
      note: null,
      created_at: Wed Oct 19 2016 18:00:58 GMT+0500 (YEKT),
      updated_at: Wed Oct 19 2016 18:00:58 GMT+0500 (YEKT),
      deleted_at: null,
      subject_id: '14',
      owner_id: '2',
      parent_id: null,
      attachments: [] } ] ]
[2016-10-19 18:00:58.621] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 18:00:58.675] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 18:00:58.700] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 18:00:58.726] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 18:00:58.748] [INFO] console - Executing (default): SELECT "id", "value", "reason", "note", "created_at", "updated_at", "deleted_at", "subject_id", "owner_id", "parent_id" FROM "Golos" AS "Golos" WHERE ("Golos"."deleted_at" IS NULL AND ("Golos"."subject_id" = '14' AND "Golos"."owner_id" = '2')) LIMIT 1;
[2016-10-19 18:00:58.761] [INFO] console - Executing (default): delete from "Golos" 
                            where
                                subject_id= 14
                                and (
                                    id= 37
                                    or parent_id = 37
                                )
[2016-10-19 18:00:58.766] [INFO] console - Executing (default): select
                            (select count(*) from "Golos" g where subject_id= 14 and value=1) "za",
                            (select count(*) from "Golos" g where subject_id= 14 and value=-1) "protiv"
[2016-10-19 18:00:58.779] [INFO] console - Executing (default): UPDATE "Predlozhenie" SET "totalZa"=0,"updated_at"='2016-10-19 13:00:58.769 +00:00' WHERE "id" = '14'
[2016-10-19 18:00:58.787] [INFO] console - Executing (d5ec49dc-f476-40ca-99fd-28002e650c14): COMMIT;
[2016-10-19 18:00:58.791] [INFO] console - [ 70, 195, {}, [ undefined ] ]
[2016-10-19 18:00:58.800] [INFO] console - [ 16,
  6099856972054528,
  { acknowledge: true },
  'ru.kopa.model.Predlozhenie.id14.rebalance',
  [],
  { totalZa: 0,
    totalProtiv: 0,
    GOLOS: '37',
    action: 'remove',
    value: 1 } ]
[2016-10-19 18:01:26.416] [INFO] console - [ 70, 198, {}, [ undefined ] ]
[2016-10-19 18:01:26.488] [INFO] console - Executing (default): delete from "Kopnik"
                where
                    name like '%temp'
                    or name like 'temp%'
[2016-10-19 18:01:26.500] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."starshina_id" = 2) ORDER BY "Kopnik"."surname" asc, "Kopnik"."name" asc, "Kopnik"."patronymic" asc;
[2016-10-19 18:01:26.514] [INFO] console - Executing (default): update "Kopnik"
                set 
                    "voiskoSize"= case when id=2 then 1 ELSE 0 END
                where
                    id>1 
                    and id<=5
[2016-10-19 18:01:26.533] [INFO] console - [ 70, 199, {}, [ [ [Object], [Object] ] ] ]
[2016-10-19 18:01:41.437] [INFO] console - [ 70, 201, {}, [ undefined ] ]
[2016-10-19 18:01:41.515] [INFO] console - Executing (default): delete from "Kopnik"
                where
                    name like '%temp'
                    or name like 'temp%'
[2016-10-19 18:01:41.525] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."starshina_id" = 2) ORDER BY "Kopnik"."surname" asc, "Kopnik"."name" asc, "Kopnik"."patronymic" asc;
[2016-10-19 18:01:41.559] [INFO] console - Executing (default): update "Kopnik"
                set 
                    "voiskoSize"= case when id=2 then 1 ELSE 0 END
                where
                    id>1 
                    and id<=5
[2016-10-19 18:01:41.570] [INFO] console - [ 70, 202, {}, [ [ [Object], [Object] ] ] ]
[2016-10-19 18:33:11.961] [INFO] console - AutobahnJS debug enabled
[2016-10-19 18:33:16.646] [INFO] Server - starting...
[2016-10-19 18:33:16.649] [INFO] console - trying to create WAMP transport of type: websocket
[2016-10-19 18:33:16.777] [INFO] console - using WAMP transport type: websocket
[2016-10-19 18:33:17.504] [INFO] console - [ 1,
  'kopa',
  { roles: 
     { caller: [Object],
       callee: [Object],
       publisher: [Object],
       subscriber: [Object] },
    authmethods: [ 'ticket' ],
    authid: 'server' } ]
[2016-10-19 18:33:17.536] [INFO] console - [ 5, 'server', {} ]
[2016-10-19 18:33:17.607] [INFO] Server - connection.onopen()
[2016-10-19 18:33:17.609] [INFO] console - [ 64, 3797277548216320, {}, 'ru.kopa.model.create' ]
[2016-10-19 18:33:17.621] [DEBUG] Server - api:model.create registered
[2016-10-19 18:33:17.623] [INFO] console - [ 64, 8584941145161728, {}, 'ru.kopa.model.get' ]
[2016-10-19 18:33:17.630] [DEBUG] Server - api:model.get registered
[2016-10-19 18:33:17.633] [INFO] console - [ 64, 8928157572792320, {}, 'ru.kopa.model.save' ]
[2016-10-19 18:33:17.643] [DEBUG] Server - api:model.save registered
[2016-10-19 18:33:17.647] [INFO] console - [ 64, 7185405952655360, {}, 'ru.kopa.pingPong' ]
[2016-10-19 18:33:17.655] [DEBUG] Server - api:pingPong registered
[2016-10-19 18:33:17.657] [INFO] console - [ 64, 3720344217059328, {}, 'ru.kopa.discloseCaller' ]
[2016-10-19 18:33:17.664] [DEBUG] Server - api:discloseCaller registered
[2016-10-19 18:33:17.666] [INFO] console - [ 64, 5467103509348352, {}, 'ru.kopa.pingPongDatabase' ]
[2016-10-19 18:33:17.671] [DEBUG] Server - api:pingPongDatabase registered
[2016-10-19 18:33:17.672] [INFO] console - [ 64, 4638911007555584, {}, 'ru.kopa.error' ]
[2016-10-19 18:33:17.679] [DEBUG] Server - api:error registered
[2016-10-19 18:33:17.680] [INFO] console - [ 64, 6866211948199936, {}, 'ru.kopa.unitTest.cleanTempData' ]
[2016-10-19 18:33:17.687] [DEBUG] Server - api:unitTest.cleanTempData registered
[2016-10-19 18:33:17.690] [INFO] console - [ 64, 3797924584620032, {}, 'ru.kopa.model.Kopnik.setStarshina' ]
[2016-10-19 18:33:17.697] [DEBUG] Server - api:model.Kopnik.setStarshina registered
[2016-10-19 18:33:17.697] [INFO] console - [ 64, 6645802973790208, {}, 'ru.kopa.model.Kopnik.getDruzhina' ]
[2016-10-19 18:33:17.706] [DEBUG] Server - api:model.Kopnik.getDruzhina registered
[2016-10-19 18:33:17.708] [INFO] console - [ 64, 4950822016253952, {}, 'ru.kopa.model.Kopnik.vote' ]
[2016-10-19 18:33:17.716] [DEBUG] Server - api:model.Kopnik.vote registered
[2016-10-19 18:33:17.724] [INFO] console - [ 64, 5234082780807168, {}, 'ru.kopa.model.Kopa.invite' ]
[2016-10-19 18:33:17.730] [DEBUG] Server - api:model.Kopa.invite registered
[2016-10-19 18:33:17.731] [INFO] console - [ 64, 1535474107678720, {}, 'ru.kopa.model.Kopa.getDialog' ]
[2016-10-19 18:33:17.739] [DEBUG] Server - api:model.Kopa.getDialog registered
[2016-10-19 18:33:17.740] [INFO] console - [ 64, 2185945814138880, {}, 'ru.kopa.model.Kopa.getResult' ]
[2016-10-19 18:33:17.747] [DEBUG] Server - api:model.Kopa.getResult registered
[2016-10-19 18:33:17.748] [INFO] console - [ 64, 7105198277263360, {}, 'ru.kopa.model.Zemla.setParent' ]
[2016-10-19 18:33:17.757] [DEBUG] Server - api:model.Zemla.setParent registered
[2016-10-19 18:33:17.758] [INFO] console - [ 64, 7658056087240704, {}, 'ru.kopa.model.Zemla.promiseKopi' ]
[2016-10-19 18:33:17.765] [DEBUG] Server - api:model.Zemla.promiseKopi registered
[2016-10-19 18:33:17.765] [INFO] console - [ 64,
  7680380618407936,
  {},
  'ru.kopa.model.Predlozhenie.getGolosa' ]
[2016-10-19 18:33:17.772] [DEBUG] Server - api:model.Predlozhenie.getGolosa registered
[2016-10-19 18:33:17.773] [INFO] console - [ 64, 4461764064313344, {}, 'ru.kopa.unitTest.orderProc' ]
[2016-10-19 18:33:17.779] [DEBUG] Server - api:unitTest.orderProc registered
[2016-10-19 18:33:17.782] [INFO] Server - started
[2016-10-19 19:01:56.080] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 2 }
[2016-10-19 19:01:56.408] [INFO] console - Executing (491d4231-30a2-4281-b016-50fff0aa2daa): START TRANSACTION;
[2016-10-19 19:01:56.414] [INFO] console - Executing (491d4231-30a2-4281-b016-50fff0aa2daa): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:01:56.467] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 19:01:56.503] [INFO] console - Executing (491d4231-30a2-4281-b016-50fff0aa2daa): COMMIT;
[2016-10-19 19:01:56.508] [INFO] console - [ 70,
  205,
  {},
  [ { fullName: 'Unit Test',
      fullPath: '/2/',
      id: '2',
      email: 'unittest2@domain.ru',
      name: 'Unit',
      surname: 'Test',
      patronymic: '1',
      voiskoSize: 1,
      birth: 1983,
      path: '/',
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: null,
      attachments: [] } ] ]
[2016-10-19 19:01:56.579] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 3 }
[2016-10-19 19:01:56.593] [INFO] console - Executing (3d5a0153-ef18-4c74-b339-ce75dfa99599): START TRANSACTION;
[2016-10-19 19:01:56.597] [INFO] console - Executing (3d5a0153-ef18-4c74-b339-ce75dfa99599): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:01:56.621] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 3);
[2016-10-19 19:01:56.645] [INFO] console - Executing (3d5a0153-ef18-4c74-b339-ce75dfa99599): COMMIT;
[2016-10-19 19:01:56.648] [INFO] console - [ 70,
  206,
  {},
  [ { fullName: 'Unit Test',
      fullPath: '/2/3/',
      id: '3',
      email: 'unittest3@domain.ru',
      name: 'Unit',
      surname: 'Test',
      patronymic: '3',
      voiskoSize: 0,
      birth: 1983,
      path: '/2/',
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: '2',
      attachments: [] } ] ]
[2016-10-19 19:01:56.721] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 19:01:56.733] [INFO] console - Executing (41ba685f-7d46-4a95-bbfc-dc79712dde1f): START TRANSACTION;
[2016-10-19 19:01:56.737] [INFO] console - Executing (41ba685f-7d46-4a95-bbfc-dc79712dde1f): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:01:56.760] [INFO] console - Executing (41ba685f-7d46-4a95-bbfc-dc79712dde1f): INSERT INTO "Slovo" ("id","value","note","created_at","updated_at","owner_id","place_id") VALUES (DEFAULT,'123 temp','456','2016-10-19 14:01:56.743 +00:00','2016-10-19 14:01:56.743 +00:00',2,3) RETURNING *;
[2016-10-19 19:01:56.782] [INFO] console - Executing (41ba685f-7d46-4a95-bbfc-dc79712dde1f): COMMIT;
[2016-10-19 19:01:56.794] [INFO] console - [ 70, 207, {}, [ '4' ] ]
[2016-10-19 19:01:56.804] [INFO] console - [ 16,
  1881170881019904,
  { acknowledge: true },
  'ru.kopa.model.Kopa.id3.slovoAdd',
  [ '4' ] ]
[2016-10-19 19:01:56.818] [DEBUG] Server - #promiseModel() [] { model: 'Slovo', id: 4 }
[2016-10-19 19:01:56.826] [INFO] console - Executing (ca866c7c-57a6-448e-a482-368129e291a6): START TRANSACTION;
[2016-10-19 19:01:56.835] [INFO] console - Executing (ca866c7c-57a6-448e-a482-368129e291a6): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:01:56.903] [INFO] console - Executing (default): SELECT "Slovo"."id", "Slovo"."value", "Slovo"."note", "Slovo"."created_at", "Slovo"."updated_at", "Slovo"."deleted_at", "Slovo"."owner_id", "Slovo"."place_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Slovo" AS "Slovo" LEFT OUTER JOIN "File" AS "attachments" ON "Slovo"."id" = "attachments"."slovo_id" AND "attachments"."deleted_at" IS NULL WHERE ("Slovo"."deleted_at" IS NULL AND "Slovo"."id" = 4);
[2016-10-19 19:01:56.924] [INFO] console - Executing (ca866c7c-57a6-448e-a482-368129e291a6): COMMIT;
[2016-10-19 19:01:56.929] [INFO] console - [ 70,
  208,
  {},
  [ { id: '4',
      value: '123 temp',
      note: '456',
      created_at: Wed Oct 19 2016 19:01:56 GMT+0500 (YEKT),
      updated_at: Wed Oct 19 2016 19:01:56 GMT+0500 (YEKT),
      deleted_at: null,
      owner_id: '2',
      place_id: '3',
      attachments: [] } ] ]
[2016-10-19 19:01:56.972] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 19:01:56.983] [INFO] console - Executing (1e2bcfb6-9592-4aab-ab01-b4108734f293): START TRANSACTION;
[2016-10-19 19:01:56.987] [INFO] console - Executing (1e2bcfb6-9592-4aab-ab01-b4108734f293): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:01:57.008] [INFO] console - Executing (1e2bcfb6-9592-4aab-ab01-b4108734f293): INSERT INTO "Slovo" ("id","value","created_at","updated_at","owner_id","place_id") VALUES (DEFAULT,'temp 1476885716951','2016-10-19 14:01:56.991 +00:00','2016-10-19 14:01:56.991 +00:00',2,3) RETURNING *;
[2016-10-19 19:01:57.024] [INFO] console - Executing (1e2bcfb6-9592-4aab-ab01-b4108734f293): COMMIT;
[2016-10-19 19:01:57.028] [INFO] console - [ 70, 209, {}, [ '5' ] ]
[2016-10-19 19:01:57.040] [INFO] console - [ 16,
  6672751093874688,
  { acknowledge: true },
  'ru.kopa.model.Kopa.id3.slovoAdd',
  [ '5' ] ]
[2016-10-19 19:01:57.058] [DEBUG] Server - #promiseModel() [] { model: 'Zemla', id: 2 }
[2016-10-19 19:01:57.073] [INFO] console - Executing (f79936ff-5440-4563-ab78-5be45a3a9f9f): START TRANSACTION;
[2016-10-19 19:01:57.085] [INFO] console - Executing (f79936ff-5440-4563-ab78-5be45a3a9f9f): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:01:57.146] [INFO] console - Executing (default): SELECT "Zemla"."id", "Zemla"."name", "Zemla"."intensity", "Zemla"."obshinaSize", "Zemla"."path", "Zemla"."note", "Zemla"."created_at", "Zemla"."updated_at", "Zemla"."deleted_at", "Zemla"."parent_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Zemla" AS "Zemla" LEFT OUTER JOIN "File" AS "attachments" ON "Zemla"."id" = "attachments"."zemla_id" AND "attachments"."deleted_at" IS NULL WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = 2);
[2016-10-19 19:01:57.160] [INFO] console - Executing (f79936ff-5440-4563-ab78-5be45a3a9f9f): COMMIT;
[2016-10-19 19:01:57.164] [INFO] console - [ 70,
  210,
  {},
  [ { fullPath: '/1/2/',
      id: '2',
      name: 'UnitTest2',
      intensity: 1000,
      obshinaSize: 26,
      path: '/1/',
      note: null,
      created_at: Mon Oct 10 2016 17:44:10 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:10 GMT+0500 (YEKT),
      deleted_at: null,
      parent_id: '1',
      attachments: [] } ] ]
[2016-10-19 19:01:57.212] [INFO] console - Executing (5eed46b1-26d8-476a-94b8-5b7e43f953ad): START TRANSACTION;
[2016-10-19 19:01:57.225] [INFO] console - Executing (5eed46b1-26d8-476a-94b8-5b7e43f953ad): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:01:57.236] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = 2);
[2016-10-19 19:01:57.275] [INFO] console - Executing (default): UPDATE "Zemla" SET "parent_id"=1,"note"='unit test 1476885715089',"updated_at"='2016-10-19 14:01:57.244 +00:00' WHERE "id" = '2'
[2016-10-19 19:01:57.325] [INFO] console - Executing (5eed46b1-26d8-476a-94b8-5b7e43f953ad): COMMIT;
[2016-10-19 19:01:57.328] [INFO] console - [ 16,
  526225455972352,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id2.change' ]
[2016-10-19 19:01:57.342] [INFO] console - [ 70, 211, {}, [ undefined ] ]
[2016-10-19 19:01:57.363] [DEBUG] Server - #promiseModel() [] { model: 'Zemla', id: 2 }
[2016-10-19 19:01:57.395] [INFO] console - Executing (04954150-587b-45e8-9da6-553f79fc3dc5): START TRANSACTION;
[2016-10-19 19:01:57.405] [DEBUG] Server - #promiseModel() [] { model: 'Zemla', id: 2 }
[2016-10-19 19:01:57.423] [INFO] console - Executing (0527c4c6-070d-409a-9039-b6720bd7b2b2): START TRANSACTION;
[2016-10-19 19:01:57.426] [INFO] console - Executing (04954150-587b-45e8-9da6-553f79fc3dc5): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:01:57.450] [INFO] console - Executing (0527c4c6-070d-409a-9039-b6720bd7b2b2): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:01:57.581] [INFO] console - Executing (default): SELECT "Zemla"."id", "Zemla"."name", "Zemla"."intensity", "Zemla"."obshinaSize", "Zemla"."path", "Zemla"."note", "Zemla"."created_at", "Zemla"."updated_at", "Zemla"."deleted_at", "Zemla"."parent_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Zemla" AS "Zemla" LEFT OUTER JOIN "File" AS "attachments" ON "Zemla"."id" = "attachments"."zemla_id" AND "attachments"."deleted_at" IS NULL WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = 2);
[2016-10-19 19:01:57.616] [INFO] console - Executing (default): SELECT "Zemla"."id", "Zemla"."name", "Zemla"."intensity", "Zemla"."obshinaSize", "Zemla"."path", "Zemla"."note", "Zemla"."created_at", "Zemla"."updated_at", "Zemla"."deleted_at", "Zemla"."parent_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Zemla" AS "Zemla" LEFT OUTER JOIN "File" AS "attachments" ON "Zemla"."id" = "attachments"."zemla_id" AND "attachments"."deleted_at" IS NULL WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = 2);
[2016-10-19 19:01:57.628] [INFO] console - Executing (04954150-587b-45e8-9da6-553f79fc3dc5): COMMIT;
[2016-10-19 19:01:57.640] [INFO] console - Executing (0527c4c6-070d-409a-9039-b6720bd7b2b2): COMMIT;
[2016-10-19 19:01:57.643] [INFO] console - [ 70,
  212,
  {},
  [ { fullPath: '/1/2/',
      id: '2',
      name: 'UnitTest2',
      intensity: 1000,
      obshinaSize: 26,
      path: '/1/',
      note: 'unit test 1476885715089',
      created_at: Mon Oct 10 2016 17:44:10 GMT+0500 (YEKT),
      updated_at: Wed Oct 19 2016 19:01:57 GMT+0500 (YEKT),
      deleted_at: null,
      parent_id: '1',
      attachments: [] } ] ]
[2016-10-19 19:01:57.657] [INFO] console - [ 70,
  213,
  {},
  [ { fullPath: '/1/2/',
      id: '2',
      name: 'UnitTest2',
      intensity: 1000,
      obshinaSize: 26,
      path: '/1/',
      note: 'unit test 1476885715089',
      created_at: Mon Oct 10 2016 17:44:10 GMT+0500 (YEKT),
      updated_at: Wed Oct 19 2016 19:01:57 GMT+0500 (YEKT),
      deleted_at: null,
      parent_id: '1',
      attachments: [] } ] ]
[2016-10-19 19:17:09.465] [INFO] console - AutobahnJS debug enabled
[2016-10-19 19:17:12.744] [INFO] Server - starting...
[2016-10-19 19:17:12.746] [INFO] console - trying to create WAMP transport of type: websocket
[2016-10-19 19:17:12.906] [INFO] console - using WAMP transport type: websocket
[2016-10-19 19:17:13.940] [INFO] console - [ 1,
  'kopa',
  { roles: 
     { caller: [Object],
       callee: [Object],
       publisher: [Object],
       subscriber: [Object] },
    authmethods: [ 'ticket' ],
    authid: 'server' } ]
[2016-10-19 19:17:14.054] [INFO] console - [ 5, 'server', {} ]
[2016-10-19 19:17:14.191] [INFO] Server - connection.onopen()
[2016-10-19 19:17:14.193] [INFO] console - [ 64, 960315489517568, {}, 'ru.kopa.model.create' ]
[2016-10-19 19:17:14.205] [DEBUG] Server - api:model.create registered
[2016-10-19 19:17:14.210] [INFO] console - [ 64, 4281576391180288, {}, 'ru.kopa.model.get' ]
[2016-10-19 19:17:14.226] [DEBUG] Server - api:model.get registered
[2016-10-19 19:17:14.230] [INFO] console - [ 64, 5649408228065280, {}, 'ru.kopa.model.save' ]
[2016-10-19 19:17:14.239] [DEBUG] Server - api:model.save registered
[2016-10-19 19:17:14.241] [INFO] console - [ 64, 3867097595641856, {}, 'ru.kopa.pingPong' ]
[2016-10-19 19:17:14.247] [DEBUG] Server - api:pingPong registered
[2016-10-19 19:17:14.249] [INFO] console - [ 64, 2549496164646912, {}, 'ru.kopa.discloseCaller' ]
[2016-10-19 19:17:14.257] [DEBUG] Server - api:discloseCaller registered
[2016-10-19 19:17:14.258] [INFO] console - [ 64, 8015984115843072, {}, 'ru.kopa.pingPongDatabase' ]
[2016-10-19 19:17:14.265] [DEBUG] Server - api:pingPongDatabase registered
[2016-10-19 19:17:14.266] [INFO] console - [ 64, 3489989578981376, {}, 'ru.kopa.error' ]
[2016-10-19 19:17:14.273] [DEBUG] Server - api:error registered
[2016-10-19 19:17:14.274] [INFO] console - [ 64, 199851348328448, {}, 'ru.kopa.unitTest.cleanTempData' ]
[2016-10-19 19:17:14.290] [DEBUG] Server - api:unitTest.cleanTempData registered
[2016-10-19 19:17:14.291] [INFO] console - [ 64, 77900434898944, {}, 'ru.kopa.model.Kopnik.setStarshina' ]
[2016-10-19 19:17:14.298] [DEBUG] Server - api:model.Kopnik.setStarshina registered
[2016-10-19 19:17:14.299] [INFO] console - [ 64, 3517674386620416, {}, 'ru.kopa.model.Kopnik.getDruzhina' ]
[2016-10-19 19:17:14.306] [DEBUG] Server - api:model.Kopnik.getDruzhina registered
[2016-10-19 19:17:14.307] [INFO] console - [ 64, 6340361953738752, {}, 'ru.kopa.model.Kopnik.vote' ]
[2016-10-19 19:17:14.314] [DEBUG] Server - api:model.Kopnik.vote registered
[2016-10-19 19:17:14.315] [INFO] console - [ 64, 2928605952737280, {}, 'ru.kopa.model.Kopa.invite' ]
[2016-10-19 19:17:14.323] [DEBUG] Server - api:model.Kopa.invite registered
[2016-10-19 19:17:14.324] [INFO] console - [ 64, 5572183558455296, {}, 'ru.kopa.model.Kopa.getDialog' ]
[2016-10-19 19:17:14.343] [DEBUG] Server - api:model.Kopa.getDialog registered
[2016-10-19 19:17:14.344] [INFO] console - [ 64, 5055603885998080, {}, 'ru.kopa.model.Kopa.getResult' ]
[2016-10-19 19:17:14.351] [DEBUG] Server - api:model.Kopa.getResult registered
[2016-10-19 19:17:14.352] [INFO] console - [ 64, 2089387781259264, {}, 'ru.kopa.model.Zemla.setParent' ]
[2016-10-19 19:17:14.359] [DEBUG] Server - api:model.Zemla.setParent registered
[2016-10-19 19:17:14.360] [INFO] console - [ 64, 7220249443172352, {}, 'ru.kopa.model.Zemla.promiseKopi' ]
[2016-10-19 19:17:14.366] [DEBUG] Server - api:model.Zemla.promiseKopi registered
[2016-10-19 19:17:14.367] [INFO] console - [ 64,
  1576004199907328,
  {},
  'ru.kopa.model.Predlozhenie.getGolosa' ]
[2016-10-19 19:17:14.374] [DEBUG] Server - api:model.Predlozhenie.getGolosa registered
[2016-10-19 19:17:14.375] [INFO] console - [ 64, 936527647473664, {}, 'ru.kopa.unitTest.orderProc' ]
[2016-10-19 19:17:14.384] [DEBUG] Server - api:unitTest.orderProc registered
[2016-10-19 19:17:14.387] [INFO] Server - started
[2016-10-19 19:19:08.686] [INFO] console - [ 70, 216, {}, [ undefined ] ]
[2016-10-19 19:19:08.898] [INFO] console - Executing (default): delete from "Kopnik"
                where
                    name like '%temp'
                    or name like 'temp%'
[2016-10-19 19:19:08.910] [INFO] console - Executing (default): update "Kopnik"
                set 
                    "voiskoSize"= case when id=2 then 1 ELSE 0 END
                where
                    id>1 
                    and id<=5
[2016-10-19 19:20:47.234] [INFO] console - [ 70, 218, {}, [ undefined ] ]
[2016-10-19 19:20:47.274] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 2 }
[2016-10-19 19:20:47.307] [INFO] console - Executing (default): delete from "Kopnik"
                where
                    name like '%temp'
                    or name like 'temp%'
[2016-10-19 19:20:47.332] [INFO] console - Executing (04f274ad-05f7-449c-b1d3-1e244d571747): START TRANSACTION;
[2016-10-19 19:20:47.342] [INFO] console - Executing (04f274ad-05f7-449c-b1d3-1e244d571747): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:20:47.370] [INFO] console - Executing (default): update "Kopnik"
                set 
                    "voiskoSize"= case when id=2 then 1 ELSE 0 END
                where
                    id>1 
                    and id<=5
[2016-10-19 19:20:47.433] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 19:20:47.530] [INFO] console - Executing (04f274ad-05f7-449c-b1d3-1e244d571747): COMMIT;
[2016-10-19 19:20:47.548] [INFO] console - [ 70,
  219,
  {},
  [ { fullName: 'Unit Test',
      fullPath: '/2/',
      id: '2',
      email: 'unittest2@domain.ru',
      name: 'Unit',
      surname: 'Test',
      patronymic: '1',
      voiskoSize: 1,
      birth: 1983,
      path: '/',
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: null,
      attachments: [] } ] ]
[2016-10-19 19:20:47.637] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 19:20:47.651] [INFO] console - Executing (1d34af1e-a0f6-4cae-975b-43db27f55978): START TRANSACTION;
[2016-10-19 19:20:47.655] [INFO] console - Executing (1d34af1e-a0f6-4cae-975b-43db27f55978): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:20:47.685] [INFO] console - Executing (1d34af1e-a0f6-4cae-975b-43db27f55978): INSERT INTO "Kopnik" ("id","name","surname","patronymic","voiskoSize","birth","path","created_at","updated_at","dom_id","starshina_id") VALUES (DEFAULT,'temp','temp','temp',0,1900,'/','2016-10-19 14:20:47.661 +00:00','2016-10-19 14:20:47.661 +00:00',2,NULL) RETURNING *;
[2016-10-19 19:20:47.701] [INFO] console - Executing (1d34af1e-a0f6-4cae-975b-43db27f55978): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 19:20:47.712] [INFO] console - Executing (1d34af1e-a0f6-4cae-975b-43db27f55978): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 19:20:47.724] [INFO] console - Executing (1d34af1e-a0f6-4cae-975b-43db27f55978): update "Zemla"
                                    set "obshinaSize"= "obshinaSize"+ 1
                                where
                                    '/1/' like path||id||'/%'
                                    or (
                                        true 
                                        and id= 2
                                    )
[2016-10-19 19:20:47.730] [INFO] console - Executing (1d34af1e-a0f6-4cae-975b-43db27f55978): COMMIT;
[2016-10-19 19:20:47.734] [INFO] console - [ 70, 220, {}, [ '29' ] ]
[2016-10-19 19:20:47.751] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 19:20:47.766] [INFO] console - Executing (default): select z.*
                                    from "Zemla" as z
                                where
                                    '/1/' like z.path||z.id||'/%'
[2016-10-19 19:20:47.791] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" IN ('1')) ORDER BY "Zemla"."path" desc;
[2016-10-19 19:20:47.801] [INFO] console - [ 16,
  4271704337547264,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id2.obshinaChange',
  [],
  { obshinaSize: 27 } ]
[2016-10-19 19:20:47.812] [INFO] console - Executing (72a36e10-7507-46d2-8eba-ae5e7cb015f9): START TRANSACTION;
[2016-10-19 19:20:47.816] [INFO] console - [ 16,
  7212629347008512,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id1.obshinaChange',
  [],
  { obshinaSize: 29 } ]
[2016-10-19 19:20:47.839] [INFO] console - Executing (72a36e10-7507-46d2-8eba-ae5e7cb015f9): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:20:47.851] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 29);
[2016-10-19 19:20:47.865] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 19:20:47.874] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 19:20:47.891] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 19:20:47.903] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 19:20:47.920] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='2',"updated_at"='2016-10-19 14:20:47.907 +00:00' WHERE "id" = '29'
[2016-10-19 19:20:47.927] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/', '/2/')
                                where
                                    id = '29'
                                    or path like '/29/'||'%'
[2016-10-19 19:20:47.950] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 19:20:47.959] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 19:20:47.971] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 19:20:47.979] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/2/29/'||'%'
[2016-10-19 19:20:47.988] [INFO] console - Executing (72a36e10-7507-46d2-8eba-ae5e7cb015f9): COMMIT;
[2016-10-19 19:20:47.993] [INFO] console - [ 70, 221, {}, [ undefined ] ]
[2016-10-19 19:20:48.007] [INFO] console - [ 16,
  3816044305055744,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.druzhinaChange',
  [],
  { action: 'add',
    kopnik: 
     { fullName: 'temp temp',
       fullPath: '/2/29/',
       id: '29',
       email: null,
       password: null,
       name: 'temp',
       surname: 'temp',
       patronymic: 'temp',
       voiskoSize: 0,
       birth: 1900,
       path: '/2/',
       note: null,
       created_at: Wed Oct 19 2016 19:20:47 GMT+0500 (YEKT),
       updated_at: Wed Oct 19 2016 19:20:47 GMT+0500 (YEKT),
       deleted_at: null,
       dom_id: '2',
       starshina_id: '2' } } ]
[2016-10-19 19:20:48.035] [INFO] console - [ 16,
  2481899213684736,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 2 } ]
[2016-10-19 19:20:57.710] [INFO] console - [ 70, 223, {}, [ undefined ] ]
[2016-10-19 19:20:57.724] [INFO] console - Executing (default): delete from "Kopnik"
                where
                    name like '%temp'
                    or name like 'temp%'
[2016-10-19 19:20:57.734] [INFO] console - Executing (default): update "Kopnik"
                set 
                    "voiskoSize"= case when id=2 then 1 ELSE 0 END
                where
                    id>1 
                    and id<=5
[2016-10-19 19:20:57.744] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 2 }
[2016-10-19 19:20:57.751] [INFO] console - Executing (3dd161ab-8890-4484-a632-afd3ca94b8b3): START TRANSACTION;
[2016-10-19 19:20:57.754] [INFO] console - Executing (3dd161ab-8890-4484-a632-afd3ca94b8b3): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:20:57.770] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 19:20:57.786] [INFO] console - Executing (3dd161ab-8890-4484-a632-afd3ca94b8b3): COMMIT;
[2016-10-19 19:20:57.789] [INFO] console - [ 70,
  224,
  {},
  [ { fullName: 'Unit Test',
      fullPath: '/2/',
      id: '2',
      email: 'unittest2@domain.ru',
      name: 'Unit',
      surname: 'Test',
      patronymic: '1',
      voiskoSize: 1,
      birth: 1983,
      path: '/',
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: null,
      attachments: [] } ] ]
[2016-10-19 19:20:57.831] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 19:20:57.842] [INFO] console - Executing (2e2aaf14-630a-43d9-a0ce-7334c1b90872): START TRANSACTION;
[2016-10-19 19:20:57.846] [INFO] console - Executing (2e2aaf14-630a-43d9-a0ce-7334c1b90872): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:20:57.867] [INFO] console - Executing (2e2aaf14-630a-43d9-a0ce-7334c1b90872): INSERT INTO "Kopnik" ("id","name","surname","patronymic","voiskoSize","birth","path","created_at","updated_at","dom_id","starshina_id") VALUES (DEFAULT,'temp','temp','temp',0,1900,'/','2016-10-19 14:20:57.852 +00:00','2016-10-19 14:20:57.852 +00:00',2,NULL) RETURNING *;
[2016-10-19 19:20:57.875] [INFO] console - Executing (2e2aaf14-630a-43d9-a0ce-7334c1b90872): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 19:20:57.885] [INFO] console - Executing (2e2aaf14-630a-43d9-a0ce-7334c1b90872): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 19:20:57.893] [INFO] console - Executing (2e2aaf14-630a-43d9-a0ce-7334c1b90872): update "Zemla"
                                    set "obshinaSize"= "obshinaSize"+ 1
                                where
                                    '/1/' like path||id||'/%'
                                    or (
                                        true 
                                        and id= 2
                                    )
[2016-10-19 19:20:57.898] [INFO] console - Executing (2e2aaf14-630a-43d9-a0ce-7334c1b90872): COMMIT;
[2016-10-19 19:20:57.901] [INFO] console - [ 70, 225, {}, [ '30' ] ]
[2016-10-19 19:20:57.915] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 19:20:57.922] [INFO] console - Executing (default): select z.*
                                    from "Zemla" as z
                                where
                                    '/1/' like z.path||z.id||'/%'
[2016-10-19 19:20:57.933] [INFO] console - Executing (791626ab-a1f3-4cb5-abfe-a4d10f6ba613): START TRANSACTION;
[2016-10-19 19:20:57.940] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" IN ('1')) ORDER BY "Zemla"."path" desc;
[2016-10-19 19:20:57.948] [INFO] console - Executing (791626ab-a1f3-4cb5-abfe-a4d10f6ba613): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:20:57.950] [INFO] console - [ 16,
  7339456623280128,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id2.obshinaChange',
  [],
  { obshinaSize: 28 } ]
[2016-10-19 19:20:57.965] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 30);
[2016-10-19 19:20:57.980] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 19:20:57.986] [INFO] console - [ 16,
  746948564877312,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id1.obshinaChange',
  [],
  { obshinaSize: 30 } ]
[2016-10-19 19:20:58.003] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 19:20:58.015] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 19:20:58.024] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 19:20:58.044] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='2',"updated_at"='2016-10-19 14:20:58.028 +00:00' WHERE "id" = '30'
[2016-10-19 19:20:58.051] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/', '/2/')
                                where
                                    id = '30'
                                    or path like '/30/'||'%'
[2016-10-19 19:20:58.056] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 19:20:58.062] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 19:20:58.075] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 19:20:58.086] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/2/30/'||'%'
[2016-10-19 19:20:58.091] [INFO] console - Executing (791626ab-a1f3-4cb5-abfe-a4d10f6ba613): COMMIT;
[2016-10-19 19:20:58.094] [INFO] console - [ 70, 226, {}, [ undefined ] ]
[2016-10-19 19:20:58.098] [INFO] console - [ 16,
  8663682298937344,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.druzhinaChange',
  [],
  { action: 'add',
    kopnik: 
     { fullName: 'temp temp',
       fullPath: '/2/30/',
       id: '30',
       email: null,
       password: null,
       name: 'temp',
       surname: 'temp',
       patronymic: 'temp',
       voiskoSize: 0,
       birth: 1900,
       path: '/2/',
       note: null,
       created_at: Wed Oct 19 2016 19:20:57 GMT+0500 (YEKT),
       updated_at: Wed Oct 19 2016 19:20:58 GMT+0500 (YEKT),
       deleted_at: null,
       dom_id: '2',
       starshina_id: '2' } } ]
[2016-10-19 19:20:58.114] [INFO] console - [ 16,
  3033358919532544,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 2 } ]
[2016-10-19 19:21:22.870] [INFO] console - [ 70, 228, {}, [ undefined ] ]
[2016-10-19 19:21:22.909] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 2 }
[2016-10-19 19:21:22.931] [INFO] console - Executing (default): delete from "Kopnik"
                where
                    name like '%temp'
                    or name like 'temp%'
[2016-10-19 19:21:22.947] [INFO] console - Executing (bfb32c50-4df0-4c6c-bba9-5fee02f61762): START TRANSACTION;
[2016-10-19 19:21:22.955] [INFO] console - Executing (default): update "Kopnik"
                set 
                    "voiskoSize"= case when id=2 then 1 ELSE 0 END
                where
                    id>1 
                    and id<=5
[2016-10-19 19:21:22.959] [INFO] console - Executing (bfb32c50-4df0-4c6c-bba9-5fee02f61762): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:21:22.993] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 19:21:23.020] [INFO] console - Executing (bfb32c50-4df0-4c6c-bba9-5fee02f61762): COMMIT;
[2016-10-19 19:21:23.034] [INFO] console - [ 70,
  229,
  {},
  [ { fullName: 'Unit Test',
      fullPath: '/2/',
      id: '2',
      email: 'unittest2@domain.ru',
      name: 'Unit',
      surname: 'Test',
      patronymic: '1',
      voiskoSize: 1,
      birth: 1983,
      path: '/',
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: null,
      attachments: [] } ] ]
[2016-10-19 19:21:23.091] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 19:21:23.102] [INFO] console - Executing (77801e46-3d54-4b34-a026-9f072e5e83d2): START TRANSACTION;
[2016-10-19 19:21:23.105] [INFO] console - Executing (77801e46-3d54-4b34-a026-9f072e5e83d2): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:21:23.118] [INFO] console - Executing (77801e46-3d54-4b34-a026-9f072e5e83d2): INSERT INTO "Kopnik" ("id","name","surname","patronymic","voiskoSize","birth","path","created_at","updated_at","dom_id","starshina_id") VALUES (DEFAULT,'temp','temp','temp',0,1900,'/','2016-10-19 14:21:23.108 +00:00','2016-10-19 14:21:23.108 +00:00',2,NULL) RETURNING *;
[2016-10-19 19:21:23.129] [INFO] console - Executing (77801e46-3d54-4b34-a026-9f072e5e83d2): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 19:21:23.141] [INFO] console - Executing (77801e46-3d54-4b34-a026-9f072e5e83d2): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 19:21:23.150] [INFO] console - Executing (77801e46-3d54-4b34-a026-9f072e5e83d2): update "Zemla"
                                    set "obshinaSize"= "obshinaSize"+ 1
                                where
                                    '/1/' like path||id||'/%'
                                    or (
                                        true 
                                        and id= 2
                                    )
[2016-10-19 19:21:23.157] [INFO] console - Executing (77801e46-3d54-4b34-a026-9f072e5e83d2): COMMIT;
[2016-10-19 19:21:23.163] [INFO] console - [ 70, 230, {}, [ '31' ] ]
[2016-10-19 19:21:23.210] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 19:21:23.216] [INFO] console - Executing (df97e504-f09d-4992-b846-8ed1454b7696): START TRANSACTION;
[2016-10-19 19:21:23.223] [INFO] console - Executing (df97e504-f09d-4992-b846-8ed1454b7696): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:21:23.228] [INFO] console - Executing (default): select z.*
                                    from "Zemla" as z
                                where
                                    '/1/' like z.path||z.id||'/%'
[2016-10-19 19:21:23.244] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 31);
[2016-10-19 19:21:23.260] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" IN ('1')) ORDER BY "Zemla"."path" desc;
[2016-10-19 19:21:23.272] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 19:21:23.274] [INFO] console - [ 16,
  6110964275478528,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id2.obshinaChange',
  [],
  { obshinaSize: 29 } ]
[2016-10-19 19:21:23.289] [INFO] console - [ 16,
  6782892432687104,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id1.obshinaChange',
  [],
  { obshinaSize: 31 } ]
[2016-10-19 19:21:23.301] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 19:21:23.340] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 19:21:23.351] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 19:21:23.399] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='2',"updated_at"='2016-10-19 14:21:23.365 +00:00' WHERE "id" = '31'
[2016-10-19 19:21:23.405] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/', '/2/')
                                where
                                    id = '31'
                                    or path like '/31/'||'%'
[2016-10-19 19:21:23.415] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 19:21:23.420] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 19:21:23.435] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 19:21:23.444] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/2/31/'||'%'
[2016-10-19 19:21:23.456] [INFO] console - Executing (df97e504-f09d-4992-b846-8ed1454b7696): COMMIT;
[2016-10-19 19:21:23.467] [INFO] console - [ 70, 231, {}, [ undefined ] ]
[2016-10-19 19:21:23.475] [INFO] console - [ 16,
  1765721119916032,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.druzhinaChange',
  [],
  { action: 'add',
    kopnik: 
     { fullName: 'temp temp',
       fullPath: '/2/31/',
       id: '31',
       email: null,
       password: null,
       name: 'temp',
       surname: 'temp',
       patronymic: 'temp',
       voiskoSize: 0,
       birth: 1900,
       path: '/2/',
       note: null,
       created_at: Wed Oct 19 2016 19:21:23 GMT+0500 (YEKT),
       updated_at: Wed Oct 19 2016 19:21:23 GMT+0500 (YEKT),
       deleted_at: null,
       dom_id: '2',
       starshina_id: '2' } } ]
[2016-10-19 19:21:23.502] [INFO] console - [ 16,
  4225813828337664,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 2 } ]
[2016-10-19 19:21:44.387] [INFO] console - [ 70, 233, {}, [ undefined ] ]
[2016-10-19 19:21:44.414] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 2 }
[2016-10-19 19:21:44.462] [INFO] console - Executing (default): delete from "Kopnik"
                where
                    name like '%temp'
                    or name like 'temp%'
[2016-10-19 19:21:44.478] [INFO] console - Executing (aef7545a-2106-42ca-b5f6-873850a7fe2a): START TRANSACTION;
[2016-10-19 19:21:44.483] [INFO] console - Executing (aef7545a-2106-42ca-b5f6-873850a7fe2a): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:21:44.488] [INFO] console - Executing (default): update "Kopnik"
                set 
                    "voiskoSize"= case when id=2 then 1 ELSE 0 END
                where
                    id>1 
                    and id<=5
[2016-10-19 19:21:44.507] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 19:21:44.523] [INFO] console - Executing (aef7545a-2106-42ca-b5f6-873850a7fe2a): COMMIT;
[2016-10-19 19:21:44.526] [INFO] console - [ 70,
  234,
  {},
  [ { fullName: 'Unit Test',
      fullPath: '/2/',
      id: '2',
      email: 'unittest2@domain.ru',
      name: 'Unit',
      surname: 'Test',
      patronymic: '1',
      voiskoSize: 1,
      birth: 1983,
      path: '/',
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: null,
      attachments: [] } ] ]
[2016-10-19 19:21:44.576] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 19:21:44.593] [INFO] console - Executing (869648ac-c001-4ec4-8845-5a3860f42150): START TRANSACTION;
[2016-10-19 19:21:44.604] [INFO] console - Executing (869648ac-c001-4ec4-8845-5a3860f42150): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:21:44.624] [INFO] console - Executing (869648ac-c001-4ec4-8845-5a3860f42150): INSERT INTO "Kopnik" ("id","name","surname","patronymic","voiskoSize","birth","path","created_at","updated_at","dom_id","starshina_id") VALUES (DEFAULT,'temp','temp','temp',0,1900,'/','2016-10-19 14:21:44.608 +00:00','2016-10-19 14:21:44.608 +00:00',2,NULL) RETURNING *;
[2016-10-19 19:21:44.635] [INFO] console - Executing (869648ac-c001-4ec4-8845-5a3860f42150): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 19:21:44.645] [INFO] console - Executing (869648ac-c001-4ec4-8845-5a3860f42150): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 19:21:44.653] [INFO] console - Executing (869648ac-c001-4ec4-8845-5a3860f42150): update "Zemla"
                                    set "obshinaSize"= "obshinaSize"+ 1
                                where
                                    '/1/' like path||id||'/%'
                                    or (
                                        true 
                                        and id= 2
                                    )
[2016-10-19 19:21:44.661] [INFO] console - Executing (869648ac-c001-4ec4-8845-5a3860f42150): COMMIT;
[2016-10-19 19:21:44.666] [INFO] console - [ 70, 235, {}, [ '32' ] ]
[2016-10-19 19:21:44.682] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 19:21:44.692] [INFO] console - Executing (default): select z.*
                                    from "Zemla" as z
                                where
                                    '/1/' like z.path||z.id||'/%'
[2016-10-19 19:21:44.702] [INFO] console - Executing (c238f260-9531-4d9d-9a99-1c6680fa6d79): START TRANSACTION;
[2016-10-19 19:21:44.708] [INFO] console - Executing (c238f260-9531-4d9d-9a99-1c6680fa6d79): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:21:44.721] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" IN ('1')) ORDER BY "Zemla"."path" desc;
[2016-10-19 19:21:44.730] [INFO] console - [ 16,
  1625782566780928,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id2.obshinaChange',
  [],
  { obshinaSize: 30 } ]
[2016-10-19 19:21:44.744] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 32);
[2016-10-19 19:21:44.747] [INFO] console - [ 16,
  616661335932928,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id1.obshinaChange',
  [],
  { obshinaSize: 32 } ]
[2016-10-19 19:21:44.777] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 19:21:44.786] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 19:21:44.797] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 19:21:44.805] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 19:21:44.824] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='2',"updated_at"='2016-10-19 14:21:44.810 +00:00' WHERE "id" = '32'
[2016-10-19 19:21:44.832] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/', '/2/')
                                where
                                    id = '32'
                                    or path like '/32/'||'%'
[2016-10-19 19:21:44.836] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 19:21:44.841] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 19:21:44.860] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 19:21:44.868] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/2/32/'||'%'
[2016-10-19 19:21:44.873] [INFO] console - Executing (c238f260-9531-4d9d-9a99-1c6680fa6d79): COMMIT;
[2016-10-19 19:21:44.877] [INFO] console - [ 70, 236, {}, [ undefined ] ]
[2016-10-19 19:22:10.106] [INFO] console - [ 16,
  4483522299428864,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.druzhinaChange',
  [],
  { action: 'add',
    kopnik: 
     { fullName: 'temp temp',
       fullPath: '/2/32/',
       id: '32',
       email: null,
       password: null,
       name: 'temp',
       surname: 'temp',
       patronymic: 'temp',
       voiskoSize: 0,
       birth: 1900,
       path: '/2/',
       note: null,
       created_at: Wed Oct 19 2016 19:21:44 GMT+0500 (YEKT),
       updated_at: Wed Oct 19 2016 19:21:44 GMT+0500 (YEKT),
       deleted_at: null,
       dom_id: '2',
       starshina_id: '2' } } ]
[2016-10-19 19:22:10.153] [INFO] console - [ 16,
  7965100189155328,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 2 } ]
[2016-10-19 19:23:12.758] [INFO] console - [ 70, 238, {}, [ undefined ] ]
[2016-10-19 19:23:12.786] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 2 }
[2016-10-19 19:23:13.062] [INFO] console - Executing (default): delete from "Kopnik"
                where
                    name like '%temp'
                    or name like 'temp%'
[2016-10-19 19:23:13.082] [INFO] console - Executing (abca3d3a-b6df-441e-8b35-7a32cbeed8c8): START TRANSACTION;
[2016-10-19 19:23:13.104] [INFO] console - Executing (abca3d3a-b6df-441e-8b35-7a32cbeed8c8): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:23:13.164] [INFO] console - Executing (default): update "Kopnik"
                set 
                    "voiskoSize"= case when id=2 then 1 ELSE 0 END
                where
                    id>1 
                    and id<=5
[2016-10-19 19:23:13.228] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 19:23:13.244] [INFO] console - Executing (abca3d3a-b6df-441e-8b35-7a32cbeed8c8): COMMIT;
[2016-10-19 19:23:13.248] [INFO] console - [ 70,
  239,
  {},
  [ { fullName: 'Unit Test',
      fullPath: '/2/',
      id: '2',
      email: 'unittest2@domain.ru',
      name: 'Unit',
      surname: 'Test',
      patronymic: '1',
      voiskoSize: 1,
      birth: 1983,
      path: '/',
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: null,
      attachments: [] } ] ]
[2016-10-19 19:23:13.339] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 19:23:13.353] [INFO] console - Executing (b6419751-f325-40aa-a1e3-bdae5d3ed0c7): START TRANSACTION;
[2016-10-19 19:23:13.358] [INFO] console - Executing (b6419751-f325-40aa-a1e3-bdae5d3ed0c7): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:23:13.391] [INFO] console - Executing (b6419751-f325-40aa-a1e3-bdae5d3ed0c7): INSERT INTO "Kopnik" ("id","name","surname","patronymic","voiskoSize","birth","path","created_at","updated_at","dom_id","starshina_id") VALUES (DEFAULT,'temp','temp','temp',0,1900,'/','2016-10-19 14:23:13.364 +00:00','2016-10-19 14:23:13.364 +00:00',2,NULL) RETURNING *;
[2016-10-19 19:23:13.402] [INFO] console - Executing (b6419751-f325-40aa-a1e3-bdae5d3ed0c7): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 19:23:13.414] [INFO] console - Executing (b6419751-f325-40aa-a1e3-bdae5d3ed0c7): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 19:23:13.422] [INFO] console - Executing (b6419751-f325-40aa-a1e3-bdae5d3ed0c7): update "Zemla"
                                    set "obshinaSize"= "obshinaSize"+ 1
                                where
                                    '/1/' like path||id||'/%'
                                    or (
                                        true 
                                        and id= 2
                                    )
[2016-10-19 19:23:13.427] [INFO] console - Executing (b6419751-f325-40aa-a1e3-bdae5d3ed0c7): COMMIT;
[2016-10-19 19:23:13.432] [INFO] console - [ 70, 240, {}, [ '33' ] ]
[2016-10-19 19:23:13.454] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 19:23:13.463] [INFO] console - Executing (dfd6e509-3ccb-49d8-a7d5-fc4d9974e0a7): START TRANSACTION;
[2016-10-19 19:23:13.470] [INFO] console - Executing (dfd6e509-3ccb-49d8-a7d5-fc4d9974e0a7): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:23:13.475] [INFO] console - Executing (default): select z.*
                                    from "Zemla" as z
                                where
                                    '/1/' like z.path||z.id||'/%'
[2016-10-19 19:23:13.491] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 33);
[2016-10-19 19:23:13.504] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" IN ('1')) ORDER BY "Zemla"."path" desc;
[2016-10-19 19:23:13.518] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 19:23:13.520] [INFO] console - [ 16,
  6269974379233280,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id2.obshinaChange',
  [],
  { obshinaSize: 31 } ]
[2016-10-19 19:23:13.539] [INFO] console - [ 16,
  3856931917660160,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id1.obshinaChange',
  [],
  { obshinaSize: 33 } ]
[2016-10-19 19:23:13.555] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 19:23:13.567] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 19:23:13.574] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 19:23:13.592] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='2',"updated_at"='2016-10-19 14:23:13.577 +00:00' WHERE "id" = '33'
[2016-10-19 19:23:13.598] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/', '/2/')
                                where
                                    id = '33'
                                    or path like '/33/'||'%'
[2016-10-19 19:23:13.604] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 19:23:13.611] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 19:23:13.623] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 19:23:13.631] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/2/33/'||'%'
[2016-10-19 19:23:13.637] [INFO] console - Executing (dfd6e509-3ccb-49d8-a7d5-fc4d9974e0a7): COMMIT;
[2016-10-19 19:23:13.642] [INFO] console - [ 70, 241, {}, [ undefined ] ]
[2016-10-19 19:23:13.649] [INFO] console - [ 16,
  2889371803975680,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.druzhinaChange',
  [],
  { action: 'add',
    kopnik: 
     { fullName: 'temp temp',
       fullPath: '/2/33/',
       id: '33',
       email: null,
       password: null,
       name: 'temp',
       surname: 'temp',
       patronymic: 'temp',
       voiskoSize: 0,
       birth: 1900,
       path: '/2/',
       note: null,
       created_at: Wed Oct 19 2016 19:23:13 GMT+0500 (YEKT),
       updated_at: Wed Oct 19 2016 19:23:13 GMT+0500 (YEKT),
       deleted_at: null,
       dom_id: '2',
       starshina_id: '2' } } ]
[2016-10-19 19:23:13.671] [INFO] console - [ 16,
  816085190311936,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 2 } ]
[2016-10-19 19:23:46.742] [INFO] console - [ 70, 243, {}, [ undefined ] ]
[2016-10-19 19:23:46.767] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 2 }
[2016-10-19 19:23:46.801] [INFO] console - Executing (default): delete from "Kopnik"
                where
                    name like '%temp'
                    or name like 'temp%'
[2016-10-19 19:23:46.808] [INFO] console - Executing (42d59b61-ec08-4280-9d77-b0c994a02014): START TRANSACTION;
[2016-10-19 19:23:46.812] [INFO] console - Executing (42d59b61-ec08-4280-9d77-b0c994a02014): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:23:46.822] [INFO] console - Executing (default): update "Kopnik"
                set 
                    "voiskoSize"= case when id=2 then 1 ELSE 0 END
                where
                    id>1 
                    and id<=5
[2016-10-19 19:23:46.836] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 19:23:46.859] [INFO] console - Executing (42d59b61-ec08-4280-9d77-b0c994a02014): COMMIT;
[2016-10-19 19:23:46.867] [INFO] console - [ 70,
  244,
  {},
  [ { fullName: 'Unit Test',
      fullPath: '/2/',
      id: '2',
      email: 'unittest2@domain.ru',
      name: 'Unit',
      surname: 'Test',
      patronymic: '1',
      voiskoSize: 1,
      birth: 1983,
      path: '/',
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: null,
      attachments: [] } ] ]
[2016-10-19 19:23:46.931] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 19:23:46.977] [INFO] console - Executing (ab552eab-00d8-47ce-948e-0bfc45423dfa): START TRANSACTION;
[2016-10-19 19:23:46.984] [INFO] console - Executing (ab552eab-00d8-47ce-948e-0bfc45423dfa): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:23:47.055] [INFO] console - Executing (ab552eab-00d8-47ce-948e-0bfc45423dfa): INSERT INTO "Kopnik" ("id","name","surname","patronymic","voiskoSize","birth","path","created_at","updated_at","dom_id","starshina_id") VALUES (DEFAULT,'temp','temp','temp',0,1900,'/','2016-10-19 14:23:47.001 +00:00','2016-10-19 14:23:47.001 +00:00',2,NULL) RETURNING *;
[2016-10-19 19:23:47.081] [INFO] console - Executing (ab552eab-00d8-47ce-948e-0bfc45423dfa): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 19:23:47.134] [INFO] console - Executing (ab552eab-00d8-47ce-948e-0bfc45423dfa): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 19:23:47.149] [INFO] console - Executing (ab552eab-00d8-47ce-948e-0bfc45423dfa): update "Zemla"
                                    set "obshinaSize"= "obshinaSize"+ 1
                                where
                                    '/1/' like path||id||'/%'
                                    or (
                                        true 
                                        and id= 2
                                    )
[2016-10-19 19:23:47.159] [INFO] console - Executing (ab552eab-00d8-47ce-948e-0bfc45423dfa): COMMIT;
[2016-10-19 19:23:47.171] [INFO] console - [ 70, 245, {}, [ '34' ] ]
[2016-10-19 19:23:47.193] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 19:23:47.227] [INFO] console - Executing (default): select z.*
                                    from "Zemla" as z
                                where
                                    '/1/' like z.path||z.id||'/%'
[2016-10-19 19:23:47.261] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" IN ('1')) ORDER BY "Zemla"."path" desc;
[2016-10-19 19:23:47.277] [INFO] console - [ 16,
  8395375356411904,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id2.obshinaChange',
  [],
  { obshinaSize: 32 } ]
[2016-10-19 19:23:47.382] [INFO] console - [ 16,
  8878745389629440,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id1.obshinaChange',
  [],
  { obshinaSize: 34 } ]
[2016-10-19 19:23:47.398] [INFO] console - Executing (6ea2707b-0222-4fad-ad66-acc1cfc965f0): START TRANSACTION;
[2016-10-19 19:23:47.405] [INFO] console - Executing (6ea2707b-0222-4fad-ad66-acc1cfc965f0): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:23:47.417] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 34);
[2016-10-19 19:23:47.431] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 19:23:47.440] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 19:23:47.453] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 19:23:47.461] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 19:23:47.489] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='2',"updated_at"='2016-10-19 14:23:47.465 +00:00' WHERE "id" = '34'
[2016-10-19 19:23:47.506] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/', '/2/')
                                where
                                    id = '34'
                                    or path like '/34/'||'%'
[2016-10-19 19:23:47.514] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 19:23:47.525] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 19:23:47.541] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 19:23:47.550] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/2/34/'||'%'
[2016-10-19 19:23:47.564] [INFO] console - Executing (6ea2707b-0222-4fad-ad66-acc1cfc965f0): COMMIT;
[2016-10-19 19:23:47.577] [INFO] console - [ 70, 246, {}, [ undefined ] ]
[2016-10-19 19:23:47.590] [INFO] console - [ 16,
  7629912355635200,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.druzhinaChange',
  [],
  { action: 'add',
    kopnik: 
     { fullName: 'temp temp',
       fullPath: '/2/34/',
       id: '34',
       email: null,
       password: null,
       name: 'temp',
       surname: 'temp',
       patronymic: 'temp',
       voiskoSize: 0,
       birth: 1900,
       path: '/2/',
       note: null,
       created_at: Wed Oct 19 2016 19:23:47 GMT+0500 (YEKT),
       updated_at: Wed Oct 19 2016 19:23:47 GMT+0500 (YEKT),
       deleted_at: null,
       dom_id: '2',
       starshina_id: '2' } } ]
[2016-10-19 19:23:47.614] [INFO] console - [ 16,
  7182051493019648,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 2 } ]
[2016-10-19 19:24:56.768] [INFO] console - [ 70, 248, {}, [ undefined ] ]
[2016-10-19 19:24:56.802] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 2 }
[2016-10-19 19:24:57.018] [INFO] console - Executing (default): delete from "Kopnik"
                where
                    name like '%temp'
                    or name like 'temp%'
[2016-10-19 19:24:57.049] [INFO] console - Executing (8245948b-a658-4345-af73-a5c8dfa15b53): START TRANSACTION;
[2016-10-19 19:24:57.056] [INFO] console - Executing (8245948b-a658-4345-af73-a5c8dfa15b53): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:24:57.068] [INFO] console - Executing (default): update "Kopnik"
                set 
                    "voiskoSize"= case when id=2 then 1 ELSE 0 END
                where
                    id>1 
                    and id<=5
[2016-10-19 19:24:57.100] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 19:24:57.128] [INFO] console - Executing (8245948b-a658-4345-af73-a5c8dfa15b53): COMMIT;
[2016-10-19 19:24:57.145] [INFO] console - [ 70,
  249,
  {},
  [ { fullName: 'Unit Test',
      fullPath: '/2/',
      id: '2',
      email: 'unittest2@domain.ru',
      name: 'Unit',
      surname: 'Test',
      patronymic: '1',
      voiskoSize: 1,
      birth: 1983,
      path: '/',
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: null,
      attachments: [] } ] ]
[2016-10-19 19:24:57.203] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 19:24:57.216] [INFO] console - Executing (462b50e1-58b5-4afe-8e27-8a27fb192ccb): START TRANSACTION;
[2016-10-19 19:24:57.220] [INFO] console - Executing (462b50e1-58b5-4afe-8e27-8a27fb192ccb): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:24:57.238] [INFO] console - Executing (462b50e1-58b5-4afe-8e27-8a27fb192ccb): INSERT INTO "Kopnik" ("id","name","surname","patronymic","voiskoSize","birth","path","created_at","updated_at","dom_id","starshina_id") VALUES (DEFAULT,'temp','temp','temp',0,1900,'/','2016-10-19 14:24:57.224 +00:00','2016-10-19 14:24:57.224 +00:00',2,NULL) RETURNING *;
[2016-10-19 19:24:57.260] [INFO] console - Executing (462b50e1-58b5-4afe-8e27-8a27fb192ccb): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 19:24:57.274] [INFO] console - Executing (462b50e1-58b5-4afe-8e27-8a27fb192ccb): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 19:24:57.283] [INFO] console - Executing (462b50e1-58b5-4afe-8e27-8a27fb192ccb): update "Zemla"
                                    set "obshinaSize"= "obshinaSize"+ 1
                                where
                                    '/1/' like path||id||'/%'
                                    or (
                                        true 
                                        and id= 2
                                    )
[2016-10-19 19:24:57.289] [INFO] console - Executing (462b50e1-58b5-4afe-8e27-8a27fb192ccb): COMMIT;
[2016-10-19 19:24:57.295] [INFO] console - [ 70, 250, {}, [ '35' ] ]
[2016-10-19 19:24:57.312] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 19:24:57.325] [INFO] console - Executing (default): select z.*
                                    from "Zemla" as z
                                where
                                    '/1/' like z.path||z.id||'/%'
[2016-10-19 19:24:57.339] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" IN ('1')) ORDER BY "Zemla"."path" desc;
[2016-10-19 19:24:57.345] [INFO] console - [ 16,
  2639732303462400,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id2.obshinaChange',
  [],
  { obshinaSize: 33 } ]
[2016-10-19 19:24:57.385] [INFO] console - [ 16,
  8881820827385856,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id1.obshinaChange',
  [],
  { obshinaSize: 35 } ]
[2016-10-19 19:24:57.401] [INFO] console - Executing (8fae9e93-9fee-4b59-a6ef-49a37600cdf5): START TRANSACTION;
[2016-10-19 19:24:57.433] [INFO] console - Executing (8fae9e93-9fee-4b59-a6ef-49a37600cdf5): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:24:57.444] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 35);
[2016-10-19 19:24:57.466] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 19:24:57.475] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 19:24:57.487] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 19:24:57.494] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 19:24:57.510] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='2',"updated_at"='2016-10-19 14:24:57.497 +00:00' WHERE "id" = '35'
[2016-10-19 19:24:57.517] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/', '/2/')
                                where
                                    id = '35'
                                    or path like '/35/'||'%'
[2016-10-19 19:24:57.525] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 19:24:57.531] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 19:24:57.542] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 19:24:57.550] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/2/35/'||'%'
[2016-10-19 19:24:57.555] [INFO] console - Executing (8fae9e93-9fee-4b59-a6ef-49a37600cdf5): COMMIT;
[2016-10-19 19:24:57.558] [INFO] console - [ 70, 251, {}, [ undefined ] ]
[2016-10-19 19:24:57.563] [INFO] console - [ 16,
  1520658443927552,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.druzhinaChange',
  [],
  { action: 'add',
    kopnik: 
     { fullName: 'temp temp',
       fullPath: '/2/35/',
       id: '35',
       email: null,
       password: null,
       name: 'temp',
       surname: 'temp',
       patronymic: 'temp',
       voiskoSize: 0,
       birth: 1900,
       path: '/2/',
       note: null,
       created_at: Wed Oct 19 2016 19:24:57 GMT+0500 (YEKT),
       updated_at: Wed Oct 19 2016 19:24:57 GMT+0500 (YEKT),
       deleted_at: null,
       dom_id: '2',
       starshina_id: '2' } } ]
[2016-10-19 19:24:57.581] [INFO] console - [ 16,
  1784453296816128,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 2 } ]
[2016-10-19 19:32:35.349] [INFO] console - [ 70, 253, {}, [ undefined ] ]
[2016-10-19 19:32:35.389] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 2 }
[2016-10-19 19:32:35.445] [INFO] console - Executing (default): delete from "Kopnik"
                where
                    name like '%temp'
                    or name like 'temp%'
[2016-10-19 19:32:35.459] [INFO] console - Executing (a7678865-7974-4fc5-b2e7-2223b624d38f): START TRANSACTION;
[2016-10-19 19:32:35.467] [INFO] console - Executing (a7678865-7974-4fc5-b2e7-2223b624d38f): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:32:35.474] [INFO] console - Executing (default): update "Kopnik"
                set 
                    "voiskoSize"= case when id=2 then 1 ELSE 0 END
                where
                    id>1 
                    and id<=5
[2016-10-19 19:32:35.498] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 19:32:35.534] [INFO] console - Executing (a7678865-7974-4fc5-b2e7-2223b624d38f): COMMIT;
[2016-10-19 19:32:35.538] [INFO] console - [ 70,
  254,
  {},
  [ { fullName: 'Unit Test',
      fullPath: '/2/',
      id: '2',
      email: 'unittest2@domain.ru',
      name: 'Unit',
      surname: 'Test',
      patronymic: '1',
      voiskoSize: 1,
      birth: 1983,
      path: '/',
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: null,
      attachments: [] } ] ]
[2016-10-19 19:32:35.582] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 19:32:35.596] [INFO] console - Executing (56cf8775-2e94-4c4f-92fb-4fc5bcdfc558): START TRANSACTION;
[2016-10-19 19:32:35.601] [INFO] console - Executing (56cf8775-2e94-4c4f-92fb-4fc5bcdfc558): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:32:35.620] [INFO] console - Executing (56cf8775-2e94-4c4f-92fb-4fc5bcdfc558): INSERT INTO "Kopnik" ("id","name","surname","patronymic","voiskoSize","birth","path","created_at","updated_at","dom_id","starshina_id") VALUES (DEFAULT,'temp','temp','temp',0,1900,'/','2016-10-19 14:32:35.605 +00:00','2016-10-19 14:32:35.605 +00:00',2,NULL) RETURNING *;
[2016-10-19 19:32:35.631] [INFO] console - Executing (56cf8775-2e94-4c4f-92fb-4fc5bcdfc558): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 19:32:35.643] [INFO] console - Executing (56cf8775-2e94-4c4f-92fb-4fc5bcdfc558): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 19:32:35.657] [INFO] console - Executing (56cf8775-2e94-4c4f-92fb-4fc5bcdfc558): update "Zemla"
                                    set "obshinaSize"= "obshinaSize"+ 1
                                where
                                    '/1/' like path||id||'/%'
                                    or (
                                        true 
                                        and id= 2
                                    )
[2016-10-19 19:32:35.662] [INFO] console - Executing (56cf8775-2e94-4c4f-92fb-4fc5bcdfc558): COMMIT;
[2016-10-19 19:32:35.666] [INFO] console - [ 70, 255, {}, [ '36' ] ]
[2016-10-19 19:32:35.710] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 19:32:35.723] [INFO] console - Executing (11c93311-0b02-4c85-b2b3-0cc65d58836c): START TRANSACTION;
[2016-10-19 19:32:35.728] [INFO] console - Executing (default): select z.*
                                    from "Zemla" as z
                                where
                                    '/1/' like z.path||z.id||'/%'
[2016-10-19 19:32:35.731] [INFO] console - Executing (11c93311-0b02-4c85-b2b3-0cc65d58836c): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:32:35.752] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" IN ('1')) ORDER BY "Zemla"."path" desc;
[2016-10-19 19:32:35.765] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 36);
[2016-10-19 19:32:35.768] [INFO] console - [ 16,
  1772612988436480,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id2.obshinaChange',
  [],
  { obshinaSize: 34 } ]
[2016-10-19 19:32:35.785] [INFO] console - [ 16,
  5478087342948352,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id1.obshinaChange',
  [],
  { obshinaSize: 36 } ]
[2016-10-19 19:32:35.807] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 19:32:35.817] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 19:32:35.830] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 19:32:35.836] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 19:32:35.854] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='2',"updated_at"='2016-10-19 14:32:35.842 +00:00' WHERE "id" = '36'
[2016-10-19 19:32:35.859] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/', '/2/')
                                where
                                    id = '36'
                                    or path like '/36/'||'%'
[2016-10-19 19:32:35.868] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 19:32:35.873] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 19:32:35.885] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 19:32:35.894] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/2/36/'||'%'
[2016-10-19 19:32:35.899] [INFO] console - Executing (11c93311-0b02-4c85-b2b3-0cc65d58836c): COMMIT;
[2016-10-19 19:32:35.906] [INFO] console - [ 70, 256, {}, [ undefined ] ]
[2016-10-19 19:32:35.917] [INFO] console - [ 16,
  6235139986161664,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.druzhinaChange',
  [],
  { action: 'add',
    kopnik: 
     { fullName: 'temp temp',
       fullPath: '/2/36/',
       id: '36',
       email: null,
       password: null,
       name: 'temp',
       surname: 'temp',
       patronymic: 'temp',
       voiskoSize: 0,
       birth: 1900,
       path: '/2/',
       note: null,
       created_at: Wed Oct 19 2016 19:32:35 GMT+0500 (YEKT),
       updated_at: Wed Oct 19 2016 19:32:35 GMT+0500 (YEKT),
       deleted_at: null,
       dom_id: '2',
       starshina_id: '2' } } ]
[2016-10-19 19:32:35.941] [INFO] console - [ 16,
  8214330709377024,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 2 } ]
[2016-10-19 19:34:02.353] [INFO] console - [ 70, 258, {}, [ undefined ] ]
[2016-10-19 19:34:02.389] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 2 }
[2016-10-19 19:34:02.439] [INFO] console - Executing (default): delete from "Kopnik"
                where
                    name like '%temp'
                    or name like 'temp%'
[2016-10-19 19:34:02.459] [INFO] console - Executing (a4a40b04-76e8-4149-a706-0516f2de1afe): START TRANSACTION;
[2016-10-19 19:34:02.471] [INFO] console - Executing (a4a40b04-76e8-4149-a706-0516f2de1afe): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:34:02.551] [INFO] console - Executing (default): update "Kopnik"
                set 
                    "voiskoSize"= case when id=2 then 1 ELSE 0 END
                where
                    id>1 
                    and id<=5
[2016-10-19 19:34:02.593] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 19:34:02.629] [INFO] console - Executing (a4a40b04-76e8-4149-a706-0516f2de1afe): COMMIT;
[2016-10-19 19:34:02.633] [INFO] console - [ 70,
  259,
  {},
  [ { fullName: 'Unit Test',
      fullPath: '/2/',
      id: '2',
      email: 'unittest2@domain.ru',
      name: 'Unit',
      surname: 'Test',
      patronymic: '1',
      voiskoSize: 1,
      birth: 1983,
      path: '/',
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: null,
      attachments: [] } ] ]
[2016-10-19 19:34:02.841] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 19:34:02.914] [INFO] console - Executing (09222413-0821-49c8-b102-6845cc9f1046): START TRANSACTION;
[2016-10-19 19:34:02.923] [INFO] console - Executing (09222413-0821-49c8-b102-6845cc9f1046): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:34:02.968] [INFO] console - Executing (09222413-0821-49c8-b102-6845cc9f1046): INSERT INTO "Kopnik" ("id","name","surname","patronymic","voiskoSize","birth","path","created_at","updated_at","dom_id","starshina_id") VALUES (DEFAULT,'temp','temp','temp',0,1900,'/','2016-10-19 14:34:02.932 +00:00','2016-10-19 14:34:02.932 +00:00',2,NULL) RETURNING *;
[2016-10-19 19:34:03.003] [INFO] console - Executing (09222413-0821-49c8-b102-6845cc9f1046): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 19:34:03.042] [INFO] console - Executing (09222413-0821-49c8-b102-6845cc9f1046): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 19:34:03.052] [INFO] console - Executing (09222413-0821-49c8-b102-6845cc9f1046): update "Zemla"
                                    set "obshinaSize"= "obshinaSize"+ 1
                                where
                                    '/1/' like path||id||'/%'
                                    or (
                                        true 
                                        and id= 2
                                    )
[2016-10-19 19:34:03.072] [INFO] console - Executing (09222413-0821-49c8-b102-6845cc9f1046): COMMIT;
[2016-10-19 19:34:03.075] [INFO] console - [ 70, 260, {}, [ '37' ] ]
[2016-10-19 19:34:03.131] [INFO] console - Executing (d169cac9-105e-4bed-bc05-f4c57d2985da): START TRANSACTION;
[2016-10-19 19:34:03.148] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 19:34:03.153] [INFO] console - Executing (d169cac9-105e-4bed-bc05-f4c57d2985da): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:34:03.173] [INFO] console - Executing (default): select z.*
                                    from "Zemla" as z
                                where
                                    '/1/' like z.path||z.id||'/%'
[2016-10-19 19:34:03.181] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 37);
[2016-10-19 19:34:03.206] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" IN ('1')) ORDER BY "Zemla"."path" desc;
[2016-10-19 19:34:03.209] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 19:34:03.220] [INFO] console - [ 16,
  8390635067277312,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id2.obshinaChange',
  [],
  { obshinaSize: 35 } ]
[2016-10-19 19:34:03.230] [INFO] console - [ 16,
  3000252707635200,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id1.obshinaChange',
  [],
  { obshinaSize: 37 } ]
[2016-10-19 19:34:03.239] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 19:34:03.255] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 19:34:03.261] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 19:34:03.279] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='2',"updated_at"='2016-10-19 14:34:03.264 +00:00' WHERE "id" = '37'
[2016-10-19 19:34:03.284] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/', '/2/')
                                where
                                    id = '37'
                                    or path like '/37/'||'%'
[2016-10-19 19:34:03.294] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 19:34:03.301] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 19:34:03.313] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 19:34:03.320] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/2/37/'||'%'
[2016-10-19 19:34:03.326] [INFO] console - Executing (d169cac9-105e-4bed-bc05-f4c57d2985da): COMMIT;
[2016-10-19 19:34:03.335] [INFO] console - [ 70, 261, {}, [ undefined ] ]
[2016-10-19 19:34:03.351] [INFO] console - [ 16,
  1077086773051392,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.druzhinaChange',
  [],
  { action: 'add',
    kopnik: 
     { fullName: 'temp temp',
       fullPath: '/2/37/',
       id: '37',
       email: null,
       password: null,
       name: 'temp',
       surname: 'temp',
       patronymic: 'temp',
       voiskoSize: 0,
       birth: 1900,
       path: '/2/',
       note: null,
       created_at: Wed Oct 19 2016 19:34:02 GMT+0500 (YEKT),
       updated_at: Wed Oct 19 2016 19:34:03 GMT+0500 (YEKT),
       deleted_at: null,
       dom_id: '2',
       starshina_id: '2' } } ]
[2016-10-19 19:34:03.392] [INFO] console - [ 16,
  5286717527425024,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 2 } ]
[2016-10-19 19:35:10.739] [INFO] console - [ 70, 263, {}, [ undefined ] ]
[2016-10-19 19:35:10.763] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 2 }
[2016-10-19 19:35:10.809] [INFO] console - Executing (default): delete from "Kopnik"
                where
                    name like '%temp'
                    or name like 'temp%'
[2016-10-19 19:35:10.846] [INFO] console - Executing (526e6966-7e00-4772-9abc-59c05f85c58b): START TRANSACTION;
[2016-10-19 19:35:10.864] [INFO] console - Executing (526e6966-7e00-4772-9abc-59c05f85c58b): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:35:10.876] [INFO] console - Executing (default): update "Kopnik"
                set 
                    "voiskoSize"= case when id=2 then 1 ELSE 0 END
                where
                    id>1 
                    and id<=5
[2016-10-19 19:35:10.921] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 19:35:10.940] [INFO] console - Executing (526e6966-7e00-4772-9abc-59c05f85c58b): COMMIT;
[2016-10-19 19:35:10.944] [INFO] console - [ 70,
  264,
  {},
  [ { fullName: 'Unit Test',
      fullPath: '/2/',
      id: '2',
      email: 'unittest2@domain.ru',
      name: 'Unit',
      surname: 'Test',
      patronymic: '1',
      voiskoSize: 1,
      birth: 1983,
      path: '/',
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: null,
      attachments: [] } ] ]
[2016-10-19 19:35:11.027] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 19:35:11.039] [INFO] console - Executing (42b56c67-9b86-49f6-8e3d-a38212f36783): START TRANSACTION;
[2016-10-19 19:35:11.043] [INFO] console - Executing (42b56c67-9b86-49f6-8e3d-a38212f36783): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:35:11.084] [INFO] console - Executing (42b56c67-9b86-49f6-8e3d-a38212f36783): INSERT INTO "Kopnik" ("id","name","surname","patronymic","voiskoSize","birth","path","created_at","updated_at","dom_id","starshina_id") VALUES (DEFAULT,'temp','temp','temp',0,1900,'/','2016-10-19 14:35:11.053 +00:00','2016-10-19 14:35:11.053 +00:00',2,NULL) RETURNING *;
[2016-10-19 19:35:11.095] [INFO] console - Executing (42b56c67-9b86-49f6-8e3d-a38212f36783): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 19:35:11.111] [INFO] console - Executing (42b56c67-9b86-49f6-8e3d-a38212f36783): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 19:35:11.121] [INFO] console - Executing (42b56c67-9b86-49f6-8e3d-a38212f36783): update "Zemla"
                                    set "obshinaSize"= "obshinaSize"+ 1
                                where
                                    '/1/' like path||id||'/%'
                                    or (
                                        true 
                                        and id= 2
                                    )
[2016-10-19 19:35:11.128] [INFO] console - Executing (42b56c67-9b86-49f6-8e3d-a38212f36783): COMMIT;
[2016-10-19 19:35:11.140] [INFO] console - [ 70, 265, {}, [ '38' ] ]
[2016-10-19 19:35:11.184] [INFO] console - Executing (105ff372-e3e6-40bf-8e4e-d71c2c3726ac): START TRANSACTION;
[2016-10-19 19:35:11.192] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 19:35:11.197] [INFO] console - Executing (105ff372-e3e6-40bf-8e4e-d71c2c3726ac): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:35:11.207] [INFO] console - Executing (default): select z.*
                                    from "Zemla" as z
                                where
                                    '/1/' like z.path||z.id||'/%'
[2016-10-19 19:35:11.223] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 38);
[2016-10-19 19:35:11.236] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" IN ('1')) ORDER BY "Zemla"."path" desc;
[2016-10-19 19:35:11.250] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 19:35:11.257] [INFO] console - [ 16,
  8319673554698240,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id2.obshinaChange',
  [],
  { obshinaSize: 36 } ]
[2016-10-19 19:35:11.269] [INFO] console - [ 16,
  8058108010037248,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id1.obshinaChange',
  [],
  { obshinaSize: 38 } ]
[2016-10-19 19:35:11.276] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 19:35:11.291] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 19:35:11.297] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 19:35:11.316] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='2',"updated_at"='2016-10-19 14:35:11.302 +00:00' WHERE "id" = '38'
[2016-10-19 19:35:11.327] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/', '/2/')
                                where
                                    id = '38'
                                    or path like '/38/'||'%'
[2016-10-19 19:35:11.335] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 19:35:11.341] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 19:35:11.357] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 19:35:11.372] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/2/38/'||'%'
[2016-10-19 19:35:11.378] [INFO] console - Executing (105ff372-e3e6-40bf-8e4e-d71c2c3726ac): COMMIT;
[2016-10-19 19:35:11.382] [INFO] console - [ 70, 266, {}, [ undefined ] ]
[2016-10-19 19:35:11.390] [INFO] console - [ 16,
  5739792639721472,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.druzhinaChange',
  [],
  { action: 'add',
    kopnik: 
     { fullName: 'temp temp',
       fullPath: '/2/38/',
       id: '38',
       email: null,
       password: null,
       name: 'temp',
       surname: 'temp',
       patronymic: 'temp',
       voiskoSize: 0,
       birth: 1900,
       path: '/2/',
       note: null,
       created_at: Wed Oct 19 2016 19:35:11 GMT+0500 (YEKT),
       updated_at: Wed Oct 19 2016 19:35:11 GMT+0500 (YEKT),
       deleted_at: null,
       dom_id: '2',
       starshina_id: '2' } } ]
[2016-10-19 19:35:11.424] [INFO] console - [ 16,
  5423943563345920,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 2 } ]
[2016-10-19 19:38:40.622] [INFO] console - [ 70, 268, {}, [ undefined ] ]
[2016-10-19 19:38:40.729] [INFO] console - Executing (default): delete from "Kopnik"
                where
                    name like '%temp'
                    or name like 'temp%'
[2016-10-19 19:38:40.742] [INFO] console - Executing (default): update "Kopnik"
                set 
                    "voiskoSize"= case when id=2 then 1 ELSE 0 END
                where
                    id>1 
                    and id<=5
[2016-10-19 19:38:43.961] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 2 }
[2016-10-19 19:38:43.971] [INFO] console - Executing (f4075d6d-3c45-4b38-ad74-e9a91e2736e9): START TRANSACTION;
[2016-10-19 19:38:43.977] [INFO] console - Executing (f4075d6d-3c45-4b38-ad74-e9a91e2736e9): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:38:44.067] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 19:38:44.099] [INFO] console - Executing (f4075d6d-3c45-4b38-ad74-e9a91e2736e9): COMMIT;
[2016-10-19 19:38:44.103] [INFO] console - [ 70,
  269,
  {},
  [ { fullName: 'Unit Test',
      fullPath: '/2/',
      id: '2',
      email: 'unittest2@domain.ru',
      name: 'Unit',
      surname: 'Test',
      patronymic: '1',
      voiskoSize: 1,
      birth: 1983,
      path: '/',
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: null,
      attachments: [] } ] ]
[2016-10-19 19:38:44.180] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 19:38:44.196] [INFO] console - Executing (44263e5c-e665-48c5-b2c0-4afab04575b4): START TRANSACTION;
[2016-10-19 19:38:44.200] [INFO] console - Executing (44263e5c-e665-48c5-b2c0-4afab04575b4): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:38:44.225] [INFO] console - Executing (44263e5c-e665-48c5-b2c0-4afab04575b4): INSERT INTO "Kopnik" ("id","name","surname","patronymic","voiskoSize","birth","path","created_at","updated_at","dom_id","starshina_id") VALUES (DEFAULT,'temp','temp','temp',0,1900,'/','2016-10-19 14:38:44.205 +00:00','2016-10-19 14:38:44.205 +00:00',2,NULL) RETURNING *;
[2016-10-19 19:38:44.233] [INFO] console - Executing (44263e5c-e665-48c5-b2c0-4afab04575b4): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 19:38:44.242] [INFO] console - Executing (44263e5c-e665-48c5-b2c0-4afab04575b4): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 19:38:44.250] [INFO] console - Executing (44263e5c-e665-48c5-b2c0-4afab04575b4): update "Zemla"
                                    set "obshinaSize"= "obshinaSize"+ 1
                                where
                                    '/1/' like path||id||'/%'
                                    or (
                                        true 
                                        and id= 2
                                    )
[2016-10-19 19:38:44.255] [INFO] console - Executing (44263e5c-e665-48c5-b2c0-4afab04575b4): COMMIT;
[2016-10-19 19:38:44.263] [INFO] console - [ 70, 270, {}, [ '39' ] ]
[2016-10-19 19:38:44.276] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 19:38:44.286] [INFO] console - Executing (default): select z.*
                                    from "Zemla" as z
                                where
                                    '/1/' like z.path||z.id||'/%'
[2016-10-19 19:38:44.289] [INFO] console - Executing (fa689da9-b439-4e7f-8af9-322ab8fb4ccd): START TRANSACTION;
[2016-10-19 19:38:44.296] [INFO] console - Executing (fa689da9-b439-4e7f-8af9-322ab8fb4ccd): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:38:44.306] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" IN ('1')) ORDER BY "Zemla"."path" desc;
[2016-10-19 19:38:44.319] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 39);
[2016-10-19 19:38:44.320] [INFO] console - [ 16,
  1456382737907712,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id2.obshinaChange',
  [],
  { obshinaSize: 37 } ]
[2016-10-19 19:38:44.335] [INFO] console - [ 16,
  8608704066748416,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id1.obshinaChange',
  [],
  { obshinaSize: 39 } ]
[2016-10-19 19:38:44.349] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 19:38:44.358] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 19:38:44.368] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 19:38:44.374] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 19:38:44.388] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='2',"updated_at"='2016-10-19 14:38:44.377 +00:00' WHERE "id" = '39'
[2016-10-19 19:38:44.394] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/', '/2/')
                                where
                                    id = '39'
                                    or path like '/39/'||'%'
[2016-10-19 19:38:44.398] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 19:38:44.403] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 19:38:44.417] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 19:38:44.424] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/2/39/'||'%'
[2016-10-19 19:38:44.428] [INFO] console - Executing (fa689da9-b439-4e7f-8af9-322ab8fb4ccd): COMMIT;
[2016-10-19 19:38:44.432] [INFO] console - [ 70, 271, {}, [ undefined ] ]
[2016-10-19 19:38:44.437] [INFO] console - [ 16,
  3049759359107072,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.druzhinaChange',
  [],
  { action: 'add',
    kopnik: 
     { fullName: 'temp temp',
       fullPath: '/2/39/',
       id: '39',
       email: null,
       password: null,
       name: 'temp',
       surname: 'temp',
       patronymic: 'temp',
       voiskoSize: 0,
       birth: 1900,
       path: '/2/',
       note: null,
       created_at: Wed Oct 19 2016 19:38:44 GMT+0500 (YEKT),
       updated_at: Wed Oct 19 2016 19:38:44 GMT+0500 (YEKT),
       deleted_at: null,
       dom_id: '2',
       starshina_id: '2' } } ]
[2016-10-19 19:38:44.456] [INFO] console - [ 16,
  3537394026414080,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 2 } ]
[2016-10-19 19:39:28.118] [INFO] console - [ 70, 273, {}, [ undefined ] ]
[2016-10-19 19:39:28.150] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 2 }
[2016-10-19 19:39:28.207] [INFO] console - Executing (default): delete from "Kopnik"
                where
                    name like '%temp'
                    or name like 'temp%'
[2016-10-19 19:39:28.212] [INFO] console - Executing (148ece22-a113-4d51-8a39-3b1a41b58e00): START TRANSACTION;
[2016-10-19 19:39:28.216] [INFO] console - Executing (148ece22-a113-4d51-8a39-3b1a41b58e00): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:39:28.245] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 19:39:28.272] [INFO] console - Executing (default): update "Kopnik"
                set 
                    "voiskoSize"= case when id=2 then 1 ELSE 0 END
                where
                    id>1 
                    and id<=5
[2016-10-19 19:39:28.284] [INFO] console - Executing (148ece22-a113-4d51-8a39-3b1a41b58e00): COMMIT;
[2016-10-19 19:39:28.289] [INFO] console - [ 70,
  274,
  {},
  [ { fullName: 'Unit Test',
      fullPath: '/2/',
      id: '2',
      email: 'unittest2@domain.ru',
      name: 'Unit',
      surname: 'Test',
      patronymic: '1',
      voiskoSize: 2,
      birth: 1983,
      path: '/',
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: null,
      attachments: [] } ] ]
[2016-10-19 19:39:28.368] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 19:39:28.385] [INFO] console - Executing (e7b55207-635f-484b-9eea-2d4dd22a1235): START TRANSACTION;
[2016-10-19 19:39:28.391] [INFO] console - Executing (e7b55207-635f-484b-9eea-2d4dd22a1235): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:39:28.424] [INFO] console - Executing (e7b55207-635f-484b-9eea-2d4dd22a1235): INSERT INTO "Kopnik" ("id","name","surname","patronymic","voiskoSize","birth","path","created_at","updated_at","dom_id","starshina_id") VALUES (DEFAULT,'temp','temp','temp',0,1900,'/','2016-10-19 14:39:28.402 +00:00','2016-10-19 14:39:28.402 +00:00',2,NULL) RETURNING *;
[2016-10-19 19:39:28.443] [INFO] console - Executing (e7b55207-635f-484b-9eea-2d4dd22a1235): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 19:39:28.455] [INFO] console - Executing (e7b55207-635f-484b-9eea-2d4dd22a1235): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 19:39:28.464] [INFO] console - Executing (e7b55207-635f-484b-9eea-2d4dd22a1235): update "Zemla"
                                    set "obshinaSize"= "obshinaSize"+ 1
                                where
                                    '/1/' like path||id||'/%'
                                    or (
                                        true 
                                        and id= 2
                                    )
[2016-10-19 19:39:28.479] [INFO] console - Executing (e7b55207-635f-484b-9eea-2d4dd22a1235): COMMIT;
[2016-10-19 19:39:28.485] [INFO] console - [ 70, 275, {}, [ '40' ] ]
[2016-10-19 19:39:28.518] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 19:39:28.531] [INFO] console - Executing (b8520947-5b60-4ebc-8290-9f2acea8e345): START TRANSACTION;
[2016-10-19 19:39:28.541] [INFO] console - Executing (default): select z.*
                                    from "Zemla" as z
                                where
                                    '/1/' like z.path||z.id||'/%'
[2016-10-19 19:39:28.544] [INFO] console - Executing (b8520947-5b60-4ebc-8290-9f2acea8e345): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:39:28.566] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" IN ('1')) ORDER BY "Zemla"."path" desc;
[2016-10-19 19:39:28.570] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 40);
[2016-10-19 19:39:28.583] [INFO] console - [ 16,
  1868868947542016,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id2.obshinaChange',
  [],
  { obshinaSize: 38 } ]
[2016-10-19 19:39:28.593] [INFO] console - [ 16,
  1735732639039488,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id1.obshinaChange',
  [],
  { obshinaSize: 40 } ]
[2016-10-19 19:39:28.720] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 19:39:28.737] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 19:39:28.749] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 19:39:28.758] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 19:39:28.779] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='2',"updated_at"='2016-10-19 14:39:28.762 +00:00' WHERE "id" = '40'
[2016-10-19 19:39:28.793] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/', '/2/')
                                where
                                    id = '40'
                                    or path like '/40/'||'%'
[2016-10-19 19:39:28.799] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 19:39:28.805] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 19:39:28.817] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 19:39:28.825] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/2/40/'||'%'
[2016-10-19 19:39:28.832] [INFO] console - Executing (b8520947-5b60-4ebc-8290-9f2acea8e345): COMMIT;
[2016-10-19 19:39:28.840] [INFO] console - [ 70, 276, {}, [ undefined ] ]
[2016-10-19 19:39:28.846] [INFO] console - [ 16,
  6508313185353728,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.druzhinaChange',
  [],
  { action: 'add',
    kopnik: 
     { fullName: 'temp temp',
       fullPath: '/2/40/',
       id: '40',
       email: null,
       password: null,
       name: 'temp',
       surname: 'temp',
       patronymic: 'temp',
       voiskoSize: 0,
       birth: 1900,
       path: '/2/',
       note: null,
       created_at: Wed Oct 19 2016 19:39:28 GMT+0500 (YEKT),
       updated_at: Wed Oct 19 2016 19:39:28 GMT+0500 (YEKT),
       deleted_at: null,
       dom_id: '2',
       starshina_id: '2' } } ]
[2016-10-19 19:39:28.865] [INFO] console - [ 16,
  8136328227061760,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 2 } ]
[2016-10-19 19:41:24.219] [INFO] console - [ 70, 278, {}, [ undefined ] ]
[2016-10-19 19:41:24.291] [INFO] console - Executing (default): delete from "Kopnik"
                where
                    name like '%temp'
                    or name like 'temp%'
[2016-10-19 19:41:24.311] [INFO] console - Executing (default): update "Kopnik"
                set 
                    "voiskoSize"= case when id=2 then 1 ELSE 0 END
                where
                    id>1 
                    and id<=5
[2016-10-19 19:41:24.318] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 2 }
[2016-10-19 19:41:24.345] [INFO] console - Executing (7a8eecc2-254d-47cc-859f-fec1c0823d68): START TRANSACTION;
[2016-10-19 19:41:24.362] [INFO] console - Executing (7a8eecc2-254d-47cc-859f-fec1c0823d68): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:41:24.437] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 19:41:24.468] [INFO] console - Executing (7a8eecc2-254d-47cc-859f-fec1c0823d68): COMMIT;
[2016-10-19 19:41:24.472] [INFO] console - [ 70,
  279,
  {},
  [ { fullName: 'Unit Test',
      fullPath: '/2/',
      id: '2',
      email: 'unittest2@domain.ru',
      name: 'Unit',
      surname: 'Test',
      patronymic: '1',
      voiskoSize: 1,
      birth: 1983,
      path: '/',
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: null,
      attachments: [] } ] ]
[2016-10-19 19:41:24.547] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 19:41:24.563] [INFO] console - Executing (251dcf7c-5560-4b6d-9a62-dd7d3e12d0f3): START TRANSACTION;
[2016-10-19 19:41:24.566] [INFO] console - Executing (251dcf7c-5560-4b6d-9a62-dd7d3e12d0f3): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:41:24.589] [INFO] console - Executing (251dcf7c-5560-4b6d-9a62-dd7d3e12d0f3): INSERT INTO "Kopnik" ("id","name","surname","patronymic","voiskoSize","birth","path","created_at","updated_at","dom_id","starshina_id") VALUES (DEFAULT,'temp','temp','temp',0,1900,'/','2016-10-19 14:41:24.571 +00:00','2016-10-19 14:41:24.571 +00:00',2,NULL) RETURNING *;
[2016-10-19 19:41:24.598] [INFO] console - Executing (251dcf7c-5560-4b6d-9a62-dd7d3e12d0f3): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 19:41:24.607] [INFO] console - Executing (251dcf7c-5560-4b6d-9a62-dd7d3e12d0f3): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 19:41:24.615] [INFO] console - Executing (251dcf7c-5560-4b6d-9a62-dd7d3e12d0f3): update "Zemla"
                                    set "obshinaSize"= "obshinaSize"+ 1
                                where
                                    '/1/' like path||id||'/%'
                                    or (
                                        true 
                                        and id= 2
                                    )
[2016-10-19 19:41:24.620] [INFO] console - Executing (251dcf7c-5560-4b6d-9a62-dd7d3e12d0f3): COMMIT;
[2016-10-19 19:41:24.623] [INFO] console - [ 70, 280, {}, [ '41' ] ]
[2016-10-19 19:41:24.646] [INFO] console - Executing (91d852a1-d4bf-45ed-a1ef-6d6ce0fda659): START TRANSACTION;
[2016-10-19 19:41:24.655] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 19:41:24.663] [INFO] console - Executing (91d852a1-d4bf-45ed-a1ef-6d6ce0fda659): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:41:24.669] [INFO] console - Executing (default): select z.*
                                    from "Zemla" as z
                                where
                                    '/1/' like z.path||z.id||'/%'
[2016-10-19 19:41:24.682] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 41);
[2016-10-19 19:41:24.696] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" IN ('1')) ORDER BY "Zemla"."path" desc;
[2016-10-19 19:41:24.716] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 19:41:24.717] [INFO] console - [ 16,
  7385765522702336,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id2.obshinaChange',
  [],
  { obshinaSize: 39 } ]
[2016-10-19 19:41:24.754] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 19:41:24.761] [INFO] console - [ 16,
  965719539843072,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id1.obshinaChange',
  [],
  { obshinaSize: 41 } ]
[2016-10-19 19:41:24.790] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 19:41:24.797] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 19:41:24.819] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='2',"updated_at"='2016-10-19 14:41:24.800 +00:00' WHERE "id" = '41'
[2016-10-19 19:41:24.829] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/', '/2/')
                                where
                                    id = '41'
                                    or path like '/41/'||'%'
[2016-10-19 19:41:24.835] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 19:41:24.839] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 19:41:24.850] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 19:41:24.858] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/2/41/'||'%'
[2016-10-19 19:41:24.869] [INFO] console - Executing (91d852a1-d4bf-45ed-a1ef-6d6ce0fda659): COMMIT;
[2016-10-19 19:41:24.873] [INFO] console - [ 70, 281, {}, [ undefined ] ]
[2016-10-19 19:41:24.881] [INFO] console - [ 16,
  7531096971411456,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.druzhinaChange',
  [],
  { action: 'add',
    kopnik: 
     { fullName: 'temp temp',
       fullPath: '/2/41/',
       id: '41',
       email: null,
       password: null,
       name: 'temp',
       surname: 'temp',
       patronymic: 'temp',
       voiskoSize: 0,
       birth: 1900,
       path: '/2/',
       note: null,
       created_at: Wed Oct 19 2016 19:41:24 GMT+0500 (YEKT),
       updated_at: Wed Oct 19 2016 19:41:24 GMT+0500 (YEKT),
       deleted_at: null,
       dom_id: '2',
       starshina_id: '2' } } ]
[2016-10-19 19:41:24.903] [INFO] console - [ 16,
  7893169324687360,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 2 } ]
[2016-10-19 19:42:04.595] [INFO] console - [ 70, 283, {}, [ undefined ] ]
[2016-10-19 19:42:04.636] [INFO] console - Executing (default): delete from "Kopnik"
                where
                    name like '%temp'
                    or name like 'temp%'
[2016-10-19 19:42:04.659] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 2 }
[2016-10-19 19:42:04.676] [INFO] console - Executing (60ebc7a6-5708-4132-b892-4b0f3fa17afb): START TRANSACTION;
[2016-10-19 19:42:04.684] [INFO] console - Executing (60ebc7a6-5708-4132-b892-4b0f3fa17afb): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:42:04.732] [INFO] console - Executing (default): update "Kopnik"
                set 
                    "voiskoSize"= case when id=2 then 1 ELSE 0 END
                where
                    id>1 
                    and id<=5
[2016-10-19 19:42:04.744] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 19:42:04.758] [INFO] console - Executing (60ebc7a6-5708-4132-b892-4b0f3fa17afb): COMMIT;
[2016-10-19 19:42:04.761] [INFO] console - [ 70,
  284,
  {},
  [ { fullName: 'Unit Test',
      fullPath: '/2/',
      id: '2',
      email: 'unittest2@domain.ru',
      name: 'Unit',
      surname: 'Test',
      patronymic: '1',
      voiskoSize: 1,
      birth: 1983,
      path: '/',
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: null,
      attachments: [] } ] ]
[2016-10-19 19:42:04.798] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 19:42:04.808] [INFO] console - Executing (3fb19532-fa8a-4f7e-afac-00f3b8a3779c): START TRANSACTION;
[2016-10-19 19:42:04.811] [INFO] console - Executing (3fb19532-fa8a-4f7e-afac-00f3b8a3779c): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:42:04.832] [INFO] console - Executing (3fb19532-fa8a-4f7e-afac-00f3b8a3779c): INSERT INTO "Kopnik" ("id","name","surname","patronymic","voiskoSize","birth","path","created_at","updated_at","dom_id","starshina_id") VALUES (DEFAULT,'temp','temp','temp',0,1900,'/','2016-10-19 14:42:04.814 +00:00','2016-10-19 14:42:04.814 +00:00',2,NULL) RETURNING *;
[2016-10-19 19:42:04.845] [INFO] console - Executing (3fb19532-fa8a-4f7e-afac-00f3b8a3779c): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 19:42:04.854] [INFO] console - Executing (3fb19532-fa8a-4f7e-afac-00f3b8a3779c): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 19:42:04.861] [INFO] console - Executing (3fb19532-fa8a-4f7e-afac-00f3b8a3779c): update "Zemla"
                                    set "obshinaSize"= "obshinaSize"+ 1
                                where
                                    '/1/' like path||id||'/%'
                                    or (
                                        true 
                                        and id= 2
                                    )
[2016-10-19 19:42:04.866] [INFO] console - Executing (3fb19532-fa8a-4f7e-afac-00f3b8a3779c): COMMIT;
[2016-10-19 19:42:04.870] [INFO] console - [ 70, 285, {}, [ '42' ] ]
[2016-10-19 19:42:04.889] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 19:42:04.896] [INFO] console - Executing (c2f74541-5303-445f-b1ac-f5d26caac33c): START TRANSACTION;
[2016-10-19 19:42:04.900] [INFO] console - Executing (default): select z.*
                                    from "Zemla" as z
                                where
                                    '/1/' like z.path||z.id||'/%'
[2016-10-19 19:42:04.902] [INFO] console - Executing (c2f74541-5303-445f-b1ac-f5d26caac33c): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:42:04.933] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" IN ('1')) ORDER BY "Zemla"."path" desc;
[2016-10-19 19:42:04.936] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 42);
[2016-10-19 19:42:04.948] [INFO] console - [ 16,
  8918404241031168,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id2.obshinaChange',
  [],
  { obshinaSize: 40 } ]
[2016-10-19 19:42:04.964] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 19:42:04.966] [INFO] console - [ 16,
  6133637623840768,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id1.obshinaChange',
  [],
  { obshinaSize: 42 } ]
[2016-10-19 19:42:04.979] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 19:42:04.989] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 19:42:04.995] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 19:42:05.009] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='2',"updated_at"='2016-10-19 14:42:04.999 +00:00' WHERE "id" = '42'
[2016-10-19 19:42:05.020] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/', '/2/')
                                where
                                    id = '42'
                                    or path like '/42/'||'%'
[2016-10-19 19:42:05.029] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 19:42:05.034] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 19:42:05.043] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 19:42:05.052] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/2/42/'||'%'
[2016-10-19 19:42:05.056] [INFO] console - Executing (c2f74541-5303-445f-b1ac-f5d26caac33c): COMMIT;
[2016-10-19 19:42:05.060] [INFO] console - [ 70, 286, {}, [ undefined ] ]
[2016-10-19 19:42:05.065] [INFO] console - [ 16,
  5998865721327616,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.druzhinaChange',
  [],
  { action: 'add',
    kopnik: 
     { fullName: 'temp temp',
       fullPath: '/2/42/',
       id: '42',
       email: null,
       password: null,
       name: 'temp',
       surname: 'temp',
       patronymic: 'temp',
       voiskoSize: 0,
       birth: 1900,
       path: '/2/',
       note: null,
       created_at: Wed Oct 19 2016 19:42:04 GMT+0500 (YEKT),
       updated_at: Wed Oct 19 2016 19:42:04 GMT+0500 (YEKT),
       deleted_at: null,
       dom_id: '2',
       starshina_id: '2' } } ]
[2016-10-19 19:42:05.101] [INFO] console - [ 16,
  8844206546092032,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 2 } ]
[2016-10-19 19:42:35.538] [INFO] console - [ 70, 288, {}, [ undefined ] ]
[2016-10-19 19:42:35.575] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 2 }
[2016-10-19 19:42:35.624] [INFO] console - Executing (default): delete from "Kopnik"
                where
                    name like '%temp'
                    or name like 'temp%'
[2016-10-19 19:42:35.629] [INFO] console - Executing (af20e509-8173-4e94-bfed-136657cc3ad7): START TRANSACTION;
[2016-10-19 19:42:35.633] [INFO] console - Executing (af20e509-8173-4e94-bfed-136657cc3ad7): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:42:35.641] [INFO] console - Executing (default): update "Kopnik"
                set 
                    "voiskoSize"= case when id=2 then 1 ELSE 0 END
                where
                    id>1 
                    and id<=5
[2016-10-19 19:42:35.653] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 19:42:35.682] [INFO] console - Executing (af20e509-8173-4e94-bfed-136657cc3ad7): COMMIT;
[2016-10-19 19:42:35.685] [INFO] console - [ 70,
  289,
  {},
  [ { fullName: 'Unit Test',
      fullPath: '/2/',
      id: '2',
      email: 'unittest2@domain.ru',
      name: 'Unit',
      surname: 'Test',
      patronymic: '1',
      voiskoSize: 1,
      birth: 1983,
      path: '/',
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: null,
      attachments: [] } ] ]
[2016-10-19 19:42:35.727] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 19:42:35.737] [INFO] console - Executing (a49ebab5-1985-4e60-81c8-1aad5628747f): START TRANSACTION;
[2016-10-19 19:42:35.741] [INFO] console - Executing (a49ebab5-1985-4e60-81c8-1aad5628747f): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:42:35.759] [INFO] console - Executing (a49ebab5-1985-4e60-81c8-1aad5628747f): INSERT INTO "Kopnik" ("id","name","surname","patronymic","voiskoSize","birth","path","created_at","updated_at","dom_id","starshina_id") VALUES (DEFAULT,'temp','temp','temp',0,1900,'/','2016-10-19 14:42:35.744 +00:00','2016-10-19 14:42:35.744 +00:00',2,NULL) RETURNING *;
[2016-10-19 19:42:35.767] [INFO] console - Executing (a49ebab5-1985-4e60-81c8-1aad5628747f): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 19:42:35.780] [INFO] console - Executing (a49ebab5-1985-4e60-81c8-1aad5628747f): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 19:42:35.788] [INFO] console - Executing (a49ebab5-1985-4e60-81c8-1aad5628747f): update "Zemla"
                                    set "obshinaSize"= "obshinaSize"+ 1
                                where
                                    '/1/' like path||id||'/%'
                                    or (
                                        true 
                                        and id= 2
                                    )
[2016-10-19 19:42:35.793] [INFO] console - Executing (a49ebab5-1985-4e60-81c8-1aad5628747f): COMMIT;
[2016-10-19 19:42:35.797] [INFO] console - [ 70, 290, {}, [ '43' ] ]
[2016-10-19 19:42:35.820] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 19:42:35.828] [INFO] console - Executing (c229c38e-3d5c-4465-ab82-d03afd93b1e0): START TRANSACTION;
[2016-10-19 19:42:35.832] [INFO] console - Executing (default): select z.*
                                    from "Zemla" as z
                                where
                                    '/1/' like z.path||z.id||'/%'
[2016-10-19 19:42:35.834] [INFO] console - Executing (c229c38e-3d5c-4465-ab82-d03afd93b1e0): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:42:35.857] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" IN ('1')) ORDER BY "Zemla"."path" desc;
[2016-10-19 19:42:35.859] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 43);
[2016-10-19 19:42:35.876] [INFO] console - [ 16,
  5097960840888320,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id2.obshinaChange',
  [],
  { obshinaSize: 41 } ]
[2016-10-19 19:42:35.889] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 19:42:35.892] [INFO] console - [ 16,
  8638989166706688,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id1.obshinaChange',
  [],
  { obshinaSize: 43 } ]
[2016-10-19 19:42:35.908] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 19:42:35.918] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 19:42:35.925] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 19:42:35.936] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='2',"updated_at"='2016-10-19 14:42:35.927 +00:00' WHERE "id" = '43'
[2016-10-19 19:42:35.944] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/', '/2/')
                                where
                                    id = '43'
                                    or path like '/43/'||'%'
[2016-10-19 19:42:35.948] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 19:42:35.953] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 19:42:35.964] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 19:42:35.972] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/2/43/'||'%'
[2016-10-19 19:42:35.979] [INFO] console - Executing (c229c38e-3d5c-4465-ab82-d03afd93b1e0): COMMIT;
[2016-10-19 19:42:35.982] [INFO] console - [ 70, 291, {}, [ undefined ] ]
[2016-10-19 19:42:35.995] [INFO] console - [ 16,
  4584275403866112,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.druzhinaChange',
  [],
  { action: 'add',
    kopnik: 
     { fullName: 'temp temp',
       fullPath: '/2/43/',
       id: '43',
       email: null,
       password: null,
       name: 'temp',
       surname: 'temp',
       patronymic: 'temp',
       voiskoSize: 0,
       birth: 1900,
       path: '/2/',
       note: null,
       created_at: Wed Oct 19 2016 19:42:35 GMT+0500 (YEKT),
       updated_at: Wed Oct 19 2016 19:42:35 GMT+0500 (YEKT),
       deleted_at: null,
       dom_id: '2',
       starshina_id: '2' } } ]
[2016-10-19 19:42:36.018] [INFO] console - [ 16,
  1839553652457472,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 2 } ]
[2016-10-19 19:43:09.174] [INFO] console - [ 70, 293, {}, [ undefined ] ]
[2016-10-19 19:43:09.226] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 2 }
[2016-10-19 19:43:09.278] [INFO] console - Executing (default): delete from "Kopnik"
                where
                    name like '%temp'
                    or name like 'temp%'
[2016-10-19 19:43:09.300] [INFO] console - Executing (e68ebcef-a621-4f6c-8e2f-c16fc4393412): START TRANSACTION;
[2016-10-19 19:43:09.308] [INFO] console - Executing (default): update "Kopnik"
                set 
                    "voiskoSize"= case when id=2 then 1 ELSE 0 END
                where
                    id>1 
                    and id<=5
[2016-10-19 19:43:09.310] [INFO] console - Executing (e68ebcef-a621-4f6c-8e2f-c16fc4393412): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:43:09.348] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 19:43:09.367] [INFO] console - Executing (e68ebcef-a621-4f6c-8e2f-c16fc4393412): COMMIT;
[2016-10-19 19:43:09.373] [INFO] console - [ 70,
  294,
  {},
  [ { fullName: 'Unit Test',
      fullPath: '/2/',
      id: '2',
      email: 'unittest2@domain.ru',
      name: 'Unit',
      surname: 'Test',
      patronymic: '1',
      voiskoSize: 1,
      birth: 1983,
      path: '/',
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: null,
      attachments: [] } ] ]
[2016-10-19 19:43:09.458] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 19:43:09.467] [INFO] console - Executing (8a92d021-0fe3-45e6-8c7b-2132cd071c65): START TRANSACTION;
[2016-10-19 19:43:09.470] [INFO] console - Executing (8a92d021-0fe3-45e6-8c7b-2132cd071c65): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:43:09.491] [INFO] console - Executing (8a92d021-0fe3-45e6-8c7b-2132cd071c65): INSERT INTO "Kopnik" ("id","name","surname","patronymic","voiskoSize","birth","path","created_at","updated_at","dom_id","starshina_id") VALUES (DEFAULT,'temp','temp','temp',0,1900,'/','2016-10-19 14:43:09.476 +00:00','2016-10-19 14:43:09.476 +00:00',2,NULL) RETURNING *;
[2016-10-19 19:43:09.507] [INFO] console - Executing (8a92d021-0fe3-45e6-8c7b-2132cd071c65): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 19:43:09.517] [INFO] console - Executing (8a92d021-0fe3-45e6-8c7b-2132cd071c65): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 19:43:09.523] [INFO] console - Executing (8a92d021-0fe3-45e6-8c7b-2132cd071c65): update "Zemla"
                                    set "obshinaSize"= "obshinaSize"+ 1
                                where
                                    '/1/' like path||id||'/%'
                                    or (
                                        true 
                                        and id= 2
                                    )
[2016-10-19 19:43:09.528] [INFO] console - Executing (8a92d021-0fe3-45e6-8c7b-2132cd071c65): COMMIT;
[2016-10-19 19:43:09.532] [INFO] console - [ 70, 295, {}, [ '44' ] ]
[2016-10-19 19:43:09.557] [INFO] console - Executing (b72f17b5-437e-4e69-83fd-16cad1cf1d79): START TRANSACTION;
[2016-10-19 19:43:09.563] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 19:43:09.567] [INFO] console - Executing (b72f17b5-437e-4e69-83fd-16cad1cf1d79): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:43:09.580] [INFO] console - Executing (default): select z.*
                                    from "Zemla" as z
                                where
                                    '/1/' like z.path||z.id||'/%'
[2016-10-19 19:43:09.586] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 44);
[2016-10-19 19:43:09.609] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" IN ('1')) ORDER BY "Zemla"."path" desc;
[2016-10-19 19:43:09.611] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 19:43:09.621] [INFO] console - [ 16,
  5849880018812928,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id2.obshinaChange',
  [],
  { obshinaSize: 42 } ]
[2016-10-19 19:43:09.629] [INFO] console - [ 16,
  3683256700502016,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id1.obshinaChange',
  [],
  { obshinaSize: 44 } ]
[2016-10-19 19:43:09.636] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 19:43:09.648] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 19:43:09.654] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 19:43:09.669] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='2',"updated_at"='2016-10-19 14:43:09.657 +00:00' WHERE "id" = '44'
[2016-10-19 19:43:09.675] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/', '/2/')
                                where
                                    id = '44'
                                    or path like '/44/'||'%'
[2016-10-19 19:43:09.681] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 19:43:09.689] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 19:43:09.698] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 19:43:09.705] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/2/44/'||'%'
[2016-10-19 19:43:09.709] [INFO] console - Executing (b72f17b5-437e-4e69-83fd-16cad1cf1d79): COMMIT;
[2016-10-19 19:43:09.713] [INFO] console - [ 70, 296, {}, [ undefined ] ]
[2016-10-19 19:43:09.721] [INFO] console - [ 16,
  4464759204216832,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.druzhinaChange',
  [],
  { action: 'add',
    kopnik: 
     { fullName: 'temp temp',
       fullPath: '/2/44/',
       id: '44',
       email: null,
       password: null,
       name: 'temp',
       surname: 'temp',
       patronymic: 'temp',
       voiskoSize: 0,
       birth: 1900,
       path: '/2/',
       note: null,
       created_at: Wed Oct 19 2016 19:43:09 GMT+0500 (YEKT),
       updated_at: Wed Oct 19 2016 19:43:09 GMT+0500 (YEKT),
       deleted_at: null,
       dom_id: '2',
       starshina_id: '2' } } ]
[2016-10-19 19:43:09.747] [INFO] console - [ 16,
  293436815048704,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 2 } ]
[2016-10-19 19:44:04.092] [INFO] console - [ 70, 298, {}, [ undefined ] ]
[2016-10-19 19:44:04.120] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 2 }
[2016-10-19 19:44:04.158] [INFO] console - Executing (default): delete from "Kopnik"
                where
                    name like '%temp'
                    or name like 'temp%'
[2016-10-19 19:44:04.173] [INFO] console - Executing (43e1d28c-ecd1-4e34-a2eb-a15b81c74762): START TRANSACTION;
[2016-10-19 19:44:04.177] [INFO] console - Executing (43e1d28c-ecd1-4e34-a2eb-a15b81c74762): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:44:04.184] [INFO] console - Executing (default): update "Kopnik"
                set 
                    "voiskoSize"= case when id=2 then 1 ELSE 0 END
                where
                    id>1 
                    and id<=5
[2016-10-19 19:44:04.198] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 19:44:04.221] [INFO] console - Executing (43e1d28c-ecd1-4e34-a2eb-a15b81c74762): COMMIT;
[2016-10-19 19:44:04.226] [INFO] console - [ 70,
  299,
  {},
  [ { fullName: 'Unit Test',
      fullPath: '/2/',
      id: '2',
      email: 'unittest2@domain.ru',
      name: 'Unit',
      surname: 'Test',
      patronymic: '1',
      voiskoSize: 1,
      birth: 1983,
      path: '/',
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: null,
      attachments: [] } ] ]
[2016-10-19 19:44:04.269] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 19:44:04.278] [INFO] console - Executing (d83ab5fb-89a3-4d60-8caf-eb32af2d2a59): START TRANSACTION;
[2016-10-19 19:44:04.283] [INFO] console - Executing (d83ab5fb-89a3-4d60-8caf-eb32af2d2a59): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:44:04.298] [INFO] console - Executing (d83ab5fb-89a3-4d60-8caf-eb32af2d2a59): INSERT INTO "Kopnik" ("id","name","surname","patronymic","voiskoSize","birth","path","created_at","updated_at","dom_id","starshina_id") VALUES (DEFAULT,'temp','temp','temp',0,1900,'/','2016-10-19 14:44:04.287 +00:00','2016-10-19 14:44:04.287 +00:00',2,NULL) RETURNING *;
[2016-10-19 19:44:04.309] [INFO] console - Executing (d83ab5fb-89a3-4d60-8caf-eb32af2d2a59): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 19:44:04.319] [INFO] console - Executing (d83ab5fb-89a3-4d60-8caf-eb32af2d2a59): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 19:44:04.326] [INFO] console - Executing (d83ab5fb-89a3-4d60-8caf-eb32af2d2a59): update "Zemla"
                                    set "obshinaSize"= "obshinaSize"+ 1
                                where
                                    '/1/' like path||id||'/%'
                                    or (
                                        true 
                                        and id= 2
                                    )
[2016-10-19 19:44:04.330] [INFO] console - Executing (d83ab5fb-89a3-4d60-8caf-eb32af2d2a59): COMMIT;
[2016-10-19 19:44:04.337] [INFO] console - [ 70, 300, {}, [ '45' ] ]
[2016-10-19 19:44:04.358] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 19:44:04.367] [INFO] console - Executing (db649f1a-3d5e-42a4-80c3-d974157705bf): START TRANSACTION;
[2016-10-19 19:44:04.370] [INFO] console - Executing (default): select z.*
                                    from "Zemla" as z
                                where
                                    '/1/' like z.path||z.id||'/%'
[2016-10-19 19:44:04.373] [INFO] console - Executing (db649f1a-3d5e-42a4-80c3-d974157705bf): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:44:04.391] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" IN ('1')) ORDER BY "Zemla"."path" desc;
[2016-10-19 19:44:04.393] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 45);
[2016-10-19 19:44:04.404] [INFO] console - [ 16,
  392231508770816,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id2.obshinaChange',
  [],
  { obshinaSize: 43 } ]
[2016-10-19 19:44:04.413] [INFO] console - [ 16,
  3735163110424576,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id1.obshinaChange',
  [],
  { obshinaSize: 45 } ]
[2016-10-19 19:44:04.432] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 19:44:04.441] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 19:44:04.452] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 19:44:04.457] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 19:44:04.475] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='2',"updated_at"='2016-10-19 14:44:04.461 +00:00' WHERE "id" = '45'
[2016-10-19 19:44:04.480] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/', '/2/')
                                where
                                    id = '45'
                                    or path like '/45/'||'%'
[2016-10-19 19:44:04.487] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 19:44:04.491] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 19:44:04.503] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 19:44:04.510] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/2/45/'||'%'
[2016-10-19 19:44:04.518] [INFO] console - Executing (db649f1a-3d5e-42a4-80c3-d974157705bf): COMMIT;
[2016-10-19 19:44:04.523] [INFO] console - [ 70, 301, {}, [ undefined ] ]
[2016-10-19 19:44:04.534] [INFO] console - [ 16,
  2170500887347200,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.druzhinaChange',
  [],
  { action: 'add',
    kopnik: 
     { fullName: 'temp temp',
       fullPath: '/2/45/',
       id: '45',
       email: null,
       password: null,
       name: 'temp',
       surname: 'temp',
       patronymic: 'temp',
       voiskoSize: 0,
       birth: 1900,
       path: '/2/',
       note: null,
       created_at: Wed Oct 19 2016 19:44:04 GMT+0500 (YEKT),
       updated_at: Wed Oct 19 2016 19:44:04 GMT+0500 (YEKT),
       deleted_at: null,
       dom_id: '2',
       starshina_id: '2' } } ]
[2016-10-19 19:44:04.560] [INFO] console - [ 16,
  6900334442053632,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 2 } ]
[2016-10-19 19:44:33.541] [INFO] console - [ 70, 303, {}, [ undefined ] ]
[2016-10-19 19:44:33.589] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 2 }
[2016-10-19 19:44:33.643] [INFO] console - Executing (default): delete from "Kopnik"
                where
                    name like '%temp'
                    or name like 'temp%'
[2016-10-19 19:44:33.672] [INFO] console - Executing (57093139-b7dc-4180-85c0-b00ad591b74e): START TRANSACTION;
[2016-10-19 19:44:33.683] [INFO] console - Executing (default): update "Kopnik"
                set 
                    "voiskoSize"= case when id=2 then 1 ELSE 0 END
                where
                    id>1 
                    and id<=5
[2016-10-19 19:44:33.685] [INFO] console - Executing (57093139-b7dc-4180-85c0-b00ad591b74e): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:44:33.781] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 19:44:33.816] [INFO] console - Executing (57093139-b7dc-4180-85c0-b00ad591b74e): COMMIT;
[2016-10-19 19:44:33.826] [INFO] console - [ 70,
  304,
  {},
  [ { fullName: 'Unit Test',
      fullPath: '/2/',
      id: '2',
      email: 'unittest2@domain.ru',
      name: 'Unit',
      surname: 'Test',
      patronymic: '1',
      voiskoSize: 1,
      birth: 1983,
      path: '/',
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: null,
      attachments: [] } ] ]
[2016-10-19 19:44:33.897] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 19:44:33.930] [INFO] console - Executing (42590269-bd22-4bd4-8155-82562a83bbe6): START TRANSACTION;
[2016-10-19 19:44:33.940] [INFO] console - Executing (42590269-bd22-4bd4-8155-82562a83bbe6): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:44:33.980] [INFO] console - Executing (42590269-bd22-4bd4-8155-82562a83bbe6): INSERT INTO "Kopnik" ("id","name","surname","patronymic","voiskoSize","birth","path","created_at","updated_at","dom_id","starshina_id") VALUES (DEFAULT,'temp','temp','temp',0,1900,'/','2016-10-19 14:44:33.950 +00:00','2016-10-19 14:44:33.950 +00:00',2,NULL) RETURNING *;
[2016-10-19 19:44:34.036] [INFO] console - Executing (42590269-bd22-4bd4-8155-82562a83bbe6): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 19:44:34.053] [INFO] console - Executing (42590269-bd22-4bd4-8155-82562a83bbe6): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 19:44:34.072] [INFO] console - Executing (42590269-bd22-4bd4-8155-82562a83bbe6): update "Zemla"
                                    set "obshinaSize"= "obshinaSize"+ 1
                                where
                                    '/1/' like path||id||'/%'
                                    or (
                                        true 
                                        and id= 2
                                    )
[2016-10-19 19:44:34.086] [INFO] console - Executing (42590269-bd22-4bd4-8155-82562a83bbe6): COMMIT;
[2016-10-19 19:44:34.089] [INFO] console - [ 70, 305, {}, [ '46' ] ]
[2016-10-19 19:44:34.129] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 19:44:34.143] [INFO] console - Executing (5422f01e-f971-4679-a878-319f4789780a): START TRANSACTION;
[2016-10-19 19:44:34.150] [INFO] console - Executing (default): select z.*
                                    from "Zemla" as z
                                where
                                    '/1/' like z.path||z.id||'/%'
[2016-10-19 19:44:34.155] [INFO] console - Executing (5422f01e-f971-4679-a878-319f4789780a): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:44:34.186] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" IN ('1')) ORDER BY "Zemla"."path" desc;
[2016-10-19 19:44:34.189] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 46);
[2016-10-19 19:44:34.202] [INFO] console - [ 16,
  1245882984955904,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id2.obshinaChange',
  [],
  { obshinaSize: 44 } ]
[2016-10-19 19:44:34.217] [INFO] console - [ 16,
  6730080254427136,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id1.obshinaChange',
  [],
  { obshinaSize: 46 } ]
[2016-10-19 19:44:34.233] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 19:44:34.246] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 19:44:34.255] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 19:44:34.263] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 19:44:34.280] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='2',"updated_at"='2016-10-19 14:44:34.266 +00:00' WHERE "id" = '46'
[2016-10-19 19:44:34.286] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/', '/2/')
                                where
                                    id = '46'
                                    or path like '/46/'||'%'
[2016-10-19 19:44:34.290] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 19:44:34.302] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 19:44:34.314] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 19:44:34.326] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/2/46/'||'%'
[2016-10-19 19:44:34.332] [INFO] console - Executing (5422f01e-f971-4679-a878-319f4789780a): COMMIT;
[2016-10-19 19:44:34.335] [INFO] console - [ 70, 306, {}, [ undefined ] ]
[2016-10-19 19:44:34.342] [INFO] console - [ 16,
  4954996571373568,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.druzhinaChange',
  [],
  { action: 'add',
    kopnik: 
     { fullName: 'temp temp',
       fullPath: '/2/46/',
       id: '46',
       email: null,
       password: null,
       name: 'temp',
       surname: 'temp',
       patronymic: 'temp',
       voiskoSize: 0,
       birth: 1900,
       path: '/2/',
       note: null,
       created_at: Wed Oct 19 2016 19:44:33 GMT+0500 (YEKT),
       updated_at: Wed Oct 19 2016 19:44:34 GMT+0500 (YEKT),
       deleted_at: null,
       dom_id: '2',
       starshina_id: '2' } } ]
[2016-10-19 19:44:34.363] [INFO] console - [ 16,
  6359054121172992,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 2 } ]
[2016-10-19 19:48:30.456] [INFO] console - [ 70, 308, {}, [ undefined ] ]
[2016-10-19 19:48:30.502] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 2 }
[2016-10-19 19:48:30.574] [INFO] console - Executing (default): delete from "Kopnik"
                where
                    name like '%temp'
                    or name like 'temp%'
[2016-10-19 19:48:30.587] [INFO] console - Executing (313c61e6-6834-4999-bf21-615995bd3c0a): START TRANSACTION;
[2016-10-19 19:48:30.591] [INFO] console - Executing (313c61e6-6834-4999-bf21-615995bd3c0a): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:48:30.621] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 19:48:30.677] [INFO] console - Executing (default): update "Kopnik"
                set 
                    "voiskoSize"= case when id=2 then 1 ELSE 0 END
                where
                    id>1 
                    and id<=5
[2016-10-19 19:48:30.697] [INFO] console - Executing (313c61e6-6834-4999-bf21-615995bd3c0a): COMMIT;
[2016-10-19 19:48:30.712] [INFO] console - [ 70,
  309,
  {},
  [ { fullName: 'Unit Test',
      fullPath: '/2/',
      id: '2',
      email: 'unittest2@domain.ru',
      name: 'Unit',
      surname: 'Test',
      patronymic: '1',
      voiskoSize: 2,
      birth: 1983,
      path: '/',
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: null,
      attachments: [] } ] ]
[2016-10-19 19:48:30.765] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 19:48:30.776] [INFO] console - Executing (e35b8c3a-0992-4458-b372-0b602273c551): START TRANSACTION;
[2016-10-19 19:48:30.781] [INFO] console - Executing (e35b8c3a-0992-4458-b372-0b602273c551): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:48:30.806] [INFO] console - Executing (e35b8c3a-0992-4458-b372-0b602273c551): INSERT INTO "Kopnik" ("id","name","surname","patronymic","voiskoSize","birth","path","created_at","updated_at","dom_id","starshina_id") VALUES (DEFAULT,'temp','temp','temp',0,1900,'/','2016-10-19 14:48:30.787 +00:00','2016-10-19 14:48:30.787 +00:00',2,NULL) RETURNING *;
[2016-10-19 19:48:30.817] [INFO] console - Executing (e35b8c3a-0992-4458-b372-0b602273c551): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 19:48:30.833] [INFO] console - Executing (e35b8c3a-0992-4458-b372-0b602273c551): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 19:48:30.847] [INFO] console - Executing (e35b8c3a-0992-4458-b372-0b602273c551): update "Zemla"
                                    set "obshinaSize"= "obshinaSize"+ 1
                                where
                                    '/1/' like path||id||'/%'
                                    or (
                                        true 
                                        and id= 2
                                    )
[2016-10-19 19:48:30.854] [INFO] console - Executing (e35b8c3a-0992-4458-b372-0b602273c551): COMMIT;
[2016-10-19 19:48:30.858] [INFO] console - [ 70, 310, {}, [ '47' ] ]
[2016-10-19 19:48:30.883] [INFO] console - Executing (6157e83c-3416-45b0-8d1b-8da1149f2fe2): START TRANSACTION;
[2016-10-19 19:48:30.890] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 19:48:30.895] [INFO] console - Executing (6157e83c-3416-45b0-8d1b-8da1149f2fe2): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:48:30.909] [INFO] console - Executing (default): select z.*
                                    from "Zemla" as z
                                where
                                    '/1/' like z.path||z.id||'/%'
[2016-10-19 19:48:30.918] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 47);
[2016-10-19 19:48:30.939] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" IN ('1')) ORDER BY "Zemla"."path" desc;
[2016-10-19 19:48:30.942] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 19:48:30.957] [INFO] console - [ 16,
  6590759186726912,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id2.obshinaChange',
  [],
  { obshinaSize: 45 } ]
[2016-10-19 19:48:30.966] [INFO] console - [ 16,
  8477442024931328,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id1.obshinaChange',
  [],
  { obshinaSize: 47 } ]
[2016-10-19 19:48:30.975] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 19:48:30.989] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 19:48:31.001] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 19:48:31.020] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='2',"updated_at"='2016-10-19 14:48:31.004 +00:00' WHERE "id" = '47'
[2016-10-19 19:48:31.030] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/', '/2/')
                                where
                                    id = '47'
                                    or path like '/47/'||'%'
[2016-10-19 19:48:31.040] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 19:48:31.063] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 19:48:31.101] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 19:48:31.112] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/2/47/'||'%'
[2016-10-19 19:48:31.117] [INFO] console - Executing (6157e83c-3416-45b0-8d1b-8da1149f2fe2): COMMIT;
[2016-10-19 19:48:31.123] [INFO] console - [ 70, 311, {}, [ undefined ] ]
[2016-10-19 19:48:31.138] [INFO] console - [ 16,
  2920754907709440,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.druzhinaChange',
  [],
  { action: 'add',
    kopnik: 
     { fullName: 'temp temp',
       fullPath: '/2/47/',
       id: '47',
       email: null,
       password: null,
       name: 'temp',
       surname: 'temp',
       patronymic: 'temp',
       voiskoSize: 0,
       birth: 1900,
       path: '/2/',
       note: null,
       created_at: Wed Oct 19 2016 19:48:30 GMT+0500 (YEKT),
       updated_at: Wed Oct 19 2016 19:48:31 GMT+0500 (YEKT),
       deleted_at: null,
       dom_id: '2',
       starshina_id: '2' } } ]
[2016-10-19 19:48:31.168] [INFO] console - [ 16,
  5031996688433152,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 2 } ]
[2016-10-19 19:49:02.228] [INFO] console - [ 70, 313, {}, [ undefined ] ]
[2016-10-19 19:49:02.262] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 2 }
[2016-10-19 19:49:02.298] [INFO] console - Executing (default): delete from "Kopnik"
                where
                    name like '%temp'
                    or name like 'temp%'
[2016-10-19 19:49:02.317] [INFO] console - Executing (097dca00-60a5-4f7b-8777-6378dc26be94): START TRANSACTION;
[2016-10-19 19:49:02.323] [INFO] console - Executing (097dca00-60a5-4f7b-8777-6378dc26be94): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:49:02.330] [INFO] console - Executing (default): update "Kopnik"
                set 
                    "voiskoSize"= case when id=2 then 1 ELSE 0 END
                where
                    id>1 
                    and id<=5
[2016-10-19 19:49:02.358] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 19:49:02.385] [INFO] console - Executing (097dca00-60a5-4f7b-8777-6378dc26be94): COMMIT;
[2016-10-19 19:49:02.396] [INFO] console - [ 70,
  314,
  {},
  [ { fullName: 'Unit Test',
      fullPath: '/2/',
      id: '2',
      email: 'unittest2@domain.ru',
      name: 'Unit',
      surname: 'Test',
      patronymic: '1',
      voiskoSize: 1,
      birth: 1983,
      path: '/',
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: null,
      attachments: [] } ] ]
[2016-10-19 19:49:02.439] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 19:49:02.450] [INFO] console - Executing (869a3d4c-48ad-497c-9c68-d0cbf8d55034): START TRANSACTION;
[2016-10-19 19:49:02.454] [INFO] console - Executing (869a3d4c-48ad-497c-9c68-d0cbf8d55034): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:49:02.467] [INFO] console - Executing (869a3d4c-48ad-497c-9c68-d0cbf8d55034): INSERT INTO "Kopnik" ("id","name","surname","patronymic","voiskoSize","birth","path","created_at","updated_at","dom_id","starshina_id") VALUES (DEFAULT,'temp','temp','temp',0,1900,'/','2016-10-19 14:49:02.457 +00:00','2016-10-19 14:49:02.457 +00:00',2,NULL) RETURNING *;
[2016-10-19 19:49:02.475] [INFO] console - Executing (869a3d4c-48ad-497c-9c68-d0cbf8d55034): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 19:49:02.486] [INFO] console - Executing (869a3d4c-48ad-497c-9c68-d0cbf8d55034): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 19:49:02.493] [INFO] console - Executing (869a3d4c-48ad-497c-9c68-d0cbf8d55034): update "Zemla"
                                    set "obshinaSize"= "obshinaSize"+ 1
                                where
                                    '/1/' like path||id||'/%'
                                    or (
                                        true 
                                        and id= 2
                                    )
[2016-10-19 19:49:02.497] [INFO] console - Executing (869a3d4c-48ad-497c-9c68-d0cbf8d55034): COMMIT;
[2016-10-19 19:49:02.501] [INFO] console - [ 70, 315, {}, [ '48' ] ]
[2016-10-19 19:49:02.517] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 19:49:02.533] [INFO] console - Executing (default): select z.*
                                    from "Zemla" as z
                                where
                                    '/1/' like z.path||z.id||'/%'
[2016-10-19 19:49:02.545] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" IN ('1')) ORDER BY "Zemla"."path" desc;
[2016-10-19 19:49:02.553] [INFO] console - [ 16,
  7368148374257664,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id2.obshinaChange',
  [],
  { obshinaSize: 46 } ]
[2016-10-19 19:49:02.569] [INFO] console - [ 16,
  5173208137334784,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id1.obshinaChange',
  [],
  { obshinaSize: 48 } ]
[2016-10-19 19:49:02.583] [INFO] console - Executing (eb62f02b-822b-47ba-88ac-7ee9b9c5a031): START TRANSACTION;
[2016-10-19 19:49:02.586] [INFO] console - Executing (eb62f02b-822b-47ba-88ac-7ee9b9c5a031): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:49:02.600] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 48);
[2016-10-19 19:49:02.622] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 19:49:02.631] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 19:49:02.647] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 19:49:02.654] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 19:49:02.669] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='2',"updated_at"='2016-10-19 14:49:02.657 +00:00' WHERE "id" = '48'
[2016-10-19 19:49:02.673] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/', '/2/')
                                where
                                    id = '48'
                                    or path like '/48/'||'%'
[2016-10-19 19:49:02.679] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 19:49:02.687] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 19:49:02.701] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 19:49:02.709] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/2/48/'||'%'
[2016-10-19 19:49:02.715] [INFO] console - Executing (eb62f02b-822b-47ba-88ac-7ee9b9c5a031): COMMIT;
[2016-10-19 19:49:02.719] [INFO] console - [ 70, 316, {}, [ undefined ] ]
[2016-10-19 19:49:02.727] [INFO] console - [ 16,
  6311597148471296,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.druzhinaChange',
  [],
  { action: 'add',
    kopnik: 
     { fullName: 'temp temp',
       fullPath: '/2/48/',
       id: '48',
       email: null,
       password: null,
       name: 'temp',
       surname: 'temp',
       patronymic: 'temp',
       voiskoSize: 0,
       birth: 1900,
       path: '/2/',
       note: null,
       created_at: Wed Oct 19 2016 19:49:02 GMT+0500 (YEKT),
       updated_at: Wed Oct 19 2016 19:49:02 GMT+0500 (YEKT),
       deleted_at: null,
       dom_id: '2',
       starshina_id: '2' } } ]
[2016-10-19 19:49:02.756] [INFO] console - [ 16,
  2705759928320000,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 2 } ]
[2016-10-19 19:49:31.355] [INFO] console - [ 70, 318, {}, [ undefined ] ]
[2016-10-19 19:49:31.387] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 2 }
[2016-10-19 19:49:32.028] [INFO] console - Executing (default): delete from "Kopnik"
                where
                    name like '%temp'
                    or name like 'temp%'
[2016-10-19 19:49:32.037] [INFO] console - Executing (ae2cdb38-894b-4850-ae22-72fc81bf9564): START TRANSACTION;
[2016-10-19 19:49:32.040] [INFO] console - Executing (ae2cdb38-894b-4850-ae22-72fc81bf9564): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:49:32.086] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 19:49:32.105] [INFO] console - Executing (ae2cdb38-894b-4850-ae22-72fc81bf9564): COMMIT;
[2016-10-19 19:49:32.108] [INFO] console - [ 70,
  319,
  {},
  [ { fullName: 'Unit Test',
      fullPath: '/2/',
      id: '2',
      email: 'unittest2@domain.ru',
      name: 'Unit',
      surname: 'Test',
      patronymic: '1',
      voiskoSize: 2,
      birth: 1983,
      path: '/',
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: null,
      attachments: [] } ] ]
[2016-10-19 19:49:32.158] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 19:49:32.165] [INFO] console - Executing (31d210b7-2a25-4711-9db0-0b068f87ed4d): START TRANSACTION;
[2016-10-19 19:49:32.168] [INFO] console - Executing (31d210b7-2a25-4711-9db0-0b068f87ed4d): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:49:32.182] [INFO] console - Executing (31d210b7-2a25-4711-9db0-0b068f87ed4d): INSERT INTO "Kopnik" ("id","name","surname","patronymic","voiskoSize","birth","path","created_at","updated_at","dom_id","starshina_id") VALUES (DEFAULT,'temp','temp','temp',0,1900,'/','2016-10-19 14:49:32.171 +00:00','2016-10-19 14:49:32.171 +00:00',2,NULL) RETURNING *;
[2016-10-19 19:49:32.197] [INFO] console - Executing (31d210b7-2a25-4711-9db0-0b068f87ed4d): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 19:49:32.206] [INFO] console - Executing (31d210b7-2a25-4711-9db0-0b068f87ed4d): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 19:49:32.215] [INFO] console - Executing (31d210b7-2a25-4711-9db0-0b068f87ed4d): update "Zemla"
                                    set "obshinaSize"= "obshinaSize"+ 1
                                where
                                    '/1/' like path||id||'/%'
                                    or (
                                        true 
                                        and id= 2
                                    )
[2016-10-19 19:49:32.220] [INFO] console - Executing (31d210b7-2a25-4711-9db0-0b068f87ed4d): COMMIT;
[2016-10-19 19:49:32.289] [INFO] console - Executing (default): update "Kopnik"
                set 
                    "voiskoSize"= case when id=2 then 1 ELSE 0 END
                where
                    id>1 
                    and id<=5
[2016-10-19 19:49:32.300] [INFO] console - [ 70, 320, {}, [ '49' ] ]
[2016-10-19 19:49:32.323] [INFO] console - Executing (f4c5b815-cc7a-451a-98a8-be1d1940093b): START TRANSACTION;
[2016-10-19 19:49:32.331] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 19:49:32.338] [INFO] console - Executing (f4c5b815-cc7a-451a-98a8-be1d1940093b): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:49:32.343] [INFO] console - Executing (default): select z.*
                                    from "Zemla" as z
                                where
                                    '/1/' like z.path||z.id||'/%'
[2016-10-19 19:49:32.379] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 49);
[2016-10-19 19:49:32.400] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" IN ('1')) ORDER BY "Zemla"."path" desc;
[2016-10-19 19:49:32.431] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 19:49:32.438] [INFO] console - [ 16,
  3831633182457856,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id2.obshinaChange',
  [],
  { obshinaSize: 47 } ]
[2016-10-19 19:49:32.466] [INFO] console - [ 16,
  6575967277416448,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id1.obshinaChange',
  [],
  { obshinaSize: 49 } ]
[2016-10-19 19:49:32.473] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 19:49:32.495] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 19:49:32.502] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 19:49:32.523] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='2',"updated_at"='2016-10-19 14:49:32.508 +00:00' WHERE "id" = '49'
[2016-10-19 19:49:32.528] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/', '/2/')
                                where
                                    id = '49'
                                    or path like '/49/'||'%'
[2016-10-19 19:49:32.535] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 19:49:32.543] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 19:49:32.554] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 19:49:32.561] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/2/49/'||'%'
[2016-10-19 19:49:32.567] [INFO] console - Executing (f4c5b815-cc7a-451a-98a8-be1d1940093b): COMMIT;
[2016-10-19 19:49:32.571] [INFO] console - [ 70, 321, {}, [ undefined ] ]
[2016-10-19 19:49:32.583] [INFO] console - [ 16,
  5594474078011392,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.druzhinaChange',
  [],
  { action: 'add',
    kopnik: 
     { fullName: 'temp temp',
       fullPath: '/2/49/',
       id: '49',
       email: null,
       password: null,
       name: 'temp',
       surname: 'temp',
       patronymic: 'temp',
       voiskoSize: 0,
       birth: 1900,
       path: '/2/',
       note: null,
       created_at: Wed Oct 19 2016 19:49:32 GMT+0500 (YEKT),
       updated_at: Wed Oct 19 2016 19:49:32 GMT+0500 (YEKT),
       deleted_at: null,
       dom_id: '2',
       starshina_id: '2' } } ]
[2016-10-19 19:49:32.618] [INFO] console - [ 16,
  2686952442691584,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 2 } ]
[2016-10-19 19:49:55.135] [INFO] console - [ 70, 323, {}, [ undefined ] ]
[2016-10-19 19:49:55.158] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 2 }
[2016-10-19 19:49:55.209] [INFO] console - Executing (default): delete from "Kopnik"
                where
                    name like '%temp'
                    or name like 'temp%'
[2016-10-19 19:49:55.227] [INFO] console - Executing (3e0a216e-053c-412a-b76d-c9f8e94dabdb): START TRANSACTION;
[2016-10-19 19:49:55.236] [INFO] console - Executing (default): update "Kopnik"
                set 
                    "voiskoSize"= case when id=2 then 1 ELSE 0 END
                where
                    id>1 
                    and id<=5
[2016-10-19 19:49:55.239] [INFO] console - Executing (3e0a216e-053c-412a-b76d-c9f8e94dabdb): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:49:55.268] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 19:49:55.290] [INFO] console - Executing (3e0a216e-053c-412a-b76d-c9f8e94dabdb): COMMIT;
[2016-10-19 19:49:55.309] [INFO] console - [ 70,
  324,
  {},
  [ { fullName: 'Unit Test',
      fullPath: '/2/',
      id: '2',
      email: 'unittest2@domain.ru',
      name: 'Unit',
      surname: 'Test',
      patronymic: '1',
      voiskoSize: 1,
      birth: 1983,
      path: '/',
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: null,
      attachments: [] } ] ]
[2016-10-19 19:49:55.352] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 19:49:55.365] [INFO] console - Executing (0ff53590-00df-4502-b268-532ef4cab191): START TRANSACTION;
[2016-10-19 19:49:55.369] [INFO] console - Executing (0ff53590-00df-4502-b268-532ef4cab191): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:49:55.397] [INFO] console - Executing (0ff53590-00df-4502-b268-532ef4cab191): INSERT INTO "Kopnik" ("id","name","surname","patronymic","voiskoSize","birth","path","created_at","updated_at","dom_id","starshina_id") VALUES (DEFAULT,'temp','temp','temp',0,1900,'/','2016-10-19 14:49:55.373 +00:00','2016-10-19 14:49:55.373 +00:00',2,NULL) RETURNING *;
[2016-10-19 19:49:55.406] [INFO] console - Executing (0ff53590-00df-4502-b268-532ef4cab191): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 19:49:55.420] [INFO] console - Executing (0ff53590-00df-4502-b268-532ef4cab191): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 19:49:55.427] [INFO] console - Executing (0ff53590-00df-4502-b268-532ef4cab191): update "Zemla"
                                    set "obshinaSize"= "obshinaSize"+ 1
                                where
                                    '/1/' like path||id||'/%'
                                    or (
                                        true 
                                        and id= 2
                                    )
[2016-10-19 19:49:55.433] [INFO] console - Executing (0ff53590-00df-4502-b268-532ef4cab191): COMMIT;
[2016-10-19 19:49:55.437] [INFO] console - [ 70, 325, {}, [ '50' ] ]
[2016-10-19 19:49:55.462] [INFO] console - Executing (5ba0eaeb-4956-459b-89e3-d05bd4da0375): START TRANSACTION;
[2016-10-19 19:49:55.474] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 19:49:55.482] [INFO] console - Executing (5ba0eaeb-4956-459b-89e3-d05bd4da0375): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:49:55.486] [INFO] console - Executing (default): select z.*
                                    from "Zemla" as z
                                where
                                    '/1/' like z.path||z.id||'/%'
[2016-10-19 19:49:55.500] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 50);
[2016-10-19 19:49:55.514] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" IN ('1')) ORDER BY "Zemla"."path" desc;
[2016-10-19 19:49:55.532] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 19:49:55.535] [INFO] console - [ 16,
  195406143160320,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id2.obshinaChange',
  [],
  { obshinaSize: 48 } ]
[2016-10-19 19:49:55.546] [INFO] console - [ 16,
  8960478126538752,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id1.obshinaChange',
  [],
  { obshinaSize: 50 } ]
[2016-10-19 19:49:55.560] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 19:49:55.573] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 19:49:55.581] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 19:49:55.596] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='2',"updated_at"='2016-10-19 14:49:55.584 +00:00' WHERE "id" = '50'
[2016-10-19 19:49:55.601] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/', '/2/')
                                where
                                    id = '50'
                                    or path like '/50/'||'%'
[2016-10-19 19:49:55.607] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 19:49:55.614] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 19:49:55.625] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 19:49:55.633] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/2/50/'||'%'
[2016-10-19 19:49:55.638] [INFO] console - Executing (5ba0eaeb-4956-459b-89e3-d05bd4da0375): COMMIT;
[2016-10-19 19:49:55.641] [INFO] console - [ 70, 326, {}, [ undefined ] ]
[2016-10-19 19:49:55.646] [INFO] console - [ 16,
  8541737425305600,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.druzhinaChange',
  [],
  { action: 'add',
    kopnik: 
     { fullName: 'temp temp',
       fullPath: '/2/50/',
       id: '50',
       email: null,
       password: null,
       name: 'temp',
       surname: 'temp',
       patronymic: 'temp',
       voiskoSize: 0,
       birth: 1900,
       path: '/2/',
       note: null,
       created_at: Wed Oct 19 2016 19:49:55 GMT+0500 (YEKT),
       updated_at: Wed Oct 19 2016 19:49:55 GMT+0500 (YEKT),
       deleted_at: null,
       dom_id: '2',
       starshina_id: '2' } } ]
[2016-10-19 19:49:55.665] [INFO] console - [ 16,
  3219417831833600,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 2 } ]
[2016-10-19 19:50:58.956] [INFO] console - [ 70, 328, {}, [ undefined ] ]
[2016-10-19 19:50:58.978] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 2 }
[2016-10-19 19:50:59.026] [INFO] console - Executing (default): delete from "Kopnik"
                where
                    name like '%temp'
                    or name like 'temp%'
[2016-10-19 19:50:59.030] [INFO] console - Executing (c119b2c0-9636-4d50-9fcf-90ffb01b7654): START TRANSACTION;
[2016-10-19 19:50:59.033] [INFO] console - Executing (c119b2c0-9636-4d50-9fcf-90ffb01b7654): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:50:59.051] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 19:50:59.083] [INFO] console - Executing (default): update "Kopnik"
                set 
                    "voiskoSize"= case when id=2 then 1 ELSE 0 END
                where
                    id>1 
                    and id<=5
[2016-10-19 19:50:59.091] [INFO] console - Executing (c119b2c0-9636-4d50-9fcf-90ffb01b7654): COMMIT;
[2016-10-19 19:50:59.105] [INFO] console - [ 70,
  329,
  {},
  [ { fullName: 'Unit Test',
      fullPath: '/2/',
      id: '2',
      email: 'unittest2@domain.ru',
      name: 'Unit',
      surname: 'Test',
      patronymic: '1',
      voiskoSize: 2,
      birth: 1983,
      path: '/',
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: null,
      attachments: [] } ] ]
[2016-10-19 19:50:59.140] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 19:50:59.149] [INFO] console - Executing (6f551a0e-b1db-4e50-aeca-cc528f8da78b): START TRANSACTION;
[2016-10-19 19:50:59.152] [INFO] console - Executing (6f551a0e-b1db-4e50-aeca-cc528f8da78b): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:50:59.173] [INFO] console - Executing (6f551a0e-b1db-4e50-aeca-cc528f8da78b): INSERT INTO "Kopnik" ("id","name","surname","patronymic","voiskoSize","birth","path","created_at","updated_at","dom_id","starshina_id") VALUES (DEFAULT,'temp','temp','temp',0,1900,'/','2016-10-19 14:50:59.155 +00:00','2016-10-19 14:50:59.155 +00:00',2,NULL) RETURNING *;
[2016-10-19 19:50:59.182] [INFO] console - Executing (6f551a0e-b1db-4e50-aeca-cc528f8da78b): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 19:50:59.195] [INFO] console - Executing (6f551a0e-b1db-4e50-aeca-cc528f8da78b): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 19:50:59.203] [INFO] console - Executing (6f551a0e-b1db-4e50-aeca-cc528f8da78b): update "Zemla"
                                    set "obshinaSize"= "obshinaSize"+ 1
                                where
                                    '/1/' like path||id||'/%'
                                    or (
                                        true 
                                        and id= 2
                                    )
[2016-10-19 19:50:59.209] [INFO] console - Executing (6f551a0e-b1db-4e50-aeca-cc528f8da78b): COMMIT;
[2016-10-19 19:50:59.212] [INFO] console - [ 70, 330, {}, [ '51' ] ]
[2016-10-19 19:50:59.235] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 19:50:59.243] [INFO] console - Executing (2bf15086-39d7-4e08-a399-f8e7847a3570): START TRANSACTION;
[2016-10-19 19:50:59.247] [INFO] console - Executing (default): select z.*
                                    from "Zemla" as z
                                where
                                    '/1/' like z.path||z.id||'/%'
[2016-10-19 19:50:59.249] [INFO] console - Executing (2bf15086-39d7-4e08-a399-f8e7847a3570): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:50:59.267] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" IN ('1')) ORDER BY "Zemla"."path" desc;
[2016-10-19 19:50:59.271] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 51);
[2016-10-19 19:50:59.290] [INFO] console - [ 16,
  3983074578661376,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id2.obshinaChange',
  [],
  { obshinaSize: 49 } ]
[2016-10-19 19:50:59.302] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 19:50:59.304] [INFO] console - [ 16,
  1818725365841920,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id1.obshinaChange',
  [],
  { obshinaSize: 51 } ]
[2016-10-19 19:50:59.323] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 19:50:59.339] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 19:50:59.349] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 19:50:59.363] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='2',"updated_at"='2016-10-19 14:50:59.353 +00:00' WHERE "id" = '51'
[2016-10-19 19:50:59.371] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/', '/2/')
                                where
                                    id = '51'
                                    or path like '/51/'||'%'
[2016-10-19 19:50:59.381] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 19:50:59.386] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 19:50:59.396] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 19:50:59.404] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/2/51/'||'%'
[2016-10-19 19:50:59.409] [INFO] console - Executing (2bf15086-39d7-4e08-a399-f8e7847a3570): COMMIT;
[2016-10-19 19:50:59.413] [INFO] console - [ 70, 331, {}, [ undefined ] ]
[2016-10-19 19:50:59.418] [INFO] console - [ 16,
  2703966567661568,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.druzhinaChange',
  [],
  { action: 'add',
    kopnik: 
     { fullName: 'temp temp',
       fullPath: '/2/51/',
       id: '51',
       email: null,
       password: null,
       name: 'temp',
       surname: 'temp',
       patronymic: 'temp',
       voiskoSize: 0,
       birth: 1900,
       path: '/2/',
       note: null,
       created_at: Wed Oct 19 2016 19:50:59 GMT+0500 (YEKT),
       updated_at: Wed Oct 19 2016 19:50:59 GMT+0500 (YEKT),
       deleted_at: null,
       dom_id: '2',
       starshina_id: '2' } } ]
[2016-10-19 19:50:59.442] [INFO] console - [ 16,
  1059365802999808,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 2 } ]
[2016-10-19 19:51:32.598] [INFO] console - [ 70, 333, {}, [ undefined ] ]
[2016-10-19 19:51:32.629] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 2 }
[2016-10-19 19:51:32.656] [INFO] console - Executing (default): delete from "Kopnik"
                where
                    name like '%temp'
                    or name like 'temp%'
[2016-10-19 19:51:32.683] [INFO] console - Executing (4dcc1a97-c295-46cd-84f4-1c08fa88466c): START TRANSACTION;
[2016-10-19 19:51:32.686] [INFO] console - Executing (4dcc1a97-c295-46cd-84f4-1c08fa88466c): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:51:32.691] [INFO] console - Executing (default): update "Kopnik"
                set 
                    "voiskoSize"= case when id=2 then 1 ELSE 0 END
                where
                    id>1 
                    and id<=5
[2016-10-19 19:51:32.706] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 19:51:32.716] [INFO] console - Executing (4dcc1a97-c295-46cd-84f4-1c08fa88466c): COMMIT;
[2016-10-19 19:51:32.720] [INFO] console - [ 70,
  334,
  {},
  [ { fullName: 'Unit Test',
      fullPath: '/2/',
      id: '2',
      email: 'unittest2@domain.ru',
      name: 'Unit',
      surname: 'Test',
      patronymic: '1',
      voiskoSize: 1,
      birth: 1983,
      path: '/',
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: null,
      attachments: [] } ] ]
[2016-10-19 19:51:32.757] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 19:51:32.767] [INFO] console - Executing (909294be-7b44-467d-89ac-6c0e562d208b): START TRANSACTION;
[2016-10-19 19:51:32.770] [INFO] console - Executing (909294be-7b44-467d-89ac-6c0e562d208b): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:51:32.789] [INFO] console - Executing (909294be-7b44-467d-89ac-6c0e562d208b): INSERT INTO "Kopnik" ("id","name","surname","patronymic","voiskoSize","birth","path","created_at","updated_at","dom_id","starshina_id") VALUES (DEFAULT,'temp','temp','temp',0,1900,'/','2016-10-19 14:51:32.775 +00:00','2016-10-19 14:51:32.775 +00:00',2,NULL) RETURNING *;
[2016-10-19 19:51:32.798] [INFO] console - Executing (909294be-7b44-467d-89ac-6c0e562d208b): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 19:51:32.810] [INFO] console - Executing (909294be-7b44-467d-89ac-6c0e562d208b): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 19:51:32.818] [INFO] console - Executing (909294be-7b44-467d-89ac-6c0e562d208b): update "Zemla"
                                    set "obshinaSize"= "obshinaSize"+ 1
                                where
                                    '/1/' like path||id||'/%'
                                    or (
                                        true 
                                        and id= 2
                                    )
[2016-10-19 19:51:32.827] [INFO] console - Executing (909294be-7b44-467d-89ac-6c0e562d208b): COMMIT;
[2016-10-19 19:51:32.831] [INFO] console - [ 70, 335, {}, [ '52' ] ]
[2016-10-19 19:51:32.844] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 19:51:32.854] [INFO] console - Executing (default): select z.*
                                    from "Zemla" as z
                                where
                                    '/1/' like z.path||z.id||'/%'
[2016-10-19 19:51:32.856] [INFO] console - Executing (0249d94d-d9f2-44f4-9732-14a939ab2146): START TRANSACTION;
[2016-10-19 19:51:32.862] [INFO] console - Executing (0249d94d-d9f2-44f4-9732-14a939ab2146): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:51:32.870] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" IN ('1')) ORDER BY "Zemla"."path" desc;
[2016-10-19 19:51:32.881] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 52);
[2016-10-19 19:51:32.883] [INFO] console - [ 16,
  8751439956410368,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id2.obshinaChange',
  [],
  { obshinaSize: 50 } ]
[2016-10-19 19:51:32.894] [INFO] console - [ 16,
  5215927176003584,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id1.obshinaChange',
  [],
  { obshinaSize: 52 } ]
[2016-10-19 19:51:32.908] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 19:51:32.916] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 19:51:32.927] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 19:51:32.934] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 19:51:32.947] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='2',"updated_at"='2016-10-19 14:51:32.936 +00:00' WHERE "id" = '52'
[2016-10-19 19:51:32.952] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/', '/2/')
                                where
                                    id = '52'
                                    or path like '/52/'||'%'
[2016-10-19 19:51:32.956] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 19:51:32.961] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 19:51:32.972] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 19:51:32.981] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/2/52/'||'%'
[2016-10-19 19:51:32.985] [INFO] console - Executing (0249d94d-d9f2-44f4-9732-14a939ab2146): COMMIT;
[2016-10-19 19:51:32.988] [INFO] console - [ 70, 336, {}, [ undefined ] ]
[2016-10-19 19:51:32.993] [INFO] console - [ 16,
  5150457964003328,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.druzhinaChange',
  [],
  { action: 'add',
    kopnik: 
     { fullName: 'temp temp',
       fullPath: '/2/52/',
       id: '52',
       email: null,
       password: null,
       name: 'temp',
       surname: 'temp',
       patronymic: 'temp',
       voiskoSize: 0,
       birth: 1900,
       path: '/2/',
       note: null,
       created_at: Wed Oct 19 2016 19:51:32 GMT+0500 (YEKT),
       updated_at: Wed Oct 19 2016 19:51:32 GMT+0500 (YEKT),
       deleted_at: null,
       dom_id: '2',
       starshina_id: '2' } } ]
[2016-10-19 19:51:33.012] [INFO] console - [ 16,
  155575159619584,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 2 } ]
[2016-10-19 19:51:44.200] [INFO] console - [ 70, 338, {}, [ undefined ] ]
[2016-10-19 19:51:44.255] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 2 }
[2016-10-19 19:51:44.300] [INFO] console - Executing (default): delete from "Kopnik"
                where
                    name like '%temp'
                    or name like 'temp%'
[2016-10-19 19:51:44.328] [INFO] console - Executing (6c35b02d-561d-4bd3-a1cf-a03a04361721): START TRANSACTION;
[2016-10-19 19:51:44.352] [INFO] console - Executing (6c35b02d-561d-4bd3-a1cf-a03a04361721): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:51:44.381] [INFO] console - Executing (default): update "Kopnik"
                set 
                    "voiskoSize"= case when id=2 then 1 ELSE 0 END
                where
                    id>1 
                    and id<=5
[2016-10-19 19:51:44.400] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 19:51:44.415] [INFO] console - Executing (6c35b02d-561d-4bd3-a1cf-a03a04361721): COMMIT;
[2016-10-19 19:51:44.419] [INFO] console - [ 70,
  339,
  {},
  [ { fullName: 'Unit Test',
      fullPath: '/2/',
      id: '2',
      email: 'unittest2@domain.ru',
      name: 'Unit',
      surname: 'Test',
      patronymic: '1',
      voiskoSize: 1,
      birth: 1983,
      path: '/',
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: null,
      attachments: [] } ] ]
[2016-10-19 19:51:44.461] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 19:51:44.471] [INFO] console - Executing (4edbf77e-9d0d-4656-a7f0-54747915e41e): START TRANSACTION;
[2016-10-19 19:51:44.474] [INFO] console - Executing (4edbf77e-9d0d-4656-a7f0-54747915e41e): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:51:44.493] [INFO] console - Executing (4edbf77e-9d0d-4656-a7f0-54747915e41e): INSERT INTO "Kopnik" ("id","name","surname","patronymic","voiskoSize","birth","path","created_at","updated_at","dom_id","starshina_id") VALUES (DEFAULT,'temp','temp','temp',0,1900,'/','2016-10-19 14:51:44.477 +00:00','2016-10-19 14:51:44.477 +00:00',2,NULL) RETURNING *;
[2016-10-19 19:51:44.511] [INFO] console - Executing (4edbf77e-9d0d-4656-a7f0-54747915e41e): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 19:51:44.524] [INFO] console - Executing (4edbf77e-9d0d-4656-a7f0-54747915e41e): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 19:51:44.536] [INFO] console - Executing (4edbf77e-9d0d-4656-a7f0-54747915e41e): update "Zemla"
                                    set "obshinaSize"= "obshinaSize"+ 1
                                where
                                    '/1/' like path||id||'/%'
                                    or (
                                        true 
                                        and id= 2
                                    )
[2016-10-19 19:51:44.543] [INFO] console - Executing (4edbf77e-9d0d-4656-a7f0-54747915e41e): COMMIT;
[2016-10-19 19:51:44.550] [INFO] console - [ 70, 340, {}, [ '53' ] ]
[2016-10-19 19:51:44.569] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 19:51:44.579] [INFO] console - Executing (a76a5b05-55f6-42a7-96d8-6ad6ba34f915): START TRANSACTION;
[2016-10-19 19:51:44.587] [INFO] console - Executing (default): select z.*
                                    from "Zemla" as z
                                where
                                    '/1/' like z.path||z.id||'/%'
[2016-10-19 19:51:44.591] [INFO] console - Executing (a76a5b05-55f6-42a7-96d8-6ad6ba34f915): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:51:44.612] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" IN ('1')) ORDER BY "Zemla"."path" desc;
[2016-10-19 19:51:44.627] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 53);
[2016-10-19 19:51:44.630] [INFO] console - [ 16,
  1055168583958528,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id2.obshinaChange',
  [],
  { obshinaSize: 51 } ]
[2016-10-19 19:51:44.655] [INFO] console - [ 16,
  8629945544736768,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id1.obshinaChange',
  [],
  { obshinaSize: 53 } ]
[2016-10-19 19:51:44.679] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 19:51:44.693] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 19:51:44.704] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 19:51:44.714] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 19:51:44.728] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='2',"updated_at"='2016-10-19 14:51:44.717 +00:00' WHERE "id" = '53'
[2016-10-19 19:51:44.735] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/', '/2/')
                                where
                                    id = '53'
                                    or path like '/53/'||'%'
[2016-10-19 19:51:44.739] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 19:51:44.746] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 19:51:44.757] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 19:51:44.768] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/2/53/'||'%'
[2016-10-19 19:51:44.772] [INFO] console - Executing (a76a5b05-55f6-42a7-96d8-6ad6ba34f915): COMMIT;
[2016-10-19 19:51:44.775] [INFO] console - [ 70, 341, {}, [ undefined ] ]
[2016-10-19 19:51:44.780] [INFO] console - [ 16,
  8823978967695360,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.druzhinaChange',
  [],
  { action: 'add',
    kopnik: 
     { fullName: 'temp temp',
       fullPath: '/2/53/',
       id: '53',
       email: null,
       password: null,
       name: 'temp',
       surname: 'temp',
       patronymic: 'temp',
       voiskoSize: 0,
       birth: 1900,
       path: '/2/',
       note: null,
       created_at: Wed Oct 19 2016 19:51:44 GMT+0500 (YEKT),
       updated_at: Wed Oct 19 2016 19:51:44 GMT+0500 (YEKT),
       deleted_at: null,
       dom_id: '2',
       starshina_id: '2' } } ]
[2016-10-19 19:51:45.075] [INFO] console - [ 16,
  4022124700237824,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 2 } ]
[2016-10-19 19:56:59.689] [INFO] console - AutobahnJS debug enabled
[2016-10-19 19:57:02.058] [INFO] Server - starting...
[2016-10-19 19:57:02.061] [INFO] console - trying to create WAMP transport of type: websocket
[2016-10-19 19:57:02.204] [INFO] console - using WAMP transport type: websocket
[2016-10-19 19:57:02.643] [INFO] console - [ 1,
  'kopa',
  { roles: 
     { caller: [Object],
       callee: [Object],
       publisher: [Object],
       subscriber: [Object] },
    authmethods: [ 'ticket' ],
    authid: 'server' } ]
[2016-10-19 19:57:02.672] [INFO] console - [ 5, 'server', {} ]
[2016-10-19 19:57:02.726] [INFO] Server - connection.onopen()
[2016-10-19 19:57:02.727] [INFO] console - [ 64, 1422773503131648, {}, 'ru.kopa.model.create' ]
[2016-10-19 19:57:02.737] [DEBUG] Server - api:model.create registered
[2016-10-19 19:57:02.739] [INFO] console - [ 64, 5464958011703296, {}, 'ru.kopa.model.get' ]
[2016-10-19 19:57:02.745] [DEBUG] Server - api:model.get registered
[2016-10-19 19:57:02.746] [INFO] console - [ 64, 5704970605166592, {}, 'ru.kopa.model.save' ]
[2016-10-19 19:57:02.752] [DEBUG] Server - api:model.save registered
[2016-10-19 19:57:02.753] [INFO] console - [ 64, 4258761153708032, {}, 'ru.kopa.pingPong' ]
[2016-10-19 19:57:02.759] [DEBUG] Server - api:pingPong registered
[2016-10-19 19:57:02.760] [INFO] console - [ 64, 657267554779136, {}, 'ru.kopa.discloseCaller' ]
[2016-10-19 19:57:02.767] [DEBUG] Server - api:discloseCaller registered
[2016-10-19 19:57:02.768] [INFO] console - [ 64, 2544566301360128, {}, 'ru.kopa.pingPongDatabase' ]
[2016-10-19 19:57:02.777] [DEBUG] Server - api:pingPongDatabase registered
[2016-10-19 19:57:02.779] [INFO] console - [ 64, 4650337919041536, {}, 'ru.kopa.error' ]
[2016-10-19 19:57:02.784] [DEBUG] Server - api:error registered
[2016-10-19 19:57:02.785] [INFO] console - [ 64, 2032953557254144, {}, 'ru.kopa.unitTest.cleanTempData' ]
[2016-10-19 19:57:02.792] [DEBUG] Server - api:unitTest.cleanTempData registered
[2016-10-19 19:57:02.794] [INFO] console - [ 64, 5136192970424320, {}, 'ru.kopa.model.Kopnik.setStarshina' ]
[2016-10-19 19:57:02.799] [DEBUG] Server - api:model.Kopnik.setStarshina registered
[2016-10-19 19:57:02.800] [INFO] console - [ 64, 8629628298067968, {}, 'ru.kopa.model.Kopnik.getDruzhina' ]
[2016-10-19 19:57:02.805] [DEBUG] Server - api:model.Kopnik.getDruzhina registered
[2016-10-19 19:57:02.807] [INFO] console - [ 64, 5218457865945088, {}, 'ru.kopa.model.Kopnik.vote' ]
[2016-10-19 19:57:02.813] [DEBUG] Server - api:model.Kopnik.vote registered
[2016-10-19 19:57:02.814] [INFO] console - [ 64, 3866201866371072, {}, 'ru.kopa.model.Kopa.invite' ]
[2016-10-19 19:57:02.820] [DEBUG] Server - api:model.Kopa.invite registered
[2016-10-19 19:57:02.821] [INFO] console - [ 64, 5990359345659904, {}, 'ru.kopa.model.Kopa.getDialog' ]
[2016-10-19 19:57:02.829] [DEBUG] Server - api:model.Kopa.getDialog registered
[2016-10-19 19:57:02.830] [INFO] console - [ 64, 1266825794945024, {}, 'ru.kopa.model.Kopa.getResult' ]
[2016-10-19 19:57:02.837] [DEBUG] Server - api:model.Kopa.getResult registered
[2016-10-19 19:57:02.838] [INFO] console - [ 64, 5045555585613824, {}, 'ru.kopa.model.Zemla.setParent' ]
[2016-10-19 19:57:02.844] [DEBUG] Server - api:model.Zemla.setParent registered
[2016-10-19 19:57:02.845] [INFO] console - [ 64, 7919677827186688, {}, 'ru.kopa.model.Zemla.promiseKopi' ]
[2016-10-19 19:57:02.851] [DEBUG] Server - api:model.Zemla.promiseKopi registered
[2016-10-19 19:57:02.852] [INFO] console - [ 64,
  8598193256267776,
  {},
  'ru.kopa.model.Predlozhenie.getGolosa' ]
[2016-10-19 19:57:02.858] [DEBUG] Server - api:model.Predlozhenie.getGolosa registered
[2016-10-19 19:57:02.859] [INFO] console - [ 64, 5503006485250048, {}, 'ru.kopa.unitTest.orderProc' ]
[2016-10-19 19:57:02.871] [DEBUG] Server - api:unitTest.orderProc registered
[2016-10-19 19:57:02.877] [INFO] Server - started
[2016-10-19 19:58:11.227] [INFO] console - [ 70, 344, {}, [ undefined ] ]
[2016-10-19 19:58:11.287] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 2 }
[2016-10-19 19:58:11.477] [INFO] console - Executing (default): delete from "Kopnik"
                where
                    name like '%temp'
                    or name like 'temp%'
[2016-10-19 19:58:11.484] [INFO] console - Executing (53a7b477-f149-48d8-b15b-ba2ddbac6ca4): START TRANSACTION;
[2016-10-19 19:58:11.493] [INFO] console - Executing (53a7b477-f149-48d8-b15b-ba2ddbac6ca4): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:58:11.521] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 19:58:11.550] [INFO] console - Executing (default): update "Kopnik"
                set 
                    "voiskoSize"= case when id=2 then 1 ELSE 0 END
                where
                    id>1 
                    and id<=5
[2016-10-19 19:58:11.569] [INFO] console - Executing (53a7b477-f149-48d8-b15b-ba2ddbac6ca4): COMMIT;
[2016-10-19 19:58:11.593] [INFO] console - [ 70,
  345,
  {},
  [ { fullName: 'Unit Test',
      fullPath: '/2/',
      id: '2',
      email: 'unittest2@domain.ru',
      name: 'Unit',
      surname: 'Test',
      patronymic: '1',
      voiskoSize: 2,
      birth: 1983,
      path: '/',
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: null,
      attachments: [] } ] ]
[2016-10-19 19:58:11.643] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 19:58:11.656] [INFO] console - Executing (8b3ba861-9317-4a19-83c2-bc26d180dd4e): START TRANSACTION;
[2016-10-19 19:58:11.660] [INFO] console - Executing (8b3ba861-9317-4a19-83c2-bc26d180dd4e): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:58:11.714] [INFO] console - Executing (8b3ba861-9317-4a19-83c2-bc26d180dd4e): INSERT INTO "Kopnik" ("id","name","surname","patronymic","voiskoSize","birth","path","created_at","updated_at","dom_id","starshina_id") VALUES (DEFAULT,'temp','temp','temp',0,1900,'/','2016-10-19 14:58:11.668 +00:00','2016-10-19 14:58:11.668 +00:00',2,NULL) RETURNING *;
[2016-10-19 19:58:11.726] [INFO] console - Executing (8b3ba861-9317-4a19-83c2-bc26d180dd4e): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 19:58:11.742] [INFO] console - Executing (8b3ba861-9317-4a19-83c2-bc26d180dd4e): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 19:58:11.759] [INFO] console - Executing (8b3ba861-9317-4a19-83c2-bc26d180dd4e): update "Zemla"
                                    set "obshinaSize"= "obshinaSize"+ 1
                                where
                                    '/1/' like path||id||'/%'
                                    or (
                                        true 
                                        and id= 2
                                    )
[2016-10-19 19:58:11.766] [INFO] console - Executing (8b3ba861-9317-4a19-83c2-bc26d180dd4e): COMMIT;
[2016-10-19 19:58:11.770] [INFO] console - [ 70, 346, {}, [ '54' ] ]
[2016-10-19 19:58:11.796] [INFO] console - Executing (d774a129-2ee9-4e35-b815-a739cb91185e): START TRANSACTION;
[2016-10-19 19:58:11.805] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 19:58:11.814] [INFO] console - Executing (d774a129-2ee9-4e35-b815-a739cb91185e): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:58:11.819] [INFO] console - Executing (default): select z.*
                                    from "Zemla" as z
                                where
                                    '/1/' like z.path||z.id||'/%'
[2016-10-19 19:58:11.833] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 54);
[2016-10-19 19:58:11.863] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" IN ('1')) ORDER BY "Zemla"."path" desc;
[2016-10-19 19:58:11.865] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 19:58:11.872] [INFO] console - [ 16,
  3185126819233792,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id2.obshinaChange',
  [],
  { obshinaSize: 52 } ]
[2016-10-19 19:58:11.889] [INFO] console - [ 16,
  3838665344155648,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id1.obshinaChange',
  [],
  { obshinaSize: 54 } ]
[2016-10-19 19:58:11.904] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 19:58:11.916] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 19:58:11.926] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 19:58:11.944] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='2',"updated_at"='2016-10-19 14:58:11.929 +00:00' WHERE "id" = '54'
[2016-10-19 19:58:11.951] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/', '/2/')
                                where
                                    id = '54'
                                    or path like '/54/'||'%'
[2016-10-19 19:58:11.956] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 19:58:11.962] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 19:58:11.974] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 19:58:11.981] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/2/54/'||'%'
[2016-10-19 19:58:11.985] [INFO] console - Executing (d774a129-2ee9-4e35-b815-a739cb91185e): COMMIT;
[2016-10-19 19:58:11.988] [INFO] console - [ 70, 347, {}, [ undefined ] ]
[2016-10-19 19:58:11.997] [INFO] console - [ 16,
  6172552831434752,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.druzhinaChange',
  [],
  { action: 'add',
    kopnik: 
     { fullName: 'temp temp',
       fullPath: '/2/54/',
       id: '54',
       email: null,
       password: null,
       name: 'temp',
       surname: 'temp',
       patronymic: 'temp',
       voiskoSize: 0,
       birth: 1900,
       path: '/2/',
       note: null,
       created_at: Wed Oct 19 2016 19:58:11 GMT+0500 (YEKT),
       updated_at: Wed Oct 19 2016 19:58:11 GMT+0500 (YEKT),
       deleted_at: null,
       dom_id: '2',
       starshina_id: '2' } } ]
[2016-10-19 19:58:12.023] [INFO] console - Executing (47f80e79-1848-4474-a497-1193874336fb): START TRANSACTION;
[2016-10-19 19:58:12.031] [INFO] console - [ 16,
  7817017077792768,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 2 } ]
[2016-10-19 19:58:12.040] [INFO] console - Executing (47f80e79-1848-4474-a497-1193874336fb): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 19:58:12.139] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 54);
[2016-10-19 19:58:12.150] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 19:58:12.160] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 19:58:12.178] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 19:58:12.196] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"=NULL,"updated_at"='2016-10-19 14:58:12.183 +00:00' WHERE "id" = '54'
[2016-10-19 19:58:12.201] [ERROR] Server - [TypeError: Cannot read property 'fullPath' of null]
TypeError: Cannot read property 'fullPath' of null
    at [object Object].<anonymous> (Kopnik.js:131:54)
    at [object Generator].next (native)
    at step (/home/alexey2baranov/htdocs/kp-sequelizejs/src/model/Kopnik.js:1:253)
    at /home/alexey2baranov/htdocs/kp-sequelizejs/src/model/Kopnik.js:1:430
    at propagateAslWrapper (/home/alexey2baranov/htdocs/kp-sequelizejs/node_modules/async-listener/index.js:421:23)
    at asyncWrap (/home/alexey2baranov/htdocs/kp-sequelizejs/node_modules/async-listener/glue.js:188:31)
    at cbIdx (/home/alexey2baranov/htdocs/kp-sequelizejs/node_modules/async-listener/index.js:458:70)
    at run (/usr/lib/node_modules/babel-cli/node_modules/core-js/modules/es6.promise.js:87:22)
    at /usr/lib/node_modules/babel-cli/node_modules/core-js/modules/es6.promise.js:100:28
    at module.exports.flush (/usr/lib/node_modules/babel-cli/node_modules/core-js/modules/_microtask.js:18:9)
    at asyncWrap (/home/alexey2baranov/htdocs/kp-sequelizejs/node_modules/async-listener/glue.js:188:31)
    at nextTickCallbackWith0Args (node.js:420:9)
    at process._tickDomainCallback [as _tickCallback] (node.js:390:13)
[2016-10-19 19:58:12.727] [INFO] console - [ 8,
  68,
  348,
  {},
  'TypeError',
  [ 'Cannot read property \'fullPath\' of null' ],
  { stack: 
     [ 'TypeError: Cannot read property \'fullPath\' of null',
       '    at [object Object].<anonymous> (Kopnik.js:131:54)',
       '    at [object Generator].next (native)',
       '    at step (/home/alexey2baranov/htdocs/kp-sequelizejs/src/model/Kopnik.js:1:253)',
       '    at /home/alexey2baranov/htdocs/kp-sequelizejs/src/model/Kopnik.js:1:430',
       '    at propagateAslWrapper (/home/alexey2baranov/htdocs/kp-sequelizejs/node_modules/async-listener/index.js:421:23)',
       '    at asyncWrap (/home/alexey2baranov/htdocs/kp-sequelizejs/node_modules/async-listener/glue.js:188:31)',
       '    at cbIdx (/home/alexey2baranov/htdocs/kp-sequelizejs/node_modules/async-listener/index.js:458:70)',
       '    at run (/usr/lib/node_modules/babel-cli/node_modules/core-js/modules/es6.promise.js:87:22)',
       '    at /usr/lib/node_modules/babel-cli/node_modules/core-js/modules/es6.promise.js:100:28',
       '    at module.exports.flush (/usr/lib/node_modules/babel-cli/node_modules/core-js/modules/_microtask.js:18:9)',
       '    at asyncWrap (/home/alexey2baranov/htdocs/kp-sequelizejs/node_modules/async-listener/glue.js:188:31)',
       '    at nextTickCallbackWith0Args (node.js:420:9)',
       '    at process._tickDomainCallback [as _tickCallback] (node.js:390:13)' ] } ]
[2016-10-19 19:58:12.751] [INFO] console - Executing (47f80e79-1848-4474-a497-1193874336fb): ROLLBACK;
[2016-10-19 20:00:57.398] [INFO] console - AutobahnJS debug enabled
[2016-10-19 20:01:00.232] [INFO] Server - starting...
[2016-10-19 20:01:00.235] [INFO] console - trying to create WAMP transport of type: websocket
[2016-10-19 20:01:00.348] [INFO] console - using WAMP transport type: websocket
[2016-10-19 20:01:00.650] [INFO] console - [ 1,
  'kopa',
  { roles: 
     { caller: [Object],
       callee: [Object],
       publisher: [Object],
       subscriber: [Object] },
    authmethods: [ 'ticket' ],
    authid: 'server' } ]
[2016-10-19 20:01:00.676] [INFO] console - [ 5, 'server', {} ]
[2016-10-19 20:01:00.709] [INFO] Server - connection.onopen()
[2016-10-19 20:01:00.710] [INFO] console - [ 64, 6062530059304960, {}, 'ru.kopa.model.create' ]
[2016-10-19 20:01:00.718] [DEBUG] Server - api:model.create registered
[2016-10-19 20:01:00.720] [INFO] console - [ 64, 6146004795523072, {}, 'ru.kopa.model.get' ]
[2016-10-19 20:01:00.726] [DEBUG] Server - api:model.get registered
[2016-10-19 20:01:00.728] [INFO] console - [ 64, 3735551471517696, {}, 'ru.kopa.model.save' ]
[2016-10-19 20:01:00.732] [DEBUG] Server - api:model.save registered
[2016-10-19 20:01:00.733] [INFO] console - [ 64, 808368023273472, {}, 'ru.kopa.pingPong' ]
[2016-10-19 20:01:00.738] [DEBUG] Server - api:pingPong registered
[2016-10-19 20:01:00.740] [INFO] console - [ 64, 1698150681149440, {}, 'ru.kopa.discloseCaller' ]
[2016-10-19 20:01:00.749] [DEBUG] Server - api:discloseCaller registered
[2016-10-19 20:01:00.750] [INFO] console - [ 64, 8317035444436992, {}, 'ru.kopa.pingPongDatabase' ]
[2016-10-19 20:01:00.755] [DEBUG] Server - api:pingPongDatabase registered
[2016-10-19 20:01:00.756] [INFO] console - [ 64, 258612890959872, {}, 'ru.kopa.error' ]
[2016-10-19 20:01:00.763] [DEBUG] Server - api:error registered
[2016-10-19 20:01:00.764] [INFO] console - [ 64, 4056698167754752, {}, 'ru.kopa.unitTest.cleanTempData' ]
[2016-10-19 20:01:00.769] [DEBUG] Server - api:unitTest.cleanTempData registered
[2016-10-19 20:01:00.770] [INFO] console - [ 64, 5781209130991616, {}, 'ru.kopa.model.Kopnik.setStarshina' ]
[2016-10-19 20:01:00.775] [DEBUG] Server - api:model.Kopnik.setStarshina registered
[2016-10-19 20:01:00.776] [INFO] console - [ 64, 8879893743927296, {}, 'ru.kopa.model.Kopnik.getDruzhina' ]
[2016-10-19 20:01:00.782] [DEBUG] Server - api:model.Kopnik.getDruzhina registered
[2016-10-19 20:01:00.783] [INFO] console - [ 64, 1998204952379392, {}, 'ru.kopa.model.Kopnik.vote' ]
[2016-10-19 20:01:00.789] [DEBUG] Server - api:model.Kopnik.vote registered
[2016-10-19 20:01:00.790] [INFO] console - [ 64, 921507192635392, {}, 'ru.kopa.model.Kopa.invite' ]
[2016-10-19 20:01:00.811] [DEBUG] Server - api:model.Kopa.invite registered
[2016-10-19 20:01:00.812] [INFO] console - [ 64, 6236724269154304, {}, 'ru.kopa.model.Kopa.getDialog' ]
[2016-10-19 20:01:00.817] [DEBUG] Server - api:model.Kopa.getDialog registered
[2016-10-19 20:01:00.818] [INFO] console - [ 64, 4484105269936128, {}, 'ru.kopa.model.Kopa.getResult' ]
[2016-10-19 20:01:00.823] [DEBUG] Server - api:model.Kopa.getResult registered
[2016-10-19 20:01:00.824] [INFO] console - [ 64, 4848753259315200, {}, 'ru.kopa.model.Zemla.setParent' ]
[2016-10-19 20:01:00.829] [DEBUG] Server - api:model.Zemla.setParent registered
[2016-10-19 20:01:00.830] [INFO] console - [ 64, 818410103504896, {}, 'ru.kopa.model.Zemla.promiseKopi' ]
[2016-10-19 20:01:00.836] [DEBUG] Server - api:model.Zemla.promiseKopi registered
[2016-10-19 20:01:00.838] [INFO] console - [ 64,
  703700242792448,
  {},
  'ru.kopa.model.Predlozhenie.getGolosa' ]
[2016-10-19 20:01:00.844] [DEBUG] Server - api:model.Predlozhenie.getGolosa registered
[2016-10-19 20:01:00.844] [INFO] console - [ 64, 4099646861344768, {}, 'ru.kopa.unitTest.orderProc' ]
[2016-10-19 20:01:00.850] [DEBUG] Server - api:unitTest.orderProc registered
[2016-10-19 20:01:00.852] [INFO] Server - started
[2016-10-19 20:01:25.763] [INFO] console - [ 70, 351, {}, [ undefined ] ]
[2016-10-19 20:01:25.786] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 2 }
[2016-10-19 20:01:25.869] [INFO] console - Executing (default): delete from "Kopnik"
                where
                    name like '%temp'
                    or name like 'temp%'
[2016-10-19 20:01:25.874] [INFO] console - Executing (066d1273-22d1-4102-962e-95555e74673c): START TRANSACTION;
[2016-10-19 20:01:25.878] [INFO] console - Executing (066d1273-22d1-4102-962e-95555e74673c): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:01:25.908] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 20:01:25.921] [INFO] console - Executing (default): update "Kopnik"
                set 
                    "voiskoSize"= case when id=2 then 1 ELSE 0 END
                where
                    id>1 
                    and id<=5
[2016-10-19 20:01:25.930] [INFO] console - Executing (066d1273-22d1-4102-962e-95555e74673c): COMMIT;
[2016-10-19 20:01:25.940] [INFO] console - [ 70,
  352,
  {},
  [ { fullName: 'Unit Test',
      fullPath: '/2/',
      id: '2',
      email: 'unittest2@domain.ru',
      name: 'Unit',
      surname: 'Test',
      patronymic: '1',
      voiskoSize: 1,
      birth: 1983,
      path: '/',
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: null,
      attachments: [] } ] ]
[2016-10-19 20:01:25.994] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 20:01:26.014] [INFO] console - Executing (5752dae2-3267-4d69-8ee6-cea23f694868): START TRANSACTION;
[2016-10-19 20:01:26.022] [INFO] console - Executing (5752dae2-3267-4d69-8ee6-cea23f694868): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:01:26.049] [INFO] console - Executing (5752dae2-3267-4d69-8ee6-cea23f694868): INSERT INTO "Kopnik" ("id","name","surname","patronymic","voiskoSize","birth","path","created_at","updated_at","dom_id","starshina_id") VALUES (DEFAULT,'temp','temp','temp',0,1900,'/','2016-10-19 15:01:26.034 +00:00','2016-10-19 15:01:26.034 +00:00',2,NULL) RETURNING *;
[2016-10-19 20:01:26.061] [INFO] console - Executing (5752dae2-3267-4d69-8ee6-cea23f694868): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:01:26.070] [INFO] console - Executing (5752dae2-3267-4d69-8ee6-cea23f694868): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:01:26.076] [INFO] console - Executing (5752dae2-3267-4d69-8ee6-cea23f694868): update "Zemla"
                                    set "obshinaSize"= "obshinaSize"+ 1
                                where
                                    '/1/' like path||id||'/%'
                                    or (
                                        true 
                                        and id= 2
                                    )
[2016-10-19 20:01:26.081] [INFO] console - Executing (5752dae2-3267-4d69-8ee6-cea23f694868): COMMIT;
[2016-10-19 20:01:26.086] [INFO] console - [ 70, 353, {}, [ '55' ] ]
[2016-10-19 20:01:26.108] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:01:26.115] [INFO] console - Executing (f7d886ed-ceaf-418f-bcb2-bae23aed42b6): START TRANSACTION;
[2016-10-19 20:01:26.122] [INFO] console - Executing (default): select z.*
                                    from "Zemla" as z
                                where
                                    '/1/' like z.path||z.id||'/%'
[2016-10-19 20:01:26.124] [INFO] console - Executing (f7d886ed-ceaf-418f-bcb2-bae23aed42b6): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:01:26.140] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" IN ('1')) ORDER BY "Zemla"."path" desc;
[2016-10-19 20:01:26.143] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 55);
[2016-10-19 20:01:26.153] [INFO] console - [ 16,
  1290159087681536,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id2.obshinaChange',
  [],
  { obshinaSize: 53 } ]
[2016-10-19 20:01:26.164] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 20:01:26.166] [INFO] console - [ 16,
  1965831705591808,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id1.obshinaChange',
  [],
  { obshinaSize: 55 } ]
[2016-10-19 20:01:26.177] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 20:01:26.186] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:01:26.191] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:01:26.215] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='2',"updated_at"='2016-10-19 15:01:26.194 +00:00' WHERE "id" = '55'
[2016-10-19 20:01:26.222] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/', '/2/')
                                where
                                    id = '55'
                                    or path like '/55/'||'%'
[2016-10-19 20:01:26.228] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 20:01:26.232] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 20:01:26.242] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:01:26.249] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/2/55/'||'%'
[2016-10-19 20:01:26.252] [INFO] console - Executing (f7d886ed-ceaf-418f-bcb2-bae23aed42b6): COMMIT;
[2016-10-19 20:01:26.255] [INFO] console - [ 70, 354, {}, [ undefined ] ]
[2016-10-19 20:01:26.259] [INFO] console - [ 16,
  8235617758478336,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.druzhinaChange',
  [],
  { action: 'add',
    kopnik: 
     { fullName: 'temp temp',
       fullPath: '/2/55/',
       id: '55',
       email: null,
       password: null,
       name: 'temp',
       surname: 'temp',
       patronymic: 'temp',
       voiskoSize: 0,
       birth: 1900,
       path: '/2/',
       note: null,
       created_at: Wed Oct 19 2016 20:01:26 GMT+0500 (YEKT),
       updated_at: Wed Oct 19 2016 20:01:26 GMT+0500 (YEKT),
       deleted_at: null,
       dom_id: '2',
       starshina_id: '2' } } ]
[2016-10-19 20:01:26.273] [INFO] console - Executing (53e3533d-520f-4675-b1aa-d6ff89c8d76a): START TRANSACTION;
[2016-10-19 20:01:26.274] [INFO] console - [ 16,
  1784302652096512,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 2 } ]
[2016-10-19 20:01:26.281] [INFO] console - Executing (53e3533d-520f-4675-b1aa-d6ff89c8d76a): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:01:26.290] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 55);
[2016-10-19 20:01:26.297] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 20:01:26.310] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:01:26.321] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 20:01:26.333] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"=NULL,"updated_at"='2016-10-19 15:01:26.325 +00:00' WHERE "id" = '55'
[2016-10-19 20:01:26.340] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/2/', '/')
                                where
                                    id = '55'
                                    or path like '/2/55/'||'%'
[2016-10-19 20:01:26.345] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:01:26.348] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 20:01:26.358] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:01:26.363] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/55/'||'%'
[2016-10-19 20:01:26.367] [INFO] console - Executing (53e3533d-520f-4675-b1aa-d6ff89c8d76a): COMMIT;
[2016-10-19 20:01:26.370] [INFO] console - [ 70, 355, {}, [ undefined ] ]
[2016-10-19 20:01:33.480] [INFO] console - [ 16,
  8392653120995328,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.druzhinaChange',
  [],
  { action: 'remove', KOPNIK: 55 } ]
[2016-10-19 20:01:33.490] [INFO] console - [ 16,
  7306177014661120,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 1 } ]
[2016-10-19 20:11:03.096] [INFO] console - [ 70, 357, {}, [ undefined ] ]
[2016-10-19 20:11:03.138] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 2 }
[2016-10-19 20:11:03.181] [INFO] console - Executing (default): delete from "Kopnik"
                where
                    name like '%temp'
                    or name like 'temp%'
[2016-10-19 20:11:03.197] [INFO] console - Executing (6860d371-cf31-4dba-8fe9-c919f4eab7e0): START TRANSACTION;
[2016-10-19 20:11:03.200] [INFO] console - Executing (6860d371-cf31-4dba-8fe9-c919f4eab7e0): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:11:03.255] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 20:11:03.271] [INFO] console - Executing (6860d371-cf31-4dba-8fe9-c919f4eab7e0): COMMIT;
[2016-10-19 20:11:03.275] [INFO] console - [ 70,
  358,
  {},
  [ { fullName: 'Unit Test',
      fullPath: '/2/',
      id: '2',
      email: 'unittest2@domain.ru',
      name: 'Unit',
      surname: 'Test',
      patronymic: '1',
      voiskoSize: 1,
      birth: 1983,
      path: '/',
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: null,
      attachments: [] } ] ]
[2016-10-19 20:11:03.325] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."starshina_id" = 2) ORDER BY "Kopnik"."surname" asc, "Kopnik"."name" asc, "Kopnik"."patronymic" asc;
[2016-10-19 20:11:03.340] [INFO] console - [ 70, 359, {}, [ [ [Object], [Object] ] ] ]
[2016-10-19 20:11:03.376] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 20:11:03.392] [INFO] console - Executing (c8e20709-83eb-4472-ad35-a00292e68117): START TRANSACTION;
[2016-10-19 20:11:03.395] [INFO] console - Executing (c8e20709-83eb-4472-ad35-a00292e68117): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:11:03.417] [INFO] console - Executing (c8e20709-83eb-4472-ad35-a00292e68117): INSERT INTO "Kopnik" ("id","name","surname","patronymic","voiskoSize","birth","path","created_at","updated_at","dom_id","starshina_id") VALUES (DEFAULT,'temp','temp','temp',0,1900,'/','2016-10-19 15:11:03.399 +00:00','2016-10-19 15:11:03.399 +00:00',2,NULL) RETURNING *;
[2016-10-19 20:11:03.424] [INFO] console - Executing (c8e20709-83eb-4472-ad35-a00292e68117): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:11:03.432] [INFO] console - Executing (c8e20709-83eb-4472-ad35-a00292e68117): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:11:03.441] [INFO] console - Executing (c8e20709-83eb-4472-ad35-a00292e68117): update "Zemla"
                                    set "obshinaSize"= "obshinaSize"+ 1
                                where
                                    '/1/' like path||id||'/%'
                                    or (
                                        true 
                                        and id= 2
                                    )
[2016-10-19 20:11:03.445] [INFO] console - Executing (c8e20709-83eb-4472-ad35-a00292e68117): COMMIT;
[2016-10-19 20:11:03.548] [INFO] console - Executing (default): update "Kopnik"
                set 
                    "voiskoSize"= case when id=2 then 1 ELSE 0 END
                where
                    id>1 
                    and id<=5
[2016-10-19 20:11:03.552] [INFO] console - [ 70, 360, {}, [ '56' ] ]
[2016-10-19 20:11:03.576] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:11:03.584] [INFO] console - Executing (default): select z.*
                                    from "Zemla" as z
                                where
                                    '/1/' like z.path||z.id||'/%'
[2016-10-19 20:11:03.598] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" IN ('1')) ORDER BY "Zemla"."path" desc;
[2016-10-19 20:11:03.613] [INFO] console - [ 16,
  1520328905850880,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id2.obshinaChange',
  [],
  { obshinaSize: 54 } ]
[2016-10-19 20:11:03.626] [INFO] console - Executing (ae3153db-933d-44ae-a8d9-719bbfcee944): START TRANSACTION;
[2016-10-19 20:11:03.628] [INFO] console - [ 16,
  7725394736185344,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id1.obshinaChange',
  [],
  { obshinaSize: 56 } ]
[2016-10-19 20:11:03.637] [INFO] console - Executing (ae3153db-933d-44ae-a8d9-719bbfcee944): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:11:03.648] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 56);
[2016-10-19 20:11:03.659] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 20:11:03.668] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 20:11:03.682] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:11:03.689] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:11:03.710] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='2',"updated_at"='2016-10-19 15:11:03.693 +00:00' WHERE "id" = '56'
[2016-10-19 20:11:03.721] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/', '/2/')
                                where
                                    id = '56'
                                    or path like '/56/'||'%'
[2016-10-19 20:11:03.726] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 20:11:03.731] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 20:11:03.742] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:11:03.751] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/2/56/'||'%'
[2016-10-19 20:11:03.756] [INFO] console - Executing (ae3153db-933d-44ae-a8d9-719bbfcee944): COMMIT;
[2016-10-19 20:11:03.760] [INFO] console - [ 70, 361, {}, [ undefined ] ]
[2016-10-19 20:11:03.768] [INFO] console - [ 16,
  5029507415146496,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.druzhinaChange',
  [],
  { action: 'add',
    kopnik: 
     { fullName: 'temp temp',
       fullPath: '/2/56/',
       id: '56',
       email: null,
       password: null,
       name: 'temp',
       surname: 'temp',
       patronymic: 'temp',
       voiskoSize: 0,
       birth: 1900,
       path: '/2/',
       note: null,
       created_at: Wed Oct 19 2016 20:11:03 GMT+0500 (YEKT),
       updated_at: Wed Oct 19 2016 20:11:03 GMT+0500 (YEKT),
       deleted_at: null,
       dom_id: '2',
       starshina_id: '2' } } ]
[2016-10-19 20:11:03.791] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 20:11:03.793] [INFO] console - [ 16,
  5018533710790656,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 2 } ]
[2016-10-19 20:11:03.806] [INFO] console - Executing (66e21545-fb1a-497f-8db8-25f486207b6f): START TRANSACTION;
[2016-10-19 20:11:03.809] [INFO] console - Executing (66e21545-fb1a-497f-8db8-25f486207b6f): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:11:03.824] [INFO] console - Executing (66e21545-fb1a-497f-8db8-25f486207b6f): INSERT INTO "Kopnik" ("id","name","surname","patronymic","voiskoSize","birth","path","created_at","updated_at","dom_id","starshina_id") VALUES (DEFAULT,'temp','temp','temp',0,1900,'/','2016-10-19 15:11:03.813 +00:00','2016-10-19 15:11:03.813 +00:00',2,NULL) RETURNING *;
[2016-10-19 20:11:03.834] [INFO] console - Executing (66e21545-fb1a-497f-8db8-25f486207b6f): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:11:03.843] [INFO] console - Executing (66e21545-fb1a-497f-8db8-25f486207b6f): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:11:03.850] [INFO] console - Executing (66e21545-fb1a-497f-8db8-25f486207b6f): update "Zemla"
                                    set "obshinaSize"= "obshinaSize"+ 1
                                where
                                    '/1/' like path||id||'/%'
                                    or (
                                        true 
                                        and id= 2
                                    )
[2016-10-19 20:11:03.855] [INFO] console - Executing (66e21545-fb1a-497f-8db8-25f486207b6f): COMMIT;
[2016-10-19 20:11:03.858] [INFO] console - [ 70, 362, {}, [ '57' ] ]
[2016-10-19 20:11:03.872] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:11:03.882] [INFO] console - Executing (default): select z.*
                                    from "Zemla" as z
                                where
                                    '/1/' like z.path||z.id||'/%'
[2016-10-19 20:11:03.884] [INFO] console - Executing (66f4656d-34e3-4f87-8ee0-34102139cf56): START TRANSACTION;
[2016-10-19 20:11:03.890] [INFO] console - Executing (66f4656d-34e3-4f87-8ee0-34102139cf56): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:11:03.899] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" IN ('1')) ORDER BY "Zemla"."path" desc;
[2016-10-19 20:11:03.911] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 57);
[2016-10-19 20:11:03.913] [INFO] console - [ 16,
  2074844619341824,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id2.obshinaChange',
  [],
  { obshinaSize: 55 } ]
[2016-10-19 20:11:03.923] [INFO] console - [ 16,
  6174888601583616,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id1.obshinaChange',
  [],
  { obshinaSize: 57 } ]
[2016-10-19 20:11:03.947] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 56);
[2016-10-19 20:11:03.956] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 20:11:03.972] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:11:03.980] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:11:03.995] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='56',"updated_at"='2016-10-19 15:11:03.983 +00:00' WHERE "id" = '57'
[2016-10-19 20:11:04.007] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/', '/2/56/')
                                where
                                    id = '57'
                                    or path like '/57/'||'%'
[2016-10-19 20:11:04.017] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/2/56/' like path||id||'/%'
[2016-10-19 20:11:04.021] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/56/' like k.path||k.id||'/%'
[2016-10-19 20:11:04.072] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('56', '2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:11:04.084] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/2/56/57/'||'%'
[2016-10-19 20:11:04.094] [INFO] console - Executing (66f4656d-34e3-4f87-8ee0-34102139cf56): COMMIT;
[2016-10-19 20:11:04.098] [INFO] console - [ 70, 363, {}, [ undefined ] ]
[2016-10-19 20:11:04.108] [INFO] console - [ 16,
  4751227032174592,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id56.druzhinaChange',
  [],
  { action: 'add',
    kopnik: 
     { fullName: 'temp temp',
       fullPath: '/2/56/57/',
       id: '57',
       email: null,
       password: null,
       name: 'temp',
       surname: 'temp',
       patronymic: 'temp',
       voiskoSize: 0,
       birth: 1900,
       path: '/2/56/',
       note: null,
       created_at: Wed Oct 19 2016 20:11:03 GMT+0500 (YEKT),
       updated_at: Wed Oct 19 2016 20:11:03 GMT+0500 (YEKT),
       deleted_at: null,
       dom_id: '2',
       starshina_id: '56' } } ]
[2016-10-19 20:11:04.129] [INFO] console - [ 16,
  5547797535260672,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id56.voiskoChange',
  [],
  { voiskoSize: 1 } ]
[2016-10-19 20:11:04.141] [INFO] console - [ 16,
  1491496515665920,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 3 } ]
[2016-10-19 20:11:04.157] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 4 }
[2016-10-19 20:11:04.166] [INFO] console - Executing (a984ac83-3dd6-47b6-a6a3-92aaef9582ed): START TRANSACTION;
[2016-10-19 20:11:04.172] [INFO] console - Executing (a984ac83-3dd6-47b6-a6a3-92aaef9582ed): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:11:04.189] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 4);
[2016-10-19 20:11:04.200] [INFO] console - Executing (a984ac83-3dd6-47b6-a6a3-92aaef9582ed): COMMIT;
[2016-10-19 20:11:04.203] [INFO] console - [ 70,
  364,
  {},
  [ { fullName: 'Unit Test',
      fullPath: '/4/',
      id: '4',
      email: 'unittest4@domain.ru',
      name: 'Unit',
      surname: 'Test',
      patronymic: '4',
      voiskoSize: 0,
      birth: 1983,
      path: '/',
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: null,
      attachments: [] } ] ]
[2016-10-19 20:11:04.228] [INFO] console - Executing (5e5630b9-f89d-4e0f-898d-3a64652be956): START TRANSACTION;
[2016-10-19 20:11:04.231] [INFO] console - Executing (5e5630b9-f89d-4e0f-898d-3a64652be956): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:11:04.241] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 56);
[2016-10-19 20:11:04.252] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 4);
[2016-10-19 20:11:04.262] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 20:11:04.274] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:11:04.283] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-2
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 20:11:04.297] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='4',"updated_at"='2016-10-19 15:11:04.285 +00:00' WHERE "id" = '56'
[2016-10-19 20:11:04.303] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/2/', '/4/')
                                where
                                    id = '56'
                                    or path like '/2/56/'||'%'
[2016-10-19 20:11:04.307] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+2
                                where
                                    '/4/' like path||id||'/%'
[2016-10-19 20:11:04.313] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/4/' like k.path||k.id||'/%'
[2016-10-19 20:11:04.325] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('4')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:11:04.333] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/4/56/'||'%'
[2016-10-19 20:11:04.338] [INFO] console - Executing (5e5630b9-f89d-4e0f-898d-3a64652be956): COMMIT;
[2016-10-19 20:11:04.342] [INFO] console - [ 70, 365, {}, [ undefined ] ]
[2016-10-19 20:11:04.346] [INFO] console - [ 16,
  5003021863878656,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.druzhinaChange',
  [],
  { action: 'remove', KOPNIK: 56 } ]
[2016-10-19 20:11:04.355] [INFO] console - [ 16,
  4717131985846272,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id4.druzhinaChange',
  [],
  { action: 'add',
    kopnik: 
     { fullName: 'temp temp',
       fullPath: '/4/56/',
       id: '56',
       email: null,
       password: null,
       name: 'temp',
       surname: 'temp',
       patronymic: 'temp',
       voiskoSize: 1,
       birth: 1900,
       path: '/4/',
       note: null,
       created_at: Wed Oct 19 2016 20:11:03 GMT+0500 (YEKT),
       updated_at: Wed Oct 19 2016 20:11:04 GMT+0500 (YEKT),
       deleted_at: null,
       dom_id: '2',
       starshina_id: '4' } } ]
[2016-10-19 20:11:04.373] [INFO] console - [ 16,
  7565444521132032,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 1 } ]
[2016-10-19 20:11:04.381] [INFO] console - [ 16,
  5644228057104384,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id4.voiskoChange',
  [],
  { voiskoSize: 2 } ]
[2016-10-19 20:11:04.391] [INFO] console - [ 16,
  427284724973568,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id57.starshinaChange',
  [],
  {} ]
[2016-10-19 20:11:04.402] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 57 }
[2016-10-19 20:11:04.408] [INFO] console - Executing (6d90a43c-35c8-4f3d-998f-b1598bf498bd): START TRANSACTION;
[2016-10-19 20:11:04.411] [INFO] console - Executing (6d90a43c-35c8-4f3d-998f-b1598bf498bd): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:11:04.425] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 57);
[2016-10-19 20:11:04.436] [INFO] console - Executing (6d90a43c-35c8-4f3d-998f-b1598bf498bd): COMMIT;
[2016-10-19 20:11:04.439] [INFO] console - [ 70,
  366,
  {},
  [ { fullName: 'temp temp',
      fullPath: '/4/56/57/',
      id: '57',
      email: null,
      name: 'temp',
      surname: 'temp',
      patronymic: 'temp',
      voiskoSize: 0,
      birth: 1900,
      path: '/4/56/',
      note: null,
      created_at: Wed Oct 19 2016 20:11:03 GMT+0500 (YEKT),
      updated_at: Wed Oct 19 2016 20:11:03 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: '56',
      attachments: [] } ] ]
[2016-10-19 20:11:04.455] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 56 }
[2016-10-19 20:11:04.461] [INFO] console - Executing (40ef7598-3ab5-43f3-b60b-988002ed4603): START TRANSACTION;
[2016-10-19 20:11:04.464] [INFO] console - Executing (40ef7598-3ab5-43f3-b60b-988002ed4603): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:11:04.482] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 56);
[2016-10-19 20:11:04.496] [INFO] console - Executing (40ef7598-3ab5-43f3-b60b-988002ed4603): COMMIT;
[2016-10-19 20:11:04.499] [INFO] console - [ 70,
  367,
  {},
  [ { fullName: 'temp temp',
      fullPath: '/4/56/',
      id: '56',
      email: null,
      name: 'temp',
      surname: 'temp',
      patronymic: 'temp',
      voiskoSize: 1,
      birth: 1900,
      path: '/4/',
      note: null,
      created_at: Wed Oct 19 2016 20:11:03 GMT+0500 (YEKT),
      updated_at: Wed Oct 19 2016 20:11:04 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: '4',
      attachments: [] } ] ]
[2016-10-19 20:11:04.522] [INFO] console - Executing (5f0adf42-5856-4eaa-b5eb-96071b037dd8): START TRANSACTION;
[2016-10-19 20:11:04.526] [INFO] console - Executing (5f0adf42-5856-4eaa-b5eb-96071b037dd8): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:11:04.552] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 56);
[2016-10-19 20:11:04.554] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 20:11:04.569] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/4/' like k.path||k.id||'/%'
[2016-10-19 20:11:04.577] [INFO] console - Executing (bab34549-a531-4aee-b106-0431f94a263e): START TRANSACTION;
[2016-10-19 20:11:04.584] [INFO] console - Executing (bab34549-a531-4aee-b106-0431f94a263e): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:11:04.591] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('4')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:11:04.603] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-2
                                where
                                    '/4/' like path||id||'/%'
[2016-10-19 20:11:04.616] [INFO] console - Executing (bab34549-a531-4aee-b106-0431f94a263e): INSERT INTO "Kopnik" ("id","name","surname","patronymic","voiskoSize","birth","path","created_at","updated_at","dom_id","starshina_id") VALUES (DEFAULT,'temp','temp','temp',0,1900,'/','2016-10-19 15:11:04.599 +00:00','2016-10-19 15:11:04.599 +00:00',2,NULL) RETURNING *;
[2016-10-19 20:11:04.626] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"=NULL,"updated_at"='2016-10-19 15:11:04.608 +00:00' WHERE "id" = '56'
[2016-10-19 20:11:04.692] [INFO] console - Executing (bab34549-a531-4aee-b106-0431f94a263e): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:11:04.697] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/4/', '/')
                                where
                                    id = '56'
                                    or path like '/4/56/'||'%'
[2016-10-19 20:11:04.705] [INFO] console - Executing (bab34549-a531-4aee-b106-0431f94a263e): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:11:04.713] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+2
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:11:04.716] [INFO] console - Executing (bab34549-a531-4aee-b106-0431f94a263e): update "Zemla"
                                    set "obshinaSize"= "obshinaSize"+ 1
                                where
                                    '/1/' like path||id||'/%'
                                    or (
                                        true 
                                        and id= 2
                                    )
[2016-10-19 20:11:04.721] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 20:11:04.728] [INFO] console - Executing (bab34549-a531-4aee-b106-0431f94a263e): COMMIT;
[2016-10-19 20:11:04.734] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:11:04.740] [INFO] console - [ 70, 369, {}, [ '58' ] ]
[2016-10-19 20:11:04.752] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/56/'||'%'
[2016-10-19 20:11:04.760] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:11:04.776] [INFO] console - Executing (136344af-8279-4fbd-9213-0c894f969eb7): START TRANSACTION;
[2016-10-19 20:11:04.804] [INFO] console - Executing (5f0adf42-5856-4eaa-b5eb-96071b037dd8): COMMIT;
[2016-10-19 20:11:04.811] [INFO] console - Executing (default): select z.*
                                    from "Zemla" as z
                                where
                                    '/1/' like z.path||z.id||'/%'
[2016-10-19 20:11:04.814] [INFO] console - Executing (136344af-8279-4fbd-9213-0c894f969eb7): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:11:04.826] [INFO] console - [ 70, 368, {}, [ undefined ] ]
[2016-10-19 20:11:04.835] [INFO] console - [ 16,
  3281361376903168,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id4.druzhinaChange',
  [],
  { action: 'remove', KOPNIK: 56 } ]
[2016-10-19 20:11:04.884] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" IN ('1')) ORDER BY "Zemla"."path" desc;
[2016-10-19 20:11:04.886] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 58);
[2016-10-19 20:11:04.890] [INFO] console - [ 16,
  8153512051474432,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id4.voiskoChange',
  [],
  { voiskoSize: 0 } ]
[2016-10-19 20:11:04.908] [INFO] console - [ 16,
  3056943570616320,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id2.obshinaChange',
  [],
  { obshinaSize: 56 } ]
[2016-10-19 20:11:04.916] [INFO] console - [ 16,
  2433922556231680,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id57.starshinaChange',
  [],
  {} ]
[2016-10-19 20:11:04.928] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 20:11:04.930] [INFO] console - [ 16,
  4414667214553088,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id1.obshinaChange',
  [],
  { obshinaSize: 58 } ]
[2016-10-19 20:11:04.946] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 20:11:04.964] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:11:04.972] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:11:04.987] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='2',"updated_at"='2016-10-19 15:11:04.976 +00:00' WHERE "id" = '58'
[2016-10-19 20:11:04.993] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/', '/2/')
                                where
                                    id = '58'
                                    or path like '/58/'||'%'
[2016-10-19 20:11:05.001] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 20:11:05.006] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 20:11:05.019] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:11:05.027] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/2/58/'||'%'
[2016-10-19 20:11:05.032] [INFO] console - Executing (136344af-8279-4fbd-9213-0c894f969eb7): COMMIT;
[2016-10-19 20:11:05.037] [INFO] console - [ 70, 370, {}, [ undefined ] ]
[2016-10-19 20:11:05.053] [INFO] console - [ 16,
  2778177592098816,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.druzhinaChange',
  [],
  { action: 'add',
    kopnik: 
     { fullName: 'temp temp',
       fullPath: '/2/58/',
       id: '58',
       email: null,
       password: null,
       name: 'temp',
       surname: 'temp',
       patronymic: 'temp',
       voiskoSize: 0,
       birth: 1900,
       path: '/2/',
       note: null,
       created_at: Wed Oct 19 2016 20:11:04 GMT+0500 (YEKT),
       updated_at: Wed Oct 19 2016 20:11:04 GMT+0500 (YEKT),
       deleted_at: null,
       dom_id: '2',
       starshina_id: '2' } } ]
[2016-10-19 20:11:05.084] [INFO] console - [ 16,
  5834689377992704,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 2 } ]
[2016-10-19 20:11:05.096] [INFO] console - Executing (cb35582f-4200-405c-b3f4-d77ce1df473e): START TRANSACTION;
[2016-10-19 20:11:05.114] [INFO] console - Executing (cb35582f-4200-405c-b3f4-d77ce1df473e): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:11:05.127] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 58);
[2016-10-19 20:11:05.137] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 20:11:05.147] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:11:05.154] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 20:11:05.168] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"=NULL,"updated_at"='2016-10-19 15:11:05.158 +00:00' WHERE "id" = '58'
[2016-10-19 20:11:05.175] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/2/', '/')
                                where
                                    id = '58'
                                    or path like '/2/58/'||'%'
[2016-10-19 20:11:05.179] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:11:05.184] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 20:11:05.194] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:11:05.199] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/58/'||'%'
[2016-10-19 20:11:05.204] [INFO] console - Executing (cb35582f-4200-405c-b3f4-d77ce1df473e): COMMIT;
[2016-10-19 20:11:05.207] [INFO] console - [ 70, 371, {}, [ undefined ] ]
[2016-10-19 20:11:05.213] [INFO] console - [ 16,
  3591899373895680,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.druzhinaChange',
  [],
  { action: 'remove', KOPNIK: 58 } ]
[2016-10-19 20:11:05.226] [INFO] console - [ 16,
  4910247747518464,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 1 } ]
[2016-10-19 20:11:05.235] [DEBUG] Server - #promiseModel() [] { model: 'Kopa', id: 3 }
[2016-10-19 20:11:05.243] [INFO] console - Executing (a4257cbe-7234-42ab-aed0-dc379d6738d5): START TRANSACTION;
[2016-10-19 20:11:05.247] [INFO] console - Executing (a4257cbe-7234-42ab-aed0-dc379d6738d5): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:11:05.266] [INFO] console - Executing (default): SELECT "Kopa"."id", "Kopa"."question", "Kopa"."invited", "Kopa"."note", "Kopa"."created_at", "Kopa"."updated_at", "Kopa"."deleted_at", "Kopa"."place_id", "Kopa"."inviter_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopa" AS "Kopa" LEFT OUTER JOIN "File" AS "attachments" ON "Kopa"."id" = "attachments"."kopa_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopa"."deleted_at" IS NULL AND "Kopa"."id" = 3);
[2016-10-19 20:11:05.277] [INFO] console - Executing (a4257cbe-7234-42ab-aed0-dc379d6738d5): COMMIT;
[2016-10-19 20:11:05.280] [INFO] console - [ 70,
  372,
  {},
  [ { id: '3',
      question: 'CHE',
      invited: Thu Sep 01 2016 00:00:00 GMT+0500 (YEKT),
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      place_id: '2',
      inviter_id: '2',
      attachments: [] } ] ]
[2016-10-19 20:11:05.307] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 20:11:05.319] [INFO] console - Executing (91c18b92-1dab-437e-bff9-0ca061ccc204): START TRANSACTION;
[2016-10-19 20:11:05.321] [INFO] console - Executing (91c18b92-1dab-437e-bff9-0ca061ccc204): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:11:05.336] [INFO] console - Executing (91c18b92-1dab-437e-bff9-0ca061ccc204): INSERT INTO "Predlozhenie" ("id","value","totalZa","totalProtiv","created_at","updated_at","author_id","place_id") VALUES (DEFAULT,'temp Wed Oct 19 2016 20:11:05 GMT+0500 (YEKT)',0,0,'2016-10-19 15:11:05.328 +00:00','2016-10-19 15:11:05.328 +00:00',2,3) RETURNING *;
[2016-10-19 20:11:05.344] [INFO] console - Executing (91c18b92-1dab-437e-bff9-0ca061ccc204): COMMIT;
[2016-10-19 20:11:05.350] [INFO] console - [ 70, 373, {}, [ '15' ] ]
[2016-10-19 20:11:05.357] [INFO] console - [ 16,
  2860607860637696,
  { acknowledge: true },
  'ru.kopa.model.Kopa.id3.predlozhenieAdd',
  [ '15' ] ]
[2016-10-19 20:11:05.376] [INFO] console - Executing (a6aa6364-dad8-4309-9fe0-b79a20afbaa6): START TRANSACTION;
[2016-10-19 20:11:05.382] [INFO] console - Executing (a6aa6364-dad8-4309-9fe0-b79a20afbaa6): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:11:05.392] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 20:11:05.404] [INFO] console - Executing (default): SELECT "id", "value", "totalZa", "totalProtiv", "state", "note", "created_at", "updated_at", "deleted_at", "author_id", "place_id" FROM "Predlozhenie" AS "Predlozhenie" WHERE ("Predlozhenie"."deleted_at" IS NULL AND "Predlozhenie"."id" = 15);
[2016-10-19 20:11:05.418] [INFO] console - Executing (default): SELECT "id", "question", "invited", "note", "created_at", "updated_at", "deleted_at", "place_id", "inviter_id" FROM "Kopa" AS "Kopa" WHERE ("Kopa"."deleted_at" IS NULL AND "Kopa"."id" = '3');
[2016-10-19 20:11:05.430] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:11:05.445] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:11:05.453] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 20:11:05.464] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:11:05.477] [INFO] console - Executing (default): SELECT "id", "value", "reason", "note", "created_at", "updated_at", "deleted_at", "subject_id", "owner_id", "parent_id" FROM "Golos" AS "Golos" WHERE ("Golos"."deleted_at" IS NULL AND ("Golos"."subject_id" = '15' AND "Golos"."owner_id" = '2')) LIMIT 1;
[2016-10-19 20:11:05.498] [INFO] console - Executing (default): INSERT INTO "Golos" ("id","value","created_at","updated_at","subject_id","owner_id") VALUES (DEFAULT,1,'2016-10-19 15:11:05.490 +00:00','2016-10-19 15:11:05.490 +00:00','15','2') RETURNING *;
[2016-10-19 20:11:05.509] [INFO] console - Executing (default): insert into "Golos" (subject_id, value, owner_id, parent_id, created_at, updated_at)
                            (
                                select 15, 1, k.id, 39, current_timestamp, current_timestamp
                                from 
                                    "Kopnik" k
                                     join "Zemla" d on d.id= k.dom_id
                                where
                                    k.path like '/2/%'
                                    and d.path||d.id||'/' like '/1/2/%' 
                            )
[2016-10-19 20:11:05.517] [INFO] console - Executing (default): select
                            (select count(*) from "Golos" g where subject_id= 15 and value=1) "za",
                            (select count(*) from "Golos" g where subject_id= 15 and value=-1) "protiv"
[2016-10-19 20:11:05.547] [INFO] console - Executing (default): UPDATE "Predlozhenie" SET "totalZa"=2,"updated_at"='2016-10-19 15:11:05.523 +00:00' WHERE "id" = '15'
[2016-10-19 20:11:05.564] [INFO] console - Executing (a6aa6364-dad8-4309-9fe0-b79a20afbaa6): COMMIT;
[2016-10-19 20:11:05.570] [INFO] console - [ 70, 374, {}, [ undefined ] ]
[2016-10-19 20:11:05.577] [INFO] console - [ 16,
  6347298734866432,
  { acknowledge: true },
  'ru.kopa.model.Predlozhenie.id15.rebalance',
  [],
  { totalZa: 2,
    totalProtiv: 0,
    GOLOS: '39',
    action: 'add',
    value: 1 } ]
[2016-10-19 20:11:05.589] [INFO] console - Executing (88ac4dd4-6b89-4253-9587-b275c74e865f): START TRANSACTION;
[2016-10-19 20:11:05.593] [INFO] console - Executing (88ac4dd4-6b89-4253-9587-b275c74e865f): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:11:05.607] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 20:11:05.620] [INFO] console - Executing (default): SELECT "id", "value", "totalZa", "totalProtiv", "state", "note", "created_at", "updated_at", "deleted_at", "author_id", "place_id" FROM "Predlozhenie" AS "Predlozhenie" WHERE ("Predlozhenie"."deleted_at" IS NULL AND "Predlozhenie"."id" = 15);
[2016-10-19 20:11:05.630] [INFO] console - Executing (default): SELECT "id", "question", "invited", "note", "created_at", "updated_at", "deleted_at", "place_id", "inviter_id" FROM "Kopa" AS "Kopa" WHERE ("Kopa"."deleted_at" IS NULL AND "Kopa"."id" = '3');
[2016-10-19 20:11:05.641] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:11:05.655] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:11:05.661] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 20:11:05.673] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:11:05.692] [INFO] console - Executing (default): SELECT "id", "value", "reason", "note", "created_at", "updated_at", "deleted_at", "subject_id", "owner_id", "parent_id" FROM "Golos" AS "Golos" WHERE ("Golos"."deleted_at" IS NULL AND ("Golos"."subject_id" = '15' AND "Golos"."owner_id" = '2')) LIMIT 1;
[2016-10-19 20:11:05.704] [INFO] console - Executing (default): delete from "Golos" 
                            where
                                subject_id= 15
                                and (
                                    id= 39
                                    or parent_id = 39
                                )
[2016-10-19 20:11:05.717] [INFO] console - Executing (default): select
                            (select count(*) from "Golos" g where subject_id= 15 and value=1) "za",
                            (select count(*) from "Golos" g where subject_id= 15 and value=-1) "protiv"
[2016-10-19 20:11:05.736] [INFO] console - Executing (default): UPDATE "Predlozhenie" SET "totalZa"=0,"updated_at"='2016-10-19 15:11:05.723 +00:00' WHERE "id" = '15'
[2016-10-19 20:11:05.741] [INFO] console - Executing (88ac4dd4-6b89-4253-9587-b275c74e865f): COMMIT;
[2016-10-19 20:11:05.744] [INFO] console - [ 70, 375, {}, [ undefined ] ]
[2016-10-19 20:11:05.749] [INFO] console - [ 16,
  5825521417977856,
  { acknowledge: true },
  'ru.kopa.model.Predlozhenie.id15.rebalance',
  [],
  { totalZa: 0,
    totalProtiv: 0,
    GOLOS: '39',
    action: 'remove',
    value: 1 } ]
[2016-10-19 20:11:05.762] [INFO] console - Executing (5c7d56dc-0d05-44e2-8fc1-066fcb24e5d3): START TRANSACTION;
[2016-10-19 20:11:05.766] [INFO] console - Executing (5c7d56dc-0d05-44e2-8fc1-066fcb24e5d3): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:11:05.779] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 20:11:05.794] [INFO] console - Executing (default): SELECT "id", "value", "totalZa", "totalProtiv", "state", "note", "created_at", "updated_at", "deleted_at", "author_id", "place_id" FROM "Predlozhenie" AS "Predlozhenie" WHERE ("Predlozhenie"."deleted_at" IS NULL AND "Predlozhenie"."id" = 15);
[2016-10-19 20:11:05.816] [INFO] console - Executing (default): SELECT "id", "question", "invited", "note", "created_at", "updated_at", "deleted_at", "place_id", "inviter_id" FROM "Kopa" AS "Kopa" WHERE ("Kopa"."deleted_at" IS NULL AND "Kopa"."id" = '3');
[2016-10-19 20:11:05.833] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:11:05.846] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:11:05.858] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 20:11:05.869] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:11:05.880] [INFO] console - Executing (default): SELECT "id", "value", "reason", "note", "created_at", "updated_at", "deleted_at", "subject_id", "owner_id", "parent_id" FROM "Golos" AS "Golos" WHERE ("Golos"."deleted_at" IS NULL AND ("Golos"."subject_id" = '15' AND "Golos"."owner_id" = '2')) LIMIT 1;
[2016-10-19 20:11:05.897] [INFO] console - Executing (default): INSERT INTO "Golos" ("id","value","created_at","updated_at","subject_id","owner_id") VALUES (DEFAULT,-1,'2016-10-19 15:11:05.886 +00:00','2016-10-19 15:11:05.886 +00:00','15','2') RETURNING *;
[2016-10-19 20:11:05.916] [INFO] console - Executing (default): insert into "Golos" (subject_id, value, owner_id, parent_id, created_at, updated_at)
                            (
                                select 15, -1, k.id, 41, current_timestamp, current_timestamp
                                from 
                                    "Kopnik" k
                                     join "Zemla" d on d.id= k.dom_id
                                where
                                    k.path like '/2/%'
                                    and d.path||d.id||'/' like '/1/2/%' 
                            )
[2016-10-19 20:11:05.931] [INFO] console - Executing (default): select
                            (select count(*) from "Golos" g where subject_id= 15 and value=1) "za",
                            (select count(*) from "Golos" g where subject_id= 15 and value=-1) "protiv"
[2016-10-19 20:11:05.984] [INFO] console - Executing (default): UPDATE "Predlozhenie" SET "totalProtiv"=2,"updated_at"='2016-10-19 15:11:05.939 +00:00' WHERE "id" = '15'
[2016-10-19 20:11:06.005] [INFO] console - Executing (5c7d56dc-0d05-44e2-8fc1-066fcb24e5d3): COMMIT;
[2016-10-19 20:11:06.011] [INFO] console - [ 70, 376, {}, [ undefined ] ]
[2016-10-19 20:11:06.018] [INFO] console - [ 16,
  2028947520880640,
  { acknowledge: true },
  'ru.kopa.model.Predlozhenie.id15.rebalance',
  [],
  { totalZa: 0,
    totalProtiv: 2,
    GOLOS: '41',
    action: 'add',
    value: -1 } ]
[2016-10-19 20:17:32.807] [INFO] console - [ 70, 378, {}, [ undefined ] ]
[2016-10-19 20:17:32.840] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 2 }
[2016-10-19 20:17:33.244] [INFO] console - Executing (default): delete from "Kopnik"
                where
                    name like '%temp'
                    or name like 'temp%'
[2016-10-19 20:17:33.277] [INFO] console - Executing (a98be86e-5666-49f6-9455-9ea965fac32b): START TRANSACTION;
[2016-10-19 20:17:33.298] [INFO] console - Executing (a98be86e-5666-49f6-9455-9ea965fac32b): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:17:33.347] [INFO] console - Executing (default): update "Kopnik"
                set 
                    "voiskoSize"= case when id=2 then 1 ELSE 0 END
                where
                    id>1 
                    and id<=5
[2016-10-19 20:17:33.527] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 20:17:33.577] [INFO] console - Executing (a98be86e-5666-49f6-9455-9ea965fac32b): COMMIT;
[2016-10-19 20:17:33.608] [INFO] console - [ 70,
  379,
  {},
  [ { fullName: 'Unit Test',
      fullPath: '/2/',
      id: '2',
      email: 'unittest2@domain.ru',
      name: 'Unit',
      surname: 'Test',
      patronymic: '1',
      voiskoSize: 1,
      birth: 1983,
      path: '/',
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: null,
      attachments: [] } ] ]
[2016-10-19 20:17:33.862] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."starshina_id" = 2) ORDER BY "Kopnik"."surname" asc, "Kopnik"."name" asc, "Kopnik"."patronymic" asc;
[2016-10-19 20:17:34.063] [INFO] console - [ 70, 380, {}, [ [ [Object], [Object] ] ] ]
[2016-10-19 20:17:34.157] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 20:17:34.284] [INFO] console - Executing (8329e5a0-dfaf-4ab5-9f82-969ceb4b9cd6): START TRANSACTION;
[2016-10-19 20:17:34.292] [INFO] console - Executing (8329e5a0-dfaf-4ab5-9f82-969ceb4b9cd6): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:17:34.406] [INFO] console - Executing (8329e5a0-dfaf-4ab5-9f82-969ceb4b9cd6): INSERT INTO "Kopnik" ("id","name","surname","patronymic","voiskoSize","birth","path","created_at","updated_at","dom_id","starshina_id") VALUES (DEFAULT,'temp','temp','temp',0,1900,'/','2016-10-19 15:17:34.302 +00:00','2016-10-19 15:17:34.302 +00:00',2,NULL) RETURNING *;
[2016-10-19 20:17:34.532] [INFO] console - Executing (8329e5a0-dfaf-4ab5-9f82-969ceb4b9cd6): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:17:34.574] [INFO] console - Executing (8329e5a0-dfaf-4ab5-9f82-969ceb4b9cd6): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:17:34.603] [INFO] console - Executing (8329e5a0-dfaf-4ab5-9f82-969ceb4b9cd6): update "Zemla"
                                    set "obshinaSize"= "obshinaSize"+ 1
                                where
                                    '/1/' like path||id||'/%'
                                    or (
                                        true 
                                        and id= 2
                                    )
[2016-10-19 20:17:34.616] [INFO] console - Executing (8329e5a0-dfaf-4ab5-9f82-969ceb4b9cd6): COMMIT;
[2016-10-19 20:17:34.626] [INFO] console - [ 70, 381, {}, [ '59' ] ]
[2016-10-19 20:17:34.655] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:17:34.696] [INFO] console - Executing (cd82184e-d80b-42aa-907c-790aaf26be4f): START TRANSACTION;
[2016-10-19 20:17:34.705] [INFO] console - Executing (default): select z.*
                                    from "Zemla" as z
                                where
                                    '/1/' like z.path||z.id||'/%'
[2016-10-19 20:17:34.712] [INFO] console - Executing (cd82184e-d80b-42aa-907c-790aaf26be4f): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:17:34.764] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" IN ('1')) ORDER BY "Zemla"."path" desc;
[2016-10-19 20:17:34.771] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 59);
[2016-10-19 20:17:34.794] [INFO] console - [ 16,
  5342923587584000,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id2.obshinaChange',
  [],
  { obshinaSize: 57 } ]
[2016-10-19 20:17:34.814] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 20:17:34.818] [INFO] console - [ 16,
  8889880346099712,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id1.obshinaChange',
  [],
  { obshinaSize: 59 } ]
[2016-10-19 20:17:34.849] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 20:17:34.878] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:17:34.890] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:17:34.922] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='2',"updated_at"='2016-10-19 15:17:34.896 +00:00' WHERE "id" = '59'
[2016-10-19 20:17:34.934] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/', '/2/')
                                where
                                    id = '59'
                                    or path like '/59/'||'%'
[2016-10-19 20:17:34.944] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 20:17:34.952] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 20:17:34.991] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:17:35.006] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/2/59/'||'%'
[2016-10-19 20:17:35.014] [INFO] console - Executing (cd82184e-d80b-42aa-907c-790aaf26be4f): COMMIT;
[2016-10-19 20:17:35.023] [INFO] console - [ 70, 382, {}, [ undefined ] ]
[2016-10-19 20:17:35.031] [INFO] console - [ 16,
  7836160759955456,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.druzhinaChange',
  [],
  { action: 'add',
    kopnik: 
     { fullName: 'temp temp',
       fullPath: '/2/59/',
       id: '59',
       email: null,
       password: null,
       name: 'temp',
       surname: 'temp',
       patronymic: 'temp',
       voiskoSize: 0,
       birth: 1900,
       path: '/2/',
       note: null,
       created_at: Wed Oct 19 2016 20:17:34 GMT+0500 (YEKT),
       updated_at: Wed Oct 19 2016 20:17:34 GMT+0500 (YEKT),
       deleted_at: null,
       dom_id: '2',
       starshina_id: '2' } } ]
[2016-10-19 20:17:35.091] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 20:17:35.093] [INFO] console - [ 16,
  3554601173254144,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 2 } ]
[2016-10-19 20:17:35.107] [INFO] console - Executing (b3884df8-51fe-4dea-9c5d-875564dd6b82): START TRANSACTION;
[2016-10-19 20:17:35.111] [INFO] console - Executing (b3884df8-51fe-4dea-9c5d-875564dd6b82): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:17:35.127] [INFO] console - Executing (b3884df8-51fe-4dea-9c5d-875564dd6b82): INSERT INTO "Kopnik" ("id","name","surname","patronymic","voiskoSize","birth","path","created_at","updated_at","dom_id","starshina_id") VALUES (DEFAULT,'temp','temp','temp',0,1900,'/','2016-10-19 15:17:35.114 +00:00','2016-10-19 15:17:35.114 +00:00',2,NULL) RETURNING *;
[2016-10-19 20:17:35.139] [INFO] console - Executing (b3884df8-51fe-4dea-9c5d-875564dd6b82): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:17:35.161] [INFO] console - Executing (b3884df8-51fe-4dea-9c5d-875564dd6b82): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:17:35.179] [INFO] console - Executing (b3884df8-51fe-4dea-9c5d-875564dd6b82): update "Zemla"
                                    set "obshinaSize"= "obshinaSize"+ 1
                                where
                                    '/1/' like path||id||'/%'
                                    or (
                                        true 
                                        and id= 2
                                    )
[2016-10-19 20:17:35.190] [INFO] console - Executing (b3884df8-51fe-4dea-9c5d-875564dd6b82): COMMIT;
[2016-10-19 20:17:35.196] [INFO] console - [ 70, 383, {}, [ '60' ] ]
[2016-10-19 20:17:35.226] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:17:35.242] [INFO] console - Executing (5ed38486-6a2d-4f54-adbb-b0fdb4640dbc): START TRANSACTION;
[2016-10-19 20:17:35.249] [INFO] console - Executing (default): select z.*
                                    from "Zemla" as z
                                where
                                    '/1/' like z.path||z.id||'/%'
[2016-10-19 20:17:35.251] [INFO] console - Executing (5ed38486-6a2d-4f54-adbb-b0fdb4640dbc): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:17:35.283] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" IN ('1')) ORDER BY "Zemla"."path" desc;
[2016-10-19 20:17:35.285] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 60);
[2016-10-19 20:17:35.301] [INFO] console - [ 16,
  752092757098496,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id2.obshinaChange',
  [],
  { obshinaSize: 58 } ]
[2016-10-19 20:17:35.317] [INFO] console - [ 16,
  4334514652315648,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id1.obshinaChange',
  [],
  { obshinaSize: 60 } ]
[2016-10-19 20:17:35.345] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 59);
[2016-10-19 20:17:35.359] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 20:17:35.378] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:17:35.385] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:17:35.398] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='59',"updated_at"='2016-10-19 15:17:35.388 +00:00' WHERE "id" = '60'
[2016-10-19 20:17:35.413] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/', '/2/59/')
                                where
                                    id = '60'
                                    or path like '/60/'||'%'
[2016-10-19 20:17:35.420] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/2/59/' like path||id||'/%'
[2016-10-19 20:17:35.426] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/59/' like k.path||k.id||'/%'
[2016-10-19 20:17:35.440] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('59', '2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:17:35.452] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/2/59/60/'||'%'
[2016-10-19 20:17:35.460] [INFO] console - Executing (5ed38486-6a2d-4f54-adbb-b0fdb4640dbc): COMMIT;
[2016-10-19 20:17:35.465] [INFO] console - [ 70, 384, {}, [ undefined ] ]
[2016-10-19 20:17:35.473] [INFO] console - [ 16,
  8896987957035008,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id59.druzhinaChange',
  [],
  { action: 'add',
    kopnik: 
     { fullName: 'temp temp',
       fullPath: '/2/59/60/',
       id: '60',
       email: null,
       password: null,
       name: 'temp',
       surname: 'temp',
       patronymic: 'temp',
       voiskoSize: 0,
       birth: 1900,
       path: '/2/59/',
       note: null,
       created_at: Wed Oct 19 2016 20:17:35 GMT+0500 (YEKT),
       updated_at: Wed Oct 19 2016 20:17:35 GMT+0500 (YEKT),
       deleted_at: null,
       dom_id: '2',
       starshina_id: '59' } } ]
[2016-10-19 20:17:35.490] [INFO] console - [ 16,
  1704206566162432,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id59.voiskoChange',
  [],
  { voiskoSize: 1 } ]
[2016-10-19 20:17:35.500] [INFO] console - [ 16,
  8930866682134528,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 3 } ]
[2016-10-19 20:17:35.528] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 4 }
[2016-10-19 20:17:35.547] [INFO] console - Executing (7173451d-e25b-49f5-b3f2-0a74781d960f): START TRANSACTION;
[2016-10-19 20:17:35.551] [INFO] console - Executing (7173451d-e25b-49f5-b3f2-0a74781d960f): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:17:35.566] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 4);
[2016-10-19 20:17:35.579] [INFO] console - Executing (7173451d-e25b-49f5-b3f2-0a74781d960f): COMMIT;
[2016-10-19 20:17:35.583] [INFO] console - [ 70,
  385,
  {},
  [ { fullName: 'Unit Test',
      fullPath: '/4/',
      id: '4',
      email: 'unittest4@domain.ru',
      name: 'Unit',
      surname: 'Test',
      patronymic: '4',
      voiskoSize: 0,
      birth: 1983,
      path: '/',
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: null,
      attachments: [] } ] ]
[2016-10-19 20:17:35.654] [INFO] console - Executing (9e04f4d7-65b2-4cb4-9399-2c5cbf2fd911): START TRANSACTION;
[2016-10-19 20:17:35.658] [INFO] console - Executing (9e04f4d7-65b2-4cb4-9399-2c5cbf2fd911): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:17:35.670] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 59);
[2016-10-19 20:17:35.684] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 4);
[2016-10-19 20:17:35.691] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 20:17:35.708] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:17:35.715] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-2
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 20:17:35.738] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='4',"updated_at"='2016-10-19 15:17:35.721 +00:00' WHERE "id" = '59'
[2016-10-19 20:17:35.746] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/2/', '/4/')
                                where
                                    id = '59'
                                    or path like '/2/59/'||'%'
[2016-10-19 20:17:35.753] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+2
                                where
                                    '/4/' like path||id||'/%'
[2016-10-19 20:17:35.759] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/4/' like k.path||k.id||'/%'
[2016-10-19 20:17:35.772] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('4')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:17:35.779] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/4/59/'||'%'
[2016-10-19 20:17:35.784] [INFO] console - Executing (9e04f4d7-65b2-4cb4-9399-2c5cbf2fd911): COMMIT;
[2016-10-19 20:17:35.788] [INFO] console - [ 70, 386, {}, [ undefined ] ]
[2016-10-19 20:17:35.815] [INFO] console - [ 16,
  6427386067288064,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.druzhinaChange',
  [],
  { action: 'remove', KOPNIK: 59 } ]
[2016-10-19 20:17:35.862] [INFO] console - [ 16,
  6046194266537984,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id4.druzhinaChange',
  [],
  { action: 'add',
    kopnik: 
     { fullName: 'temp temp',
       fullPath: '/4/59/',
       id: '59',
       email: null,
       password: null,
       name: 'temp',
       surname: 'temp',
       patronymic: 'temp',
       voiskoSize: 1,
       birth: 1900,
       path: '/4/',
       note: null,
       created_at: Wed Oct 19 2016 20:17:34 GMT+0500 (YEKT),
       updated_at: Wed Oct 19 2016 20:17:35 GMT+0500 (YEKT),
       deleted_at: null,
       dom_id: '2',
       starshina_id: '4' } } ]
[2016-10-19 20:17:35.887] [INFO] console - [ 16,
  6965467310718976,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 1 } ]
[2016-10-19 20:17:35.910] [INFO] console - [ 16,
  6357250012610560,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id4.voiskoChange',
  [],
  { voiskoSize: 2 } ]
[2016-10-19 20:17:35.924] [INFO] console - [ 16,
  1793007638544384,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id60.starshinaChange',
  [],
  {} ]
[2016-10-19 20:17:35.945] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 60 }
[2016-10-19 20:17:35.957] [INFO] console - Executing (bc7bc2ed-4867-4dfd-9af6-f70e7a46a7fa): START TRANSACTION;
[2016-10-19 20:17:35.967] [INFO] console - Executing (bc7bc2ed-4867-4dfd-9af6-f70e7a46a7fa): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:17:35.991] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 60);
[2016-10-19 20:17:36.036] [INFO] console - Executing (bc7bc2ed-4867-4dfd-9af6-f70e7a46a7fa): COMMIT;
[2016-10-19 20:17:36.052] [INFO] console - [ 70,
  387,
  {},
  [ { fullName: 'temp temp',
      fullPath: '/4/59/60/',
      id: '60',
      email: null,
      name: 'temp',
      surname: 'temp',
      patronymic: 'temp',
      voiskoSize: 0,
      birth: 1900,
      path: '/4/59/',
      note: null,
      created_at: Wed Oct 19 2016 20:17:35 GMT+0500 (YEKT),
      updated_at: Wed Oct 19 2016 20:17:35 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: '59',
      attachments: [] } ] ]
[2016-10-19 20:17:36.081] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 59 }
[2016-10-19 20:17:36.088] [INFO] console - Executing (a9268585-e816-4bc1-9032-515e79ed0c07): START TRANSACTION;
[2016-10-19 20:17:36.093] [INFO] console - Executing (a9268585-e816-4bc1-9032-515e79ed0c07): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:17:36.116] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 59);
[2016-10-19 20:17:36.132] [INFO] console - Executing (a9268585-e816-4bc1-9032-515e79ed0c07): COMMIT;
[2016-10-19 20:17:36.135] [INFO] console - [ 70,
  388,
  {},
  [ { fullName: 'temp temp',
      fullPath: '/4/59/',
      id: '59',
      email: null,
      name: 'temp',
      surname: 'temp',
      patronymic: 'temp',
      voiskoSize: 1,
      birth: 1900,
      path: '/4/',
      note: null,
      created_at: Wed Oct 19 2016 20:17:34 GMT+0500 (YEKT),
      updated_at: Wed Oct 19 2016 20:17:35 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: '4',
      attachments: [] } ] ]
[2016-10-19 20:17:36.163] [INFO] console - Executing (bbace46a-f21a-4417-a3d6-357b485f7396): START TRANSACTION;
[2016-10-19 20:17:36.167] [INFO] console - Executing (bbace46a-f21a-4417-a3d6-357b485f7396): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:17:36.179] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 59);
[2016-10-19 20:17:36.188] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/4/' like k.path||k.id||'/%'
[2016-10-19 20:17:36.204] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('4')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:17:36.215] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-2
                                where
                                    '/4/' like path||id||'/%'
[2016-10-19 20:17:36.231] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 20:17:36.256] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"=NULL,"updated_at"='2016-10-19 15:17:36.233 +00:00' WHERE "id" = '59'
[2016-10-19 20:17:36.268] [INFO] console - Executing (1b2784de-af7a-4c63-9684-85d0533ab173): START TRANSACTION;
[2016-10-19 20:17:36.275] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/4/', '/')
                                where
                                    id = '59'
                                    or path like '/4/59/'||'%'
[2016-10-19 20:17:36.276] [INFO] console - Executing (1b2784de-af7a-4c63-9684-85d0533ab173): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:17:36.297] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+2
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:17:36.311] [INFO] console - Executing (1b2784de-af7a-4c63-9684-85d0533ab173): INSERT INTO "Kopnik" ("id","name","surname","patronymic","voiskoSize","birth","path","created_at","updated_at","dom_id","starshina_id") VALUES (DEFAULT,'temp','temp','temp',0,1900,'/','2016-10-19 15:17:36.284 +00:00','2016-10-19 15:17:36.284 +00:00',2,NULL) RETURNING *;
[2016-10-19 20:17:36.321] [INFO] console - Executing (1b2784de-af7a-4c63-9684-85d0533ab173): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:17:36.326] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 20:17:36.343] [INFO] console - Executing (1b2784de-af7a-4c63-9684-85d0533ab173): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:17:36.364] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:17:36.369] [INFO] console - Executing (1b2784de-af7a-4c63-9684-85d0533ab173): update "Zemla"
                                    set "obshinaSize"= "obshinaSize"+ 1
                                where
                                    '/1/' like path||id||'/%'
                                    or (
                                        true 
                                        and id= 2
                                    )
[2016-10-19 20:17:36.375] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/59/'||'%'
[2016-10-19 20:17:36.384] [INFO] console - Executing (bbace46a-f21a-4417-a3d6-357b485f7396): COMMIT;
[2016-10-19 20:17:36.387] [INFO] console - Executing (1b2784de-af7a-4c63-9684-85d0533ab173): COMMIT;
[2016-10-19 20:17:36.391] [INFO] console - [ 70, 389, {}, [ undefined ] ]
[2016-10-19 20:17:36.403] [INFO] console - [ 16,
  6988910682963968,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id4.druzhinaChange',
  [],
  { action: 'remove', KOPNIK: 59 } ]
[2016-10-19 20:17:36.414] [INFO] console - [ 70, 390, {}, [ '61' ] ]
[2016-10-19 20:17:36.423] [INFO] console - [ 16,
  8500445496475648,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id4.voiskoChange',
  [],
  { voiskoSize: 0 } ]
[2016-10-19 20:17:36.446] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:17:36.468] [INFO] console - Executing (default): select z.*
                                    from "Zemla" as z
                                where
                                    '/1/' like z.path||z.id||'/%'
[2016-10-19 20:17:36.476] [INFO] console - [ 16,
  7829747163725824,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id60.starshinaChange',
  [],
  {} ]
[2016-10-19 20:17:36.502] [INFO] console - Executing (dc269113-e8d8-4147-94f0-da2a88ce6005): START TRANSACTION;
[2016-10-19 20:17:36.517] [INFO] console - Executing (dc269113-e8d8-4147-94f0-da2a88ce6005): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:17:36.533] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" IN ('1')) ORDER BY "Zemla"."path" desc;
[2016-10-19 20:17:36.555] [INFO] console - [ 16,
  6492415875612672,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id2.obshinaChange',
  [],
  { obshinaSize: 59 } ]
[2016-10-19 20:17:36.578] [INFO] console - [ 16,
  7072895308136448,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id1.obshinaChange',
  [],
  { obshinaSize: 61 } ]
[2016-10-19 20:17:36.604] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 61);
[2016-10-19 20:17:36.643] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 20:17:36.672] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 20:17:36.708] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:17:36.733] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:17:36.792] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='2',"updated_at"='2016-10-19 15:17:36.749 +00:00' WHERE "id" = '61'
[2016-10-19 20:17:36.814] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/', '/2/')
                                where
                                    id = '61'
                                    or path like '/61/'||'%'
[2016-10-19 20:17:36.853] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 20:17:36.933] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 20:17:36.950] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:17:36.965] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/2/61/'||'%'
[2016-10-19 20:17:36.975] [INFO] console - Executing (dc269113-e8d8-4147-94f0-da2a88ce6005): COMMIT;
[2016-10-19 20:17:36.986] [INFO] console - [ 70, 391, {}, [ undefined ] ]
[2016-10-19 20:17:37.000] [INFO] console - [ 16,
  822803693568000,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.druzhinaChange',
  [],
  { action: 'add',
    kopnik: 
     { fullName: 'temp temp',
       fullPath: '/2/61/',
       id: '61',
       email: null,
       password: null,
       name: 'temp',
       surname: 'temp',
       patronymic: 'temp',
       voiskoSize: 0,
       birth: 1900,
       path: '/2/',
       note: null,
       created_at: Wed Oct 19 2016 20:17:36 GMT+0500 (YEKT),
       updated_at: Wed Oct 19 2016 20:17:36 GMT+0500 (YEKT),
       deleted_at: null,
       dom_id: '2',
       starshina_id: '2' } } ]
[2016-10-19 20:17:37.053] [INFO] console - [ 16,
  5926691413164032,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 2 } ]
[2016-10-19 20:17:37.076] [INFO] console - Executing (6a684506-6fb3-428c-82bc-335e96a7f997): START TRANSACTION;
[2016-10-19 20:17:37.093] [INFO] console - Executing (6a684506-6fb3-428c-82bc-335e96a7f997): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:17:37.112] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 61);
[2016-10-19 20:17:37.168] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 20:17:37.206] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:17:37.224] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 20:17:37.260] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"=NULL,"updated_at"='2016-10-19 15:17:37.232 +00:00' WHERE "id" = '61'
[2016-10-19 20:17:37.288] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/2/', '/')
                                where
                                    id = '61'
                                    or path like '/2/61/'||'%'
[2016-10-19 20:17:37.294] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:17:37.303] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 20:17:37.323] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:17:37.335] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/61/'||'%'
[2016-10-19 20:17:37.345] [INFO] console - Executing (6a684506-6fb3-428c-82bc-335e96a7f997): COMMIT;
[2016-10-19 20:17:37.350] [INFO] console - [ 70, 392, {}, [ undefined ] ]
[2016-10-19 20:17:37.368] [INFO] console - [ 16,
  5214658415820800,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.druzhinaChange',
  [],
  { action: 'remove', KOPNIK: 61 } ]
[2016-10-19 20:17:37.405] [INFO] console - [ 16,
  1059449064128512,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 1 } ]
[2016-10-19 20:17:37.441] [DEBUG] Server - #promiseModel() [] { model: 'Kopa', id: 3 }
[2016-10-19 20:17:37.453] [INFO] console - Executing (bea4c09c-c811-4da0-b79b-a69d07da5faf): START TRANSACTION;
[2016-10-19 20:17:37.456] [INFO] console - Executing (bea4c09c-c811-4da0-b79b-a69d07da5faf): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:17:37.484] [INFO] console - Executing (default): SELECT "Kopa"."id", "Kopa"."question", "Kopa"."invited", "Kopa"."note", "Kopa"."created_at", "Kopa"."updated_at", "Kopa"."deleted_at", "Kopa"."place_id", "Kopa"."inviter_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopa" AS "Kopa" LEFT OUTER JOIN "File" AS "attachments" ON "Kopa"."id" = "attachments"."kopa_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopa"."deleted_at" IS NULL AND "Kopa"."id" = 3);
[2016-10-19 20:17:37.501] [INFO] console - Executing (bea4c09c-c811-4da0-b79b-a69d07da5faf): COMMIT;
[2016-10-19 20:17:37.506] [INFO] console - [ 70,
  393,
  {},
  [ { id: '3',
      question: 'CHE',
      invited: Thu Sep 01 2016 00:00:00 GMT+0500 (YEKT),
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      place_id: '2',
      inviter_id: '2',
      attachments: [] } ] ]
[2016-10-19 20:17:37.549] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 20:17:37.564] [INFO] console - Executing (ac27eb76-80e9-4f29-a381-92c6acab4b22): START TRANSACTION;
[2016-10-19 20:17:37.568] [INFO] console - Executing (ac27eb76-80e9-4f29-a381-92c6acab4b22): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:17:37.587] [INFO] console - Executing (ac27eb76-80e9-4f29-a381-92c6acab4b22): INSERT INTO "Predlozhenie" ("id","value","totalZa","totalProtiv","created_at","updated_at","author_id","place_id") VALUES (DEFAULT,'temp Wed Oct 19 2016 20:17:37 GMT+0500 (YEKT)',0,0,'2016-10-19 15:17:37.574 +00:00','2016-10-19 15:17:37.574 +00:00',2,3) RETURNING *;
[2016-10-19 20:17:37.597] [INFO] console - Executing (ac27eb76-80e9-4f29-a381-92c6acab4b22): COMMIT;
[2016-10-19 20:17:37.602] [INFO] console - [ 70, 394, {}, [ '16' ] ]
[2016-10-19 20:17:37.619] [INFO] console - [ 16,
  2233204991852544,
  { acknowledge: true },
  'ru.kopa.model.Kopa.id3.predlozhenieAdd',
  [ '16' ] ]
[2016-10-19 20:17:37.644] [INFO] console - Executing (d89ca1a2-2377-42c1-8535-c94216bf1daf): START TRANSACTION;
[2016-10-19 20:17:37.648] [INFO] console - Executing (d89ca1a2-2377-42c1-8535-c94216bf1daf): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:17:37.667] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 20:17:37.680] [INFO] console - Executing (default): SELECT "id", "value", "totalZa", "totalProtiv", "state", "note", "created_at", "updated_at", "deleted_at", "author_id", "place_id" FROM "Predlozhenie" AS "Predlozhenie" WHERE ("Predlozhenie"."deleted_at" IS NULL AND "Predlozhenie"."id" = 16);
[2016-10-19 20:17:37.695] [INFO] console - Executing (default): SELECT "id", "question", "invited", "note", "created_at", "updated_at", "deleted_at", "place_id", "inviter_id" FROM "Kopa" AS "Kopa" WHERE ("Kopa"."deleted_at" IS NULL AND "Kopa"."id" = '3');
[2016-10-19 20:17:37.707] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:17:37.722] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:17:37.731] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 20:17:37.751] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:17:37.768] [INFO] console - Executing (default): SELECT "id", "value", "reason", "note", "created_at", "updated_at", "deleted_at", "subject_id", "owner_id", "parent_id" FROM "Golos" AS "Golos" WHERE ("Golos"."deleted_at" IS NULL AND ("Golos"."subject_id" = '16' AND "Golos"."owner_id" = '2')) LIMIT 1;
[2016-10-19 20:17:37.785] [INFO] console - Executing (default): INSERT INTO "Golos" ("id","value","created_at","updated_at","subject_id","owner_id") VALUES (DEFAULT,1,'2016-10-19 15:17:37.774 +00:00','2016-10-19 15:17:37.774 +00:00','16','2') RETURNING *;
[2016-10-19 20:17:37.796] [INFO] console - Executing (default): insert into "Golos" (subject_id, value, owner_id, parent_id, created_at, updated_at)
                            (
                                select 16, 1, k.id, 43, current_timestamp, current_timestamp
                                from 
                                    "Kopnik" k
                                     join "Zemla" d on d.id= k.dom_id
                                where
                                    k.path like '/2/%'
                                    and d.path||d.id||'/' like '/1/2/%' 
                            )
[2016-10-19 20:17:37.803] [INFO] console - Executing (default): select
                            (select count(*) from "Golos" g where subject_id= 16 and value=1) "za",
                            (select count(*) from "Golos" g where subject_id= 16 and value=-1) "protiv"
[2016-10-19 20:17:37.816] [INFO] console - Executing (default): UPDATE "Predlozhenie" SET "totalZa"=2,"updated_at"='2016-10-19 15:17:37.807 +00:00' WHERE "id" = '16'
[2016-10-19 20:17:37.823] [INFO] console - Executing (d89ca1a2-2377-42c1-8535-c94216bf1daf): COMMIT;
[2016-10-19 20:17:37.826] [INFO] console - [ 70, 395, {}, [ undefined ] ]
[2016-10-19 20:17:37.841] [INFO] console - [ 16,
  257251484893184,
  { acknowledge: true },
  'ru.kopa.model.Predlozhenie.id16.rebalance',
  [],
  { totalZa: 2,
    totalProtiv: 0,
    GOLOS: '43',
    action: 'add',
    value: 1 } ]
[2016-10-19 20:17:37.860] [INFO] console - Executing (281f9137-6d9c-4920-8b40-e11efe633a52): START TRANSACTION;
[2016-10-19 20:17:37.863] [INFO] console - Executing (281f9137-6d9c-4920-8b40-e11efe633a52): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:17:37.878] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 20:17:37.893] [INFO] console - Executing (default): SELECT "id", "value", "totalZa", "totalProtiv", "state", "note", "created_at", "updated_at", "deleted_at", "author_id", "place_id" FROM "Predlozhenie" AS "Predlozhenie" WHERE ("Predlozhenie"."deleted_at" IS NULL AND "Predlozhenie"."id" = 16);
[2016-10-19 20:17:37.904] [INFO] console - Executing (default): SELECT "id", "question", "invited", "note", "created_at", "updated_at", "deleted_at", "place_id", "inviter_id" FROM "Kopa" AS "Kopa" WHERE ("Kopa"."deleted_at" IS NULL AND "Kopa"."id" = '3');
[2016-10-19 20:17:37.916] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:17:37.926] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:17:37.933] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 20:17:37.945] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:17:37.958] [INFO] console - Executing (default): SELECT "id", "value", "reason", "note", "created_at", "updated_at", "deleted_at", "subject_id", "owner_id", "parent_id" FROM "Golos" AS "Golos" WHERE ("Golos"."deleted_at" IS NULL AND ("Golos"."subject_id" = '16' AND "Golos"."owner_id" = '2')) LIMIT 1;
[2016-10-19 20:17:37.970] [INFO] console - Executing (default): delete from "Golos" 
                            where
                                subject_id= 16
                                and (
                                    id= 43
                                    or parent_id = 43
                                )
[2016-10-19 20:17:37.977] [INFO] console - Executing (default): select
                            (select count(*) from "Golos" g where subject_id= 16 and value=1) "za",
                            (select count(*) from "Golos" g where subject_id= 16 and value=-1) "protiv"
[2016-10-19 20:17:37.988] [INFO] console - Executing (default): UPDATE "Predlozhenie" SET "totalZa"=0,"updated_at"='2016-10-19 15:17:37.980 +00:00' WHERE "id" = '16'
[2016-10-19 20:17:37.994] [INFO] console - Executing (281f9137-6d9c-4920-8b40-e11efe633a52): COMMIT;
[2016-10-19 20:17:38.002] [INFO] console - [ 70, 396, {}, [ undefined ] ]
[2016-10-19 20:17:38.007] [INFO] console - [ 16,
  2800406033858560,
  { acknowledge: true },
  'ru.kopa.model.Predlozhenie.id16.rebalance',
  [],
  { totalZa: 0,
    totalProtiv: 0,
    GOLOS: '43',
    action: 'remove',
    value: 1 } ]
[2016-10-19 20:17:38.022] [INFO] console - Executing (a9af1d60-b092-4844-b0f1-785c15a9f2b1): START TRANSACTION;
[2016-10-19 20:17:38.026] [INFO] console - Executing (a9af1d60-b092-4844-b0f1-785c15a9f2b1): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:17:38.039] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 20:17:38.060] [INFO] console - Executing (default): SELECT "id", "value", "totalZa", "totalProtiv", "state", "note", "created_at", "updated_at", "deleted_at", "author_id", "place_id" FROM "Predlozhenie" AS "Predlozhenie" WHERE ("Predlozhenie"."deleted_at" IS NULL AND "Predlozhenie"."id" = 16);
[2016-10-19 20:17:38.073] [INFO] console - Executing (default): SELECT "id", "question", "invited", "note", "created_at", "updated_at", "deleted_at", "place_id", "inviter_id" FROM "Kopa" AS "Kopa" WHERE ("Kopa"."deleted_at" IS NULL AND "Kopa"."id" = '3');
[2016-10-19 20:17:38.085] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:17:38.097] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:17:38.103] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 20:17:38.117] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:17:38.127] [INFO] console - Executing (default): SELECT "id", "value", "reason", "note", "created_at", "updated_at", "deleted_at", "subject_id", "owner_id", "parent_id" FROM "Golos" AS "Golos" WHERE ("Golos"."deleted_at" IS NULL AND ("Golos"."subject_id" = '16' AND "Golos"."owner_id" = '2')) LIMIT 1;
[2016-10-19 20:17:38.140] [INFO] console - Executing (default): INSERT INTO "Golos" ("id","value","created_at","updated_at","subject_id","owner_id") VALUES (DEFAULT,-1,'2016-10-19 15:17:38.132 +00:00','2016-10-19 15:17:38.132 +00:00','16','2') RETURNING *;
[2016-10-19 20:17:38.150] [INFO] console - Executing (default): insert into "Golos" (subject_id, value, owner_id, parent_id, created_at, updated_at)
                            (
                                select 16, -1, k.id, 45, current_timestamp, current_timestamp
                                from 
                                    "Kopnik" k
                                     join "Zemla" d on d.id= k.dom_id
                                where
                                    k.path like '/2/%'
                                    and d.path||d.id||'/' like '/1/2/%' 
                            )
[2016-10-19 20:17:38.215] [INFO] console - Executing (default): select
                            (select count(*) from "Golos" g where subject_id= 16 and value=1) "za",
                            (select count(*) from "Golos" g where subject_id= 16 and value=-1) "protiv"
[2016-10-19 20:17:38.230] [INFO] console - Executing (default): UPDATE "Predlozhenie" SET "totalProtiv"=2,"updated_at"='2016-10-19 15:17:38.221 +00:00' WHERE "id" = '16'
[2016-10-19 20:17:38.419] [INFO] console - Executing (a9af1d60-b092-4844-b0f1-785c15a9f2b1): COMMIT;
[2016-10-19 20:17:38.422] [INFO] console - [ 70, 397, {}, [ undefined ] ]
[2016-10-19 20:17:38.435] [INFO] console - [ 16,
  1713379049734144,
  { acknowledge: true },
  'ru.kopa.model.Predlozhenie.id16.rebalance',
  [],
  { totalZa: 0,
    totalProtiv: 2,
    GOLOS: '45',
    action: 'add',
    value: -1 } ]
[2016-10-19 20:18:17.156] [INFO] console - [ 70, 399, {}, [ undefined ] ]
[2016-10-19 20:18:17.195] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 2 }
[2016-10-19 20:18:17.239] [INFO] console - Executing (default): delete from "Kopnik"
                where
                    name like '%temp'
                    or name like 'temp%'
[2016-10-19 20:18:17.255] [INFO] console - Executing (4a72a91c-71f6-4e91-a354-b0e339370195): START TRANSACTION;
[2016-10-19 20:18:17.257] [INFO] console - Executing (4a72a91c-71f6-4e91-a354-b0e339370195): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:18:17.290] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 20:18:17.313] [INFO] console - Executing (default): update "Kopnik"
                set 
                    "voiskoSize"= case when id=2 then 1 ELSE 0 END
                where
                    id>1 
                    and id<=5
[2016-10-19 20:18:17.321] [INFO] console - Executing (4a72a91c-71f6-4e91-a354-b0e339370195): COMMIT;
[2016-10-19 20:18:17.326] [INFO] console - [ 70,
  400,
  {},
  [ { fullName: 'Unit Test',
      fullPath: '/2/',
      id: '2',
      email: 'unittest2@domain.ru',
      name: 'Unit',
      surname: 'Test',
      patronymic: '1',
      voiskoSize: 1,
      birth: 1983,
      path: '/',
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: null,
      attachments: [] } ] ]
[2016-10-19 20:18:17.381] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."starshina_id" = 2) ORDER BY "Kopnik"."surname" asc, "Kopnik"."name" asc, "Kopnik"."patronymic" asc;
[2016-10-19 20:18:17.391] [INFO] console - [ 70, 401, {}, [ [ [Object], [Object] ] ] ]
[2016-10-19 20:18:17.429] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 20:18:17.443] [INFO] console - Executing (ad2d828e-674d-4371-8291-19e0770f4ec0): START TRANSACTION;
[2016-10-19 20:18:17.446] [INFO] console - Executing (ad2d828e-674d-4371-8291-19e0770f4ec0): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:18:17.460] [INFO] console - Executing (ad2d828e-674d-4371-8291-19e0770f4ec0): INSERT INTO "Kopnik" ("id","name","surname","patronymic","voiskoSize","birth","path","created_at","updated_at","dom_id","starshina_id") VALUES (DEFAULT,'temp','temp','temp',0,1900,'/','2016-10-19 15:18:17.449 +00:00','2016-10-19 15:18:17.449 +00:00',2,NULL) RETURNING *;
[2016-10-19 20:18:17.469] [INFO] console - Executing (ad2d828e-674d-4371-8291-19e0770f4ec0): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:18:17.478] [INFO] console - Executing (ad2d828e-674d-4371-8291-19e0770f4ec0): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:18:17.488] [INFO] console - Executing (ad2d828e-674d-4371-8291-19e0770f4ec0): update "Zemla"
                                    set "obshinaSize"= "obshinaSize"+ 1
                                where
                                    '/1/' like path||id||'/%'
                                    or (
                                        true 
                                        and id= 2
                                    )
[2016-10-19 20:18:17.496] [INFO] console - Executing (ad2d828e-674d-4371-8291-19e0770f4ec0): COMMIT;
[2016-10-19 20:18:17.500] [INFO] console - [ 70, 402, {}, [ '62' ] ]
[2016-10-19 20:18:17.524] [INFO] console - Executing (a863a8b5-c2c9-4671-b441-b6db42c737db): START TRANSACTION;
[2016-10-19 20:18:17.529] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:18:17.533] [INFO] console - Executing (a863a8b5-c2c9-4671-b441-b6db42c737db): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:18:17.543] [INFO] console - Executing (default): select z.*
                                    from "Zemla" as z
                                where
                                    '/1/' like z.path||z.id||'/%'
[2016-10-19 20:18:17.549] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 62);
[2016-10-19 20:18:17.570] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" IN ('1')) ORDER BY "Zemla"."path" desc;
[2016-10-19 20:18:17.574] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 20:18:17.584] [INFO] console - [ 16,
  2711814135611392,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id2.obshinaChange',
  [],
  { obshinaSize: 60 } ]
[2016-10-19 20:18:17.593] [INFO] console - [ 16,
  6859258576502784,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id1.obshinaChange',
  [],
  { obshinaSize: 62 } ]
[2016-10-19 20:18:17.601] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 20:18:17.613] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:18:17.619] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:18:17.633] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='2',"updated_at"='2016-10-19 15:18:17.622 +00:00' WHERE "id" = '62'
[2016-10-19 20:18:17.641] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/', '/2/')
                                where
                                    id = '62'
                                    or path like '/62/'||'%'
[2016-10-19 20:18:17.646] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 20:18:17.651] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 20:18:17.665] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:18:17.672] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/2/62/'||'%'
[2016-10-19 20:18:17.678] [INFO] console - Executing (a863a8b5-c2c9-4671-b441-b6db42c737db): COMMIT;
[2016-10-19 20:18:17.683] [INFO] console - [ 70, 403, {}, [ undefined ] ]
[2016-10-19 20:18:17.689] [INFO] console - [ 16,
  4571129922453504,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.druzhinaChange',
  [],
  { action: 'add',
    kopnik: 
     { fullName: 'temp temp',
       fullPath: '/2/62/',
       id: '62',
       email: null,
       password: null,
       name: 'temp',
       surname: 'temp',
       patronymic: 'temp',
       voiskoSize: 0,
       birth: 1900,
       path: '/2/',
       note: null,
       created_at: Wed Oct 19 2016 20:18:17 GMT+0500 (YEKT),
       updated_at: Wed Oct 19 2016 20:18:17 GMT+0500 (YEKT),
       deleted_at: null,
       dom_id: '2',
       starshina_id: '2' } } ]
[2016-10-19 20:18:17.769] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 20:18:17.772] [INFO] console - [ 16,
  8243034812579840,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 2 } ]
[2016-10-19 20:18:17.792] [INFO] console - Executing (6fda40b1-7f9a-49a0-9270-1625af862d84): START TRANSACTION;
[2016-10-19 20:18:17.797] [INFO] console - Executing (6fda40b1-7f9a-49a0-9270-1625af862d84): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:18:17.827] [INFO] console - Executing (6fda40b1-7f9a-49a0-9270-1625af862d84): INSERT INTO "Kopnik" ("id","name","surname","patronymic","voiskoSize","birth","path","created_at","updated_at","dom_id","starshina_id") VALUES (DEFAULT,'temp','temp','temp',0,1900,'/','2016-10-19 15:18:17.801 +00:00','2016-10-19 15:18:17.801 +00:00',2,NULL) RETURNING *;
[2016-10-19 20:18:17.838] [INFO] console - Executing (6fda40b1-7f9a-49a0-9270-1625af862d84): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:18:17.846] [INFO] console - Executing (6fda40b1-7f9a-49a0-9270-1625af862d84): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:18:17.854] [INFO] console - Executing (6fda40b1-7f9a-49a0-9270-1625af862d84): update "Zemla"
                                    set "obshinaSize"= "obshinaSize"+ 1
                                where
                                    '/1/' like path||id||'/%'
                                    or (
                                        true 
                                        and id= 2
                                    )
[2016-10-19 20:18:17.858] [INFO] console - Executing (6fda40b1-7f9a-49a0-9270-1625af862d84): COMMIT;
[2016-10-19 20:18:17.862] [INFO] console - [ 70, 404, {}, [ '63' ] ]
[2016-10-19 20:18:17.877] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:18:17.885] [INFO] console - Executing (509ca985-191e-4a07-bc21-248346bbe2cd): START TRANSACTION;
[2016-10-19 20:18:17.889] [INFO] console - Executing (default): select z.*
                                    from "Zemla" as z
                                where
                                    '/1/' like z.path||z.id||'/%'
[2016-10-19 20:18:17.892] [INFO] console - Executing (509ca985-191e-4a07-bc21-248346bbe2cd): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:18:17.924] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" IN ('1')) ORDER BY "Zemla"."path" desc;
[2016-10-19 20:18:17.927] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 63);
[2016-10-19 20:18:17.939] [INFO] console - [ 16,
  4716747082956800,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id2.obshinaChange',
  [],
  { obshinaSize: 61 } ]
[2016-10-19 20:18:17.956] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 62);
[2016-10-19 20:18:17.959] [INFO] console - [ 16,
  2058393684541440,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id1.obshinaChange',
  [],
  { obshinaSize: 63 } ]
[2016-10-19 20:18:17.976] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 20:18:17.988] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:18:18.008] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:18:18.037] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='62',"updated_at"='2016-10-19 15:18:18.014 +00:00' WHERE "id" = '63'
[2016-10-19 20:18:18.049] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/', '/2/62/')
                                where
                                    id = '63'
                                    or path like '/63/'||'%'
[2016-10-19 20:18:18.061] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/2/62/' like path||id||'/%'
[2016-10-19 20:18:18.068] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/62/' like k.path||k.id||'/%'
[2016-10-19 20:18:18.086] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('62', '2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:18:18.095] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/2/62/63/'||'%'
[2016-10-19 20:18:18.100] [INFO] console - Executing (509ca985-191e-4a07-bc21-248346bbe2cd): COMMIT;
[2016-10-19 20:18:18.103] [INFO] console - [ 70, 405, {}, [ undefined ] ]
[2016-10-19 20:18:18.110] [INFO] console - [ 16,
  5041716218298368,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id62.druzhinaChange',
  [],
  { action: 'add',
    kopnik: 
     { fullName: 'temp temp',
       fullPath: '/2/62/63/',
       id: '63',
       email: null,
       password: null,
       name: 'temp',
       surname: 'temp',
       patronymic: 'temp',
       voiskoSize: 0,
       birth: 1900,
       path: '/2/62/',
       note: null,
       created_at: Wed Oct 19 2016 20:18:17 GMT+0500 (YEKT),
       updated_at: Wed Oct 19 2016 20:18:18 GMT+0500 (YEKT),
       deleted_at: null,
       dom_id: '2',
       starshina_id: '62' } } ]
[2016-10-19 20:18:18.124] [INFO] console - [ 16,
  6031146223665152,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id62.voiskoChange',
  [],
  { voiskoSize: 1 } ]
[2016-10-19 20:18:18.139] [INFO] console - [ 16,
  2220252689596416,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 3 } ]
[2016-10-19 20:18:18.164] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 4 }
[2016-10-19 20:18:18.171] [INFO] console - Executing (f11bf12d-ec67-4e87-b8dc-ce65dbadff7e): START TRANSACTION;
[2016-10-19 20:18:18.176] [INFO] console - Executing (f11bf12d-ec67-4e87-b8dc-ce65dbadff7e): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:18:18.194] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 4);
[2016-10-19 20:18:18.206] [INFO] console - Executing (f11bf12d-ec67-4e87-b8dc-ce65dbadff7e): COMMIT;
[2016-10-19 20:18:18.209] [INFO] console - [ 70,
  406,
  {},
  [ { fullName: 'Unit Test',
      fullPath: '/4/',
      id: '4',
      email: 'unittest4@domain.ru',
      name: 'Unit',
      surname: 'Test',
      patronymic: '4',
      voiskoSize: 0,
      birth: 1983,
      path: '/',
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: null,
      attachments: [] } ] ]
[2016-10-19 20:18:18.232] [INFO] console - Executing (d8e6ed6b-3289-420d-b98c-476c4b25e63f): START TRANSACTION;
[2016-10-19 20:18:18.234] [INFO] console - Executing (d8e6ed6b-3289-420d-b98c-476c4b25e63f): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:18:18.243] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 62);
[2016-10-19 20:18:18.252] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 4);
[2016-10-19 20:18:18.259] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 20:18:18.273] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:18:18.281] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-2
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 20:18:18.293] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='4',"updated_at"='2016-10-19 15:18:18.284 +00:00' WHERE "id" = '62'
[2016-10-19 20:18:18.301] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/2/', '/4/')
                                where
                                    id = '62'
                                    or path like '/2/62/'||'%'
[2016-10-19 20:18:18.304] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+2
                                where
                                    '/4/' like path||id||'/%'
[2016-10-19 20:18:18.308] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/4/' like k.path||k.id||'/%'
[2016-10-19 20:18:18.318] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('4')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:18:18.324] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/4/62/'||'%'
[2016-10-19 20:18:18.328] [INFO] console - Executing (d8e6ed6b-3289-420d-b98c-476c4b25e63f): COMMIT;
[2016-10-19 20:18:18.331] [INFO] console - [ 70, 407, {}, [ undefined ] ]
[2016-10-19 20:18:18.338] [INFO] console - [ 16,
  5949305059803136,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.druzhinaChange',
  [],
  { action: 'remove', KOPNIK: 62 } ]
[2016-10-19 20:18:18.348] [INFO] console - [ 16,
  223624403353600,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id4.druzhinaChange',
  [],
  { action: 'add',
    kopnik: 
     { fullName: 'temp temp',
       fullPath: '/4/62/',
       id: '62',
       email: null,
       password: null,
       name: 'temp',
       surname: 'temp',
       patronymic: 'temp',
       voiskoSize: 1,
       birth: 1900,
       path: '/4/',
       note: null,
       created_at: Wed Oct 19 2016 20:18:17 GMT+0500 (YEKT),
       updated_at: Wed Oct 19 2016 20:18:18 GMT+0500 (YEKT),
       deleted_at: null,
       dom_id: '2',
       starshina_id: '4' } } ]
[2016-10-19 20:18:18.368] [INFO] console - [ 16,
  3297199087681536,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 1 } ]
[2016-10-19 20:18:18.385] [INFO] console - [ 16,
  6345935032418304,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id4.voiskoChange',
  [],
  { voiskoSize: 2 } ]
[2016-10-19 20:18:18.396] [INFO] console - [ 16,
  7067321413664768,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id63.starshinaChange',
  [],
  {} ]
[2016-10-19 20:18:18.408] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 63 }
[2016-10-19 20:18:18.415] [INFO] console - Executing (5807c6e3-c434-4b4e-8fa3-59d63d657c49): START TRANSACTION;
[2016-10-19 20:18:18.418] [INFO] console - Executing (5807c6e3-c434-4b4e-8fa3-59d63d657c49): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:18:18.432] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 63);
[2016-10-19 20:18:18.444] [INFO] console - Executing (5807c6e3-c434-4b4e-8fa3-59d63d657c49): COMMIT;
[2016-10-19 20:18:18.447] [INFO] console - [ 70,
  408,
  {},
  [ { fullName: 'temp temp',
      fullPath: '/4/62/63/',
      id: '63',
      email: null,
      name: 'temp',
      surname: 'temp',
      patronymic: 'temp',
      voiskoSize: 0,
      birth: 1900,
      path: '/4/62/',
      note: null,
      created_at: Wed Oct 19 2016 20:18:17 GMT+0500 (YEKT),
      updated_at: Wed Oct 19 2016 20:18:18 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: '62',
      attachments: [] } ] ]
[2016-10-19 20:18:18.466] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 62 }
[2016-10-19 20:18:18.479] [INFO] console - Executing (21531fbc-1eed-42e1-9a61-3fc6cfa1c06e): START TRANSACTION;
[2016-10-19 20:18:18.482] [INFO] console - Executing (21531fbc-1eed-42e1-9a61-3fc6cfa1c06e): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:18:18.501] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 62);
[2016-10-19 20:18:18.511] [INFO] console - Executing (21531fbc-1eed-42e1-9a61-3fc6cfa1c06e): COMMIT;
[2016-10-19 20:18:18.513] [INFO] console - [ 70,
  409,
  {},
  [ { fullName: 'temp temp',
      fullPath: '/4/62/',
      id: '62',
      email: null,
      name: 'temp',
      surname: 'temp',
      patronymic: 'temp',
      voiskoSize: 1,
      birth: 1900,
      path: '/4/',
      note: null,
      created_at: Wed Oct 19 2016 20:18:17 GMT+0500 (YEKT),
      updated_at: Wed Oct 19 2016 20:18:18 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: '4',
      attachments: [] } ] ]
[2016-10-19 20:18:18.541] [INFO] console - Executing (29c2267b-e380-4ced-9a22-be6f4a684e28): START TRANSACTION;
[2016-10-19 20:18:18.543] [INFO] console - Executing (dbb6a147-f1ab-4d13-8620-f215e22dd7ea): START TRANSACTION;
[2016-10-19 20:18:18.547] [INFO] console - Executing (29c2267b-e380-4ced-9a22-be6f4a684e28): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:18:18.549] [INFO] console - Executing (dbb6a147-f1ab-4d13-8620-f215e22dd7ea): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:18:18.561] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 62);
[2016-10-19 20:18:18.563] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 62);
[2016-10-19 20:18:18.573] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/4/' like k.path||k.id||'/%'
[2016-10-19 20:18:18.575] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/4/' like k.path||k.id||'/%'
[2016-10-19 20:18:18.591] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('4')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:18:18.594] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('4')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:18:18.602] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-2
                                where
                                    '/4/' like path||id||'/%'
[2016-10-19 20:18:18.603] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-2
                                where
                                    '/4/' like path||id||'/%'
[2016-10-19 20:18:18.615] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"=NULL,"updated_at"='2016-10-19 15:18:18.606 +00:00' WHERE "id" = '62'
[2016-10-19 20:18:18.624] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"=NULL,"updated_at"='2016-10-19 15:18:18.617 +00:00' WHERE "id" = '62'
[2016-10-19 20:18:18.629] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/4/', '/')
                                where
                                    id = '62'
                                    or path like '/4/62/'||'%'
[2016-10-19 20:18:18.631] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/4/', '/')
                                where
                                    id = '62'
                                    or path like '/4/62/'||'%'
[2016-10-19 20:18:18.638] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+2
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:18:18.641] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+2
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:18:18.645] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 20:18:18.651] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 20:18:18.660] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:18:18.668] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:18:18.672] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/62/'||'%'
[2016-10-19 20:18:18.676] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/62/'||'%'
[2016-10-19 20:18:18.679] [INFO] console - Executing (29c2267b-e380-4ced-9a22-be6f4a684e28): COMMIT;
[2016-10-19 20:18:18.682] [INFO] console - Executing (dbb6a147-f1ab-4d13-8620-f215e22dd7ea): COMMIT;
[2016-10-19 20:18:18.684] [INFO] console - [ 70, 410, {}, [ undefined ] ]
[2016-10-19 20:18:18.691] [INFO] console - [ 16,
  7689799401996288,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id4.druzhinaChange',
  [],
  { action: 'remove', KOPNIK: 62 } ]
[2016-10-19 20:18:18.697] [INFO] console - [ 70, 411, {}, [ undefined ] ]
[2016-10-19 20:18:18.702] [INFO] console - [ 16,
  5536036799119360,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id4.voiskoChange',
  [],
  { voiskoSize: 0 } ]
[2016-10-19 20:18:18.706] [INFO] console - [ 16,
  5321326227095552,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id4.druzhinaChange',
  [],
  { action: 'remove', KOPNIK: 62 } ]
[2016-10-19 20:18:18.713] [INFO] console - [ 16,
  8416288323928064,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id63.starshinaChange',
  [],
  {} ]
[2016-10-19 20:18:18.719] [INFO] console - [ 16,
  904163726721024,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id4.voiskoChange',
  [],
  { voiskoSize: 0 } ]
[2016-10-19 20:18:18.727] [INFO] console - [ 16,
  1333127433682944,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id63.starshinaChange',
  [],
  {} ]
[2016-10-19 20:18:49.127] [INFO] console - [ 70, 413, {}, [ undefined ] ]
[2016-10-19 20:18:49.186] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 2 }
[2016-10-19 20:18:49.228] [INFO] console - Executing (default): delete from "Kopnik"
                where
                    name like '%temp'
                    or name like 'temp%'
[2016-10-19 20:18:49.237] [INFO] console - Executing (f39579e3-8af4-4b3d-b410-34b84346a51b): START TRANSACTION;
[2016-10-19 20:18:49.244] [INFO] console - Executing (f39579e3-8af4-4b3d-b410-34b84346a51b): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:18:49.251] [INFO] console - Executing (default): update "Kopnik"
                set 
                    "voiskoSize"= case when id=2 then 1 ELSE 0 END
                where
                    id>1 
                    and id<=5
[2016-10-19 20:18:49.293] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 20:18:49.337] [INFO] console - Executing (f39579e3-8af4-4b3d-b410-34b84346a51b): COMMIT;
[2016-10-19 20:18:49.353] [INFO] console - [ 70,
  414,
  {},
  [ { fullName: 'Unit Test',
      fullPath: '/2/',
      id: '2',
      email: 'unittest2@domain.ru',
      name: 'Unit',
      surname: 'Test',
      patronymic: '1',
      voiskoSize: 1,
      birth: 1983,
      path: '/',
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: null,
      attachments: [] } ] ]
[2016-10-19 20:18:49.634] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."starshina_id" = 2) ORDER BY "Kopnik"."surname" asc, "Kopnik"."name" asc, "Kopnik"."patronymic" asc;
[2016-10-19 20:18:49.711] [INFO] console - [ 70, 415, {}, [ [ [Object], [Object] ] ] ]
[2016-10-19 20:18:49.791] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 20:18:49.808] [INFO] console - Executing (47b0ff06-6edf-47f5-b140-053fa9509d41): START TRANSACTION;
[2016-10-19 20:18:49.812] [INFO] console - Executing (47b0ff06-6edf-47f5-b140-053fa9509d41): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:18:49.830] [INFO] console - Executing (47b0ff06-6edf-47f5-b140-053fa9509d41): INSERT INTO "Kopnik" ("id","name","surname","patronymic","voiskoSize","birth","path","created_at","updated_at","dom_id","starshina_id") VALUES (DEFAULT,'temp','temp','temp',0,1900,'/','2016-10-19 15:18:49.818 +00:00','2016-10-19 15:18:49.818 +00:00',2,NULL) RETURNING *;
[2016-10-19 20:18:49.838] [INFO] console - Executing (47b0ff06-6edf-47f5-b140-053fa9509d41): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:18:49.853] [INFO] console - Executing (47b0ff06-6edf-47f5-b140-053fa9509d41): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:18:49.864] [INFO] console - Executing (47b0ff06-6edf-47f5-b140-053fa9509d41): update "Zemla"
                                    set "obshinaSize"= "obshinaSize"+ 1
                                where
                                    '/1/' like path||id||'/%'
                                    or (
                                        true 
                                        and id= 2
                                    )
[2016-10-19 20:18:49.876] [INFO] console - Executing (47b0ff06-6edf-47f5-b140-053fa9509d41): COMMIT;
[2016-10-19 20:18:49.880] [INFO] console - [ 70, 416, {}, [ '64' ] ]
[2016-10-19 20:18:49.917] [INFO] console - Executing (2765dfc7-862a-4117-be35-60ff2c72a025): START TRANSACTION;
[2016-10-19 20:18:49.931] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:18:49.937] [INFO] console - Executing (2765dfc7-862a-4117-be35-60ff2c72a025): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:18:49.946] [INFO] console - Executing (default): select z.*
                                    from "Zemla" as z
                                where
                                    '/1/' like z.path||z.id||'/%'
[2016-10-19 20:18:49.958] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 64);
[2016-10-19 20:18:49.974] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" IN ('1')) ORDER BY "Zemla"."path" desc;
[2016-10-19 20:18:49.986] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 20:18:49.987] [INFO] console - [ 16,
  97308572123136,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id2.obshinaChange',
  [],
  { obshinaSize: 62 } ]
[2016-10-19 20:18:49.998] [INFO] console - [ 16,
  6626363756773376,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id1.obshinaChange',
  [],
  { obshinaSize: 64 } ]
[2016-10-19 20:18:50.013] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 20:18:50.023] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:18:50.031] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:18:50.044] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='2',"updated_at"='2016-10-19 15:18:50.035 +00:00' WHERE "id" = '64'
[2016-10-19 20:18:50.051] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/', '/2/')
                                where
                                    id = '64'
                                    or path like '/64/'||'%'
[2016-10-19 20:18:50.057] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 20:18:50.061] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 20:18:50.074] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:18:50.084] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/2/64/'||'%'
[2016-10-19 20:18:50.089] [INFO] console - Executing (2765dfc7-862a-4117-be35-60ff2c72a025): COMMIT;
[2016-10-19 20:18:50.092] [INFO] console - [ 70, 417, {}, [ undefined ] ]
[2016-10-19 20:18:50.102] [INFO] console - [ 16,
  7876922348404736,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.druzhinaChange',
  [],
  { action: 'add',
    kopnik: 
     { fullName: 'temp temp',
       fullPath: '/2/64/',
       id: '64',
       email: null,
       password: null,
       name: 'temp',
       surname: 'temp',
       patronymic: 'temp',
       voiskoSize: 0,
       birth: 1900,
       path: '/2/',
       note: null,
       created_at: Wed Oct 19 2016 20:18:49 GMT+0500 (YEKT),
       updated_at: Wed Oct 19 2016 20:18:50 GMT+0500 (YEKT),
       deleted_at: null,
       dom_id: '2',
       starshina_id: '2' } } ]
[2016-10-19 20:18:50.126] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 20:18:50.128] [INFO] console - [ 16,
  8184198569394176,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 2 } ]
[2016-10-19 20:18:50.142] [INFO] console - Executing (7407a85e-b6e6-4afd-a410-db6b015ff55e): START TRANSACTION;
[2016-10-19 20:18:50.145] [INFO] console - Executing (7407a85e-b6e6-4afd-a410-db6b015ff55e): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:18:50.163] [INFO] console - Executing (7407a85e-b6e6-4afd-a410-db6b015ff55e): INSERT INTO "Kopnik" ("id","name","surname","patronymic","voiskoSize","birth","path","created_at","updated_at","dom_id","starshina_id") VALUES (DEFAULT,'temp','temp','temp',0,1900,'/','2016-10-19 15:18:50.150 +00:00','2016-10-19 15:18:50.150 +00:00',2,NULL) RETURNING *;
[2016-10-19 20:18:50.171] [INFO] console - Executing (7407a85e-b6e6-4afd-a410-db6b015ff55e): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:18:50.182] [INFO] console - Executing (7407a85e-b6e6-4afd-a410-db6b015ff55e): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:18:50.192] [INFO] console - Executing (7407a85e-b6e6-4afd-a410-db6b015ff55e): update "Zemla"
                                    set "obshinaSize"= "obshinaSize"+ 1
                                where
                                    '/1/' like path||id||'/%'
                                    or (
                                        true 
                                        and id= 2
                                    )
[2016-10-19 20:18:50.198] [INFO] console - Executing (7407a85e-b6e6-4afd-a410-db6b015ff55e): COMMIT;
[2016-10-19 20:18:50.201] [INFO] console - [ 70, 418, {}, [ '65' ] ]
[2016-10-19 20:18:50.218] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:18:50.228] [INFO] console - Executing (default): select z.*
                                    from "Zemla" as z
                                where
                                    '/1/' like z.path||z.id||'/%'
[2016-10-19 20:18:50.235] [INFO] console - Executing (d8d0d498-1b9d-400b-b889-0e2184677180): START TRANSACTION;
[2016-10-19 20:18:50.240] [INFO] console - Executing (d8d0d498-1b9d-400b-b889-0e2184677180): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:18:50.246] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" IN ('1')) ORDER BY "Zemla"."path" desc;
[2016-10-19 20:18:50.253] [INFO] console - [ 16,
  2034366857347072,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id2.obshinaChange',
  [],
  { obshinaSize: 63 } ]
[2016-10-19 20:18:50.263] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 65);
[2016-10-19 20:18:50.268] [INFO] console - [ 16,
  5176664642289664,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id1.obshinaChange',
  [],
  { obshinaSize: 65 } ]
[2016-10-19 20:18:50.289] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 64);
[2016-10-19 20:18:50.297] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 20:18:50.309] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:18:50.317] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:18:50.331] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='64',"updated_at"='2016-10-19 15:18:50.320 +00:00' WHERE "id" = '65'
[2016-10-19 20:18:50.337] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/', '/2/64/')
                                where
                                    id = '65'
                                    or path like '/65/'||'%'
[2016-10-19 20:18:50.341] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/2/64/' like path||id||'/%'
[2016-10-19 20:18:50.347] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/64/' like k.path||k.id||'/%'
[2016-10-19 20:18:50.361] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('64', '2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:18:50.369] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/2/64/65/'||'%'
[2016-10-19 20:18:50.378] [INFO] console - Executing (d8d0d498-1b9d-400b-b889-0e2184677180): COMMIT;
[2016-10-19 20:18:50.385] [INFO] console - [ 70, 419, {}, [ undefined ] ]
[2016-10-19 20:18:50.393] [INFO] console - [ 16,
  7691151299575808,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id64.druzhinaChange',
  [],
  { action: 'add',
    kopnik: 
     { fullName: 'temp temp',
       fullPath: '/2/64/65/',
       id: '65',
       email: null,
       password: null,
       name: 'temp',
       surname: 'temp',
       patronymic: 'temp',
       voiskoSize: 0,
       birth: 1900,
       path: '/2/64/',
       note: null,
       created_at: Wed Oct 19 2016 20:18:50 GMT+0500 (YEKT),
       updated_at: Wed Oct 19 2016 20:18:50 GMT+0500 (YEKT),
       deleted_at: null,
       dom_id: '2',
       starshina_id: '64' } } ]
[2016-10-19 20:18:50.409] [INFO] console - [ 16,
  3171519337332736,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id64.voiskoChange',
  [],
  { voiskoSize: 1 } ]
[2016-10-19 20:18:50.418] [INFO] console - [ 16,
  4874842278985728,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 3 } ]
[2016-10-19 20:18:50.430] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 4 }
[2016-10-19 20:18:50.439] [INFO] console - Executing (6563caa2-8797-40a1-ae57-bbb206ec9980): START TRANSACTION;
[2016-10-19 20:18:50.443] [INFO] console - Executing (6563caa2-8797-40a1-ae57-bbb206ec9980): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:18:50.473] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 4);
[2016-10-19 20:18:50.489] [INFO] console - Executing (6563caa2-8797-40a1-ae57-bbb206ec9980): COMMIT;
[2016-10-19 20:18:50.493] [INFO] console - [ 70,
  420,
  {},
  [ { fullName: 'Unit Test',
      fullPath: '/4/',
      id: '4',
      email: 'unittest4@domain.ru',
      name: 'Unit',
      surname: 'Test',
      patronymic: '4',
      voiskoSize: 0,
      birth: 1983,
      path: '/',
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: null,
      attachments: [] } ] ]
[2016-10-19 20:18:50.519] [INFO] console - Executing (a011d405-b01b-4f94-b614-4a0b7f2335c8): START TRANSACTION;
[2016-10-19 20:18:50.522] [INFO] console - Executing (a011d405-b01b-4f94-b614-4a0b7f2335c8): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:18:50.532] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 64);
[2016-10-19 20:18:50.542] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 4);
[2016-10-19 20:18:50.553] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 20:18:50.566] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:18:50.573] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-2
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 20:18:50.586] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='4',"updated_at"='2016-10-19 15:18:50.577 +00:00' WHERE "id" = '64'
[2016-10-19 20:18:50.593] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/2/', '/4/')
                                where
                                    id = '64'
                                    or path like '/2/64/'||'%'
[2016-10-19 20:18:50.599] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+2
                                where
                                    '/4/' like path||id||'/%'
[2016-10-19 20:18:50.603] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/4/' like k.path||k.id||'/%'
[2016-10-19 20:18:50.615] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('4')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:18:50.622] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/4/64/'||'%'
[2016-10-19 20:18:50.627] [INFO] console - Executing (a011d405-b01b-4f94-b614-4a0b7f2335c8): COMMIT;
[2016-10-19 20:18:50.631] [INFO] console - [ 70, 421, {}, [ undefined ] ]
[2016-10-19 20:18:50.641] [INFO] console - [ 16,
  5099713994948608,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.druzhinaChange',
  [],
  { action: 'remove', KOPNIK: 64 } ]
[2016-10-19 20:18:50.653] [INFO] console - [ 16,
  2319949590691840,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id4.druzhinaChange',
  [],
  { action: 'add',
    kopnik: 
     { fullName: 'temp temp',
       fullPath: '/4/64/',
       id: '64',
       email: null,
       password: null,
       name: 'temp',
       surname: 'temp',
       patronymic: 'temp',
       voiskoSize: 1,
       birth: 1900,
       path: '/4/',
       note: null,
       created_at: Wed Oct 19 2016 20:18:49 GMT+0500 (YEKT),
       updated_at: Wed Oct 19 2016 20:18:50 GMT+0500 (YEKT),
       deleted_at: null,
       dom_id: '2',
       starshina_id: '4' } } ]
[2016-10-19 20:18:50.671] [INFO] console - [ 16,
  3992106479648768,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 1 } ]
[2016-10-19 20:18:50.679] [INFO] console - [ 16,
  5296048872357888,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id4.voiskoChange',
  [],
  { voiskoSize: 2 } ]
[2016-10-19 20:18:50.687] [INFO] console - [ 16,
  6664218294091776,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id65.starshinaChange',
  [],
  {} ]
[2016-10-19 20:18:50.699] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 65 }
[2016-10-19 20:18:50.704] [INFO] console - Executing (00bf788c-13ac-49e5-93f5-004938619216): START TRANSACTION;
[2016-10-19 20:18:50.707] [INFO] console - Executing (00bf788c-13ac-49e5-93f5-004938619216): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:18:50.724] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 65);
[2016-10-19 20:18:50.736] [INFO] console - Executing (00bf788c-13ac-49e5-93f5-004938619216): COMMIT;
[2016-10-19 20:18:50.740] [INFO] console - [ 70,
  422,
  {},
  [ { fullName: 'temp temp',
      fullPath: '/4/64/65/',
      id: '65',
      email: null,
      name: 'temp',
      surname: 'temp',
      patronymic: 'temp',
      voiskoSize: 0,
      birth: 1900,
      path: '/4/64/',
      note: null,
      created_at: Wed Oct 19 2016 20:18:50 GMT+0500 (YEKT),
      updated_at: Wed Oct 19 2016 20:18:50 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: '64',
      attachments: [] } ] ]
[2016-10-19 20:18:50.763] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 64 }
[2016-10-19 20:18:50.773] [INFO] console - Executing (b3a030c6-5a37-4919-a0fb-faf985f479dd): START TRANSACTION;
[2016-10-19 20:18:50.791] [INFO] console - Executing (b3a030c6-5a37-4919-a0fb-faf985f479dd): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:18:50.824] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 64);
[2016-10-19 20:18:50.840] [INFO] console - Executing (b3a030c6-5a37-4919-a0fb-faf985f479dd): COMMIT;
[2016-10-19 20:18:50.846] [INFO] console - [ 70,
  423,
  {},
  [ { fullName: 'temp temp',
      fullPath: '/4/64/',
      id: '64',
      email: null,
      name: 'temp',
      surname: 'temp',
      patronymic: 'temp',
      voiskoSize: 1,
      birth: 1900,
      path: '/4/',
      note: null,
      created_at: Wed Oct 19 2016 20:18:49 GMT+0500 (YEKT),
      updated_at: Wed Oct 19 2016 20:18:50 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: '4',
      attachments: [] } ] ]
[2016-10-19 20:18:50.913] [INFO] console - Executing (03722223-6240-4916-a6d1-bbdbaa722b4f): START TRANSACTION;
[2016-10-19 20:18:50.921] [INFO] console - Executing (419f068b-0f47-4016-a618-cd108d9aa325): START TRANSACTION;
[2016-10-19 20:18:50.932] [INFO] console - Executing (03722223-6240-4916-a6d1-bbdbaa722b4f): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:18:50.935] [INFO] console - Executing (419f068b-0f47-4016-a618-cd108d9aa325): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:18:50.953] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 64);
[2016-10-19 20:18:50.955] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 64);
[2016-10-19 20:18:50.972] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/4/' like k.path||k.id||'/%'
[2016-10-19 20:18:50.973] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/4/' like k.path||k.id||'/%'
[2016-10-19 20:18:50.989] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('4')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:18:51.010] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('4')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:18:51.018] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-2
                                where
                                    '/4/' like path||id||'/%'
[2016-10-19 20:18:51.021] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-2
                                where
                                    '/4/' like path||id||'/%'
[2016-10-19 20:18:51.035] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"=NULL,"updated_at"='2016-10-19 15:18:51.024 +00:00' WHERE "id" = '64'
[2016-10-19 20:18:51.046] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"=NULL,"updated_at"='2016-10-19 15:18:51.036 +00:00' WHERE "id" = '64'
[2016-10-19 20:18:51.057] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/4/', '/')
                                where
                                    id = '64'
                                    or path like '/4/64/'||'%'
[2016-10-19 20:18:51.066] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/4/', '/')
                                where
                                    id = '64'
                                    or path like '/4/64/'||'%'
[2016-10-19 20:18:51.075] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+2
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:18:51.085] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 20:18:51.101] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+2
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:18:51.111] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:18:51.118] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/64/'||'%'
[2016-10-19 20:18:51.120] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 20:18:51.127] [INFO] console - Executing (03722223-6240-4916-a6d1-bbdbaa722b4f): COMMIT;
[2016-10-19 20:18:51.134] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:18:51.139] [INFO] console - [ 70, 424, {}, [ undefined ] ]
[2016-10-19 20:18:51.143] [INFO] console - [ 16,
  8123428303273984,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id4.druzhinaChange',
  [],
  { action: 'remove', KOPNIK: 64 } ]
[2016-10-19 20:18:51.150] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/64/'||'%'
[2016-10-19 20:18:51.153] [INFO] console - [ 16,
  2523237426659328,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id4.voiskoChange',
  [],
  { voiskoSize: 0 } ]
[2016-10-19 20:18:51.160] [INFO] console - Executing (419f068b-0f47-4016-a618-cd108d9aa325): COMMIT;
[2016-10-19 20:18:51.163] [INFO] console - [ 16,
  6916796110077952,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id65.starshinaChange',
  [],
  {} ]
[2016-10-19 20:18:51.169] [INFO] console - [ 70, 425, {}, [ undefined ] ]
[2016-10-19 20:18:51.175] [INFO] console - [ 16,
  8349321533587456,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id4.druzhinaChange',
  [],
  { action: 'remove', KOPNIK: 64 } ]
[2016-10-19 20:18:51.184] [INFO] console - [ 16,
  6950119935049728,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id4.voiskoChange',
  [],
  { voiskoSize: 0 } ]
[2016-10-19 20:18:51.192] [INFO] console - [ 16,
  5468416123076608,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id65.starshinaChange',
  [],
  {} ]
[2016-10-19 20:19:20.258] [INFO] console - [ 70, 427, {}, [ undefined ] ]
[2016-10-19 20:19:20.287] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 2 }
[2016-10-19 20:19:20.357] [INFO] console - Executing (default): delete from "Kopnik"
                where
                    name like '%temp'
                    or name like 'temp%'
[2016-10-19 20:19:20.374] [INFO] console - Executing (86b0d25b-871a-4744-8474-cdb0729cc20d): START TRANSACTION;
[2016-10-19 20:19:20.383] [INFO] console - Executing (86b0d25b-871a-4744-8474-cdb0729cc20d): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:19:20.395] [INFO] console - Executing (default): update "Kopnik"
                set 
                    "voiskoSize"= case when id=2 then 1 ELSE 0 END
                where
                    id>1 
                    and id<=5
[2016-10-19 20:19:20.434] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 20:19:20.478] [INFO] console - Executing (86b0d25b-871a-4744-8474-cdb0729cc20d): COMMIT;
[2016-10-19 20:19:20.487] [INFO] console - [ 70,
  428,
  {},
  [ { fullName: 'Unit Test',
      fullPath: '/2/',
      id: '2',
      email: 'unittest2@domain.ru',
      name: 'Unit',
      surname: 'Test',
      patronymic: '1',
      voiskoSize: 1,
      birth: 1983,
      path: '/',
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: null,
      attachments: [] } ] ]
[2016-10-19 20:19:20.582] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."starshina_id" = 2) ORDER BY "Kopnik"."surname" asc, "Kopnik"."name" asc, "Kopnik"."patronymic" asc;
[2016-10-19 20:19:20.609] [INFO] console - [ 70, 429, {}, [ [ [Object], [Object] ] ] ]
[2016-10-19 20:19:20.664] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 20:19:20.680] [INFO] console - Executing (a345e084-1a97-411f-b374-77072f33b2cc): START TRANSACTION;
[2016-10-19 20:19:20.684] [INFO] console - Executing (a345e084-1a97-411f-b374-77072f33b2cc): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:19:20.709] [INFO] console - Executing (a345e084-1a97-411f-b374-77072f33b2cc): INSERT INTO "Kopnik" ("id","name","surname","patronymic","voiskoSize","birth","path","created_at","updated_at","dom_id","starshina_id") VALUES (DEFAULT,'temp','temp','temp',0,1900,'/','2016-10-19 15:19:20.690 +00:00','2016-10-19 15:19:20.690 +00:00',2,NULL) RETURNING *;
[2016-10-19 20:19:20.726] [INFO] console - Executing (a345e084-1a97-411f-b374-77072f33b2cc): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:19:20.745] [INFO] console - Executing (a345e084-1a97-411f-b374-77072f33b2cc): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:19:20.764] [INFO] console - Executing (a345e084-1a97-411f-b374-77072f33b2cc): update "Zemla"
                                    set "obshinaSize"= "obshinaSize"+ 1
                                where
                                    '/1/' like path||id||'/%'
                                    or (
                                        true 
                                        and id= 2
                                    )
[2016-10-19 20:19:20.784] [INFO] console - Executing (a345e084-1a97-411f-b374-77072f33b2cc): COMMIT;
[2016-10-19 20:19:20.788] [INFO] console - [ 70, 430, {}, [ '66' ] ]
[2016-10-19 20:19:20.810] [INFO] console - Executing (fa8f4579-aebc-4691-8411-56936dee1676): START TRANSACTION;
[2016-10-19 20:19:20.816] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:19:20.825] [INFO] console - Executing (fa8f4579-aebc-4691-8411-56936dee1676): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:19:20.831] [INFO] console - Executing (default): select z.*
                                    from "Zemla" as z
                                where
                                    '/1/' like z.path||z.id||'/%'
[2016-10-19 20:19:20.845] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 66);
[2016-10-19 20:19:20.863] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" IN ('1')) ORDER BY "Zemla"."path" desc;
[2016-10-19 20:19:20.881] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 20:19:20.883] [INFO] console - [ 16,
  1519418339229696,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id2.obshinaChange',
  [],
  { obshinaSize: 64 } ]
[2016-10-19 20:19:20.895] [INFO] console - [ 16,
  1179921305042944,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id1.obshinaChange',
  [],
  { obshinaSize: 66 } ]
[2016-10-19 20:19:20.910] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 20:19:20.925] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:19:20.934] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:19:20.951] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='2',"updated_at"='2016-10-19 15:19:20.937 +00:00' WHERE "id" = '66'
[2016-10-19 20:19:20.958] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/', '/2/')
                                where
                                    id = '66'
                                    or path like '/66/'||'%'
[2016-10-19 20:19:20.966] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 20:19:20.970] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 20:19:20.985] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:19:20.993] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/2/66/'||'%'
[2016-10-19 20:19:20.999] [INFO] console - Executing (fa8f4579-aebc-4691-8411-56936dee1676): COMMIT;
[2016-10-19 20:19:21.004] [INFO] console - [ 70, 431, {}, [ undefined ] ]
[2016-10-19 20:19:21.019] [INFO] console - [ 16,
  4295049915400192,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.druzhinaChange',
  [],
  { action: 'add',
    kopnik: 
     { fullName: 'temp temp',
       fullPath: '/2/66/',
       id: '66',
       email: null,
       password: null,
       name: 'temp',
       surname: 'temp',
       patronymic: 'temp',
       voiskoSize: 0,
       birth: 1900,
       path: '/2/',
       note: null,
       created_at: Wed Oct 19 2016 20:19:20 GMT+0500 (YEKT),
       updated_at: Wed Oct 19 2016 20:19:20 GMT+0500 (YEKT),
       deleted_at: null,
       dom_id: '2',
       starshina_id: '2' } } ]
[2016-10-19 20:19:21.048] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 20:19:21.051] [INFO] console - [ 16,
  8638631841366016,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 2 } ]
[2016-10-19 20:19:21.072] [INFO] console - Executing (29ae22b1-f713-4a63-a58b-d5cb365f32fb): START TRANSACTION;
[2016-10-19 20:19:21.076] [INFO] console - Executing (29ae22b1-f713-4a63-a58b-d5cb365f32fb): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:19:21.095] [INFO] console - Executing (29ae22b1-f713-4a63-a58b-d5cb365f32fb): INSERT INTO "Kopnik" ("id","name","surname","patronymic","voiskoSize","birth","path","created_at","updated_at","dom_id","starshina_id") VALUES (DEFAULT,'temp','temp','temp',0,1900,'/','2016-10-19 15:19:21.081 +00:00','2016-10-19 15:19:21.081 +00:00',2,NULL) RETURNING *;
[2016-10-19 20:19:21.120] [INFO] console - Executing (29ae22b1-f713-4a63-a58b-d5cb365f32fb): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:19:21.139] [INFO] console - Executing (29ae22b1-f713-4a63-a58b-d5cb365f32fb): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:19:21.150] [INFO] console - Executing (29ae22b1-f713-4a63-a58b-d5cb365f32fb): update "Zemla"
                                    set "obshinaSize"= "obshinaSize"+ 1
                                where
                                    '/1/' like path||id||'/%'
                                    or (
                                        true 
                                        and id= 2
                                    )
[2016-10-19 20:19:21.162] [INFO] console - Executing (29ae22b1-f713-4a63-a58b-d5cb365f32fb): COMMIT;
[2016-10-19 20:19:21.165] [INFO] console - [ 70, 432, {}, [ '67' ] ]
[2016-10-19 20:19:21.214] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:19:21.232] [INFO] console - Executing (8d559b31-f726-4e14-8c28-d623b53b692d): START TRANSACTION;
[2016-10-19 20:19:21.239] [INFO] console - Executing (default): select z.*
                                    from "Zemla" as z
                                where
                                    '/1/' like z.path||z.id||'/%'
[2016-10-19 20:19:21.241] [INFO] console - Executing (8d559b31-f726-4e14-8c28-d623b53b692d): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:19:21.265] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" IN ('1')) ORDER BY "Zemla"."path" desc;
[2016-10-19 20:19:21.288] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 67);
[2016-10-19 20:19:21.290] [INFO] console - [ 16,
  905221597298688,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id2.obshinaChange',
  [],
  { obshinaSize: 65 } ]
[2016-10-19 20:19:21.307] [INFO] console - [ 16,
  7007545415696384,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id1.obshinaChange',
  [],
  { obshinaSize: 67 } ]
[2016-10-19 20:19:21.330] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 66);
[2016-10-19 20:19:21.342] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 20:19:21.367] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:19:21.378] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:19:21.402] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='66',"updated_at"='2016-10-19 15:19:21.386 +00:00' WHERE "id" = '67'
[2016-10-19 20:19:21.408] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/', '/2/66/')
                                where
                                    id = '67'
                                    or path like '/67/'||'%'
[2016-10-19 20:19:21.413] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/2/66/' like path||id||'/%'
[2016-10-19 20:19:21.419] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/66/' like k.path||k.id||'/%'
[2016-10-19 20:19:21.434] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('66', '2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:19:21.442] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/2/66/67/'||'%'
[2016-10-19 20:19:21.450] [INFO] console - Executing (8d559b31-f726-4e14-8c28-d623b53b692d): COMMIT;
[2016-10-19 20:19:21.454] [INFO] console - [ 70, 433, {}, [ undefined ] ]
[2016-10-19 20:19:21.464] [INFO] console - [ 16,
  3842613192949760,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id66.druzhinaChange',
  [],
  { action: 'add',
    kopnik: 
     { fullName: 'temp temp',
       fullPath: '/2/66/67/',
       id: '67',
       email: null,
       password: null,
       name: 'temp',
       surname: 'temp',
       patronymic: 'temp',
       voiskoSize: 0,
       birth: 1900,
       path: '/2/66/',
       note: null,
       created_at: Wed Oct 19 2016 20:19:21 GMT+0500 (YEKT),
       updated_at: Wed Oct 19 2016 20:19:21 GMT+0500 (YEKT),
       deleted_at: null,
       dom_id: '2',
       starshina_id: '66' } } ]
[2016-10-19 20:19:21.478] [INFO] console - [ 16,
  7997339373404160,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id66.voiskoChange',
  [],
  { voiskoSize: 1 } ]
[2016-10-19 20:19:21.488] [INFO] console - [ 16,
  3755897832603648,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 3 } ]
[2016-10-19 20:19:21.502] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 4 }
[2016-10-19 20:19:21.507] [INFO] console - Executing (a0a957a6-146f-4d8a-b266-ee0ddea862d2): START TRANSACTION;
[2016-10-19 20:19:21.519] [INFO] console - Executing (a0a957a6-146f-4d8a-b266-ee0ddea862d2): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:19:21.539] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 4);
[2016-10-19 20:19:21.555] [INFO] console - Executing (a0a957a6-146f-4d8a-b266-ee0ddea862d2): COMMIT;
[2016-10-19 20:19:21.560] [INFO] console - [ 70,
  434,
  {},
  [ { fullName: 'Unit Test',
      fullPath: '/4/',
      id: '4',
      email: 'unittest4@domain.ru',
      name: 'Unit',
      surname: 'Test',
      patronymic: '4',
      voiskoSize: 0,
      birth: 1983,
      path: '/',
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: null,
      attachments: [] } ] ]
[2016-10-19 20:19:21.582] [INFO] console - Executing (761ccf92-7cef-48df-8491-c71d85c79397): START TRANSACTION;
[2016-10-19 20:19:21.586] [INFO] console - Executing (761ccf92-7cef-48df-8491-c71d85c79397): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:19:21.593] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 66);
[2016-10-19 20:19:21.607] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 4);
[2016-10-19 20:19:21.618] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 20:19:21.635] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:19:21.643] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-2
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 20:19:21.660] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='4',"updated_at"='2016-10-19 15:19:21.649 +00:00' WHERE "id" = '66'
[2016-10-19 20:19:21.666] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/2/', '/4/')
                                where
                                    id = '66'
                                    or path like '/2/66/'||'%'
[2016-10-19 20:19:21.671] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+2
                                where
                                    '/4/' like path||id||'/%'
[2016-10-19 20:19:21.676] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/4/' like k.path||k.id||'/%'
[2016-10-19 20:19:21.689] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('4')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:19:21.695] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/4/66/'||'%'
[2016-10-19 20:19:21.701] [INFO] console - Executing (761ccf92-7cef-48df-8491-c71d85c79397): COMMIT;
[2016-10-19 20:19:21.705] [INFO] console - [ 70, 435, {}, [ undefined ] ]
[2016-10-19 20:19:21.710] [INFO] console - [ 16,
  5138467474374656,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.druzhinaChange',
  [],
  { action: 'remove', KOPNIK: 66 } ]
[2016-10-19 20:19:21.730] [INFO] console - [ 16,
  6071753178611712,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id4.druzhinaChange',
  [],
  { action: 'add',
    kopnik: 
     { fullName: 'temp temp',
       fullPath: '/4/66/',
       id: '66',
       email: null,
       password: null,
       name: 'temp',
       surname: 'temp',
       patronymic: 'temp',
       voiskoSize: 1,
       birth: 1900,
       path: '/4/',
       note: null,
       created_at: Wed Oct 19 2016 20:19:20 GMT+0500 (YEKT),
       updated_at: Wed Oct 19 2016 20:19:21 GMT+0500 (YEKT),
       deleted_at: null,
       dom_id: '2',
       starshina_id: '4' } } ]
[2016-10-19 20:19:21.746] [INFO] console - [ 16,
  1071426138275840,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 1 } ]
[2016-10-19 20:19:21.755] [INFO] console - [ 16,
  7560198075973632,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id4.voiskoChange',
  [],
  { voiskoSize: 2 } ]
[2016-10-19 20:19:21.769] [INFO] console - [ 16,
  5267397388795904,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id67.starshinaChange',
  [],
  {} ]
[2016-10-19 20:19:21.782] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 67 }
[2016-10-19 20:19:21.787] [INFO] console - Executing (3cce5f82-0659-4ed8-b6ce-fc4ada33baef): START TRANSACTION;
[2016-10-19 20:19:21.790] [INFO] console - Executing (3cce5f82-0659-4ed8-b6ce-fc4ada33baef): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:19:21.805] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 67);
[2016-10-19 20:19:21.820] [INFO] console - Executing (3cce5f82-0659-4ed8-b6ce-fc4ada33baef): COMMIT;
[2016-10-19 20:19:21.824] [INFO] console - [ 70,
  436,
  {},
  [ { fullName: 'temp temp',
      fullPath: '/4/66/67/',
      id: '67',
      email: null,
      name: 'temp',
      surname: 'temp',
      patronymic: 'temp',
      voiskoSize: 0,
      birth: 1900,
      path: '/4/66/',
      note: null,
      created_at: Wed Oct 19 2016 20:19:21 GMT+0500 (YEKT),
      updated_at: Wed Oct 19 2016 20:19:21 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: '66',
      attachments: [] } ] ]
[2016-10-19 20:19:21.843] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 66 }
[2016-10-19 20:19:21.850] [INFO] console - Executing (80aa2501-d297-47aa-882d-e4bbebcd5872): START TRANSACTION;
[2016-10-19 20:19:21.853] [INFO] console - Executing (80aa2501-d297-47aa-882d-e4bbebcd5872): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:19:21.867] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 66);
[2016-10-19 20:19:21.876] [INFO] console - Executing (80aa2501-d297-47aa-882d-e4bbebcd5872): COMMIT;
[2016-10-19 20:19:21.879] [INFO] console - [ 70,
  437,
  {},
  [ { fullName: 'temp temp',
      fullPath: '/4/66/',
      id: '66',
      email: null,
      name: 'temp',
      surname: 'temp',
      patronymic: 'temp',
      voiskoSize: 1,
      birth: 1900,
      path: '/4/',
      note: null,
      created_at: Wed Oct 19 2016 20:19:20 GMT+0500 (YEKT),
      updated_at: Wed Oct 19 2016 20:19:21 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: '4',
      attachments: [] } ] ]
[2016-10-19 20:19:21.906] [INFO] console - Executing (ec0ec07f-7cff-4a06-b525-6399311f6ba4): START TRANSACTION;
[2016-10-19 20:19:21.915] [INFO] console - Executing (ec0ec07f-7cff-4a06-b525-6399311f6ba4): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:19:21.924] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 66);
[2016-10-19 20:19:21.930] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/4/' like k.path||k.id||'/%'
[2016-10-19 20:19:21.942] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('4')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:19:21.952] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-2
                                where
                                    '/4/' like path||id||'/%'
[2016-10-19 20:19:21.966] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"=NULL,"updated_at"='2016-10-19 15:19:21.955 +00:00' WHERE "id" = '66'
[2016-10-19 20:19:21.970] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/4/', '/')
                                where
                                    id = '66'
                                    or path like '/4/66/'||'%'
[2016-10-19 20:19:21.977] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+2
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:19:21.981] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 20:19:21.991] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:19:22.011] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/66/'||'%'
[2016-10-19 20:19:22.018] [INFO] console - Executing (ec0ec07f-7cff-4a06-b525-6399311f6ba4): COMMIT;
[2016-10-19 20:19:22.025] [INFO] console - [ 70, 438, {}, [ undefined ] ]
[2016-10-19 20:19:22.031] [INFO] console - [ 16,
  2408263805042688,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id4.druzhinaChange',
  [],
  { action: 'remove', KOPNIK: 66 } ]
[2016-10-19 20:19:22.040] [INFO] console - [ 16,
  853309707517952,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id4.voiskoChange',
  [],
  { voiskoSize: 0 } ]
[2016-10-19 20:19:22.049] [INFO] console - [ 16,
  8854057951166464,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id67.starshinaChange',
  [],
  {} ]
[2016-10-19 20:20:14.592] [INFO] console - [ 70, 440, {}, [ undefined ] ]
[2016-10-19 20:20:14.642] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 2 }
[2016-10-19 20:20:14.696] [INFO] console - Executing (default): delete from "Kopnik"
                where
                    name like '%temp'
                    or name like 'temp%'
[2016-10-19 20:20:14.701] [INFO] console - Executing (3c6d56d3-1111-4398-b381-7e4f235ab127): START TRANSACTION;
[2016-10-19 20:20:14.705] [INFO] console - Executing (3c6d56d3-1111-4398-b381-7e4f235ab127): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:20:14.729] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 20:20:14.749] [INFO] console - Executing (default): update "Kopnik"
                set 
                    "voiskoSize"= case when id=2 then 1 ELSE 0 END
                where
                    id>1 
                    and id<=5
[2016-10-19 20:20:14.760] [INFO] console - Executing (3c6d56d3-1111-4398-b381-7e4f235ab127): COMMIT;
[2016-10-19 20:20:14.765] [INFO] console - [ 70,
  441,
  {},
  [ { fullName: 'Unit Test',
      fullPath: '/2/',
      id: '2',
      email: 'unittest2@domain.ru',
      name: 'Unit',
      surname: 'Test',
      patronymic: '1',
      voiskoSize: 1,
      birth: 1983,
      path: '/',
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: null,
      attachments: [] } ] ]
[2016-10-19 20:20:14.849] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."starshina_id" = 2) ORDER BY "Kopnik"."surname" asc, "Kopnik"."name" asc, "Kopnik"."patronymic" asc;
[2016-10-19 20:20:14.873] [INFO] console - [ 70, 442, {}, [ [ [Object], [Object] ] ] ]
[2016-10-19 20:20:14.921] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 20:20:14.934] [INFO] console - Executing (66327583-c16f-41e3-91dc-2a758c258e9b): START TRANSACTION;
[2016-10-19 20:20:14.940] [INFO] console - Executing (66327583-c16f-41e3-91dc-2a758c258e9b): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:20:14.978] [INFO] console - Executing (66327583-c16f-41e3-91dc-2a758c258e9b): INSERT INTO "Kopnik" ("id","name","surname","patronymic","voiskoSize","birth","path","created_at","updated_at","dom_id","starshina_id") VALUES (DEFAULT,'temp','temp','temp',0,1900,'/','2016-10-19 15:20:14.947 +00:00','2016-10-19 15:20:14.947 +00:00',2,NULL) RETURNING *;
[2016-10-19 20:20:14.990] [INFO] console - Executing (66327583-c16f-41e3-91dc-2a758c258e9b): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:20:15.006] [INFO] console - Executing (66327583-c16f-41e3-91dc-2a758c258e9b): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:20:15.018] [INFO] console - Executing (66327583-c16f-41e3-91dc-2a758c258e9b): update "Zemla"
                                    set "obshinaSize"= "obshinaSize"+ 1
                                where
                                    '/1/' like path||id||'/%'
                                    or (
                                        true 
                                        and id= 2
                                    )
[2016-10-19 20:20:15.027] [INFO] console - Executing (66327583-c16f-41e3-91dc-2a758c258e9b): COMMIT;
[2016-10-19 20:20:15.032] [INFO] console - [ 70, 443, {}, [ '68' ] ]
[2016-10-19 20:20:15.052] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:20:15.069] [INFO] console - Executing (c6d68786-b005-4b61-b77b-fe2a5133121e): START TRANSACTION;
[2016-10-19 20:20:15.075] [INFO] console - Executing (default): select z.*
                                    from "Zemla" as z
                                where
                                    '/1/' like z.path||z.id||'/%'
[2016-10-19 20:20:15.078] [INFO] console - Executing (c6d68786-b005-4b61-b77b-fe2a5133121e): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:20:15.104] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" IN ('1')) ORDER BY "Zemla"."path" desc;
[2016-10-19 20:20:15.108] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 68);
[2016-10-19 20:20:15.119] [INFO] console - [ 16,
  6148476941369344,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id2.obshinaChange',
  [],
  { obshinaSize: 66 } ]
[2016-10-19 20:20:15.134] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 20:20:15.136] [INFO] console - [ 16,
  2757506673672192,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id1.obshinaChange',
  [],
  { obshinaSize: 68 } ]
[2016-10-19 20:20:15.150] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 20:20:15.170] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:20:15.177] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:20:15.192] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='2',"updated_at"='2016-10-19 15:20:15.180 +00:00' WHERE "id" = '68'
[2016-10-19 20:20:15.198] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/', '/2/')
                                where
                                    id = '68'
                                    or path like '/68/'||'%'
[2016-10-19 20:20:15.205] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 20:20:15.213] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 20:20:15.225] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:20:15.232] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/2/68/'||'%'
[2016-10-19 20:20:15.237] [INFO] console - Executing (c6d68786-b005-4b61-b77b-fe2a5133121e): COMMIT;
[2016-10-19 20:20:15.241] [INFO] console - [ 70, 444, {}, [ undefined ] ]
[2016-10-19 20:20:15.249] [INFO] console - [ 16,
  1707028732968960,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.druzhinaChange',
  [],
  { action: 'add',
    kopnik: 
     { fullName: 'temp temp',
       fullPath: '/2/68/',
       id: '68',
       email: null,
       password: null,
       name: 'temp',
       surname: 'temp',
       patronymic: 'temp',
       voiskoSize: 0,
       birth: 1900,
       path: '/2/',
       note: null,
       created_at: Wed Oct 19 2016 20:20:14 GMT+0500 (YEKT),
       updated_at: Wed Oct 19 2016 20:20:15 GMT+0500 (YEKT),
       deleted_at: null,
       dom_id: '2',
       starshina_id: '2' } } ]
[2016-10-19 20:20:15.276] [INFO] console - [ 16,
  6387794886787072,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 2 } ]
[2016-10-19 20:20:15.289] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 20:20:15.297] [INFO] console - Executing (d70e0da4-a05b-466a-ba89-80b854c4a4c6): START TRANSACTION;
[2016-10-19 20:20:15.300] [INFO] console - Executing (d70e0da4-a05b-466a-ba89-80b854c4a4c6): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:20:15.316] [INFO] console - Executing (d70e0da4-a05b-466a-ba89-80b854c4a4c6): INSERT INTO "Kopnik" ("id","name","surname","patronymic","voiskoSize","birth","path","created_at","updated_at","dom_id","starshina_id") VALUES (DEFAULT,'temp','temp','temp',0,1900,'/','2016-10-19 15:20:15.303 +00:00','2016-10-19 15:20:15.303 +00:00',2,NULL) RETURNING *;
[2016-10-19 20:20:15.322] [INFO] console - Executing (d70e0da4-a05b-466a-ba89-80b854c4a4c6): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:20:15.330] [INFO] console - Executing (d70e0da4-a05b-466a-ba89-80b854c4a4c6): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:20:15.336] [INFO] console - Executing (d70e0da4-a05b-466a-ba89-80b854c4a4c6): update "Zemla"
                                    set "obshinaSize"= "obshinaSize"+ 1
                                where
                                    '/1/' like path||id||'/%'
                                    or (
                                        true 
                                        and id= 2
                                    )
[2016-10-19 20:20:15.340] [INFO] console - Executing (d70e0da4-a05b-466a-ba89-80b854c4a4c6): COMMIT;
[2016-10-19 20:20:15.345] [INFO] console - [ 70, 445, {}, [ '69' ] ]
[2016-10-19 20:20:15.367] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:20:15.376] [INFO] console - Executing (ad943760-72d9-4dba-886a-c7b43577c577): START TRANSACTION;
[2016-10-19 20:20:15.380] [INFO] console - Executing (default): select z.*
                                    from "Zemla" as z
                                where
                                    '/1/' like z.path||z.id||'/%'
[2016-10-19 20:20:15.382] [INFO] console - Executing (ad943760-72d9-4dba-886a-c7b43577c577): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:20:15.404] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" IN ('1')) ORDER BY "Zemla"."path" desc;
[2016-10-19 20:20:15.406] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 69);
[2016-10-19 20:20:15.416] [INFO] console - [ 16,
  8963927314530304,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id2.obshinaChange',
  [],
  { obshinaSize: 67 } ]
[2016-10-19 20:20:15.424] [INFO] console - [ 16,
  7625627196719104,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id1.obshinaChange',
  [],
  { obshinaSize: 69 } ]
[2016-10-19 20:20:15.435] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 68);
[2016-10-19 20:20:15.444] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 20:20:15.453] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:20:15.459] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:20:15.479] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='68',"updated_at"='2016-10-19 15:20:15.463 +00:00' WHERE "id" = '69'
[2016-10-19 20:20:15.484] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/', '/2/68/')
                                where
                                    id = '69'
                                    or path like '/69/'||'%'
[2016-10-19 20:20:15.491] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/2/68/' like path||id||'/%'
[2016-10-19 20:20:15.498] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/68/' like k.path||k.id||'/%'
[2016-10-19 20:20:15.511] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('68', '2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:20:15.518] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/2/68/69/'||'%'
[2016-10-19 20:20:15.524] [INFO] console - Executing (ad943760-72d9-4dba-886a-c7b43577c577): COMMIT;
[2016-10-19 20:20:15.527] [INFO] console - [ 70, 446, {}, [ undefined ] ]
[2016-10-19 20:20:15.534] [INFO] console - [ 16,
  5804692279918592,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id68.druzhinaChange',
  [],
  { action: 'add',
    kopnik: 
     { fullName: 'temp temp',
       fullPath: '/2/68/69/',
       id: '69',
       email: null,
       password: null,
       name: 'temp',
       surname: 'temp',
       patronymic: 'temp',
       voiskoSize: 0,
       birth: 1900,
       path: '/2/68/',
       note: null,
       created_at: Wed Oct 19 2016 20:20:15 GMT+0500 (YEKT),
       updated_at: Wed Oct 19 2016 20:20:15 GMT+0500 (YEKT),
       deleted_at: null,
       dom_id: '2',
       starshina_id: '68' } } ]
[2016-10-19 20:20:15.552] [INFO] console - [ 16,
  5144344151457792,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id68.voiskoChange',
  [],
  { voiskoSize: 1 } ]
[2016-10-19 20:20:15.561] [INFO] console - [ 16,
  3864861656219648,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 3 } ]
[2016-10-19 20:20:15.579] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 4 }
[2016-10-19 20:20:15.589] [INFO] console - Executing (761caad8-91d7-41f4-9bbb-8b011524c5b5): START TRANSACTION;
[2016-10-19 20:20:15.600] [INFO] console - Executing (761caad8-91d7-41f4-9bbb-8b011524c5b5): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:20:15.619] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 4);
[2016-10-19 20:20:15.630] [INFO] console - Executing (761caad8-91d7-41f4-9bbb-8b011524c5b5): COMMIT;
[2016-10-19 20:20:15.633] [INFO] console - [ 70,
  447,
  {},
  [ { fullName: 'Unit Test',
      fullPath: '/4/',
      id: '4',
      email: 'unittest4@domain.ru',
      name: 'Unit',
      surname: 'Test',
      patronymic: '4',
      voiskoSize: 0,
      birth: 1983,
      path: '/',
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: null,
      attachments: [] } ] ]
[2016-10-19 20:20:15.664] [INFO] console - Executing (de61154f-cb6c-49b2-9493-475386b4133b): START TRANSACTION;
[2016-10-19 20:20:15.666] [INFO] console - Executing (de61154f-cb6c-49b2-9493-475386b4133b): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:20:15.678] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 68);
[2016-10-19 20:20:15.692] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 4);
[2016-10-19 20:20:15.704] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 20:20:15.714] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:20:15.723] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-2
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 20:20:15.745] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='4',"updated_at"='2016-10-19 15:20:15.730 +00:00' WHERE "id" = '68'
[2016-10-19 20:20:15.754] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/2/', '/4/')
                                where
                                    id = '68'
                                    or path like '/2/68/'||'%'
[2016-10-19 20:20:15.759] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+2
                                where
                                    '/4/' like path||id||'/%'
[2016-10-19 20:20:15.768] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/4/' like k.path||k.id||'/%'
[2016-10-19 20:20:15.781] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('4')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:20:15.788] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/4/68/'||'%'
[2016-10-19 20:20:15.793] [INFO] console - Executing (de61154f-cb6c-49b2-9493-475386b4133b): COMMIT;
[2016-10-19 20:20:15.800] [INFO] console - [ 70, 448, {}, [ undefined ] ]
[2016-10-19 20:20:15.806] [INFO] console - [ 16,
  5209646725857280,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.druzhinaChange',
  [],
  { action: 'remove', KOPNIK: 68 } ]
[2016-10-19 20:20:15.821] [INFO] console - [ 16,
  4744578563309568,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id4.druzhinaChange',
  [],
  { action: 'add',
    kopnik: 
     { fullName: 'temp temp',
       fullPath: '/4/68/',
       id: '68',
       email: null,
       password: null,
       name: 'temp',
       surname: 'temp',
       patronymic: 'temp',
       voiskoSize: 1,
       birth: 1900,
       path: '/4/',
       note: null,
       created_at: Wed Oct 19 2016 20:20:14 GMT+0500 (YEKT),
       updated_at: Wed Oct 19 2016 20:20:15 GMT+0500 (YEKT),
       deleted_at: null,
       dom_id: '2',
       starshina_id: '4' } } ]
[2016-10-19 20:20:15.836] [INFO] console - [ 16,
  3378198863675392,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 1 } ]
[2016-10-19 20:20:15.844] [INFO] console - [ 16,
  6172450352005120,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id4.voiskoChange',
  [],
  { voiskoSize: 2 } ]
[2016-10-19 20:20:15.852] [INFO] console - [ 16,
  3317864901640192,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id69.starshinaChange',
  [],
  {} ]
[2016-10-19 20:20:15.863] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 69 }
[2016-10-19 20:20:15.870] [INFO] console - Executing (7ff69d7d-1ca1-47f7-9a9d-9b373a1ade94): START TRANSACTION;
[2016-10-19 20:20:15.874] [INFO] console - Executing (7ff69d7d-1ca1-47f7-9a9d-9b373a1ade94): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:20:15.903] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 69);
[2016-10-19 20:20:15.912] [INFO] console - Executing (7ff69d7d-1ca1-47f7-9a9d-9b373a1ade94): COMMIT;
[2016-10-19 20:20:15.916] [INFO] console - [ 70,
  449,
  {},
  [ { fullName: 'temp temp',
      fullPath: '/4/68/69/',
      id: '69',
      email: null,
      name: 'temp',
      surname: 'temp',
      patronymic: 'temp',
      voiskoSize: 0,
      birth: 1900,
      path: '/4/68/',
      note: null,
      created_at: Wed Oct 19 2016 20:20:15 GMT+0500 (YEKT),
      updated_at: Wed Oct 19 2016 20:20:15 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: '68',
      attachments: [] } ] ]
[2016-10-19 20:20:15.932] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 68 }
[2016-10-19 20:20:15.937] [INFO] console - Executing (56011f8f-48ef-499a-974f-c91572227ec3): START TRANSACTION;
[2016-10-19 20:20:15.941] [INFO] console - Executing (56011f8f-48ef-499a-974f-c91572227ec3): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:20:15.955] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 68);
[2016-10-19 20:20:15.964] [INFO] console - Executing (56011f8f-48ef-499a-974f-c91572227ec3): COMMIT;
[2016-10-19 20:20:15.967] [INFO] console - [ 70,
  450,
  {},
  [ { fullName: 'temp temp',
      fullPath: '/4/68/',
      id: '68',
      email: null,
      name: 'temp',
      surname: 'temp',
      patronymic: 'temp',
      voiskoSize: 1,
      birth: 1900,
      path: '/4/',
      note: null,
      created_at: Wed Oct 19 2016 20:20:14 GMT+0500 (YEKT),
      updated_at: Wed Oct 19 2016 20:20:15 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: '4',
      attachments: [] } ] ]
[2016-10-19 20:20:15.985] [INFO] console - Executing (92598c4b-cdf3-45c7-93f9-21249381b2d7): START TRANSACTION;
[2016-10-19 20:20:16.003] [INFO] console - Executing (92598c4b-cdf3-45c7-93f9-21249381b2d7): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:20:16.020] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 68);
[2016-10-19 20:20:16.032] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/4/' like k.path||k.id||'/%'
[2016-10-19 20:20:16.051] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('4')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:20:16.062] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-2
                                where
                                    '/4/' like path||id||'/%'
[2016-10-19 20:20:16.077] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"=NULL,"updated_at"='2016-10-19 15:20:16.068 +00:00' WHERE "id" = '68'
[2016-10-19 20:20:16.082] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/4/', '/')
                                where
                                    id = '68'
                                    or path like '/4/68/'||'%'
[2016-10-19 20:20:16.086] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+2
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:20:16.091] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 20:20:16.101] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:20:16.106] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/68/'||'%'
[2016-10-19 20:20:16.110] [INFO] console - Executing (92598c4b-cdf3-45c7-93f9-21249381b2d7): COMMIT;
[2016-10-19 20:20:16.113] [INFO] console - [ 70, 451, {}, [ undefined ] ]
[2016-10-19 20:20:16.120] [INFO] console - [ 16,
  5398397930438656,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id4.druzhinaChange',
  [],
  { action: 'remove', KOPNIK: 68 } ]
[2016-10-19 20:20:16.133] [INFO] console - [ 16,
  8995952574595072,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id4.voiskoChange',
  [],
  { voiskoSize: 0 } ]
[2016-10-19 20:20:16.142] [INFO] console - [ 16,
  4965598840750080,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id69.starshinaChange',
  [],
  {} ]
[2016-10-19 20:20:58.891] [INFO] console - [ 70, 453, {}, [ undefined ] ]
[2016-10-19 20:20:58.909] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 2 }
[2016-10-19 20:20:58.998] [INFO] console - Executing (default): delete from "Kopnik"
                where
                    name like '%temp'
                    or name like 'temp%'
[2016-10-19 20:20:59.023] [INFO] console - Executing (0a8af447-a688-4dc1-9e0e-492ba88f3409): START TRANSACTION;
[2016-10-19 20:20:59.027] [INFO] console - Executing (0a8af447-a688-4dc1-9e0e-492ba88f3409): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:20:59.064] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 20:20:59.079] [INFO] console - Executing (default): update "Kopnik"
                set 
                    "voiskoSize"= case when id=2 then 1 ELSE 0 END
                where
                    id>1 
                    and id<=5
[2016-10-19 20:20:59.099] [INFO] console - Executing (0a8af447-a688-4dc1-9e0e-492ba88f3409): COMMIT;
[2016-10-19 20:20:59.107] [INFO] console - [ 70,
  454,
  {},
  [ { fullName: 'Unit Test',
      fullPath: '/2/',
      id: '2',
      email: 'unittest2@domain.ru',
      name: 'Unit',
      surname: 'Test',
      patronymic: '1',
      voiskoSize: 1,
      birth: 1983,
      path: '/',
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: null,
      attachments: [] } ] ]
[2016-10-19 20:20:59.173] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."starshina_id" = 2) ORDER BY "Kopnik"."surname" asc, "Kopnik"."name" asc, "Kopnik"."patronymic" asc;
[2016-10-19 20:20:59.182] [INFO] console - [ 70, 455, {}, [ [ [Object], [Object] ] ] ]
[2016-10-19 20:20:59.237] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 20:20:59.249] [INFO] console - Executing (eeeb7ee1-dbb7-477b-a380-ac2c3f454095): START TRANSACTION;
[2016-10-19 20:20:59.253] [INFO] console - Executing (eeeb7ee1-dbb7-477b-a380-ac2c3f454095): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:20:59.274] [INFO] console - Executing (eeeb7ee1-dbb7-477b-a380-ac2c3f454095): INSERT INTO "Kopnik" ("id","name","surname","patronymic","voiskoSize","birth","path","created_at","updated_at","dom_id","starshina_id") VALUES (DEFAULT,'temp','temp','temp',0,1900,'/','2016-10-19 15:20:59.261 +00:00','2016-10-19 15:20:59.261 +00:00',2,NULL) RETURNING *;
[2016-10-19 20:20:59.298] [INFO] console - Executing (eeeb7ee1-dbb7-477b-a380-ac2c3f454095): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:20:59.313] [INFO] console - Executing (eeeb7ee1-dbb7-477b-a380-ac2c3f454095): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:20:59.323] [INFO] console - Executing (eeeb7ee1-dbb7-477b-a380-ac2c3f454095): update "Zemla"
                                    set "obshinaSize"= "obshinaSize"+ 1
                                where
                                    '/1/' like path||id||'/%'
                                    or (
                                        true 
                                        and id= 2
                                    )
[2016-10-19 20:20:59.333] [INFO] console - Executing (eeeb7ee1-dbb7-477b-a380-ac2c3f454095): COMMIT;
[2016-10-19 20:20:59.338] [INFO] console - [ 70, 456, {}, [ '70' ] ]
[2016-10-19 20:20:59.365] [INFO] console - Executing (7df31b04-82a2-4e1c-9e79-2850b81164ee): START TRANSACTION;
[2016-10-19 20:20:59.370] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:20:59.375] [INFO] console - Executing (7df31b04-82a2-4e1c-9e79-2850b81164ee): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:20:59.385] [INFO] console - Executing (default): select z.*
                                    from "Zemla" as z
                                where
                                    '/1/' like z.path||z.id||'/%'
[2016-10-19 20:20:59.399] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 70);
[2016-10-19 20:20:59.411] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" IN ('1')) ORDER BY "Zemla"."path" desc;
[2016-10-19 20:20:59.422] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 20:20:59.423] [INFO] console - [ 16,
  113129549725696,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id2.obshinaChange',
  [],
  { obshinaSize: 68 } ]
[2016-10-19 20:20:59.434] [INFO] console - [ 16,
  6078505802530816,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id1.obshinaChange',
  [],
  { obshinaSize: 70 } ]
[2016-10-19 20:20:59.446] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 20:20:59.457] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:20:59.463] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:20:59.478] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='2',"updated_at"='2016-10-19 15:20:59.466 +00:00' WHERE "id" = '70'
[2016-10-19 20:20:59.486] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/', '/2/')
                                where
                                    id = '70'
                                    or path like '/70/'||'%'
[2016-10-19 20:20:59.490] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 20:20:59.495] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 20:20:59.507] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:20:59.513] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/2/70/'||'%'
[2016-10-19 20:20:59.518] [INFO] console - Executing (7df31b04-82a2-4e1c-9e79-2850b81164ee): COMMIT;
[2016-10-19 20:20:59.524] [INFO] console - [ 70, 457, {}, [ undefined ] ]
[2016-10-19 20:20:59.537] [INFO] console - [ 16,
  8186647476699136,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.druzhinaChange',
  [],
  { action: 'add',
    kopnik: 
     { fullName: 'temp temp',
       fullPath: '/2/70/',
       id: '70',
       email: null,
       password: null,
       name: 'temp',
       surname: 'temp',
       patronymic: 'temp',
       voiskoSize: 0,
       birth: 1900,
       path: '/2/',
       note: null,
       created_at: Wed Oct 19 2016 20:20:59 GMT+0500 (YEKT),
       updated_at: Wed Oct 19 2016 20:20:59 GMT+0500 (YEKT),
       deleted_at: null,
       dom_id: '2',
       starshina_id: '2' } } ]
[2016-10-19 20:20:59.566] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 20:20:59.568] [INFO] console - [ 16,
  2872849618436096,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 2 } ]
[2016-10-19 20:20:59.605] [INFO] console - Executing (bc21cb25-ca0b-47bc-88d4-a9a94a8707b2): START TRANSACTION;
[2016-10-19 20:20:59.612] [INFO] console - Executing (bc21cb25-ca0b-47bc-88d4-a9a94a8707b2): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:20:59.625] [INFO] console - Executing (bc21cb25-ca0b-47bc-88d4-a9a94a8707b2): INSERT INTO "Kopnik" ("id","name","surname","patronymic","voiskoSize","birth","path","created_at","updated_at","dom_id","starshina_id") VALUES (DEFAULT,'temp','temp','temp',0,1900,'/','2016-10-19 15:20:59.615 +00:00','2016-10-19 15:20:59.615 +00:00',2,NULL) RETURNING *;
[2016-10-19 20:20:59.637] [INFO] console - Executing (bc21cb25-ca0b-47bc-88d4-a9a94a8707b2): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:20:59.646] [INFO] console - Executing (bc21cb25-ca0b-47bc-88d4-a9a94a8707b2): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:20:59.654] [INFO] console - Executing (bc21cb25-ca0b-47bc-88d4-a9a94a8707b2): update "Zemla"
                                    set "obshinaSize"= "obshinaSize"+ 1
                                where
                                    '/1/' like path||id||'/%'
                                    or (
                                        true 
                                        and id= 2
                                    )
[2016-10-19 20:20:59.659] [INFO] console - Executing (bc21cb25-ca0b-47bc-88d4-a9a94a8707b2): COMMIT;
[2016-10-19 20:20:59.662] [INFO] console - [ 70, 458, {}, [ '71' ] ]
[2016-10-19 20:20:59.685] [INFO] console - Executing (dae89f44-fdea-451e-bb53-d9e755d15fd0): START TRANSACTION;
[2016-10-19 20:20:59.692] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:20:59.696] [INFO] console - Executing (dae89f44-fdea-451e-bb53-d9e755d15fd0): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:20:59.706] [INFO] console - Executing (default): select z.*
                                    from "Zemla" as z
                                where
                                    '/1/' like z.path||z.id||'/%'
[2016-10-19 20:20:59.714] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 71);
[2016-10-19 20:20:59.736] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" IN ('1')) ORDER BY "Zemla"."path" desc;
[2016-10-19 20:20:59.739] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 70);
[2016-10-19 20:20:59.744] [INFO] console - [ 16,
  4329214929010688,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id2.obshinaChange',
  [],
  { obshinaSize: 69 } ]
[2016-10-19 20:20:59.757] [INFO] console - [ 16,
  6452987849342976,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id1.obshinaChange',
  [],
  { obshinaSize: 71 } ]
[2016-10-19 20:20:59.779] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 20:20:59.808] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:20:59.819] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:20:59.836] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='70',"updated_at"='2016-10-19 15:20:59.823 +00:00' WHERE "id" = '71'
[2016-10-19 20:20:59.844] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/', '/2/70/')
                                where
                                    id = '71'
                                    or path like '/71/'||'%'
[2016-10-19 20:20:59.853] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/2/70/' like path||id||'/%'
[2016-10-19 20:20:59.856] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/70/' like k.path||k.id||'/%'
[2016-10-19 20:20:59.870] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('70', '2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:20:59.881] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/2/70/71/'||'%'
[2016-10-19 20:20:59.886] [INFO] console - Executing (dae89f44-fdea-451e-bb53-d9e755d15fd0): COMMIT;
[2016-10-19 20:20:59.890] [INFO] console - [ 70, 459, {}, [ undefined ] ]
[2016-10-19 20:20:59.897] [INFO] console - [ 16,
  2865805821739008,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id70.druzhinaChange',
  [],
  { action: 'add',
    kopnik: 
     { fullName: 'temp temp',
       fullPath: '/2/70/71/',
       id: '71',
       email: null,
       password: null,
       name: 'temp',
       surname: 'temp',
       patronymic: 'temp',
       voiskoSize: 0,
       birth: 1900,
       path: '/2/70/',
       note: null,
       created_at: Wed Oct 19 2016 20:20:59 GMT+0500 (YEKT),
       updated_at: Wed Oct 19 2016 20:20:59 GMT+0500 (YEKT),
       deleted_at: null,
       dom_id: '2',
       starshina_id: '70' } } ]
[2016-10-19 20:20:59.916] [INFO] console - [ 16,
  4921141823012864,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id70.voiskoChange',
  [],
  { voiskoSize: 1 } ]
[2016-10-19 20:20:59.923] [INFO] console - [ 16,
  5534020729307136,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 3 } ]
[2016-10-19 20:20:59.947] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 4 }
[2016-10-19 20:20:59.959] [INFO] console - Executing (d6700499-6fd3-4ebd-bc1a-872a41786243): START TRANSACTION;
[2016-10-19 20:20:59.962] [INFO] console - Executing (d6700499-6fd3-4ebd-bc1a-872a41786243): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:20:59.984] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 4);
[2016-10-19 20:21:00.005] [INFO] console - Executing (d6700499-6fd3-4ebd-bc1a-872a41786243): COMMIT;
[2016-10-19 20:21:00.009] [INFO] console - [ 70,
  460,
  {},
  [ { fullName: 'Unit Test',
      fullPath: '/4/',
      id: '4',
      email: 'unittest4@domain.ru',
      name: 'Unit',
      surname: 'Test',
      patronymic: '4',
      voiskoSize: 0,
      birth: 1983,
      path: '/',
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: null,
      attachments: [] } ] ]
[2016-10-19 20:21:00.034] [INFO] console - Executing (108ed9ab-4b8d-42e9-8dc9-7f5f6c32868d): START TRANSACTION;
[2016-10-19 20:21:00.040] [INFO] console - Executing (108ed9ab-4b8d-42e9-8dc9-7f5f6c32868d): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:21:00.050] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 70);
[2016-10-19 20:21:00.063] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 4);
[2016-10-19 20:21:00.073] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 20:21:00.086] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:21:00.095] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-2
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 20:21:00.116] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='4',"updated_at"='2016-10-19 15:21:00.101 +00:00' WHERE "id" = '70'
[2016-10-19 20:21:00.123] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/2/', '/4/')
                                where
                                    id = '70'
                                    or path like '/2/70/'||'%'
[2016-10-19 20:21:00.129] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+2
                                where
                                    '/4/' like path||id||'/%'
[2016-10-19 20:21:00.135] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/4/' like k.path||k.id||'/%'
[2016-10-19 20:21:00.159] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('4')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:21:00.170] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/4/70/'||'%'
[2016-10-19 20:21:00.178] [INFO] console - Executing (108ed9ab-4b8d-42e9-8dc9-7f5f6c32868d): COMMIT;
[2016-10-19 20:21:00.183] [INFO] console - [ 70, 461, {}, [ undefined ] ]
[2016-10-19 20:21:00.190] [INFO] console - [ 16,
  8797175475601408,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.druzhinaChange',
  [],
  { action: 'remove', KOPNIK: 70 } ]
[2016-10-19 20:21:00.213] [INFO] console - [ 16,
  395075293020160,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id4.druzhinaChange',
  [],
  { action: 'add',
    kopnik: 
     { fullName: 'temp temp',
       fullPath: '/4/70/',
       id: '70',
       email: null,
       password: null,
       name: 'temp',
       surname: 'temp',
       patronymic: 'temp',
       voiskoSize: 1,
       birth: 1900,
       path: '/4/',
       note: null,
       created_at: Wed Oct 19 2016 20:20:59 GMT+0500 (YEKT),
       updated_at: Wed Oct 19 2016 20:21:00 GMT+0500 (YEKT),
       deleted_at: null,
       dom_id: '2',
       starshina_id: '4' } } ]
[2016-10-19 20:21:00.246] [INFO] console - [ 16,
  2158258349408256,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 1 } ]
[2016-10-19 20:21:00.262] [INFO] console - [ 16,
  7021029048188928,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id4.voiskoChange',
  [],
  { voiskoSize: 2 } ]
[2016-10-19 20:21:00.272] [INFO] console - [ 16,
  7638451088261120,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id71.starshinaChange',
  [],
  {} ]
[2016-10-19 20:21:00.287] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 71 }
[2016-10-19 20:21:00.293] [INFO] console - Executing (1f990c3b-a506-4a51-bf77-08e9637c2217): START TRANSACTION;
[2016-10-19 20:21:00.296] [INFO] console - Executing (1f990c3b-a506-4a51-bf77-08e9637c2217): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:21:00.316] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 71);
[2016-10-19 20:21:00.341] [INFO] console - Executing (1f990c3b-a506-4a51-bf77-08e9637c2217): COMMIT;
[2016-10-19 20:21:00.344] [INFO] console - [ 70,
  462,
  {},
  [ { fullName: 'temp temp',
      fullPath: '/4/70/71/',
      id: '71',
      email: null,
      name: 'temp',
      surname: 'temp',
      patronymic: 'temp',
      voiskoSize: 0,
      birth: 1900,
      path: '/4/70/',
      note: null,
      created_at: Wed Oct 19 2016 20:20:59 GMT+0500 (YEKT),
      updated_at: Wed Oct 19 2016 20:20:59 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: '70',
      attachments: [] } ] ]
[2016-10-19 20:21:00.366] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 70 }
[2016-10-19 20:21:00.372] [INFO] console - Executing (88633d0f-c693-44cb-b1ea-22e5cda1790d): START TRANSACTION;
[2016-10-19 20:21:00.377] [INFO] console - Executing (88633d0f-c693-44cb-b1ea-22e5cda1790d): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:21:00.389] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 70);
[2016-10-19 20:21:00.400] [INFO] console - Executing (88633d0f-c693-44cb-b1ea-22e5cda1790d): COMMIT;
[2016-10-19 20:21:00.404] [INFO] console - [ 70,
  463,
  {},
  [ { fullName: 'temp temp',
      fullPath: '/4/70/',
      id: '70',
      email: null,
      name: 'temp',
      surname: 'temp',
      patronymic: 'temp',
      voiskoSize: 1,
      birth: 1900,
      path: '/4/',
      note: null,
      created_at: Wed Oct 19 2016 20:20:59 GMT+0500 (YEKT),
      updated_at: Wed Oct 19 2016 20:21:00 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: '4',
      attachments: [] } ] ]
[2016-10-19 20:21:00.426] [INFO] console - Executing (11f1e45a-3eeb-4148-8376-cda4420e4380): START TRANSACTION;
[2016-10-19 20:21:00.430] [INFO] console - Executing (11f1e45a-3eeb-4148-8376-cda4420e4380): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:21:00.442] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 70);
[2016-10-19 20:21:00.450] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/4/' like k.path||k.id||'/%'
[2016-10-19 20:21:00.461] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('4')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:21:00.473] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-2
                                where
                                    '/4/' like path||id||'/%'
[2016-10-19 20:21:00.486] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"=NULL,"updated_at"='2016-10-19 15:21:00.477 +00:00' WHERE "id" = '70'
[2016-10-19 20:21:00.490] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/4/', '/')
                                where
                                    id = '70'
                                    or path like '/4/70/'||'%'
[2016-10-19 20:21:00.496] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+2
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:21:00.499] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 20:21:00.508] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:21:00.515] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/70/'||'%'
[2016-10-19 20:21:00.520] [INFO] console - Executing (11f1e45a-3eeb-4148-8376-cda4420e4380): COMMIT;
[2016-10-19 20:21:00.523] [INFO] console - [ 70, 464, {}, [ undefined ] ]
[2016-10-19 20:21:00.530] [INFO] console - [ 16,
  2902161952342016,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id4.druzhinaChange',
  [],
  { action: 'remove', KOPNIK: 70 } ]
[2016-10-19 20:21:00.550] [INFO] console - [ 16,
  1895532148555776,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id4.voiskoChange',
  [],
  { voiskoSize: 0 } ]
[2016-10-19 20:21:00.565] [INFO] console - [ 16,
  2049809793941504,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id71.starshinaChange',
  [],
  {} ]
[2016-10-19 20:21:04.813] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 20:21:04.826] [INFO] console - Executing (94f706f6-0d89-450a-af57-1b851faa237d): START TRANSACTION;
[2016-10-19 20:21:04.830] [INFO] console - Executing (94f706f6-0d89-450a-af57-1b851faa237d): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:21:04.986] [INFO] console - Executing (94f706f6-0d89-450a-af57-1b851faa237d): INSERT INTO "Kopnik" ("id","name","surname","patronymic","voiskoSize","birth","path","created_at","updated_at","dom_id","starshina_id") VALUES (DEFAULT,'temp','temp','temp',0,1900,'/','2016-10-19 15:21:04.837 +00:00','2016-10-19 15:21:04.837 +00:00',2,NULL) RETURNING *;
[2016-10-19 20:21:05.001] [INFO] console - Executing (94f706f6-0d89-450a-af57-1b851faa237d): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:21:05.009] [INFO] console - Executing (94f706f6-0d89-450a-af57-1b851faa237d): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:21:05.013] [INFO] console - Executing (94f706f6-0d89-450a-af57-1b851faa237d): update "Zemla"
                                    set "obshinaSize"= "obshinaSize"+ 1
                                where
                                    '/1/' like path||id||'/%'
                                    or (
                                        true 
                                        and id= 2
                                    )
[2016-10-19 20:21:05.017] [INFO] console - Executing (94f706f6-0d89-450a-af57-1b851faa237d): COMMIT;
[2016-10-19 20:21:05.030] [INFO] console - [ 70, 465, {}, [ '72' ] ]
[2016-10-19 20:21:05.052] [INFO] console - Executing (907b61dc-627f-4f68-bc68-1ed75f35a49e): START TRANSACTION;
[2016-10-19 20:21:05.057] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:21:05.060] [INFO] console - Executing (907b61dc-627f-4f68-bc68-1ed75f35a49e): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:21:05.067] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 72);
[2016-10-19 20:21:05.079] [INFO] console - Executing (default): select z.*
                                    from "Zemla" as z
                                where
                                    '/1/' like z.path||z.id||'/%'
[2016-10-19 20:21:05.084] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 20:21:05.129] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 20:21:05.135] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" IN ('1')) ORDER BY "Zemla"."path" desc;
[2016-10-19 20:21:05.143] [INFO] console - [ 16,
  272910639955968,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id2.obshinaChange',
  [],
  { obshinaSize: 70 } ]
[2016-10-19 20:21:05.155] [INFO] console - [ 16,
  7529702069633024,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id1.obshinaChange',
  [],
  { obshinaSize: 72 } ]
[2016-10-19 20:21:05.168] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:21:05.176] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:21:05.194] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='2',"updated_at"='2016-10-19 15:21:05.179 +00:00' WHERE "id" = '72'
[2016-10-19 20:21:05.200] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/', '/2/')
                                where
                                    id = '72'
                                    or path like '/72/'||'%'
[2016-10-19 20:21:05.206] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 20:21:05.210] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 20:21:05.221] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:21:05.229] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/2/72/'||'%'
[2016-10-19 20:21:05.232] [INFO] console - Executing (907b61dc-627f-4f68-bc68-1ed75f35a49e): COMMIT;
[2016-10-19 20:21:05.236] [INFO] console - [ 70, 466, {}, [ undefined ] ]
[2016-10-19 20:21:05.242] [INFO] console - [ 16,
  1926470786088960,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.druzhinaChange',
  [],
  { action: 'add',
    kopnik: 
     { fullName: 'temp temp',
       fullPath: '/2/72/',
       id: '72',
       email: null,
       password: null,
       name: 'temp',
       surname: 'temp',
       patronymic: 'temp',
       voiskoSize: 0,
       birth: 1900,
       path: '/2/',
       note: null,
       created_at: Wed Oct 19 2016 20:21:04 GMT+0500 (YEKT),
       updated_at: Wed Oct 19 2016 20:21:05 GMT+0500 (YEKT),
       deleted_at: null,
       dom_id: '2',
       starshina_id: '2' } } ]
[2016-10-19 20:21:05.255] [INFO] console - Executing (8e038efa-14ff-4bff-a352-49d3d698b8c4): START TRANSACTION;
[2016-10-19 20:21:05.259] [INFO] console - [ 16,
  555082078748672,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 2 } ]
[2016-10-19 20:21:05.267] [INFO] console - Executing (8e038efa-14ff-4bff-a352-49d3d698b8c4): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:21:05.276] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 72);
[2016-10-19 20:21:05.283] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 20:21:05.292] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:21:05.302] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 20:21:05.314] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"=NULL,"updated_at"='2016-10-19 15:21:05.304 +00:00' WHERE "id" = '72'
[2016-10-19 20:21:05.320] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/2/', '/')
                                where
                                    id = '72'
                                    or path like '/2/72/'||'%'
[2016-10-19 20:21:05.326] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:21:05.337] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 20:21:05.344] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:21:05.350] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/72/'||'%'
[2016-10-19 20:21:05.354] [INFO] console - Executing (8e038efa-14ff-4bff-a352-49d3d698b8c4): COMMIT;
[2016-10-19 20:21:05.357] [INFO] console - [ 70, 467, {}, [ undefined ] ]
[2016-10-19 20:21:05.361] [INFO] console - [ 16,
  3366085120229376,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.druzhinaChange',
  [],
  { action: 'remove', KOPNIK: 72 } ]
[2016-10-19 20:21:05.370] [INFO] console - [ 16,
  323701924954112,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 1 } ]
[2016-10-19 20:21:05.377] [DEBUG] Server - #promiseModel() [] { model: 'Kopa', id: 3 }
[2016-10-19 20:21:05.382] [INFO] console - Executing (b54cfed2-43e8-4f73-a432-0abc2933ef6e): START TRANSACTION;
[2016-10-19 20:21:05.386] [INFO] console - Executing (b54cfed2-43e8-4f73-a432-0abc2933ef6e): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:21:05.399] [INFO] console - Executing (default): SELECT "Kopa"."id", "Kopa"."question", "Kopa"."invited", "Kopa"."note", "Kopa"."created_at", "Kopa"."updated_at", "Kopa"."deleted_at", "Kopa"."place_id", "Kopa"."inviter_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopa" AS "Kopa" LEFT OUTER JOIN "File" AS "attachments" ON "Kopa"."id" = "attachments"."kopa_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopa"."deleted_at" IS NULL AND "Kopa"."id" = 3);
[2016-10-19 20:21:05.409] [INFO] console - Executing (b54cfed2-43e8-4f73-a432-0abc2933ef6e): COMMIT;
[2016-10-19 20:21:05.412] [INFO] console - [ 70,
  468,
  {},
  [ { id: '3',
      question: 'CHE',
      invited: Thu Sep 01 2016 00:00:00 GMT+0500 (YEKT),
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      place_id: '2',
      inviter_id: '2',
      attachments: [] } ] ]
[2016-10-19 20:21:05.439] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 20:21:05.446] [INFO] console - Executing (12a8e804-35e1-475d-981e-f938eece7ba1): START TRANSACTION;
[2016-10-19 20:21:05.448] [INFO] console - Executing (12a8e804-35e1-475d-981e-f938eece7ba1): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:21:05.459] [INFO] console - Executing (12a8e804-35e1-475d-981e-f938eece7ba1): INSERT INTO "Predlozhenie" ("id","value","totalZa","totalProtiv","created_at","updated_at","author_id","place_id") VALUES (DEFAULT,'temp Wed Oct 19 2016 20:21:05 GMT+0500 (YEKT)',0,0,'2016-10-19 15:21:05.451 +00:00','2016-10-19 15:21:05.451 +00:00',2,3) RETURNING *;
[2016-10-19 20:21:05.466] [INFO] console - Executing (12a8e804-35e1-475d-981e-f938eece7ba1): COMMIT;
[2016-10-19 20:21:05.469] [INFO] console - [ 70, 469, {}, [ '17' ] ]
[2016-10-19 20:21:05.478] [INFO] console - [ 16,
  7330269411409920,
  { acknowledge: true },
  'ru.kopa.model.Kopa.id3.predlozhenieAdd',
  [ '17' ] ]
[2016-10-19 20:21:05.492] [INFO] console - Executing (3a42a360-0d2d-4495-a4bb-e984c6f8b531): START TRANSACTION;
[2016-10-19 20:21:05.495] [INFO] console - Executing (3a42a360-0d2d-4495-a4bb-e984c6f8b531): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:21:05.502] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 20:21:05.511] [INFO] console - Executing (default): SELECT "id", "value", "totalZa", "totalProtiv", "state", "note", "created_at", "updated_at", "deleted_at", "author_id", "place_id" FROM "Predlozhenie" AS "Predlozhenie" WHERE ("Predlozhenie"."deleted_at" IS NULL AND "Predlozhenie"."id" = 17);
[2016-10-19 20:21:05.522] [INFO] console - Executing (default): SELECT "id", "question", "invited", "note", "created_at", "updated_at", "deleted_at", "place_id", "inviter_id" FROM "Kopa" AS "Kopa" WHERE ("Kopa"."deleted_at" IS NULL AND "Kopa"."id" = '3');
[2016-10-19 20:21:05.531] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:21:05.539] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:21:05.544] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 20:21:05.552] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:21:05.562] [INFO] console - Executing (default): SELECT "id", "value", "reason", "note", "created_at", "updated_at", "deleted_at", "subject_id", "owner_id", "parent_id" FROM "Golos" AS "Golos" WHERE ("Golos"."deleted_at" IS NULL AND ("Golos"."subject_id" = '17' AND "Golos"."owner_id" = '2')) LIMIT 1;
[2016-10-19 20:21:05.573] [INFO] console - Executing (default): INSERT INTO "Golos" ("id","value","created_at","updated_at","subject_id","owner_id") VALUES (DEFAULT,1,'2016-10-19 15:21:05.567 +00:00','2016-10-19 15:21:05.567 +00:00','17','2') RETURNING *;
[2016-10-19 20:21:05.587] [INFO] console - Executing (default): insert into "Golos" (subject_id, value, owner_id, parent_id, created_at, updated_at)
                            (
                                select 17, 1, k.id, 47, current_timestamp, current_timestamp
                                from 
                                    "Kopnik" k
                                     join "Zemla" d on d.id= k.dom_id
                                where
                                    k.path like '/2/%'
                                    and d.path||d.id||'/' like '/1/2/%' 
                            )
[2016-10-19 20:21:05.598] [INFO] console - Executing (default): select
                            (select count(*) from "Golos" g where subject_id= 17 and value=1) "za",
                            (select count(*) from "Golos" g where subject_id= 17 and value=-1) "protiv"
[2016-10-19 20:21:05.610] [INFO] console - Executing (default): UPDATE "Predlozhenie" SET "totalZa"=2,"updated_at"='2016-10-19 15:21:05.602 +00:00' WHERE "id" = '17'
[2016-10-19 20:21:05.615] [INFO] console - Executing (3a42a360-0d2d-4495-a4bb-e984c6f8b531): COMMIT;
[2016-10-19 20:21:05.617] [INFO] console - [ 70, 470, {}, [ undefined ] ]
[2016-10-19 20:21:05.632] [INFO] console - [ 16,
  5488879624781824,
  { acknowledge: true },
  'ru.kopa.model.Predlozhenie.id17.rebalance',
  [],
  { totalZa: 2,
    totalProtiv: 0,
    GOLOS: '47',
    action: 'add',
    value: 1 } ]
[2016-10-19 20:21:05.640] [INFO] console - Executing (9b434f33-4b65-42f9-a92f-8372f513176d): START TRANSACTION;
[2016-10-19 20:21:05.651] [INFO] console - Executing (9b434f33-4b65-42f9-a92f-8372f513176d): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:21:05.658] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 20:21:05.669] [INFO] console - Executing (default): SELECT "id", "value", "totalZa", "totalProtiv", "state", "note", "created_at", "updated_at", "deleted_at", "author_id", "place_id" FROM "Predlozhenie" AS "Predlozhenie" WHERE ("Predlozhenie"."deleted_at" IS NULL AND "Predlozhenie"."id" = 17);
[2016-10-19 20:21:05.678] [INFO] console - Executing (default): SELECT "id", "question", "invited", "note", "created_at", "updated_at", "deleted_at", "place_id", "inviter_id" FROM "Kopa" AS "Kopa" WHERE ("Kopa"."deleted_at" IS NULL AND "Kopa"."id" = '3');
[2016-10-19 20:21:05.688] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:21:05.697] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:21:05.702] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 20:21:05.711] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:21:05.720] [INFO] console - Executing (default): SELECT "id", "value", "reason", "note", "created_at", "updated_at", "deleted_at", "subject_id", "owner_id", "parent_id" FROM "Golos" AS "Golos" WHERE ("Golos"."deleted_at" IS NULL AND ("Golos"."subject_id" = '17' AND "Golos"."owner_id" = '2')) LIMIT 1;
[2016-10-19 20:21:05.726] [INFO] console - Executing (default): delete from "Golos" 
                            where
                                subject_id= 17
                                and (
                                    id= 47
                                    or parent_id = 47
                                )
[2016-10-19 20:21:05.731] [INFO] console - Executing (default): select
                            (select count(*) from "Golos" g where subject_id= 17 and value=1) "za",
                            (select count(*) from "Golos" g where subject_id= 17 and value=-1) "protiv"
[2016-10-19 20:21:05.742] [INFO] console - Executing (default): UPDATE "Predlozhenie" SET "totalZa"=0,"updated_at"='2016-10-19 15:21:05.735 +00:00' WHERE "id" = '17'
[2016-10-19 20:21:05.746] [INFO] console - Executing (9b434f33-4b65-42f9-a92f-8372f513176d): COMMIT;
[2016-10-19 20:21:05.749] [INFO] console - [ 70, 471, {}, [ undefined ] ]
[2016-10-19 20:21:05.753] [INFO] console - [ 16,
  588402374213632,
  { acknowledge: true },
  'ru.kopa.model.Predlozhenie.id17.rebalance',
  [],
  { totalZa: 0,
    totalProtiv: 0,
    GOLOS: '47',
    action: 'remove',
    value: 1 } ]
[2016-10-19 20:21:05.767] [INFO] console - Executing (22178a1a-9284-406f-9c25-9661a3e61aa8): START TRANSACTION;
[2016-10-19 20:21:05.770] [INFO] console - Executing (22178a1a-9284-406f-9c25-9661a3e61aa8): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:21:05.788] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 20:21:05.798] [INFO] console - Executing (default): SELECT "id", "value", "totalZa", "totalProtiv", "state", "note", "created_at", "updated_at", "deleted_at", "author_id", "place_id" FROM "Predlozhenie" AS "Predlozhenie" WHERE ("Predlozhenie"."deleted_at" IS NULL AND "Predlozhenie"."id" = 17);
[2016-10-19 20:21:05.808] [INFO] console - Executing (default): SELECT "id", "question", "invited", "note", "created_at", "updated_at", "deleted_at", "place_id", "inviter_id" FROM "Kopa" AS "Kopa" WHERE ("Kopa"."deleted_at" IS NULL AND "Kopa"."id" = '3');
[2016-10-19 20:21:05.818] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:21:05.828] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:21:05.837] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 20:21:05.847] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:21:05.864] [INFO] console - Executing (default): SELECT "id", "value", "reason", "note", "created_at", "updated_at", "deleted_at", "subject_id", "owner_id", "parent_id" FROM "Golos" AS "Golos" WHERE ("Golos"."deleted_at" IS NULL AND ("Golos"."subject_id" = '17' AND "Golos"."owner_id" = '2')) LIMIT 1;
[2016-10-19 20:21:05.885] [INFO] console - Executing (default): INSERT INTO "Golos" ("id","value","created_at","updated_at","subject_id","owner_id") VALUES (DEFAULT,-1,'2016-10-19 15:21:05.870 +00:00','2016-10-19 15:21:05.870 +00:00','17','2') RETURNING *;
[2016-10-19 20:21:05.895] [INFO] console - Executing (default): insert into "Golos" (subject_id, value, owner_id, parent_id, created_at, updated_at)
                            (
                                select 17, -1, k.id, 49, current_timestamp, current_timestamp
                                from 
                                    "Kopnik" k
                                     join "Zemla" d on d.id= k.dom_id
                                where
                                    k.path like '/2/%'
                                    and d.path||d.id||'/' like '/1/2/%' 
                            )
[2016-10-19 20:21:05.905] [INFO] console - Executing (default): select
                            (select count(*) from "Golos" g where subject_id= 17 and value=1) "za",
                            (select count(*) from "Golos" g where subject_id= 17 and value=-1) "protiv"
[2016-10-19 20:21:05.922] [INFO] console - Executing (default): UPDATE "Predlozhenie" SET "totalProtiv"=2,"updated_at"='2016-10-19 15:21:05.912 +00:00' WHERE "id" = '17'
[2016-10-19 20:21:05.929] [INFO] console - Executing (22178a1a-9284-406f-9c25-9661a3e61aa8): COMMIT;
[2016-10-19 20:21:05.935] [INFO] console - [ 70, 472, {}, [ undefined ] ]
[2016-10-19 20:21:05.943] [INFO] console - [ 16,
  5670621518233600,
  { acknowledge: true },
  'ru.kopa.model.Predlozhenie.id17.rebalance',
  [],
  { totalZa: 0,
    totalProtiv: 2,
    GOLOS: '49',
    action: 'add',
    value: -1 } ]
[2016-10-19 20:21:49.664] [INFO] console - [ 70, 474, {}, [ undefined ] ]
[2016-10-19 20:21:49.694] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 2 }
[2016-10-19 20:21:49.732] [INFO] console - Executing (default): delete from "Kopnik"
                where
                    name like '%temp'
                    or name like 'temp%'
[2016-10-19 20:21:49.754] [INFO] console - Executing (7972b1b3-5608-4fe2-a09a-32f92cc876c4): START TRANSACTION;
[2016-10-19 20:21:49.761] [INFO] console - Executing (7972b1b3-5608-4fe2-a09a-32f92cc876c4): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:21:49.773] [INFO] console - Executing (default): update "Kopnik"
                set 
                    "voiskoSize"= case when id=2 then 1 ELSE 0 END
                where
                    id>1 
                    and id<=5
[2016-10-19 20:21:49.796] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 20:21:49.830] [INFO] console - Executing (7972b1b3-5608-4fe2-a09a-32f92cc876c4): COMMIT;
[2016-10-19 20:21:49.843] [INFO] console - [ 70,
  475,
  {},
  [ { fullName: 'Unit Test',
      fullPath: '/2/',
      id: '2',
      email: 'unittest2@domain.ru',
      name: 'Unit',
      surname: 'Test',
      patronymic: '1',
      voiskoSize: 1,
      birth: 1983,
      path: '/',
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: null,
      attachments: [] } ] ]
[2016-10-19 20:21:49.937] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."starshina_id" = 2) ORDER BY "Kopnik"."surname" asc, "Kopnik"."name" asc, "Kopnik"."patronymic" asc;
[2016-10-19 20:21:49.953] [INFO] console - [ 70, 476, {}, [ [ [Object], [Object] ] ] ]
[2016-10-19 20:21:50.018] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 20:21:50.030] [INFO] console - Executing (8d78ddd1-ea25-4275-b8e2-17a6fa016551): START TRANSACTION;
[2016-10-19 20:21:50.040] [INFO] console - Executing (8d78ddd1-ea25-4275-b8e2-17a6fa016551): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:21:50.072] [INFO] console - Executing (8d78ddd1-ea25-4275-b8e2-17a6fa016551): INSERT INTO "Kopnik" ("id","name","surname","patronymic","voiskoSize","birth","path","created_at","updated_at","dom_id","starshina_id") VALUES (DEFAULT,'temp','temp','temp',0,1900,'/','2016-10-19 15:21:50.053 +00:00','2016-10-19 15:21:50.053 +00:00',2,NULL) RETURNING *;
[2016-10-19 20:21:50.102] [INFO] console - Executing (8d78ddd1-ea25-4275-b8e2-17a6fa016551): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:21:50.113] [INFO] console - Executing (8d78ddd1-ea25-4275-b8e2-17a6fa016551): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:21:50.123] [INFO] console - Executing (8d78ddd1-ea25-4275-b8e2-17a6fa016551): update "Zemla"
                                    set "obshinaSize"= "obshinaSize"+ 1
                                where
                                    '/1/' like path||id||'/%'
                                    or (
                                        true 
                                        and id= 2
                                    )
[2016-10-19 20:21:50.129] [INFO] console - Executing (8d78ddd1-ea25-4275-b8e2-17a6fa016551): COMMIT;
[2016-10-19 20:21:50.132] [INFO] console - [ 70, 477, {}, [ '73' ] ]
[2016-10-19 20:21:50.159] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:21:50.164] [INFO] console - Executing (edf369d9-580b-4a21-b6cd-8b8c37c57e12): START TRANSACTION;
[2016-10-19 20:21:50.174] [INFO] console - Executing (edf369d9-580b-4a21-b6cd-8b8c37c57e12): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:21:50.181] [INFO] console - Executing (default): select z.*
                                    from "Zemla" as z
                                where
                                    '/1/' like z.path||z.id||'/%'
[2016-10-19 20:21:50.196] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 73);
[2016-10-19 20:21:50.211] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" IN ('1')) ORDER BY "Zemla"."path" desc;
[2016-10-19 20:21:50.222] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 20:21:50.223] [INFO] console - [ 16,
  2198596409622528,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id2.obshinaChange',
  [],
  { obshinaSize: 71 } ]
[2016-10-19 20:21:50.233] [INFO] console - [ 16,
  2707907437133824,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id1.obshinaChange',
  [],
  { obshinaSize: 73 } ]
[2016-10-19 20:21:50.245] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 20:21:50.257] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:21:50.263] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:21:50.284] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='2',"updated_at"='2016-10-19 15:21:50.265 +00:00' WHERE "id" = '73'
[2016-10-19 20:21:50.294] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/', '/2/')
                                where
                                    id = '73'
                                    or path like '/73/'||'%'
[2016-10-19 20:21:50.302] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 20:21:50.309] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 20:21:50.322] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:21:50.329] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/2/73/'||'%'
[2016-10-19 20:21:50.334] [INFO] console - Executing (edf369d9-580b-4a21-b6cd-8b8c37c57e12): COMMIT;
[2016-10-19 20:21:50.337] [INFO] console - [ 70, 478, {}, [ undefined ] ]
[2016-10-19 20:21:50.343] [INFO] console - [ 16,
  5049537573945344,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.druzhinaChange',
  [],
  { action: 'add',
    kopnik: 
     { fullName: 'temp temp',
       fullPath: '/2/73/',
       id: '73',
       email: null,
       password: null,
       name: 'temp',
       surname: 'temp',
       patronymic: 'temp',
       voiskoSize: 0,
       birth: 1900,
       path: '/2/',
       note: null,
       created_at: Wed Oct 19 2016 20:21:50 GMT+0500 (YEKT),
       updated_at: Wed Oct 19 2016 20:21:50 GMT+0500 (YEKT),
       deleted_at: null,
       dom_id: '2',
       starshina_id: '2' } } ]
[2016-10-19 20:21:50.366] [INFO] console - [ 16,
  4035248004268032,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 2 } ]
[2016-10-19 20:21:50.394] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 20:21:50.415] [INFO] console - Executing (db0ead49-4cde-4223-a4af-479ae74e172e): START TRANSACTION;
[2016-10-19 20:21:50.418] [INFO] console - Executing (db0ead49-4cde-4223-a4af-479ae74e172e): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:21:50.437] [INFO] console - Executing (db0ead49-4cde-4223-a4af-479ae74e172e): INSERT INTO "Kopnik" ("id","name","surname","patronymic","voiskoSize","birth","path","created_at","updated_at","dom_id","starshina_id") VALUES (DEFAULT,'temp','temp','temp',0,1900,'/','2016-10-19 15:21:50.427 +00:00','2016-10-19 15:21:50.427 +00:00',2,NULL) RETURNING *;
[2016-10-19 20:21:50.446] [INFO] console - Executing (db0ead49-4cde-4223-a4af-479ae74e172e): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:21:50.455] [INFO] console - Executing (db0ead49-4cde-4223-a4af-479ae74e172e): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:21:50.465] [INFO] console - Executing (db0ead49-4cde-4223-a4af-479ae74e172e): update "Zemla"
                                    set "obshinaSize"= "obshinaSize"+ 1
                                where
                                    '/1/' like path||id||'/%'
                                    or (
                                        true 
                                        and id= 2
                                    )
[2016-10-19 20:21:50.469] [INFO] console - Executing (db0ead49-4cde-4223-a4af-479ae74e172e): COMMIT;
[2016-10-19 20:21:50.473] [INFO] console - [ 70, 479, {}, [ '74' ] ]
[2016-10-19 20:21:50.492] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:21:50.501] [INFO] console - Executing (22e9c04e-5569-4476-8853-1fb27a02a896): START TRANSACTION;
[2016-10-19 20:21:50.506] [INFO] console - Executing (default): select z.*
                                    from "Zemla" as z
                                where
                                    '/1/' like z.path||z.id||'/%'
[2016-10-19 20:21:50.509] [INFO] console - Executing (22e9c04e-5569-4476-8853-1fb27a02a896): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:21:50.525] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" IN ('1')) ORDER BY "Zemla"."path" desc;
[2016-10-19 20:21:50.527] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 74);
[2016-10-19 20:21:50.537] [INFO] console - [ 16,
  630372108861440,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id2.obshinaChange',
  [],
  { obshinaSize: 72 } ]
[2016-10-19 20:21:50.544] [INFO] console - [ 16,
  1557548240994304,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id1.obshinaChange',
  [],
  { obshinaSize: 74 } ]
[2016-10-19 20:21:50.554] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 73);
[2016-10-19 20:21:50.563] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 20:21:50.577] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:21:50.583] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:21:50.597] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='73',"updated_at"='2016-10-19 15:21:50.586 +00:00' WHERE "id" = '74'
[2016-10-19 20:21:50.604] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/', '/2/73/')
                                where
                                    id = '74'
                                    or path like '/74/'||'%'
[2016-10-19 20:21:50.610] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/2/73/' like path||id||'/%'
[2016-10-19 20:21:50.615] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/73/' like k.path||k.id||'/%'
[2016-10-19 20:21:50.627] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('73', '2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:21:50.636] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/2/73/74/'||'%'
[2016-10-19 20:21:50.641] [INFO] console - Executing (22e9c04e-5569-4476-8853-1fb27a02a896): COMMIT;
[2016-10-19 20:21:50.646] [INFO] console - [ 70, 480, {}, [ undefined ] ]
[2016-10-19 20:21:50.659] [INFO] console - [ 16,
  7581408344145920,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id73.druzhinaChange',
  [],
  { action: 'add',
    kopnik: 
     { fullName: 'temp temp',
       fullPath: '/2/73/74/',
       id: '74',
       email: null,
       password: null,
       name: 'temp',
       surname: 'temp',
       patronymic: 'temp',
       voiskoSize: 0,
       birth: 1900,
       path: '/2/73/',
       note: null,
       created_at: Wed Oct 19 2016 20:21:50 GMT+0500 (YEKT),
       updated_at: Wed Oct 19 2016 20:21:50 GMT+0500 (YEKT),
       deleted_at: null,
       dom_id: '2',
       starshina_id: '73' } } ]
[2016-10-19 20:21:50.686] [INFO] console - [ 16,
  2948330659250176,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id73.voiskoChange',
  [],
  { voiskoSize: 1 } ]
[2016-10-19 20:21:50.696] [INFO] console - [ 16,
  3913383860502528,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 3 } ]
[2016-10-19 20:21:50.716] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 4 }
[2016-10-19 20:21:50.724] [INFO] console - Executing (d88530f9-47ce-4621-96d0-de7a3570c039): START TRANSACTION;
[2016-10-19 20:21:50.731] [INFO] console - Executing (d88530f9-47ce-4621-96d0-de7a3570c039): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:21:50.744] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 4);
[2016-10-19 20:21:50.756] [INFO] console - Executing (d88530f9-47ce-4621-96d0-de7a3570c039): COMMIT;
[2016-10-19 20:21:50.759] [INFO] console - [ 70,
  481,
  {},
  [ { fullName: 'Unit Test',
      fullPath: '/4/',
      id: '4',
      email: 'unittest4@domain.ru',
      name: 'Unit',
      surname: 'Test',
      patronymic: '4',
      voiskoSize: 0,
      birth: 1983,
      path: '/',
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: null,
      attachments: [] } ] ]
[2016-10-19 20:21:50.782] [INFO] console - Executing (299a161e-e24c-4453-9bc0-fa940107ecd2): START TRANSACTION;
[2016-10-19 20:21:50.785] [INFO] console - Executing (299a161e-e24c-4453-9bc0-fa940107ecd2): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:21:50.797] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 73);
[2016-10-19 20:21:50.809] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 4);
[2016-10-19 20:21:50.820] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 20:21:50.835] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:21:50.843] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-2
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 20:21:50.863] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='4',"updated_at"='2016-10-19 15:21:50.847 +00:00' WHERE "id" = '73'
[2016-10-19 20:21:50.870] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/2/', '/4/')
                                where
                                    id = '73'
                                    or path like '/2/73/'||'%'
[2016-10-19 20:21:50.874] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+2
                                where
                                    '/4/' like path||id||'/%'
[2016-10-19 20:21:50.881] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/4/' like k.path||k.id||'/%'
[2016-10-19 20:21:50.892] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('4')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:21:50.899] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/4/73/'||'%'
[2016-10-19 20:21:50.904] [INFO] console - Executing (299a161e-e24c-4453-9bc0-fa940107ecd2): COMMIT;
[2016-10-19 20:21:50.908] [INFO] console - [ 70, 482, {}, [ undefined ] ]
[2016-10-19 20:21:50.922] [INFO] console - [ 16,
  3082808111136768,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.druzhinaChange',
  [],
  { action: 'remove', KOPNIK: 73 } ]
[2016-10-19 20:21:50.933] [INFO] console - [ 16,
  1265099243257856,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id4.druzhinaChange',
  [],
  { action: 'add',
    kopnik: 
     { fullName: 'temp temp',
       fullPath: '/4/73/',
       id: '73',
       email: null,
       password: null,
       name: 'temp',
       surname: 'temp',
       patronymic: 'temp',
       voiskoSize: 1,
       birth: 1900,
       path: '/4/',
       note: null,
       created_at: Wed Oct 19 2016 20:21:50 GMT+0500 (YEKT),
       updated_at: Wed Oct 19 2016 20:21:50 GMT+0500 (YEKT),
       deleted_at: null,
       dom_id: '2',
       starshina_id: '4' } } ]
[2016-10-19 20:21:50.950] [INFO] console - [ 16,
  7483676034072576,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 1 } ]
[2016-10-19 20:21:50.958] [INFO] console - [ 16,
  3305817298173952,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id4.voiskoChange',
  [],
  { voiskoSize: 2 } ]
[2016-10-19 20:21:50.966] [INFO] console - [ 16,
  433668803788800,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id74.starshinaChange',
  [],
  {} ]
[2016-10-19 20:21:50.979] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 74 }
[2016-10-19 20:21:50.984] [INFO] console - Executing (ba4b8f21-a5c5-4cc9-8448-adf33383d35e): START TRANSACTION;
[2016-10-19 20:21:50.987] [INFO] console - Executing (ba4b8f21-a5c5-4cc9-8448-adf33383d35e): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:21:51.001] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 74);
[2016-10-19 20:21:51.012] [INFO] console - Executing (ba4b8f21-a5c5-4cc9-8448-adf33383d35e): COMMIT;
[2016-10-19 20:21:51.015] [INFO] console - [ 70,
  483,
  {},
  [ { fullName: 'temp temp',
      fullPath: '/4/73/74/',
      id: '74',
      email: null,
      name: 'temp',
      surname: 'temp',
      patronymic: 'temp',
      voiskoSize: 0,
      birth: 1900,
      path: '/4/73/',
      note: null,
      created_at: Wed Oct 19 2016 20:21:50 GMT+0500 (YEKT),
      updated_at: Wed Oct 19 2016 20:21:50 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: '73',
      attachments: [] } ] ]
[2016-10-19 20:21:51.035] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 73 }
[2016-10-19 20:21:51.042] [INFO] console - Executing (697162c8-0cfe-4aae-9833-7d85d85d4810): START TRANSACTION;
[2016-10-19 20:21:51.046] [INFO] console - Executing (697162c8-0cfe-4aae-9833-7d85d85d4810): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:21:51.060] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 73);
[2016-10-19 20:21:51.070] [INFO] console - Executing (697162c8-0cfe-4aae-9833-7d85d85d4810): COMMIT;
[2016-10-19 20:21:51.074] [INFO] console - [ 70,
  484,
  {},
  [ { fullName: 'temp temp',
      fullPath: '/4/73/',
      id: '73',
      email: null,
      name: 'temp',
      surname: 'temp',
      patronymic: 'temp',
      voiskoSize: 1,
      birth: 1900,
      path: '/4/',
      note: null,
      created_at: Wed Oct 19 2016 20:21:50 GMT+0500 (YEKT),
      updated_at: Wed Oct 19 2016 20:21:50 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: '4',
      attachments: [] } ] ]
[2016-10-19 20:21:51.102] [INFO] console - Executing (375367b3-7238-433e-860e-e62391c36f06): START TRANSACTION;
[2016-10-19 20:21:51.111] [INFO] console - Executing (375367b3-7238-433e-860e-e62391c36f06): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:21:51.123] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 73);
[2016-10-19 20:21:51.132] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/4/' like k.path||k.id||'/%'
[2016-10-19 20:21:51.143] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('4')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:21:51.150] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-2
                                where
                                    '/4/' like path||id||'/%'
[2016-10-19 20:21:51.162] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"=NULL,"updated_at"='2016-10-19 15:21:51.153 +00:00' WHERE "id" = '73'
[2016-10-19 20:21:51.168] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/4/', '/')
                                where
                                    id = '73'
                                    or path like '/4/73/'||'%'
[2016-10-19 20:21:51.172] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+2
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:21:51.178] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 20:21:51.187] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:21:51.194] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/73/'||'%'
[2016-10-19 20:21:51.199] [INFO] console - Executing (375367b3-7238-433e-860e-e62391c36f06): COMMIT;
[2016-10-19 20:21:51.202] [INFO] console - [ 70, 485, {}, [ undefined ] ]
[2016-10-19 20:21:51.207] [INFO] console - [ 16,
  1587101252452352,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id4.druzhinaChange',
  [],
  { action: 'remove', KOPNIK: 73 } ]
[2016-10-19 20:21:51.217] [INFO] console - [ 16,
  6055703319937024,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id4.voiskoChange',
  [],
  { voiskoSize: 0 } ]
[2016-10-19 20:21:51.234] [INFO] console - [ 16,
  21993395060736,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id74.starshinaChange',
  [],
  {} ]
[2016-10-19 20:21:51.251] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 20:21:51.263] [INFO] console - Executing (849de213-72a8-4390-9529-754ad67e7929): START TRANSACTION;
[2016-10-19 20:21:51.266] [INFO] console - Executing (849de213-72a8-4390-9529-754ad67e7929): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:21:51.279] [INFO] console - Executing (849de213-72a8-4390-9529-754ad67e7929): INSERT INTO "Kopnik" ("id","name","surname","patronymic","voiskoSize","birth","path","created_at","updated_at","dom_id","starshina_id") VALUES (DEFAULT,'temp','temp','temp',0,1900,'/','2016-10-19 15:21:51.269 +00:00','2016-10-19 15:21:51.269 +00:00',2,NULL) RETURNING *;
[2016-10-19 20:21:51.287] [INFO] console - Executing (849de213-72a8-4390-9529-754ad67e7929): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:21:51.295] [INFO] console - Executing (849de213-72a8-4390-9529-754ad67e7929): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:21:51.305] [INFO] console - Executing (849de213-72a8-4390-9529-754ad67e7929): update "Zemla"
                                    set "obshinaSize"= "obshinaSize"+ 1
                                where
                                    '/1/' like path||id||'/%'
                                    or (
                                        true 
                                        and id= 2
                                    )
[2016-10-19 20:21:51.310] [INFO] console - Executing (849de213-72a8-4390-9529-754ad67e7929): COMMIT;
[2016-10-19 20:21:51.313] [INFO] console - [ 70, 486, {}, [ '75' ] ]
[2016-10-19 20:21:51.344] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:21:51.354] [INFO] console - Executing (b3adc3ad-9660-43bd-933f-77b000c50f3c): START TRANSACTION;
[2016-10-19 20:21:51.361] [INFO] console - Executing (default): select z.*
                                    from "Zemla" as z
                                where
                                    '/1/' like z.path||z.id||'/%'
[2016-10-19 20:21:51.365] [INFO] console - Executing (b3adc3ad-9660-43bd-933f-77b000c50f3c): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:21:51.386] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" IN ('1')) ORDER BY "Zemla"."path" desc;
[2016-10-19 20:21:51.389] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 75);
[2016-10-19 20:21:51.394] [INFO] console - [ 16,
  3881084819341312,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id2.obshinaChange',
  [],
  { obshinaSize: 73 } ]
[2016-10-19 20:21:51.405] [INFO] console - [ 16,
  8129622487072768,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id1.obshinaChange',
  [],
  { obshinaSize: 75 } ]
[2016-10-19 20:21:51.416] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 20:21:51.425] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 20:21:51.434] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:21:51.439] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:21:51.453] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='2',"updated_at"='2016-10-19 15:21:51.442 +00:00' WHERE "id" = '75'
[2016-10-19 20:21:51.457] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/', '/2/')
                                where
                                    id = '75'
                                    or path like '/75/'||'%'
[2016-10-19 20:21:51.464] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 20:21:51.469] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 20:21:51.479] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:21:51.488] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/2/75/'||'%'
[2016-10-19 20:21:51.492] [INFO] console - Executing (b3adc3ad-9660-43bd-933f-77b000c50f3c): COMMIT;
[2016-10-19 20:21:51.495] [INFO] console - [ 70, 487, {}, [ undefined ] ]
[2016-10-19 20:21:51.500] [INFO] console - [ 16,
  7109349625298944,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.druzhinaChange',
  [],
  { action: 'add',
    kopnik: 
     { fullName: 'temp temp',
       fullPath: '/2/75/',
       id: '75',
       email: null,
       password: null,
       name: 'temp',
       surname: 'temp',
       patronymic: 'temp',
       voiskoSize: 0,
       birth: 1900,
       path: '/2/',
       note: null,
       created_at: Wed Oct 19 2016 20:21:51 GMT+0500 (YEKT),
       updated_at: Wed Oct 19 2016 20:21:51 GMT+0500 (YEKT),
       deleted_at: null,
       dom_id: '2',
       starshina_id: '2' } } ]
[2016-10-19 20:21:51.518] [INFO] console - Executing (bba239e6-c635-4221-a57e-79811d87072b): START TRANSACTION;
[2016-10-19 20:21:51.521] [INFO] console - [ 16,
  2589252795760640,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 2 } ]
[2016-10-19 20:21:51.529] [INFO] console - Executing (bba239e6-c635-4221-a57e-79811d87072b): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:21:51.540] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 75);
[2016-10-19 20:21:51.548] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 20:21:51.560] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:21:51.569] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 20:21:51.581] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"=NULL,"updated_at"='2016-10-19 15:21:51.572 +00:00' WHERE "id" = '75'
[2016-10-19 20:21:51.586] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/2/', '/')
                                where
                                    id = '75'
                                    or path like '/2/75/'||'%'
[2016-10-19 20:21:51.592] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:21:51.596] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 20:21:51.607] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:21:51.616] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/75/'||'%'
[2016-10-19 20:21:51.634] [INFO] console - Executing (bba239e6-c635-4221-a57e-79811d87072b): COMMIT;
[2016-10-19 20:21:51.644] [INFO] console - [ 70, 488, {}, [ undefined ] ]
[2016-10-19 20:21:51.657] [INFO] console - [ 16,
  4846452469661696,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.druzhinaChange',
  [],
  { action: 'remove', KOPNIK: 75 } ]
[2016-10-19 20:21:51.675] [INFO] console - [ 16,
  5755098196082688,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 1 } ]
[2016-10-19 20:21:51.685] [DEBUG] Server - #promiseModel() [] { model: 'Kopa', id: 3 }
[2016-10-19 20:21:51.693] [INFO] console - Executing (b9c4a24f-271c-4c25-9e4a-9c0a25d82bcd): START TRANSACTION;
[2016-10-19 20:21:51.698] [INFO] console - Executing (b9c4a24f-271c-4c25-9e4a-9c0a25d82bcd): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:21:51.714] [INFO] console - Executing (default): SELECT "Kopa"."id", "Kopa"."question", "Kopa"."invited", "Kopa"."note", "Kopa"."created_at", "Kopa"."updated_at", "Kopa"."deleted_at", "Kopa"."place_id", "Kopa"."inviter_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopa" AS "Kopa" LEFT OUTER JOIN "File" AS "attachments" ON "Kopa"."id" = "attachments"."kopa_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopa"."deleted_at" IS NULL AND "Kopa"."id" = 3);
[2016-10-19 20:21:51.725] [INFO] console - Executing (b9c4a24f-271c-4c25-9e4a-9c0a25d82bcd): COMMIT;
[2016-10-19 20:21:51.728] [INFO] console - [ 70,
  489,
  {},
  [ { id: '3',
      question: 'CHE',
      invited: Thu Sep 01 2016 00:00:00 GMT+0500 (YEKT),
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      place_id: '2',
      inviter_id: '2',
      attachments: [] } ] ]
[2016-10-19 20:21:51.755] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 20:21:51.764] [INFO] console - Executing (8eab323d-4be8-48f8-8095-87ae25427156): START TRANSACTION;
[2016-10-19 20:21:51.767] [INFO] console - Executing (8eab323d-4be8-48f8-8095-87ae25427156): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:21:51.782] [INFO] console - Executing (8eab323d-4be8-48f8-8095-87ae25427156): INSERT INTO "Predlozhenie" ("id","value","totalZa","totalProtiv","created_at","updated_at","author_id","place_id") VALUES (DEFAULT,'temp Wed Oct 19 2016 20:21:51 GMT+0500 (YEKT)',0,0,'2016-10-19 15:21:51.772 +00:00','2016-10-19 15:21:51.772 +00:00',2,3) RETURNING *;
[2016-10-19 20:21:51.790] [INFO] console - Executing (8eab323d-4be8-48f8-8095-87ae25427156): COMMIT;
[2016-10-19 20:21:51.794] [INFO] console - [ 70, 490, {}, [ '18' ] ]
[2016-10-19 20:21:51.800] [INFO] console - [ 16,
  1323106125742080,
  { acknowledge: true },
  'ru.kopa.model.Kopa.id3.predlozhenieAdd',
  [ '18' ] ]
[2016-10-19 20:21:51.821] [INFO] console - Executing (ecf66850-743e-4f6e-aaf7-0974968c6239): START TRANSACTION;
[2016-10-19 20:21:51.827] [INFO] console - Executing (ecf66850-743e-4f6e-aaf7-0974968c6239): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:21:51.841] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 20:21:51.856] [INFO] console - Executing (default): SELECT "id", "value", "totalZa", "totalProtiv", "state", "note", "created_at", "updated_at", "deleted_at", "author_id", "place_id" FROM "Predlozhenie" AS "Predlozhenie" WHERE ("Predlozhenie"."deleted_at" IS NULL AND "Predlozhenie"."id" = 18);
[2016-10-19 20:21:51.871] [INFO] console - Executing (default): SELECT "id", "question", "invited", "note", "created_at", "updated_at", "deleted_at", "place_id", "inviter_id" FROM "Kopa" AS "Kopa" WHERE ("Kopa"."deleted_at" IS NULL AND "Kopa"."id" = '3');
[2016-10-19 20:21:51.884] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:21:51.895] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:21:51.902] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 20:21:51.915] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:21:51.927] [INFO] console - Executing (default): SELECT "id", "value", "reason", "note", "created_at", "updated_at", "deleted_at", "subject_id", "owner_id", "parent_id" FROM "Golos" AS "Golos" WHERE ("Golos"."deleted_at" IS NULL AND ("Golos"."subject_id" = '18' AND "Golos"."owner_id" = '2')) LIMIT 1;
[2016-10-19 20:21:51.941] [INFO] console - Executing (default): INSERT INTO "Golos" ("id","value","created_at","updated_at","subject_id","owner_id") VALUES (DEFAULT,1,'2016-10-19 15:21:51.932 +00:00','2016-10-19 15:21:51.932 +00:00','18','2') RETURNING *;
[2016-10-19 20:21:51.964] [INFO] console - Executing (default): insert into "Golos" (subject_id, value, owner_id, parent_id, created_at, updated_at)
                            (
                                select 18, 1, k.id, 51, current_timestamp, current_timestamp
                                from 
                                    "Kopnik" k
                                     join "Zemla" d on d.id= k.dom_id
                                where
                                    k.path like '/2/%'
                                    and d.path||d.id||'/' like '/1/2/%' 
                            )
[2016-10-19 20:21:51.972] [INFO] console - Executing (default): select
                            (select count(*) from "Golos" g where subject_id= 18 and value=1) "za",
                            (select count(*) from "Golos" g where subject_id= 18 and value=-1) "protiv"
[2016-10-19 20:21:51.984] [INFO] console - Executing (default): UPDATE "Predlozhenie" SET "totalZa"=2,"updated_at"='2016-10-19 15:21:51.976 +00:00' WHERE "id" = '18'
[2016-10-19 20:21:51.992] [INFO] console - Executing (ecf66850-743e-4f6e-aaf7-0974968c6239): COMMIT;
[2016-10-19 20:21:51.996] [INFO] console - [ 70, 491, {}, [ undefined ] ]
[2016-10-19 20:21:52.007] [INFO] console - [ 16,
  606407705493504,
  { acknowledge: true },
  'ru.kopa.model.Predlozhenie.id18.rebalance',
  [],
  { totalZa: 2,
    totalProtiv: 0,
    GOLOS: '51',
    action: 'add',
    value: 1 } ]
[2016-10-19 20:21:52.025] [INFO] console - Executing (cf6f6bc5-fc22-45b9-ada0-09d13964e697): START TRANSACTION;
[2016-10-19 20:21:52.028] [INFO] console - Executing (cf6f6bc5-fc22-45b9-ada0-09d13964e697): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:21:52.041] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 20:21:52.061] [INFO] console - Executing (default): SELECT "id", "value", "totalZa", "totalProtiv", "state", "note", "created_at", "updated_at", "deleted_at", "author_id", "place_id" FROM "Predlozhenie" AS "Predlozhenie" WHERE ("Predlozhenie"."deleted_at" IS NULL AND "Predlozhenie"."id" = 18);
[2016-10-19 20:21:52.077] [INFO] console - Executing (default): SELECT "id", "question", "invited", "note", "created_at", "updated_at", "deleted_at", "place_id", "inviter_id" FROM "Kopa" AS "Kopa" WHERE ("Kopa"."deleted_at" IS NULL AND "Kopa"."id" = '3');
[2016-10-19 20:21:52.094] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:21:52.105] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:21:52.115] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 20:21:52.129] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:21:52.151] [INFO] console - Executing (default): SELECT "id", "value", "reason", "note", "created_at", "updated_at", "deleted_at", "subject_id", "owner_id", "parent_id" FROM "Golos" AS "Golos" WHERE ("Golos"."deleted_at" IS NULL AND ("Golos"."subject_id" = '18' AND "Golos"."owner_id" = '2')) LIMIT 1;
[2016-10-19 20:21:52.173] [INFO] console - Executing (default): delete from "Golos" 
                            where
                                subject_id= 18
                                and (
                                    id= 51
                                    or parent_id = 51
                                )
[2016-10-19 20:21:52.181] [INFO] console - Executing (default): select
                            (select count(*) from "Golos" g where subject_id= 18 and value=1) "za",
                            (select count(*) from "Golos" g where subject_id= 18 and value=-1) "protiv"
[2016-10-19 20:21:52.194] [INFO] console - Executing (default): UPDATE "Predlozhenie" SET "totalZa"=0,"updated_at"='2016-10-19 15:21:52.186 +00:00' WHERE "id" = '18'
[2016-10-19 20:21:52.200] [INFO] console - Executing (cf6f6bc5-fc22-45b9-ada0-09d13964e697): COMMIT;
[2016-10-19 20:21:52.203] [INFO] console - [ 70, 492, {}, [ undefined ] ]
[2016-10-19 20:21:52.210] [INFO] console - [ 16,
  2017450486923264,
  { acknowledge: true },
  'ru.kopa.model.Predlozhenie.id18.rebalance',
  [],
  { totalZa: 0,
    totalProtiv: 0,
    GOLOS: '51',
    action: 'remove',
    value: 1 } ]
[2016-10-19 20:21:52.225] [INFO] console - Executing (6f62f226-e4d9-40a2-be3a-fad9fadecb99): START TRANSACTION;
[2016-10-19 20:21:52.228] [INFO] console - Executing (6f62f226-e4d9-40a2-be3a-fad9fadecb99): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:21:52.237] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 20:21:52.265] [INFO] console - Executing (default): SELECT "id", "value", "totalZa", "totalProtiv", "state", "note", "created_at", "updated_at", "deleted_at", "author_id", "place_id" FROM "Predlozhenie" AS "Predlozhenie" WHERE ("Predlozhenie"."deleted_at" IS NULL AND "Predlozhenie"."id" = 18);
[2016-10-19 20:21:52.286] [INFO] console - Executing (default): SELECT "id", "question", "invited", "note", "created_at", "updated_at", "deleted_at", "place_id", "inviter_id" FROM "Kopa" AS "Kopa" WHERE ("Kopa"."deleted_at" IS NULL AND "Kopa"."id" = '3');
[2016-10-19 20:21:52.318] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:21:52.351] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:21:52.375] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 20:21:52.395] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:21:52.419] [INFO] console - Executing (default): SELECT "id", "value", "reason", "note", "created_at", "updated_at", "deleted_at", "subject_id", "owner_id", "parent_id" FROM "Golos" AS "Golos" WHERE ("Golos"."deleted_at" IS NULL AND ("Golos"."subject_id" = '18' AND "Golos"."owner_id" = '2')) LIMIT 1;
[2016-10-19 20:21:52.481] [INFO] console - Executing (default): INSERT INTO "Golos" ("id","value","created_at","updated_at","subject_id","owner_id") VALUES (DEFAULT,-1,'2016-10-19 15:21:52.433 +00:00','2016-10-19 15:21:52.433 +00:00','18','2') RETURNING *;
[2016-10-19 20:21:52.504] [INFO] console - Executing (default): insert into "Golos" (subject_id, value, owner_id, parent_id, created_at, updated_at)
                            (
                                select 18, -1, k.id, 53, current_timestamp, current_timestamp
                                from 
                                    "Kopnik" k
                                     join "Zemla" d on d.id= k.dom_id
                                where
                                    k.path like '/2/%'
                                    and d.path||d.id||'/' like '/1/2/%' 
                            )
[2016-10-19 20:21:52.508] [INFO] console - Executing (default): select
                            (select count(*) from "Golos" g where subject_id= 18 and value=1) "za",
                            (select count(*) from "Golos" g where subject_id= 18 and value=-1) "protiv"
[2016-10-19 20:21:52.522] [INFO] console - Executing (default): UPDATE "Predlozhenie" SET "totalProtiv"=2,"updated_at"='2016-10-19 15:21:52.512 +00:00' WHERE "id" = '18'
[2016-10-19 20:21:52.528] [INFO] console - Executing (6f62f226-e4d9-40a2-be3a-fad9fadecb99): COMMIT;
[2016-10-19 20:21:52.532] [INFO] console - [ 70, 493, {}, [ undefined ] ]
[2016-10-19 20:21:52.537] [INFO] console - [ 16,
  3443064324489216,
  { acknowledge: true },
  'ru.kopa.model.Predlozhenie.id18.rebalance',
  [],
  { totalZa: 0,
    totalProtiv: 2,
    GOLOS: '53',
    action: 'add',
    value: -1 } ]
[2016-10-19 20:25:18.502] [INFO] console - [ 70, 495, {}, [ undefined ] ]
[2016-10-19 20:25:18.544] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 2 }
[2016-10-19 20:25:18.588] [INFO] console - Executing (default): delete from "Kopnik"
                where
                    name like '%temp'
                    or name like 'temp%'
[2016-10-19 20:25:18.622] [INFO] console - Executing (a7e147ec-6c0a-480a-a10e-430770160951): START TRANSACTION;
[2016-10-19 20:25:18.638] [INFO] console - Executing (default): update "Kopnik"
                set 
                    "voiskoSize"= case when id=2 then 1 ELSE 0 END
                where
                    id>1 
                    and id<=5
[2016-10-19 20:25:18.640] [INFO] console - Executing (a7e147ec-6c0a-480a-a10e-430770160951): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:25:18.710] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 20:25:18.746] [INFO] console - Executing (a7e147ec-6c0a-480a-a10e-430770160951): COMMIT;
[2016-10-19 20:25:18.754] [INFO] console - [ 70,
  496,
  {},
  [ { fullName: 'Unit Test',
      fullPath: '/2/',
      id: '2',
      email: 'unittest2@domain.ru',
      name: 'Unit',
      surname: 'Test',
      patronymic: '1',
      voiskoSize: 1,
      birth: 1983,
      path: '/',
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: null,
      attachments: [] } ] ]
[2016-10-19 20:25:18.856] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."starshina_id" = 2) ORDER BY "Kopnik"."surname" asc, "Kopnik"."name" asc, "Kopnik"."patronymic" asc;
[2016-10-19 20:25:18.906] [INFO] console - [ 70, 497, {}, [ [ [Object], [Object] ] ] ]
[2016-10-19 20:25:18.983] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 20:25:18.994] [INFO] console - Executing (94b688ec-ff5a-42b8-b730-aec1674a8048): START TRANSACTION;
[2016-10-19 20:25:18.998] [INFO] console - Executing (94b688ec-ff5a-42b8-b730-aec1674a8048): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:25:19.025] [INFO] console - Executing (94b688ec-ff5a-42b8-b730-aec1674a8048): INSERT INTO "Kopnik" ("id","name","surname","patronymic","voiskoSize","birth","path","created_at","updated_at","dom_id","starshina_id") VALUES (DEFAULT,'temp','temp','temp',0,1900,'/','2016-10-19 15:25:19.002 +00:00','2016-10-19 15:25:19.002 +00:00',2,NULL) RETURNING *;
[2016-10-19 20:25:19.035] [INFO] console - Executing (94b688ec-ff5a-42b8-b730-aec1674a8048): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:25:19.047] [INFO] console - Executing (94b688ec-ff5a-42b8-b730-aec1674a8048): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:25:19.055] [INFO] console - Executing (94b688ec-ff5a-42b8-b730-aec1674a8048): update "Zemla"
                                    set "obshinaSize"= "obshinaSize"+ 1
                                where
                                    '/1/' like path||id||'/%'
                                    or (
                                        true 
                                        and id= 2
                                    )
[2016-10-19 20:25:19.061] [INFO] console - Executing (94b688ec-ff5a-42b8-b730-aec1674a8048): COMMIT;
[2016-10-19 20:25:19.068] [INFO] console - [ 70, 498, {}, [ '76' ] ]
[2016-10-19 20:25:19.088] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:25:19.097] [INFO] console - Executing (default): select z.*
                                    from "Zemla" as z
                                where
                                    '/1/' like z.path||z.id||'/%'
[2016-10-19 20:25:19.128] [INFO] console - Executing (d834d7ed-6d33-46a3-911b-dd7ab4235ace): START TRANSACTION;
[2016-10-19 20:25:19.136] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" IN ('1')) ORDER BY "Zemla"."path" desc;
[2016-10-19 20:25:19.140] [INFO] console - Executing (d834d7ed-6d33-46a3-911b-dd7ab4235ace): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:25:19.161] [INFO] console - [ 16,
  8912120034885632,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id2.obshinaChange',
  [],
  { obshinaSize: 74 } ]
[2016-10-19 20:25:19.175] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 76);
[2016-10-19 20:25:19.178] [INFO] console - [ 16,
  7712436559806464,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id1.obshinaChange',
  [],
  { obshinaSize: 76 } ]
[2016-10-19 20:25:19.202] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 20:25:19.218] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 20:25:19.235] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:25:19.242] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:25:19.261] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='2',"updated_at"='2016-10-19 15:25:19.247 +00:00' WHERE "id" = '76'
[2016-10-19 20:25:19.266] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/', '/2/')
                                where
                                    id = '76'
                                    or path like '/76/'||'%'
[2016-10-19 20:25:19.273] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 20:25:19.280] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 20:25:19.291] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:25:19.302] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/2/76/'||'%'
[2016-10-19 20:25:19.307] [INFO] console - Executing (d834d7ed-6d33-46a3-911b-dd7ab4235ace): COMMIT;
[2016-10-19 20:25:19.312] [INFO] console - [ 70, 499, {}, [ undefined ] ]
[2016-10-19 20:25:19.326] [INFO] console - [ 16,
  4908396637585408,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.druzhinaChange',
  [],
  { action: 'add',
    kopnik: 
     { fullName: 'temp temp',
       fullPath: '/2/76/',
       id: '76',
       email: null,
       password: null,
       name: 'temp',
       surname: 'temp',
       patronymic: 'temp',
       voiskoSize: 0,
       birth: 1900,
       path: '/2/',
       note: null,
       created_at: Wed Oct 19 2016 20:25:19 GMT+0500 (YEKT),
       updated_at: Wed Oct 19 2016 20:25:19 GMT+0500 (YEKT),
       deleted_at: null,
       dom_id: '2',
       starshina_id: '2' } } ]
[2016-10-19 20:25:19.349] [INFO] console - [ 16,
  6123042522529792,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 2 } ]
[2016-10-19 20:25:19.368] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 20:25:19.378] [INFO] console - Executing (49ba39e4-7b3e-4132-9d0c-887925ebed8e): START TRANSACTION;
[2016-10-19 20:25:19.383] [INFO] console - Executing (49ba39e4-7b3e-4132-9d0c-887925ebed8e): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:25:19.400] [INFO] console - Executing (49ba39e4-7b3e-4132-9d0c-887925ebed8e): INSERT INTO "Kopnik" ("id","name","surname","patronymic","voiskoSize","birth","path","created_at","updated_at","dom_id","starshina_id") VALUES (DEFAULT,'temp','temp','temp',0,1900,'/','2016-10-19 15:25:19.388 +00:00','2016-10-19 15:25:19.388 +00:00',2,NULL) RETURNING *;
[2016-10-19 20:25:19.408] [INFO] console - Executing (49ba39e4-7b3e-4132-9d0c-887925ebed8e): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:25:19.421] [INFO] console - Executing (49ba39e4-7b3e-4132-9d0c-887925ebed8e): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:25:19.429] [INFO] console - Executing (49ba39e4-7b3e-4132-9d0c-887925ebed8e): update "Zemla"
                                    set "obshinaSize"= "obshinaSize"+ 1
                                where
                                    '/1/' like path||id||'/%'
                                    or (
                                        true 
                                        and id= 2
                                    )
[2016-10-19 20:25:19.434] [INFO] console - Executing (49ba39e4-7b3e-4132-9d0c-887925ebed8e): COMMIT;
[2016-10-19 20:25:19.438] [INFO] console - [ 70, 500, {}, [ '77' ] ]
[2016-10-19 20:25:19.465] [INFO] console - Executing (8eca1646-a956-4b3c-8ebd-314a15e2abd6): START TRANSACTION;
[2016-10-19 20:25:19.473] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:25:19.484] [INFO] console - Executing (8eca1646-a956-4b3c-8ebd-314a15e2abd6): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:25:19.489] [INFO] console - Executing (default): select z.*
                                    from "Zemla" as z
                                where
                                    '/1/' like z.path||z.id||'/%'
[2016-10-19 20:25:19.502] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 77);
[2016-10-19 20:25:19.517] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" IN ('1')) ORDER BY "Zemla"."path" desc;
[2016-10-19 20:25:19.533] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 76);
[2016-10-19 20:25:19.534] [INFO] console - [ 16,
  8219164556656640,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id2.obshinaChange',
  [],
  { obshinaSize: 75 } ]
[2016-10-19 20:25:19.548] [INFO] console - [ 16,
  1265419851661312,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id1.obshinaChange',
  [],
  { obshinaSize: 77 } ]
[2016-10-19 20:25:19.562] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 20:25:19.576] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:25:19.583] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:25:19.601] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='76',"updated_at"='2016-10-19 15:25:19.586 +00:00' WHERE "id" = '77'
[2016-10-19 20:25:19.609] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/', '/2/76/')
                                where
                                    id = '77'
                                    or path like '/77/'||'%'
[2016-10-19 20:25:19.613] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/2/76/' like path||id||'/%'
[2016-10-19 20:25:19.621] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/76/' like k.path||k.id||'/%'
[2016-10-19 20:25:19.638] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('76', '2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:25:19.646] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/2/76/77/'||'%'
[2016-10-19 20:25:19.651] [INFO] console - Executing (8eca1646-a956-4b3c-8ebd-314a15e2abd6): COMMIT;
[2016-10-19 20:25:19.654] [INFO] console - [ 70, 501, {}, [ undefined ] ]
[2016-10-19 20:25:19.659] [INFO] console - [ 16,
  2408126980554752,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id76.druzhinaChange',
  [],
  { action: 'add',
    kopnik: 
     { fullName: 'temp temp',
       fullPath: '/2/76/77/',
       id: '77',
       email: null,
       password: null,
       name: 'temp',
       surname: 'temp',
       patronymic: 'temp',
       voiskoSize: 0,
       birth: 1900,
       path: '/2/76/',
       note: null,
       created_at: Wed Oct 19 2016 20:25:19 GMT+0500 (YEKT),
       updated_at: Wed Oct 19 2016 20:25:19 GMT+0500 (YEKT),
       deleted_at: null,
       dom_id: '2',
       starshina_id: '76' } } ]
[2016-10-19 20:25:19.675] [INFO] console - [ 16,
  2018769402593280,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id76.voiskoChange',
  [],
  { voiskoSize: 1 } ]
[2016-10-19 20:25:19.684] [INFO] console - [ 16,
  7634356648542208,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 3 } ]
[2016-10-19 20:25:19.697] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 4 }
[2016-10-19 20:25:19.704] [INFO] console - Executing (9d75f0ea-0f0d-4bf8-aedb-0032d86f82f3): START TRANSACTION;
[2016-10-19 20:25:19.708] [INFO] console - Executing (9d75f0ea-0f0d-4bf8-aedb-0032d86f82f3): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:25:19.730] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 4);
[2016-10-19 20:25:19.741] [INFO] console - Executing (9d75f0ea-0f0d-4bf8-aedb-0032d86f82f3): COMMIT;
[2016-10-19 20:25:19.745] [INFO] console - [ 70,
  502,
  {},
  [ { fullName: 'Unit Test',
      fullPath: '/4/',
      id: '4',
      email: 'unittest4@domain.ru',
      name: 'Unit',
      surname: 'Test',
      patronymic: '4',
      voiskoSize: 0,
      birth: 1983,
      path: '/',
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: null,
      attachments: [] } ] ]
[2016-10-19 20:25:19.770] [INFO] console - Executing (be6ffe58-3eb2-4dc2-9d8a-749318ed8b34): START TRANSACTION;
[2016-10-19 20:25:19.773] [INFO] console - Executing (be6ffe58-3eb2-4dc2-9d8a-749318ed8b34): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:25:19.781] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 76);
[2016-10-19 20:25:19.794] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 4);
[2016-10-19 20:25:19.808] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 20:25:19.834] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:25:19.848] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-2
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 20:25:19.864] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='4',"updated_at"='2016-10-19 15:25:19.851 +00:00' WHERE "id" = '76'
[2016-10-19 20:25:19.869] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/2/', '/4/')
                                where
                                    id = '76'
                                    or path like '/2/76/'||'%'
[2016-10-19 20:25:19.874] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+2
                                where
                                    '/4/' like path||id||'/%'
[2016-10-19 20:25:19.880] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/4/' like k.path||k.id||'/%'
[2016-10-19 20:25:19.890] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('4')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:25:19.897] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/4/76/'||'%'
[2016-10-19 20:25:19.903] [INFO] console - Executing (be6ffe58-3eb2-4dc2-9d8a-749318ed8b34): COMMIT;
[2016-10-19 20:25:19.909] [INFO] console - [ 70, 503, {}, [ undefined ] ]
[2016-10-19 20:25:19.913] [INFO] console - [ 16,
  3556007452082176,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.druzhinaChange',
  [],
  { action: 'remove', KOPNIK: 76 } ]
[2016-10-19 20:25:19.926] [INFO] console - [ 16,
  7051750821330944,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id4.druzhinaChange',
  [],
  { action: 'add',
    kopnik: 
     { fullName: 'temp temp',
       fullPath: '/4/76/',
       id: '76',
       email: null,
       password: null,
       name: 'temp',
       surname: 'temp',
       patronymic: 'temp',
       voiskoSize: 1,
       birth: 1900,
       path: '/4/',
       note: null,
       created_at: Wed Oct 19 2016 20:25:19 GMT+0500 (YEKT),
       updated_at: Wed Oct 19 2016 20:25:19 GMT+0500 (YEKT),
       deleted_at: null,
       dom_id: '2',
       starshina_id: '4' } } ]
[2016-10-19 20:25:19.941] [INFO] console - [ 16,
  4072134412337152,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 1 } ]
[2016-10-19 20:25:19.951] [INFO] console - [ 16,
  4044979617923072,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id4.voiskoChange',
  [],
  { voiskoSize: 2 } ]
[2016-10-19 20:25:19.960] [INFO] console - [ 16,
  8133443240067072,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id77.starshinaChange',
  [],
  {} ]
[2016-10-19 20:25:19.974] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 77 }
[2016-10-19 20:25:19.980] [INFO] console - Executing (11ee4eb7-a00e-48cb-be9b-dc8052a122ce): START TRANSACTION;
[2016-10-19 20:25:19.983] [INFO] console - Executing (11ee4eb7-a00e-48cb-be9b-dc8052a122ce): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:25:19.999] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 77);
[2016-10-19 20:25:20.011] [INFO] console - Executing (11ee4eb7-a00e-48cb-be9b-dc8052a122ce): COMMIT;
[2016-10-19 20:25:20.015] [INFO] console - [ 70,
  504,
  {},
  [ { fullName: 'temp temp',
      fullPath: '/4/76/77/',
      id: '77',
      email: null,
      name: 'temp',
      surname: 'temp',
      patronymic: 'temp',
      voiskoSize: 0,
      birth: 1900,
      path: '/4/76/',
      note: null,
      created_at: Wed Oct 19 2016 20:25:19 GMT+0500 (YEKT),
      updated_at: Wed Oct 19 2016 20:25:19 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: '76',
      attachments: [] } ] ]
[2016-10-19 20:25:20.035] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 76 }
[2016-10-19 20:25:20.042] [INFO] console - Executing (c204d483-ee75-4968-95c2-01cef9becf2a): START TRANSACTION;
[2016-10-19 20:25:20.045] [INFO] console - Executing (c204d483-ee75-4968-95c2-01cef9becf2a): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:25:20.064] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 76);
[2016-10-19 20:25:20.074] [INFO] console - Executing (c204d483-ee75-4968-95c2-01cef9becf2a): COMMIT;
[2016-10-19 20:25:20.078] [INFO] console - [ 70,
  505,
  {},
  [ { fullName: 'temp temp',
      fullPath: '/4/76/',
      id: '76',
      email: null,
      name: 'temp',
      surname: 'temp',
      patronymic: 'temp',
      voiskoSize: 1,
      birth: 1900,
      path: '/4/',
      note: null,
      created_at: Wed Oct 19 2016 20:25:19 GMT+0500 (YEKT),
      updated_at: Wed Oct 19 2016 20:25:19 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: '4',
      attachments: [] } ] ]
[2016-10-19 20:25:20.101] [INFO] console - Executing (9934cf37-3792-4eba-85e6-77cca534cf13): START TRANSACTION;
[2016-10-19 20:25:20.104] [INFO] console - Executing (9934cf37-3792-4eba-85e6-77cca534cf13): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:25:20.113] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 76);
[2016-10-19 20:25:20.123] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/4/' like k.path||k.id||'/%'
[2016-10-19 20:25:20.134] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('4')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:25:20.142] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-2
                                where
                                    '/4/' like path||id||'/%'
[2016-10-19 20:25:20.158] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"=NULL,"updated_at"='2016-10-19 15:25:20.146 +00:00' WHERE "id" = '76'
[2016-10-19 20:25:20.165] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/4/', '/')
                                where
                                    id = '76'
                                    or path like '/4/76/'||'%'
[2016-10-19 20:25:20.170] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+2
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:25:20.174] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 20:25:20.184] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:25:20.190] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/76/'||'%'
[2016-10-19 20:25:20.196] [INFO] console - Executing (9934cf37-3792-4eba-85e6-77cca534cf13): COMMIT;
[2016-10-19 20:25:20.201] [INFO] console - [ 70, 506, {}, [ undefined ] ]
[2016-10-19 20:25:20.212] [INFO] console - [ 16,
  1470967192748032,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id4.druzhinaChange',
  [],
  { action: 'remove', KOPNIK: 76 } ]
[2016-10-19 20:25:20.223] [INFO] console - [ 16,
  6759866313998336,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id4.voiskoChange',
  [],
  { voiskoSize: 0 } ]
[2016-10-19 20:25:20.230] [INFO] console - [ 16,
  3304086969516032,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id77.starshinaChange',
  [],
  {} ]
[2016-10-19 20:25:20.257] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 20:25:20.266] [INFO] console - Executing (6ccd056f-e84d-41e0-9e83-4aa7ca80afcd): START TRANSACTION;
[2016-10-19 20:25:20.269] [INFO] console - Executing (6ccd056f-e84d-41e0-9e83-4aa7ca80afcd): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:25:20.290] [INFO] console - Executing (6ccd056f-e84d-41e0-9e83-4aa7ca80afcd): INSERT INTO "Kopnik" ("id","name","surname","patronymic","voiskoSize","birth","path","created_at","updated_at","dom_id","starshina_id") VALUES (DEFAULT,'temp','temp','temp',0,1900,'/','2016-10-19 15:25:20.275 +00:00','2016-10-19 15:25:20.275 +00:00',2,NULL) RETURNING *;
[2016-10-19 20:25:20.297] [INFO] console - Executing (6ccd056f-e84d-41e0-9e83-4aa7ca80afcd): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:25:20.304] [INFO] console - Executing (6ccd056f-e84d-41e0-9e83-4aa7ca80afcd): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:25:20.311] [INFO] console - Executing (6ccd056f-e84d-41e0-9e83-4aa7ca80afcd): update "Zemla"
                                    set "obshinaSize"= "obshinaSize"+ 1
                                where
                                    '/1/' like path||id||'/%'
                                    or (
                                        true 
                                        and id= 2
                                    )
[2016-10-19 20:25:20.316] [INFO] console - Executing (6ccd056f-e84d-41e0-9e83-4aa7ca80afcd): COMMIT;
[2016-10-19 20:25:20.321] [INFO] console - [ 70, 507, {}, [ '78' ] ]
[2016-10-19 20:25:20.340] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:25:20.350] [INFO] console - Executing (4146c5ce-2ef2-477b-8c1d-b8740f50c69a): START TRANSACTION;
[2016-10-19 20:25:20.356] [INFO] console - Executing (default): select z.*
                                    from "Zemla" as z
                                where
                                    '/1/' like z.path||z.id||'/%'
[2016-10-19 20:25:20.360] [INFO] console - Executing (4146c5ce-2ef2-477b-8c1d-b8740f50c69a): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:25:20.375] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" IN ('1')) ORDER BY "Zemla"."path" desc;
[2016-10-19 20:25:20.379] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 78);
[2016-10-19 20:25:20.389] [INFO] console - [ 16,
  1573439538200576,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id2.obshinaChange',
  [],
  { obshinaSize: 76 } ]
[2016-10-19 20:25:20.398] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 20:25:20.400] [INFO] console - [ 16,
  900295546634240,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id1.obshinaChange',
  [],
  { obshinaSize: 78 } ]
[2016-10-19 20:25:20.411] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 20:25:20.423] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:25:20.429] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:25:20.445] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='2',"updated_at"='2016-10-19 15:25:20.433 +00:00' WHERE "id" = '78'
[2016-10-19 20:25:20.452] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/', '/2/')
                                where
                                    id = '78'
                                    or path like '/78/'||'%'
[2016-10-19 20:25:20.456] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 20:25:20.460] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 20:25:20.472] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:25:20.479] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/2/78/'||'%'
[2016-10-19 20:25:20.485] [INFO] console - Executing (4146c5ce-2ef2-477b-8c1d-b8740f50c69a): COMMIT;
[2016-10-19 20:25:20.488] [INFO] console - [ 70, 508, {}, [ undefined ] ]
[2016-10-19 20:25:20.492] [INFO] console - [ 16,
  6812578420359168,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.druzhinaChange',
  [],
  { action: 'add',
    kopnik: 
     { fullName: 'temp temp',
       fullPath: '/2/78/',
       id: '78',
       email: null,
       password: null,
       name: 'temp',
       surname: 'temp',
       patronymic: 'temp',
       voiskoSize: 0,
       birth: 1900,
       path: '/2/',
       note: null,
       created_at: Wed Oct 19 2016 20:25:20 GMT+0500 (YEKT),
       updated_at: Wed Oct 19 2016 20:25:20 GMT+0500 (YEKT),
       deleted_at: null,
       dom_id: '2',
       starshina_id: '2' } } ]
[2016-10-19 20:25:20.507] [INFO] console - Executing (13f1fe77-65d3-44c7-b8b2-b7de5b712e6a): START TRANSACTION;
[2016-10-19 20:25:20.509] [INFO] console - [ 16,
  8781194892148736,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 2 } ]
[2016-10-19 20:25:20.515] [INFO] console - Executing (13f1fe77-65d3-44c7-b8b2-b7de5b712e6a): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:25:20.524] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 78);
[2016-10-19 20:25:20.533] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 20:25:20.547] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:25:20.557] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 20:25:20.575] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"=NULL,"updated_at"='2016-10-19 15:25:20.561 +00:00' WHERE "id" = '78'
[2016-10-19 20:25:20.581] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/2/', '/')
                                where
                                    id = '78'
                                    or path like '/2/78/'||'%'
[2016-10-19 20:25:20.585] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:25:20.590] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 20:25:20.606] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:25:20.612] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/78/'||'%'
[2016-10-19 20:25:20.617] [INFO] console - Executing (13f1fe77-65d3-44c7-b8b2-b7de5b712e6a): COMMIT;
[2016-10-19 20:25:20.619] [INFO] console - [ 70, 509, {}, [ undefined ] ]
[2016-10-19 20:25:20.626] [INFO] console - [ 16,
  3735510841294848,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.druzhinaChange',
  [],
  { action: 'remove', KOPNIK: 78 } ]
[2016-10-19 20:25:20.634] [INFO] console - [ 16,
  3621125638586368,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 1 } ]
[2016-10-19 20:25:20.644] [DEBUG] Server - #promiseModel() [] { model: 'Kopa', id: 3 }
[2016-10-19 20:25:20.656] [INFO] console - Executing (ae203db0-505a-4e31-b068-15fabddf2fde): START TRANSACTION;
[2016-10-19 20:25:20.661] [INFO] console - Executing (ae203db0-505a-4e31-b068-15fabddf2fde): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:25:20.680] [INFO] console - Executing (default): SELECT "Kopa"."id", "Kopa"."question", "Kopa"."invited", "Kopa"."note", "Kopa"."created_at", "Kopa"."updated_at", "Kopa"."deleted_at", "Kopa"."place_id", "Kopa"."inviter_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopa" AS "Kopa" LEFT OUTER JOIN "File" AS "attachments" ON "Kopa"."id" = "attachments"."kopa_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopa"."deleted_at" IS NULL AND "Kopa"."id" = 3);
[2016-10-19 20:25:20.692] [INFO] console - Executing (ae203db0-505a-4e31-b068-15fabddf2fde): COMMIT;
[2016-10-19 20:25:20.696] [INFO] console - [ 70,
  510,
  {},
  [ { id: '3',
      question: 'CHE',
      invited: Thu Sep 01 2016 00:00:00 GMT+0500 (YEKT),
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      place_id: '2',
      inviter_id: '2',
      attachments: [] } ] ]
[2016-10-19 20:25:20.724] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 20:25:20.732] [INFO] console - Executing (127bc522-134b-414d-ba29-d9c73c4997cd): START TRANSACTION;
[2016-10-19 20:25:20.735] [INFO] console - Executing (127bc522-134b-414d-ba29-d9c73c4997cd): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:25:20.748] [INFO] console - Executing (127bc522-134b-414d-ba29-d9c73c4997cd): INSERT INTO "Predlozhenie" ("id","value","totalZa","totalProtiv","created_at","updated_at","author_id","place_id") VALUES (DEFAULT,'temp Wed Oct 19 2016 20:25:20 GMT+0500 (YEKT)',0,0,'2016-10-19 15:25:20.739 +00:00','2016-10-19 15:25:20.739 +00:00',2,3) RETURNING *;
[2016-10-19 20:25:20.755] [INFO] console - Executing (127bc522-134b-414d-ba29-d9c73c4997cd): COMMIT;
[2016-10-19 20:25:20.759] [INFO] console - [ 70, 511, {}, [ '19' ] ]
[2016-10-19 20:25:20.765] [INFO] console - [ 16,
  5684046738751488,
  { acknowledge: true },
  'ru.kopa.model.Kopa.id3.predlozhenieAdd',
  [ '19' ] ]
[2016-10-19 20:25:20.782] [INFO] console - Executing (c209e808-cabb-4ad9-a41e-0a12ab5fa4e2): START TRANSACTION;
[2016-10-19 20:25:20.785] [INFO] console - Executing (c209e808-cabb-4ad9-a41e-0a12ab5fa4e2): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:25:20.796] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 20:25:20.807] [INFO] console - Executing (default): SELECT "id", "value", "totalZa", "totalProtiv", "state", "note", "created_at", "updated_at", "deleted_at", "author_id", "place_id" FROM "Predlozhenie" AS "Predlozhenie" WHERE ("Predlozhenie"."deleted_at" IS NULL AND "Predlozhenie"."id" = 19);
[2016-10-19 20:25:20.820] [INFO] console - Executing (default): SELECT "id", "question", "invited", "note", "created_at", "updated_at", "deleted_at", "place_id", "inviter_id" FROM "Kopa" AS "Kopa" WHERE ("Kopa"."deleted_at" IS NULL AND "Kopa"."id" = '3');
[2016-10-19 20:25:20.831] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:25:20.844] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:25:20.851] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 20:25:20.860] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:25:20.872] [INFO] console - Executing (default): SELECT "id", "value", "reason", "note", "created_at", "updated_at", "deleted_at", "subject_id", "owner_id", "parent_id" FROM "Golos" AS "Golos" WHERE ("Golos"."deleted_at" IS NULL AND ("Golos"."subject_id" = '19' AND "Golos"."owner_id" = '2')) LIMIT 1;
[2016-10-19 20:25:20.900] [INFO] console - Executing (default): INSERT INTO "Golos" ("id","value","created_at","updated_at","subject_id","owner_id") VALUES (DEFAULT,1,'2016-10-19 15:25:20.887 +00:00','2016-10-19 15:25:20.887 +00:00','19','2') RETURNING *;
[2016-10-19 20:25:20.911] [INFO] console - Executing (default): insert into "Golos" (subject_id, value, owner_id, parent_id, created_at, updated_at)
                            (
                                select 19, 1, k.id, 55, current_timestamp, current_timestamp
                                from 
                                    "Kopnik" k
                                     join "Zemla" d on d.id= k.dom_id
                                where
                                    k.path like '/2/%'
                                    and d.path||d.id||'/' like '/1/2/%' 
                            )
[2016-10-19 20:25:20.914] [INFO] console - Executing (default): select
                            (select count(*) from "Golos" g where subject_id= 19 and value=1) "za",
                            (select count(*) from "Golos" g where subject_id= 19 and value=-1) "protiv"
[2016-10-19 20:25:20.928] [INFO] console - Executing (default): UPDATE "Predlozhenie" SET "totalZa"=2,"updated_at"='2016-10-19 15:25:20.918 +00:00' WHERE "id" = '19'
[2016-10-19 20:25:20.932] [INFO] console - Executing (c209e808-cabb-4ad9-a41e-0a12ab5fa4e2): COMMIT;
[2016-10-19 20:25:20.935] [INFO] console - [ 70, 512, {}, [ undefined ] ]
[2016-10-19 20:25:20.941] [INFO] console - [ 16,
  8788531480625152,
  { acknowledge: true },
  'ru.kopa.model.Predlozhenie.id19.rebalance',
  [],
  { totalZa: 2,
    totalProtiv: 0,
    GOLOS: '55',
    action: 'add',
    value: 1 } ]
[2016-10-19 20:25:20.955] [INFO] console - Executing (1d27f027-06e7-4f65-a15d-a7f62af9fd26): START TRANSACTION;
[2016-10-19 20:25:20.959] [INFO] console - Executing (1d27f027-06e7-4f65-a15d-a7f62af9fd26): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:25:20.994] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 20:25:21.008] [INFO] console - Executing (default): SELECT "id", "value", "totalZa", "totalProtiv", "state", "note", "created_at", "updated_at", "deleted_at", "author_id", "place_id" FROM "Predlozhenie" AS "Predlozhenie" WHERE ("Predlozhenie"."deleted_at" IS NULL AND "Predlozhenie"."id" = 19);
[2016-10-19 20:25:21.025] [INFO] console - Executing (default): SELECT "id", "question", "invited", "note", "created_at", "updated_at", "deleted_at", "place_id", "inviter_id" FROM "Kopa" AS "Kopa" WHERE ("Kopa"."deleted_at" IS NULL AND "Kopa"."id" = '3');
[2016-10-19 20:25:21.046] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:25:21.065] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:25:21.073] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 20:25:21.086] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:25:21.097] [INFO] console - Executing (default): SELECT "id", "value", "reason", "note", "created_at", "updated_at", "deleted_at", "subject_id", "owner_id", "parent_id" FROM "Golos" AS "Golos" WHERE ("Golos"."deleted_at" IS NULL AND ("Golos"."subject_id" = '19' AND "Golos"."owner_id" = '2')) LIMIT 1;
[2016-10-19 20:25:21.111] [INFO] console - Executing (default): delete from "Golos" 
                            where
                                subject_id= 19
                                and (
                                    id= 55
                                    or parent_id = 55
                                )
[2016-10-19 20:25:21.114] [INFO] console - Executing (default): select
                            (select count(*) from "Golos" g where subject_id= 19 and value=1) "za",
                            (select count(*) from "Golos" g where subject_id= 19 and value=-1) "protiv"
[2016-10-19 20:25:21.131] [INFO] console - Executing (default): UPDATE "Predlozhenie" SET "totalZa"=0,"updated_at"='2016-10-19 15:25:21.120 +00:00' WHERE "id" = '19'
[2016-10-19 20:25:21.137] [INFO] console - Executing (1d27f027-06e7-4f65-a15d-a7f62af9fd26): COMMIT;
[2016-10-19 20:25:21.142] [INFO] console - [ 70, 513, {}, [ undefined ] ]
[2016-10-19 20:25:21.149] [INFO] console - [ 16,
  1837087481397248,
  { acknowledge: true },
  'ru.kopa.model.Predlozhenie.id19.rebalance',
  [],
  { totalZa: 0,
    totalProtiv: 0,
    GOLOS: '55',
    action: 'remove',
    value: 1 } ]
[2016-10-19 20:25:40.645] [INFO] console - Executing (958cfe12-d7b1-4b78-b45d-354a31ecb66d): START TRANSACTION;
[2016-10-19 20:25:40.649] [INFO] console - Executing (958cfe12-d7b1-4b78-b45d-354a31ecb66d): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:25:40.706] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 20:25:40.722] [INFO] console - Executing (default): SELECT "id", "value", "totalZa", "totalProtiv", "state", "note", "created_at", "updated_at", "deleted_at", "author_id", "place_id" FROM "Predlozhenie" AS "Predlozhenie" WHERE ("Predlozhenie"."deleted_at" IS NULL AND "Predlozhenie"."id" = 19);
[2016-10-19 20:25:40.743] [INFO] console - Executing (default): SELECT "id", "question", "invited", "note", "created_at", "updated_at", "deleted_at", "place_id", "inviter_id" FROM "Kopa" AS "Kopa" WHERE ("Kopa"."deleted_at" IS NULL AND "Kopa"."id" = '3');
[2016-10-19 20:25:40.760] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:25:40.777] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:25:40.785] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 20:25:40.796] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:25:40.812] [INFO] console - Executing (default): SELECT "id", "value", "reason", "note", "created_at", "updated_at", "deleted_at", "subject_id", "owner_id", "parent_id" FROM "Golos" AS "Golos" WHERE ("Golos"."deleted_at" IS NULL AND ("Golos"."subject_id" = '19' AND "Golos"."owner_id" = '2')) LIMIT 1;
[2016-10-19 20:25:40.827] [INFO] console - Executing (default): INSERT INTO "Golos" ("id","value","created_at","updated_at","subject_id","owner_id") VALUES (DEFAULT,-1,'2016-10-19 15:25:40.816 +00:00','2016-10-19 15:25:40.816 +00:00','19','2') RETURNING *;
[2016-10-19 20:25:40.846] [INFO] console - Executing (default): insert into "Golos" (subject_id, value, owner_id, parent_id, created_at, updated_at)
                            (
                                select 19, -1, k.id, 57, current_timestamp, current_timestamp
                                from 
                                    "Kopnik" k
                                     join "Zemla" d on d.id= k.dom_id
                                where
                                    k.path like '/2/%'
                                    and d.path||d.id||'/' like '/1/2/%' 
                            )
[2016-10-19 20:25:40.850] [INFO] console - Executing (default): select
                            (select count(*) from "Golos" g where subject_id= 19 and value=1) "za",
                            (select count(*) from "Golos" g where subject_id= 19 and value=-1) "protiv"
[2016-10-19 20:25:40.868] [INFO] console - Executing (default): UPDATE "Predlozhenie" SET "totalProtiv"=2,"updated_at"='2016-10-19 15:25:40.857 +00:00' WHERE "id" = '19'
[2016-10-19 20:25:40.873] [INFO] console - Executing (958cfe12-d7b1-4b78-b45d-354a31ecb66d): COMMIT;
[2016-10-19 20:25:40.877] [INFO] console - [ 70, 514, {}, [ undefined ] ]
[2016-10-19 20:25:40.883] [INFO] console - [ 16,
  6161082437599232,
  { acknowledge: true },
  'ru.kopa.model.Predlozhenie.id19.rebalance',
  [],
  { totalZa: 0,
    totalProtiv: 2,
    GOLOS: '57',
    action: 'add',
    value: -1 } ]
[2016-10-19 20:25:58.358] [INFO] console - [ 70, 516, {}, [ undefined ] ]
[2016-10-19 20:25:58.387] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 2 }
[2016-10-19 20:25:58.420] [INFO] console - Executing (default): delete from "Kopnik"
                where
                    name like '%temp'
                    or name like 'temp%'
[2016-10-19 20:25:58.436] [INFO] console - Executing (728495dc-50ca-4022-b78a-c5bfbecc0aad): START TRANSACTION;
[2016-10-19 20:25:58.441] [INFO] console - Executing (728495dc-50ca-4022-b78a-c5bfbecc0aad): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:25:58.490] [INFO] console - Executing (default): update "Kopnik"
                set 
                    "voiskoSize"= case when id=2 then 1 ELSE 0 END
                where
                    id>1 
                    and id<=5
[2016-10-19 20:25:58.500] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 20:25:58.514] [INFO] console - Executing (728495dc-50ca-4022-b78a-c5bfbecc0aad): COMMIT;
[2016-10-19 20:25:58.517] [INFO] console - [ 70,
  517,
  {},
  [ { fullName: 'Unit Test',
      fullPath: '/2/',
      id: '2',
      email: 'unittest2@domain.ru',
      name: 'Unit',
      surname: 'Test',
      patronymic: '1',
      voiskoSize: 1,
      birth: 1983,
      path: '/',
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: null,
      attachments: [] } ] ]
[2016-10-19 20:25:58.590] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."starshina_id" = 2) ORDER BY "Kopnik"."surname" asc, "Kopnik"."name" asc, "Kopnik"."patronymic" asc;
[2016-10-19 20:25:58.603] [INFO] console - [ 70, 518, {}, [ [ [Object], [Object] ] ] ]
[2016-10-19 20:25:58.662] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 20:25:58.673] [INFO] console - Executing (64210cc6-8c6a-407a-8ce0-d518707ddcce): START TRANSACTION;
[2016-10-19 20:25:58.675] [INFO] console - Executing (64210cc6-8c6a-407a-8ce0-d518707ddcce): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:25:58.706] [INFO] console - Executing (64210cc6-8c6a-407a-8ce0-d518707ddcce): INSERT INTO "Kopnik" ("id","name","surname","patronymic","voiskoSize","birth","path","created_at","updated_at","dom_id","starshina_id") VALUES (DEFAULT,'temp','temp','temp',0,1900,'/','2016-10-19 15:25:58.678 +00:00','2016-10-19 15:25:58.678 +00:00',2,NULL) RETURNING *;
[2016-10-19 20:25:58.724] [INFO] console - Executing (64210cc6-8c6a-407a-8ce0-d518707ddcce): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:25:58.740] [INFO] console - Executing (64210cc6-8c6a-407a-8ce0-d518707ddcce): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:25:58.749] [INFO] console - Executing (64210cc6-8c6a-407a-8ce0-d518707ddcce): update "Zemla"
                                    set "obshinaSize"= "obshinaSize"+ 1
                                where
                                    '/1/' like path||id||'/%'
                                    or (
                                        true 
                                        and id= 2
                                    )
[2016-10-19 20:25:58.755] [INFO] console - Executing (64210cc6-8c6a-407a-8ce0-d518707ddcce): COMMIT;
[2016-10-19 20:25:58.759] [INFO] console - [ 70, 519, {}, [ '79' ] ]
[2016-10-19 20:25:58.777] [INFO] console - Executing (54dad756-ab59-40c0-aa7d-92a292674c8e): START TRANSACTION;
[2016-10-19 20:25:58.785] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:25:58.791] [INFO] console - Executing (54dad756-ab59-40c0-aa7d-92a292674c8e): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:25:58.796] [INFO] console - Executing (default): select z.*
                                    from "Zemla" as z
                                where
                                    '/1/' like z.path||z.id||'/%'
[2016-10-19 20:25:58.807] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 79);
[2016-10-19 20:25:58.824] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" IN ('1')) ORDER BY "Zemla"."path" desc;
[2016-10-19 20:25:58.835] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 20:25:58.836] [INFO] console - [ 16,
  1021016201494528,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id2.obshinaChange',
  [],
  { obshinaSize: 77 } ]
[2016-10-19 20:25:58.847] [INFO] console - [ 16,
  621709388414976,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id1.obshinaChange',
  [],
  { obshinaSize: 79 } ]
[2016-10-19 20:25:58.860] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 20:25:58.875] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:25:58.884] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:25:58.899] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='2',"updated_at"='2016-10-19 15:25:58.888 +00:00' WHERE "id" = '79'
[2016-10-19 20:25:58.909] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/', '/2/')
                                where
                                    id = '79'
                                    or path like '/79/'||'%'
[2016-10-19 20:25:58.914] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 20:25:58.922] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 20:25:58.940] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:25:58.949] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/2/79/'||'%'
[2016-10-19 20:25:58.953] [INFO] console - Executing (54dad756-ab59-40c0-aa7d-92a292674c8e): COMMIT;
[2016-10-19 20:25:58.959] [INFO] console - [ 70, 520, {}, [ undefined ] ]
[2016-10-19 20:25:58.968] [INFO] console - [ 16,
  1209208766726144,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.druzhinaChange',
  [],
  { action: 'add',
    kopnik: 
     { fullName: 'temp temp',
       fullPath: '/2/79/',
       id: '79',
       email: null,
       password: null,
       name: 'temp',
       surname: 'temp',
       patronymic: 'temp',
       voiskoSize: 0,
       birth: 1900,
       path: '/2/',
       note: null,
       created_at: Wed Oct 19 2016 20:25:58 GMT+0500 (YEKT),
       updated_at: Wed Oct 19 2016 20:25:58 GMT+0500 (YEKT),
       deleted_at: null,
       dom_id: '2',
       starshina_id: '2' } } ]
[2016-10-19 20:25:58.987] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 20:25:59.004] [INFO] console - [ 16,
  3036300181504000,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 2 } ]
[2016-10-19 20:25:59.020] [INFO] console - Executing (47ae62c8-e86a-450b-972c-4f1792a73718): START TRANSACTION;
[2016-10-19 20:25:59.024] [INFO] console - Executing (47ae62c8-e86a-450b-972c-4f1792a73718): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:25:59.088] [INFO] console - Executing (47ae62c8-e86a-450b-972c-4f1792a73718): INSERT INTO "Kopnik" ("id","name","surname","patronymic","voiskoSize","birth","path","created_at","updated_at","dom_id","starshina_id") VALUES (DEFAULT,'temp','temp','temp',0,1900,'/','2016-10-19 15:25:59.028 +00:00','2016-10-19 15:25:59.028 +00:00',2,NULL) RETURNING *;
[2016-10-19 20:25:59.097] [INFO] console - Executing (47ae62c8-e86a-450b-972c-4f1792a73718): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:25:59.107] [INFO] console - Executing (47ae62c8-e86a-450b-972c-4f1792a73718): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:25:59.114] [INFO] console - Executing (47ae62c8-e86a-450b-972c-4f1792a73718): update "Zemla"
                                    set "obshinaSize"= "obshinaSize"+ 1
                                where
                                    '/1/' like path||id||'/%'
                                    or (
                                        true 
                                        and id= 2
                                    )
[2016-10-19 20:25:59.119] [INFO] console - Executing (47ae62c8-e86a-450b-972c-4f1792a73718): COMMIT;
[2016-10-19 20:25:59.122] [INFO] console - [ 70, 521, {}, [ '80' ] ]
[2016-10-19 20:25:59.140] [INFO] console - Executing (3236be3c-2a8c-4655-bc07-2df5c84ecf7a): START TRANSACTION;
[2016-10-19 20:25:59.145] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:25:59.148] [INFO] console - Executing (3236be3c-2a8c-4655-bc07-2df5c84ecf7a): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:25:59.158] [INFO] console - Executing (default): select z.*
                                    from "Zemla" as z
                                where
                                    '/1/' like z.path||z.id||'/%'
[2016-10-19 20:25:59.166] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 80);
[2016-10-19 20:25:59.183] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" IN ('1')) ORDER BY "Zemla"."path" desc;
[2016-10-19 20:25:59.185] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 79);
[2016-10-19 20:25:59.194] [INFO] console - [ 16,
  8192452504584192,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id2.obshinaChange',
  [],
  { obshinaSize: 78 } ]
[2016-10-19 20:25:59.201] [INFO] console - [ 16,
  2426352009478144,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id1.obshinaChange',
  [],
  { obshinaSize: 80 } ]
[2016-10-19 20:25:59.209] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 20:25:59.219] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:25:59.228] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:25:59.247] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='79',"updated_at"='2016-10-19 15:25:59.234 +00:00' WHERE "id" = '80'
[2016-10-19 20:25:59.254] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/', '/2/79/')
                                where
                                    id = '80'
                                    or path like '/80/'||'%'
[2016-10-19 20:25:59.268] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/2/79/' like path||id||'/%'
[2016-10-19 20:25:59.274] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/79/' like k.path||k.id||'/%'
[2016-10-19 20:25:59.285] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('79', '2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:25:59.293] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/2/79/80/'||'%'
[2016-10-19 20:25:59.298] [INFO] console - Executing (3236be3c-2a8c-4655-bc07-2df5c84ecf7a): COMMIT;
[2016-10-19 20:25:59.303] [INFO] console - [ 70, 522, {}, [ undefined ] ]
[2016-10-19 20:25:59.310] [INFO] console - [ 16,
  2569393009590272,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id79.druzhinaChange',
  [],
  { action: 'add',
    kopnik: 
     { fullName: 'temp temp',
       fullPath: '/2/79/80/',
       id: '80',
       email: null,
       password: null,
       name: 'temp',
       surname: 'temp',
       patronymic: 'temp',
       voiskoSize: 0,
       birth: 1900,
       path: '/2/79/',
       note: null,
       created_at: Wed Oct 19 2016 20:25:59 GMT+0500 (YEKT),
       updated_at: Wed Oct 19 2016 20:25:59 GMT+0500 (YEKT),
       deleted_at: null,
       dom_id: '2',
       starshina_id: '79' } } ]
[2016-10-19 20:25:59.329] [INFO] console - [ 16,
  4962413549977600,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id79.voiskoChange',
  [],
  { voiskoSize: 1 } ]
[2016-10-19 20:25:59.337] [INFO] console - [ 16,
  3353627494187008,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 3 } ]
[2016-10-19 20:25:59.351] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 4 }
[2016-10-19 20:25:59.357] [INFO] console - Executing (f6193d62-e3dd-4327-a19f-2d5204780d61): START TRANSACTION;
[2016-10-19 20:25:59.360] [INFO] console - Executing (f6193d62-e3dd-4327-a19f-2d5204780d61): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:25:59.376] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 4);
[2016-10-19 20:25:59.390] [INFO] console - Executing (f6193d62-e3dd-4327-a19f-2d5204780d61): COMMIT;
[2016-10-19 20:25:59.393] [INFO] console - [ 70,
  523,
  {},
  [ { fullName: 'Unit Test',
      fullPath: '/4/',
      id: '4',
      email: 'unittest4@domain.ru',
      name: 'Unit',
      surname: 'Test',
      patronymic: '4',
      voiskoSize: 0,
      birth: 1983,
      path: '/',
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: null,
      attachments: [] } ] ]
[2016-10-19 20:25:59.419] [INFO] console - Executing (a9d8eae6-6742-4289-a267-c250049b7a24): START TRANSACTION;
[2016-10-19 20:25:59.422] [INFO] console - Executing (a9d8eae6-6742-4289-a267-c250049b7a24): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:25:59.432] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 79);
[2016-10-19 20:25:59.449] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 4);
[2016-10-19 20:25:59.457] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 20:25:59.470] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:25:59.478] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-2
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 20:25:59.493] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='4',"updated_at"='2016-10-19 15:25:59.482 +00:00' WHERE "id" = '79'
[2016-10-19 20:25:59.503] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/2/', '/4/')
                                where
                                    id = '79'
                                    or path like '/2/79/'||'%'
[2016-10-19 20:25:59.511] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+2
                                where
                                    '/4/' like path||id||'/%'
[2016-10-19 20:25:59.516] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/4/' like k.path||k.id||'/%'
[2016-10-19 20:25:59.525] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('4')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:25:59.532] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/4/79/'||'%'
[2016-10-19 20:25:59.537] [INFO] console - Executing (a9d8eae6-6742-4289-a267-c250049b7a24): COMMIT;
[2016-10-19 20:25:59.540] [INFO] console - [ 70, 524, {}, [ undefined ] ]
[2016-10-19 20:25:59.545] [INFO] console - [ 16,
  7651723613044736,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.druzhinaChange',
  [],
  { action: 'remove', KOPNIK: 79 } ]
[2016-10-19 20:25:59.554] [INFO] console - [ 16,
  1886169241485312,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id4.druzhinaChange',
  [],
  { action: 'add',
    kopnik: 
     { fullName: 'temp temp',
       fullPath: '/4/79/',
       id: '79',
       email: null,
       password: null,
       name: 'temp',
       surname: 'temp',
       patronymic: 'temp',
       voiskoSize: 1,
       birth: 1900,
       path: '/4/',
       note: null,
       created_at: Wed Oct 19 2016 20:25:58 GMT+0500 (YEKT),
       updated_at: Wed Oct 19 2016 20:25:59 GMT+0500 (YEKT),
       deleted_at: null,
       dom_id: '2',
       starshina_id: '4' } } ]
[2016-10-19 20:25:59.568] [INFO] console - [ 16,
  5463054292615168,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 1 } ]
[2016-10-19 20:25:59.575] [INFO] console - [ 16,
  3878538474160128,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id4.voiskoChange',
  [],
  { voiskoSize: 2 } ]
[2016-10-19 20:25:59.583] [INFO] console - [ 16,
  7482404256088064,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id80.starshinaChange',
  [],
  {} ]
[2016-10-19 20:25:59.593] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 80 }
[2016-10-19 20:25:59.598] [INFO] console - Executing (e7f03268-f207-449f-8c7e-4af2ac29c849): START TRANSACTION;
[2016-10-19 20:25:59.601] [INFO] console - Executing (e7f03268-f207-449f-8c7e-4af2ac29c849): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:25:59.621] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 80);
[2016-10-19 20:25:59.629] [INFO] console - Executing (e7f03268-f207-449f-8c7e-4af2ac29c849): COMMIT;
[2016-10-19 20:25:59.632] [INFO] console - [ 70,
  525,
  {},
  [ { fullName: 'temp temp',
      fullPath: '/4/79/80/',
      id: '80',
      email: null,
      name: 'temp',
      surname: 'temp',
      patronymic: 'temp',
      voiskoSize: 0,
      birth: 1900,
      path: '/4/79/',
      note: null,
      created_at: Wed Oct 19 2016 20:25:59 GMT+0500 (YEKT),
      updated_at: Wed Oct 19 2016 20:25:59 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: '79',
      attachments: [] } ] ]
[2016-10-19 20:25:59.645] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 79 }
[2016-10-19 20:25:59.653] [INFO] console - Executing (962dc95f-5736-48bd-958f-332b982b33a0): START TRANSACTION;
[2016-10-19 20:25:59.658] [INFO] console - Executing (962dc95f-5736-48bd-958f-332b982b33a0): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:25:59.671] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 79);
[2016-10-19 20:25:59.681] [INFO] console - Executing (962dc95f-5736-48bd-958f-332b982b33a0): COMMIT;
[2016-10-19 20:25:59.683] [INFO] console - [ 70,
  526,
  {},
  [ { fullName: 'temp temp',
      fullPath: '/4/79/',
      id: '79',
      email: null,
      name: 'temp',
      surname: 'temp',
      patronymic: 'temp',
      voiskoSize: 1,
      birth: 1900,
      path: '/4/',
      note: null,
      created_at: Wed Oct 19 2016 20:25:58 GMT+0500 (YEKT),
      updated_at: Wed Oct 19 2016 20:25:59 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: '4',
      attachments: [] } ] ]
[2016-10-19 20:25:59.701] [INFO] console - Executing (9f49794c-8826-43f6-bdea-7955aeb4f02c): START TRANSACTION;
[2016-10-19 20:25:59.706] [INFO] console - Executing (9f49794c-8826-43f6-bdea-7955aeb4f02c): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:25:59.717] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 79);
[2016-10-19 20:25:59.724] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/4/' like k.path||k.id||'/%'
[2016-10-19 20:25:59.734] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('4')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:25:59.745] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-2
                                where
                                    '/4/' like path||id||'/%'
[2016-10-19 20:25:59.760] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"=NULL,"updated_at"='2016-10-19 15:25:59.747 +00:00' WHERE "id" = '79'
[2016-10-19 20:25:59.764] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/4/', '/')
                                where
                                    id = '79'
                                    or path like '/4/79/'||'%'
[2016-10-19 20:25:59.769] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+2
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:25:59.774] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 20:25:59.781] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:25:59.786] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/79/'||'%'
[2016-10-19 20:25:59.789] [INFO] console - Executing (9f49794c-8826-43f6-bdea-7955aeb4f02c): COMMIT;
[2016-10-19 20:25:59.793] [INFO] console - [ 70, 527, {}, [ undefined ] ]
[2016-10-19 20:25:59.800] [INFO] console - [ 16,
  2203260135931904,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id4.druzhinaChange',
  [],
  { action: 'remove', KOPNIK: 79 } ]
[2016-10-19 20:25:59.811] [INFO] console - [ 16,
  8769673325707264,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id4.voiskoChange',
  [],
  { voiskoSize: 0 } ]
[2016-10-19 20:25:59.825] [INFO] console - [ 16,
  3914550816538624,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id80.starshinaChange',
  [],
  {} ]
[2016-10-19 20:25:59.858] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 20:25:59.883] [INFO] console - Executing (12a09a14-ebdf-4132-88ef-b7f60b363d8c): START TRANSACTION;
[2016-10-19 20:25:59.886] [INFO] console - Executing (12a09a14-ebdf-4132-88ef-b7f60b363d8c): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:25:59.904] [INFO] console - Executing (12a09a14-ebdf-4132-88ef-b7f60b363d8c): INSERT INTO "Kopnik" ("id","name","surname","patronymic","voiskoSize","birth","path","created_at","updated_at","dom_id","starshina_id") VALUES (DEFAULT,'temp','temp','temp',0,1900,'/','2016-10-19 15:25:59.892 +00:00','2016-10-19 15:25:59.892 +00:00',2,NULL) RETURNING *;
[2016-10-19 20:25:59.912] [INFO] console - Executing (12a09a14-ebdf-4132-88ef-b7f60b363d8c): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:25:59.920] [INFO] console - Executing (12a09a14-ebdf-4132-88ef-b7f60b363d8c): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:25:59.930] [INFO] console - Executing (12a09a14-ebdf-4132-88ef-b7f60b363d8c): update "Zemla"
                                    set "obshinaSize"= "obshinaSize"+ 1
                                where
                                    '/1/' like path||id||'/%'
                                    or (
                                        true 
                                        and id= 2
                                    )
[2016-10-19 20:25:59.936] [INFO] console - Executing (12a09a14-ebdf-4132-88ef-b7f60b363d8c): COMMIT;
[2016-10-19 20:25:59.939] [INFO] console - [ 70, 528, {}, [ '81' ] ]
[2016-10-19 20:25:59.975] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:25:59.992] [INFO] console - Executing (default): select z.*
                                    from "Zemla" as z
                                where
                                    '/1/' like z.path||z.id||'/%'
[2016-10-19 20:26:00.011] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" IN ('1')) ORDER BY "Zemla"."path" desc;
[2016-10-19 20:26:00.017] [INFO] console - [ 16,
  2953032750858240,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id2.obshinaChange',
  [],
  { obshinaSize: 79 } ]
[2016-10-19 20:26:00.025] [INFO] console - Executing (b83c98bb-d965-4b3d-94f1-f0ceb3d601e5): START TRANSACTION;
[2016-10-19 20:26:00.026] [INFO] console - [ 16,
  7502523141193728,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id1.obshinaChange',
  [],
  { obshinaSize: 81 } ]
[2016-10-19 20:26:00.036] [INFO] console - Executing (b83c98bb-d965-4b3d-94f1-f0ceb3d601e5): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:26:00.047] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 81);
[2016-10-19 20:26:00.064] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 20:26:00.071] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 20:26:00.079] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:26:00.085] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:26:00.094] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='2',"updated_at"='2016-10-19 15:26:00.087 +00:00' WHERE "id" = '81'
[2016-10-19 20:26:00.098] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/', '/2/')
                                where
                                    id = '81'
                                    or path like '/81/'||'%'
[2016-10-19 20:26:00.104] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 20:26:00.108] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 20:26:00.117] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:26:00.123] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/2/81/'||'%'
[2016-10-19 20:26:00.127] [INFO] console - Executing (b83c98bb-d965-4b3d-94f1-f0ceb3d601e5): COMMIT;
[2016-10-19 20:26:00.130] [INFO] console - [ 70, 529, {}, [ undefined ] ]
[2016-10-19 20:26:00.135] [INFO] console - [ 16,
  1250197057306624,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.druzhinaChange',
  [],
  { action: 'add',
    kopnik: 
     { fullName: 'temp temp',
       fullPath: '/2/81/',
       id: '81',
       email: null,
       password: null,
       name: 'temp',
       surname: 'temp',
       patronymic: 'temp',
       voiskoSize: 0,
       birth: 1900,
       path: '/2/',
       note: null,
       created_at: Wed Oct 19 2016 20:25:59 GMT+0500 (YEKT),
       updated_at: Wed Oct 19 2016 20:26:00 GMT+0500 (YEKT),
       deleted_at: null,
       dom_id: '2',
       starshina_id: '2' } } ]
[2016-10-19 20:26:00.147] [INFO] console - Executing (90daf8f4-5b6e-4bfd-82c9-6193e534206c): START TRANSACTION;
[2016-10-19 20:26:00.151] [INFO] console - Executing (90daf8f4-5b6e-4bfd-82c9-6193e534206c): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:26:00.153] [INFO] console - [ 16,
  5611886458437632,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 2 } ]
[2016-10-19 20:26:00.164] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 81);
[2016-10-19 20:26:00.171] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 20:26:00.183] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:26:00.189] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 20:26:00.199] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"=NULL,"updated_at"='2016-10-19 15:26:00.192 +00:00' WHERE "id" = '81'
[2016-10-19 20:26:00.205] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/2/', '/')
                                where
                                    id = '81'
                                    or path like '/2/81/'||'%'
[2016-10-19 20:26:00.210] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:26:00.217] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 20:26:00.227] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:26:00.233] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/81/'||'%'
[2016-10-19 20:26:00.237] [INFO] console - Executing (90daf8f4-5b6e-4bfd-82c9-6193e534206c): COMMIT;
[2016-10-19 20:26:00.242] [INFO] console - [ 70, 530, {}, [ undefined ] ]
[2016-10-19 20:26:00.250] [INFO] console - [ 16,
  4704179631161344,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.druzhinaChange',
  [],
  { action: 'remove', KOPNIK: 81 } ]
[2016-10-19 20:26:00.272] [DEBUG] Server - #promiseModel() [] { model: 'Kopa', id: 3 }
[2016-10-19 20:26:00.276] [INFO] console - [ 16,
  1703436915572736,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 1 } ]
[2016-10-19 20:26:00.293] [INFO] console - Executing (43c67df6-f2b9-4cdd-ba8b-f9659b22962b): START TRANSACTION;
[2016-10-19 20:26:00.298] [INFO] console - Executing (43c67df6-f2b9-4cdd-ba8b-f9659b22962b): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:26:00.314] [INFO] console - Executing (default): SELECT "Kopa"."id", "Kopa"."question", "Kopa"."invited", "Kopa"."note", "Kopa"."created_at", "Kopa"."updated_at", "Kopa"."deleted_at", "Kopa"."place_id", "Kopa"."inviter_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopa" AS "Kopa" LEFT OUTER JOIN "File" AS "attachments" ON "Kopa"."id" = "attachments"."kopa_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopa"."deleted_at" IS NULL AND "Kopa"."id" = 3);
[2016-10-19 20:26:00.326] [INFO] console - Executing (43c67df6-f2b9-4cdd-ba8b-f9659b22962b): COMMIT;
[2016-10-19 20:26:00.330] [INFO] console - [ 70,
  531,
  {},
  [ { id: '3',
      question: 'CHE',
      invited: Thu Sep 01 2016 00:00:00 GMT+0500 (YEKT),
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      place_id: '2',
      inviter_id: '2',
      attachments: [] } ] ]
[2016-10-19 20:26:00.368] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 20:26:00.377] [INFO] console - Executing (da0ade88-31aa-4c9e-abfb-eab345a83969): START TRANSACTION;
[2016-10-19 20:26:00.381] [INFO] console - Executing (da0ade88-31aa-4c9e-abfb-eab345a83969): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:26:00.394] [INFO] console - Executing (da0ade88-31aa-4c9e-abfb-eab345a83969): INSERT INTO "Predlozhenie" ("id","value","totalZa","totalProtiv","created_at","updated_at","author_id","place_id") VALUES (DEFAULT,'temp Wed Oct 19 2016 20:26:00 GMT+0500 (YEKT)',0,0,'2016-10-19 15:26:00.386 +00:00','2016-10-19 15:26:00.386 +00:00',2,3) RETURNING *;
[2016-10-19 20:26:00.400] [INFO] console - Executing (da0ade88-31aa-4c9e-abfb-eab345a83969): COMMIT;
[2016-10-19 20:26:00.402] [INFO] console - [ 70, 532, {}, [ '20' ] ]
[2016-10-19 20:26:00.406] [INFO] console - [ 16,
  1489183791120384,
  { acknowledge: true },
  'ru.kopa.model.Kopa.id3.predlozhenieAdd',
  [ '20' ] ]
[2016-10-19 20:26:00.425] [INFO] console - Executing (a010d4e4-5617-4ad4-ad54-6557f31eeda6): START TRANSACTION;
[2016-10-19 20:26:00.428] [INFO] console - Executing (a010d4e4-5617-4ad4-ad54-6557f31eeda6): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:26:00.437] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 20:26:00.447] [INFO] console - Executing (default): SELECT "id", "value", "totalZa", "totalProtiv", "state", "note", "created_at", "updated_at", "deleted_at", "author_id", "place_id" FROM "Predlozhenie" AS "Predlozhenie" WHERE ("Predlozhenie"."deleted_at" IS NULL AND "Predlozhenie"."id" = 20);
[2016-10-19 20:26:00.460] [INFO] console - Executing (default): SELECT "id", "question", "invited", "note", "created_at", "updated_at", "deleted_at", "place_id", "inviter_id" FROM "Kopa" AS "Kopa" WHERE ("Kopa"."deleted_at" IS NULL AND "Kopa"."id" = '3');
[2016-10-19 20:26:00.474] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:26:00.485] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:26:00.491] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 20:26:00.503] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:26:00.512] [INFO] console - Executing (default): SELECT "id", "value", "reason", "note", "created_at", "updated_at", "deleted_at", "subject_id", "owner_id", "parent_id" FROM "Golos" AS "Golos" WHERE ("Golos"."deleted_at" IS NULL AND ("Golos"."subject_id" = '20' AND "Golos"."owner_id" = '2')) LIMIT 1;
[2016-10-19 20:26:00.526] [INFO] console - Executing (default): INSERT INTO "Golos" ("id","value","created_at","updated_at","subject_id","owner_id") VALUES (DEFAULT,1,'2016-10-19 15:26:00.518 +00:00','2016-10-19 15:26:00.518 +00:00','20','2') RETURNING *;
[2016-10-19 20:26:00.541] [INFO] console - Executing (default): insert into "Golos" (subject_id, value, owner_id, parent_id, created_at, updated_at)
                            (
                                select 20, 1, k.id, 59, current_timestamp, current_timestamp
                                from 
                                    "Kopnik" k
                                     join "Zemla" d on d.id= k.dom_id
                                where
                                    k.path like '/2/%'
                                    and d.path||d.id||'/' like '/1/2/%' 
                            )
[2016-10-19 20:26:00.544] [INFO] console - Executing (default): select
                            (select count(*) from "Golos" g where subject_id= 20 and value=1) "za",
                            (select count(*) from "Golos" g where subject_id= 20 and value=-1) "protiv"
[2016-10-19 20:26:00.561] [INFO] console - Executing (default): UPDATE "Predlozhenie" SET "totalZa"=2,"updated_at"='2016-10-19 15:26:00.550 +00:00' WHERE "id" = '20'
[2016-10-19 20:26:00.567] [INFO] console - Executing (a010d4e4-5617-4ad4-ad54-6557f31eeda6): COMMIT;
[2016-10-19 20:26:00.570] [INFO] console - [ 70, 533, {}, [ undefined ] ]
[2016-10-19 20:26:00.574] [INFO] console - [ 16,
  3262120573534208,
  { acknowledge: true },
  'ru.kopa.model.Predlozhenie.id20.rebalance',
  [],
  { totalZa: 2,
    totalProtiv: 0,
    GOLOS: '59',
    action: 'add',
    value: 1 } ]
[2016-10-19 20:26:00.585] [INFO] console - Executing (33c7b39c-2a60-492b-b729-6e5c72fb6491): START TRANSACTION;
[2016-10-19 20:26:00.589] [INFO] console - Executing (33c7b39c-2a60-492b-b729-6e5c72fb6491): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:26:00.597] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 20:26:00.614] [INFO] console - Executing (default): SELECT "id", "value", "totalZa", "totalProtiv", "state", "note", "created_at", "updated_at", "deleted_at", "author_id", "place_id" FROM "Predlozhenie" AS "Predlozhenie" WHERE ("Predlozhenie"."deleted_at" IS NULL AND "Predlozhenie"."id" = 20);
[2016-10-19 20:26:00.627] [INFO] console - Executing (default): SELECT "id", "question", "invited", "note", "created_at", "updated_at", "deleted_at", "place_id", "inviter_id" FROM "Kopa" AS "Kopa" WHERE ("Kopa"."deleted_at" IS NULL AND "Kopa"."id" = '3');
[2016-10-19 20:26:00.640] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:26:00.653] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:26:00.660] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 20:26:00.679] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:26:00.690] [INFO] console - Executing (default): SELECT "id", "value", "reason", "note", "created_at", "updated_at", "deleted_at", "subject_id", "owner_id", "parent_id" FROM "Golos" AS "Golos" WHERE ("Golos"."deleted_at" IS NULL AND ("Golos"."subject_id" = '20' AND "Golos"."owner_id" = '2')) LIMIT 1;
[2016-10-19 20:26:00.700] [INFO] console - Executing (default): delete from "Golos" 
                            where
                                subject_id= 20
                                and (
                                    id= 59
                                    or parent_id = 59
                                )
[2016-10-19 20:26:00.704] [INFO] console - Executing (default): select
                            (select count(*) from "Golos" g where subject_id= 20 and value=1) "za",
                            (select count(*) from "Golos" g where subject_id= 20 and value=-1) "protiv"
[2016-10-19 20:26:00.718] [INFO] console - Executing (default): UPDATE "Predlozhenie" SET "totalZa"=0,"updated_at"='2016-10-19 15:26:00.708 +00:00' WHERE "id" = '20'
[2016-10-19 20:26:00.725] [INFO] console - Executing (33c7b39c-2a60-492b-b729-6e5c72fb6491): COMMIT;
[2016-10-19 20:26:00.728] [INFO] console - [ 70, 534, {}, [ undefined ] ]
[2016-10-19 20:26:00.734] [INFO] console - [ 16,
  760481226686464,
  { acknowledge: true },
  'ru.kopa.model.Predlozhenie.id20.rebalance',
  [],
  { totalZa: 0,
    totalProtiv: 0,
    GOLOS: '59',
    action: 'remove',
    value: 1 } ]
[2016-10-19 20:26:14.743] [INFO] console - Executing (a5416e23-8dbf-4113-9fb6-e98b548afdd3): START TRANSACTION;
[2016-10-19 20:26:14.746] [INFO] console - Executing (a5416e23-8dbf-4113-9fb6-e98b548afdd3): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:26:14.796] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 20:26:14.815] [INFO] console - Executing (default): SELECT "id", "value", "totalZa", "totalProtiv", "state", "note", "created_at", "updated_at", "deleted_at", "author_id", "place_id" FROM "Predlozhenie" AS "Predlozhenie" WHERE ("Predlozhenie"."deleted_at" IS NULL AND "Predlozhenie"."id" = 20);
[2016-10-19 20:26:14.860] [INFO] console - Executing (default): SELECT "id", "question", "invited", "note", "created_at", "updated_at", "deleted_at", "place_id", "inviter_id" FROM "Kopa" AS "Kopa" WHERE ("Kopa"."deleted_at" IS NULL AND "Kopa"."id" = '3');
[2016-10-19 20:26:14.875] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:26:14.886] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:26:14.895] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 20:26:14.907] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:26:14.921] [INFO] console - Executing (default): SELECT "id", "value", "reason", "note", "created_at", "updated_at", "deleted_at", "subject_id", "owner_id", "parent_id" FROM "Golos" AS "Golos" WHERE ("Golos"."deleted_at" IS NULL AND ("Golos"."subject_id" = '20' AND "Golos"."owner_id" = '2')) LIMIT 1;
[2016-10-19 20:26:14.938] [INFO] console - Executing (default): INSERT INTO "Golos" ("id","value","created_at","updated_at","subject_id","owner_id") VALUES (DEFAULT,-1,'2016-10-19 15:26:14.926 +00:00','2016-10-19 15:26:14.926 +00:00','20','2') RETURNING *;
[2016-10-19 20:26:14.966] [INFO] console - Executing (default): insert into "Golos" (subject_id, value, owner_id, parent_id, created_at, updated_at)
                            (
                                select 20, -1, k.id, 61, current_timestamp, current_timestamp
                                from 
                                    "Kopnik" k
                                     join "Zemla" d on d.id= k.dom_id
                                where
                                    k.path like '/2/%'
                                    and d.path||d.id||'/' like '/1/2/%' 
                            )
[2016-10-19 20:26:14.971] [INFO] console - Executing (default): select
                            (select count(*) from "Golos" g where subject_id= 20 and value=1) "za",
                            (select count(*) from "Golos" g where subject_id= 20 and value=-1) "protiv"
[2016-10-19 20:26:14.993] [INFO] console - Executing (default): UPDATE "Predlozhenie" SET "totalProtiv"=2,"updated_at"='2016-10-19 15:26:14.982 +00:00' WHERE "id" = '20'
[2016-10-19 20:26:15.000] [INFO] console - Executing (a5416e23-8dbf-4113-9fb6-e98b548afdd3): COMMIT;
[2016-10-19 20:26:15.003] [INFO] console - [ 70, 535, {}, [ undefined ] ]
[2016-10-19 20:26:15.009] [INFO] console - [ 16,
  8253670772703232,
  { acknowledge: true },
  'ru.kopa.model.Predlozhenie.id20.rebalance',
  [],
  { totalZa: 0,
    totalProtiv: 2,
    GOLOS: '61',
    action: 'add',
    value: -1 } ]
[2016-10-19 20:26:25.390] [INFO] console - [ 70, 537, {}, [ undefined ] ]
[2016-10-19 20:26:25.416] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 2 }
[2016-10-19 20:26:25.475] [INFO] console - Executing (default): delete from "Kopnik"
                where
                    name like '%temp'
                    or name like 'temp%'
[2016-10-19 20:26:25.493] [INFO] console - Executing (42bf1be0-c55b-4e63-a60a-6ea722508b6c): START TRANSACTION;
[2016-10-19 20:26:25.498] [INFO] console - Executing (42bf1be0-c55b-4e63-a60a-6ea722508b6c): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:26:25.548] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 20:26:25.560] [INFO] console - Executing (default): update "Kopnik"
                set 
                    "voiskoSize"= case when id=2 then 1 ELSE 0 END
                where
                    id>1 
                    and id<=5
[2016-10-19 20:26:25.568] [INFO] console - Executing (42bf1be0-c55b-4e63-a60a-6ea722508b6c): COMMIT;
[2016-10-19 20:26:25.571] [INFO] console - [ 70,
  538,
  {},
  [ { fullName: 'Unit Test',
      fullPath: '/2/',
      id: '2',
      email: 'unittest2@domain.ru',
      name: 'Unit',
      surname: 'Test',
      patronymic: '1',
      voiskoSize: 1,
      birth: 1983,
      path: '/',
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: null,
      attachments: [] } ] ]
[2016-10-19 20:26:25.620] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."starshina_id" = 2) ORDER BY "Kopnik"."surname" asc, "Kopnik"."name" asc, "Kopnik"."patronymic" asc;
[2016-10-19 20:26:25.639] [INFO] console - [ 70, 539, {}, [ [ [Object], [Object] ] ] ]
[2016-10-19 20:26:25.675] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 20:26:25.684] [INFO] console - Executing (763c7805-01d2-4917-a67c-927b2b58d37b): START TRANSACTION;
[2016-10-19 20:26:25.688] [INFO] console - Executing (763c7805-01d2-4917-a67c-927b2b58d37b): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:26:25.707] [INFO] console - Executing (763c7805-01d2-4917-a67c-927b2b58d37b): INSERT INTO "Kopnik" ("id","name","surname","patronymic","voiskoSize","birth","path","created_at","updated_at","dom_id","starshina_id") VALUES (DEFAULT,'temp','temp','temp',0,1900,'/','2016-10-19 15:26:25.693 +00:00','2016-10-19 15:26:25.693 +00:00',2,NULL) RETURNING *;
[2016-10-19 20:26:25.725] [INFO] console - Executing (763c7805-01d2-4917-a67c-927b2b58d37b): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:26:25.739] [INFO] console - Executing (763c7805-01d2-4917-a67c-927b2b58d37b): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:26:25.748] [INFO] console - Executing (763c7805-01d2-4917-a67c-927b2b58d37b): update "Zemla"
                                    set "obshinaSize"= "obshinaSize"+ 1
                                where
                                    '/1/' like path||id||'/%'
                                    or (
                                        true 
                                        and id= 2
                                    )
[2016-10-19 20:26:25.755] [INFO] console - Executing (763c7805-01d2-4917-a67c-927b2b58d37b): COMMIT;
[2016-10-19 20:26:25.762] [INFO] console - [ 70, 540, {}, [ '82' ] ]
[2016-10-19 20:26:25.781] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:26:25.786] [INFO] console - Executing (4628a60e-27bc-4773-ad29-e680b52de717): START TRANSACTION;
[2016-10-19 20:26:25.791] [INFO] console - Executing (4628a60e-27bc-4773-ad29-e680b52de717): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:26:25.796] [INFO] console - Executing (default): select z.*
                                    from "Zemla" as z
                                where
                                    '/1/' like z.path||z.id||'/%'
[2016-10-19 20:26:25.805] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 82);
[2016-10-19 20:26:25.819] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" IN ('1')) ORDER BY "Zemla"."path" desc;
[2016-10-19 20:26:25.832] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 20:26:25.834] [INFO] console - [ 16,
  4290130669993984,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id2.obshinaChange',
  [],
  { obshinaSize: 80 } ]
[2016-10-19 20:26:25.849] [INFO] console - [ 16,
  4810724442374144,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id1.obshinaChange',
  [],
  { obshinaSize: 82 } ]
[2016-10-19 20:26:25.865] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 20:26:25.876] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:26:25.884] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:26:25.902] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='2',"updated_at"='2016-10-19 15:26:25.887 +00:00' WHERE "id" = '82'
[2016-10-19 20:26:25.911] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/', '/2/')
                                where
                                    id = '82'
                                    or path like '/82/'||'%'
[2016-10-19 20:26:25.915] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 20:26:25.922] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 20:26:25.934] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:26:25.944] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/2/82/'||'%'
[2016-10-19 20:26:25.949] [INFO] console - Executing (4628a60e-27bc-4773-ad29-e680b52de717): COMMIT;
[2016-10-19 20:26:25.953] [INFO] console - [ 70, 541, {}, [ undefined ] ]
[2016-10-19 20:26:25.966] [INFO] console - [ 16,
  3000556119392256,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.druzhinaChange',
  [],
  { action: 'add',
    kopnik: 
     { fullName: 'temp temp',
       fullPath: '/2/82/',
       id: '82',
       email: null,
       password: null,
       name: 'temp',
       surname: 'temp',
       patronymic: 'temp',
       voiskoSize: 0,
       birth: 1900,
       path: '/2/',
       note: null,
       created_at: Wed Oct 19 2016 20:26:25 GMT+0500 (YEKT),
       updated_at: Wed Oct 19 2016 20:26:25 GMT+0500 (YEKT),
       deleted_at: null,
       dom_id: '2',
       starshina_id: '2' } } ]
[2016-10-19 20:26:26.022] [INFO] console - [ 16,
  3917534342414336,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 2 } ]
[2016-10-19 20:26:26.040] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 20:26:26.048] [INFO] console - Executing (b0223c6f-1c3b-44d3-9ffd-7bac20fe426f): START TRANSACTION;
[2016-10-19 20:26:26.050] [INFO] console - Executing (b0223c6f-1c3b-44d3-9ffd-7bac20fe426f): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:26:26.062] [INFO] console - Executing (b0223c6f-1c3b-44d3-9ffd-7bac20fe426f): INSERT INTO "Kopnik" ("id","name","surname","patronymic","voiskoSize","birth","path","created_at","updated_at","dom_id","starshina_id") VALUES (DEFAULT,'temp','temp','temp',0,1900,'/','2016-10-19 15:26:26.053 +00:00','2016-10-19 15:26:26.053 +00:00',2,NULL) RETURNING *;
[2016-10-19 20:26:26.071] [INFO] console - Executing (b0223c6f-1c3b-44d3-9ffd-7bac20fe426f): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:26:26.079] [INFO] console - Executing (b0223c6f-1c3b-44d3-9ffd-7bac20fe426f): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:26:26.088] [INFO] console - Executing (b0223c6f-1c3b-44d3-9ffd-7bac20fe426f): update "Zemla"
                                    set "obshinaSize"= "obshinaSize"+ 1
                                where
                                    '/1/' like path||id||'/%'
                                    or (
                                        true 
                                        and id= 2
                                    )
[2016-10-19 20:26:26.093] [INFO] console - Executing (b0223c6f-1c3b-44d3-9ffd-7bac20fe426f): COMMIT;
[2016-10-19 20:26:26.096] [INFO] console - [ 70, 542, {}, [ '83' ] ]
[2016-10-19 20:26:26.112] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:26:26.120] [INFO] console - Executing (b1c5da9b-a272-46bb-8e3b-547008a9dfb4): START TRANSACTION;
[2016-10-19 20:26:26.125] [INFO] console - Executing (default): select z.*
                                    from "Zemla" as z
                                where
                                    '/1/' like z.path||z.id||'/%'
[2016-10-19 20:26:26.127] [INFO] console - Executing (b1c5da9b-a272-46bb-8e3b-547008a9dfb4): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:26:26.141] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" IN ('1')) ORDER BY "Zemla"."path" desc;
[2016-10-19 20:26:26.146] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 83);
[2016-10-19 20:26:26.155] [INFO] console - [ 16,
  3760626235080704,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id2.obshinaChange',
  [],
  { obshinaSize: 81 } ]
[2016-10-19 20:26:26.162] [INFO] console - [ 16,
  2257029898960896,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id1.obshinaChange',
  [],
  { obshinaSize: 83 } ]
[2016-10-19 20:26:26.172] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 82);
[2016-10-19 20:26:26.181] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 20:26:26.190] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:26:26.195] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:26:26.206] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='82',"updated_at"='2016-10-19 15:26:26.197 +00:00' WHERE "id" = '83'
[2016-10-19 20:26:26.213] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/', '/2/82/')
                                where
                                    id = '83'
                                    or path like '/83/'||'%'
[2016-10-19 20:26:26.221] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/2/82/' like path||id||'/%'
[2016-10-19 20:26:26.226] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/82/' like k.path||k.id||'/%'
[2016-10-19 20:26:26.236] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('82', '2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:26:26.244] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/2/82/83/'||'%'
[2016-10-19 20:26:26.248] [INFO] console - Executing (b1c5da9b-a272-46bb-8e3b-547008a9dfb4): COMMIT;
[2016-10-19 20:26:26.251] [INFO] console - [ 70, 543, {}, [ undefined ] ]
[2016-10-19 20:26:26.257] [INFO] console - [ 16,
  1523791444312064,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id82.druzhinaChange',
  [],
  { action: 'add',
    kopnik: 
     { fullName: 'temp temp',
       fullPath: '/2/82/83/',
       id: '83',
       email: null,
       password: null,
       name: 'temp',
       surname: 'temp',
       patronymic: 'temp',
       voiskoSize: 0,
       birth: 1900,
       path: '/2/82/',
       note: null,
       created_at: Wed Oct 19 2016 20:26:26 GMT+0500 (YEKT),
       updated_at: Wed Oct 19 2016 20:26:26 GMT+0500 (YEKT),
       deleted_at: null,
       dom_id: '2',
       starshina_id: '82' } } ]
[2016-10-19 20:26:26.271] [INFO] console - [ 16,
  4507439172943872,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id82.voiskoChange',
  [],
  { voiskoSize: 1 } ]
[2016-10-19 20:26:26.279] [INFO] console - [ 16,
  7845471903023104,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 3 } ]
[2016-10-19 20:26:26.294] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 4 }
[2016-10-19 20:26:26.300] [INFO] console - Executing (775569fe-b847-4f70-8740-fd96ef23a449): START TRANSACTION;
[2016-10-19 20:26:26.303] [INFO] console - Executing (775569fe-b847-4f70-8740-fd96ef23a449): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:26:26.318] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 4);
[2016-10-19 20:26:26.330] [INFO] console - Executing (775569fe-b847-4f70-8740-fd96ef23a449): COMMIT;
[2016-10-19 20:26:26.332] [INFO] console - [ 70,
  544,
  {},
  [ { fullName: 'Unit Test',
      fullPath: '/4/',
      id: '4',
      email: 'unittest4@domain.ru',
      name: 'Unit',
      surname: 'Test',
      patronymic: '4',
      voiskoSize: 0,
      birth: 1983,
      path: '/',
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: null,
      attachments: [] } ] ]
[2016-10-19 20:26:26.356] [INFO] console - Executing (370be51a-0fbb-4af3-bdb0-93eb10974df7): START TRANSACTION;
[2016-10-19 20:26:26.359] [INFO] console - Executing (370be51a-0fbb-4af3-bdb0-93eb10974df7): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:26:26.368] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 82);
[2016-10-19 20:26:26.381] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 4);
[2016-10-19 20:26:26.389] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 20:26:26.409] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:26:26.418] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-2
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 20:26:26.431] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='4',"updated_at"='2016-10-19 15:26:26.421 +00:00' WHERE "id" = '82'
[2016-10-19 20:26:26.437] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/2/', '/4/')
                                where
                                    id = '82'
                                    or path like '/2/82/'||'%'
[2016-10-19 20:26:26.440] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+2
                                where
                                    '/4/' like path||id||'/%'
[2016-10-19 20:26:26.449] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/4/' like k.path||k.id||'/%'
[2016-10-19 20:26:26.462] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('4')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:26:26.471] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/4/82/'||'%'
[2016-10-19 20:26:26.475] [INFO] console - Executing (370be51a-0fbb-4af3-bdb0-93eb10974df7): COMMIT;
[2016-10-19 20:26:26.478] [INFO] console - [ 70, 545, {}, [ undefined ] ]
[2016-10-19 20:26:26.485] [INFO] console - [ 16,
  6168944993894400,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.druzhinaChange',
  [],
  { action: 'remove', KOPNIK: 82 } ]
[2016-10-19 20:26:26.493] [INFO] console - [ 16,
  641286465912832,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id4.druzhinaChange',
  [],
  { action: 'add',
    kopnik: 
     { fullName: 'temp temp',
       fullPath: '/4/82/',
       id: '82',
       email: null,
       password: null,
       name: 'temp',
       surname: 'temp',
       patronymic: 'temp',
       voiskoSize: 1,
       birth: 1900,
       path: '/4/',
       note: null,
       created_at: Wed Oct 19 2016 20:26:25 GMT+0500 (YEKT),
       updated_at: Wed Oct 19 2016 20:26:26 GMT+0500 (YEKT),
       deleted_at: null,
       dom_id: '2',
       starshina_id: '4' } } ]
[2016-10-19 20:26:26.510] [INFO] console - [ 16,
  4155544700977152,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 1 } ]
[2016-10-19 20:26:26.517] [INFO] console - [ 16,
  2304809596092416,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id4.voiskoChange',
  [],
  { voiskoSize: 2 } ]
[2016-10-19 20:26:26.525] [INFO] console - [ 16,
  2531863935582208,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id83.starshinaChange',
  [],
  {} ]
[2016-10-19 20:26:26.536] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 83 }
[2016-10-19 20:26:26.542] [INFO] console - Executing (235c2cde-1f32-401f-bf56-c3bfac216344): START TRANSACTION;
[2016-10-19 20:26:26.545] [INFO] console - Executing (235c2cde-1f32-401f-bf56-c3bfac216344): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:26:26.562] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 83);
[2016-10-19 20:26:26.571] [INFO] console - Executing (235c2cde-1f32-401f-bf56-c3bfac216344): COMMIT;
[2016-10-19 20:26:26.573] [INFO] console - [ 70,
  546,
  {},
  [ { fullName: 'temp temp',
      fullPath: '/4/82/83/',
      id: '83',
      email: null,
      name: 'temp',
      surname: 'temp',
      patronymic: 'temp',
      voiskoSize: 0,
      birth: 1900,
      path: '/4/82/',
      note: null,
      created_at: Wed Oct 19 2016 20:26:26 GMT+0500 (YEKT),
      updated_at: Wed Oct 19 2016 20:26:26 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: '82',
      attachments: [] } ] ]
[2016-10-19 20:26:26.586] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 82 }
[2016-10-19 20:26:26.590] [INFO] console - Executing (970fd29e-ee81-49f2-b380-27d170c36229): START TRANSACTION;
[2016-10-19 20:26:26.597] [INFO] console - Executing (970fd29e-ee81-49f2-b380-27d170c36229): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:26:26.640] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 82);
[2016-10-19 20:26:26.660] [INFO] console - Executing (970fd29e-ee81-49f2-b380-27d170c36229): COMMIT;
[2016-10-19 20:26:26.665] [INFO] console - [ 70,
  547,
  {},
  [ { fullName: 'temp temp',
      fullPath: '/4/82/',
      id: '82',
      email: null,
      name: 'temp',
      surname: 'temp',
      patronymic: 'temp',
      voiskoSize: 1,
      birth: 1900,
      path: '/4/',
      note: null,
      created_at: Wed Oct 19 2016 20:26:25 GMT+0500 (YEKT),
      updated_at: Wed Oct 19 2016 20:26:26 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: '4',
      attachments: [] } ] ]
[2016-10-19 20:26:26.696] [INFO] console - Executing (1004ffe1-25de-46a0-8503-c8914b1b14b8): START TRANSACTION;
[2016-10-19 20:26:26.701] [INFO] console - Executing (1004ffe1-25de-46a0-8503-c8914b1b14b8): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:26:26.714] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 82);
[2016-10-19 20:26:26.722] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/4/' like k.path||k.id||'/%'
[2016-10-19 20:26:26.736] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('4')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:26:26.745] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-2
                                where
                                    '/4/' like path||id||'/%'
[2016-10-19 20:26:26.766] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"=NULL,"updated_at"='2016-10-19 15:26:26.750 +00:00' WHERE "id" = '82'
[2016-10-19 20:26:26.773] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/4/', '/')
                                where
                                    id = '82'
                                    or path like '/4/82/'||'%'
[2016-10-19 20:26:26.778] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+2
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:26:26.782] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 20:26:26.794] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:26:26.802] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/82/'||'%'
[2016-10-19 20:26:26.808] [INFO] console - Executing (1004ffe1-25de-46a0-8503-c8914b1b14b8): COMMIT;
[2016-10-19 20:26:26.811] [INFO] console - [ 70, 548, {}, [ undefined ] ]
[2016-10-19 20:26:26.819] [INFO] console - [ 16,
  5485273108447232,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id4.druzhinaChange',
  [],
  { action: 'remove', KOPNIK: 82 } ]
[2016-10-19 20:26:26.832] [INFO] console - [ 16,
  4489138424250368,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id4.voiskoChange',
  [],
  { voiskoSize: 0 } ]
[2016-10-19 20:26:26.853] [INFO] console - [ 16,
  6305850920534016,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id83.starshinaChange',
  [],
  {} ]
[2016-10-19 20:26:26.917] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 20:26:26.941] [INFO] console - Executing (2d855f37-1465-4d44-82ca-765027763e41): START TRANSACTION;
[2016-10-19 20:26:26.945] [INFO] console - Executing (2d855f37-1465-4d44-82ca-765027763e41): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:26:26.965] [INFO] console - Executing (2d855f37-1465-4d44-82ca-765027763e41): INSERT INTO "Kopnik" ("id","name","surname","patronymic","voiskoSize","birth","path","created_at","updated_at","dom_id","starshina_id") VALUES (DEFAULT,'temp','temp','temp',0,1900,'/','2016-10-19 15:26:26.951 +00:00','2016-10-19 15:26:26.951 +00:00',2,NULL) RETURNING *;
[2016-10-19 20:26:26.974] [INFO] console - Executing (2d855f37-1465-4d44-82ca-765027763e41): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:26:26.981] [INFO] console - Executing (2d855f37-1465-4d44-82ca-765027763e41): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:26:26.988] [INFO] console - Executing (2d855f37-1465-4d44-82ca-765027763e41): update "Zemla"
                                    set "obshinaSize"= "obshinaSize"+ 1
                                where
                                    '/1/' like path||id||'/%'
                                    or (
                                        true 
                                        and id= 2
                                    )
[2016-10-19 20:26:26.992] [INFO] console - Executing (2d855f37-1465-4d44-82ca-765027763e41): COMMIT;
[2016-10-19 20:26:26.995] [INFO] console - [ 70, 549, {}, [ '84' ] ]
[2016-10-19 20:26:27.012] [INFO] console - Executing (b522ab0f-5d3a-43b7-9348-fa608dcba146): START TRANSACTION;
[2016-10-19 20:26:27.018] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:26:27.023] [INFO] console - Executing (b522ab0f-5d3a-43b7-9348-fa608dcba146): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:26:27.028] [INFO] console - Executing (default): select z.*
                                    from "Zemla" as z
                                where
                                    '/1/' like z.path||z.id||'/%'
[2016-10-19 20:26:27.037] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 84);
[2016-10-19 20:26:27.047] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" IN ('1')) ORDER BY "Zemla"."path" desc;
[2016-10-19 20:26:27.059] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 20:26:27.060] [INFO] console - [ 16,
  4875773403987968,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id2.obshinaChange',
  [],
  { obshinaSize: 82 } ]
[2016-10-19 20:26:27.071] [INFO] console - [ 16,
  5899854320500736,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id1.obshinaChange',
  [],
  { obshinaSize: 84 } ]
[2016-10-19 20:26:27.079] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 20:26:27.087] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:26:27.093] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:26:27.104] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='2',"updated_at"='2016-10-19 15:26:27.095 +00:00' WHERE "id" = '84'
[2016-10-19 20:26:27.111] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/', '/2/')
                                where
                                    id = '84'
                                    or path like '/84/'||'%'
[2016-10-19 20:26:27.117] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 20:26:27.121] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 20:26:27.136] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:26:27.142] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/2/84/'||'%'
[2016-10-19 20:26:27.147] [INFO] console - Executing (b522ab0f-5d3a-43b7-9348-fa608dcba146): COMMIT;
[2016-10-19 20:26:27.151] [INFO] console - [ 70, 550, {}, [ undefined ] ]
[2016-10-19 20:26:27.164] [INFO] console - [ 16,
  1893210204930048,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.druzhinaChange',
  [],
  { action: 'add',
    kopnik: 
     { fullName: 'temp temp',
       fullPath: '/2/84/',
       id: '84',
       email: null,
       password: null,
       name: 'temp',
       surname: 'temp',
       patronymic: 'temp',
       voiskoSize: 0,
       birth: 1900,
       path: '/2/',
       note: null,
       created_at: Wed Oct 19 2016 20:26:26 GMT+0500 (YEKT),
       updated_at: Wed Oct 19 2016 20:26:27 GMT+0500 (YEKT),
       deleted_at: null,
       dom_id: '2',
       starshina_id: '2' } } ]
[2016-10-19 20:26:27.183] [INFO] console - Executing (fb0c0979-1131-4b7e-b4f7-3e20f9f4f88f): START TRANSACTION;
[2016-10-19 20:26:27.189] [INFO] console - Executing (fb0c0979-1131-4b7e-b4f7-3e20f9f4f88f): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:26:27.214] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 84);
[2016-10-19 20:26:27.217] [INFO] console - [ 16,
  8713963011309568,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 2 } ]
[2016-10-19 20:26:27.233] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 20:26:27.242] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:26:27.251] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 20:26:27.265] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"=NULL,"updated_at"='2016-10-19 15:26:27.254 +00:00' WHERE "id" = '84'
[2016-10-19 20:26:27.271] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/2/', '/')
                                where
                                    id = '84'
                                    or path like '/2/84/'||'%'
[2016-10-19 20:26:27.275] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:26:27.280] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 20:26:27.295] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:26:27.301] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/84/'||'%'
[2016-10-19 20:26:27.305] [INFO] console - Executing (fb0c0979-1131-4b7e-b4f7-3e20f9f4f88f): COMMIT;
[2016-10-19 20:26:27.308] [INFO] console - [ 70, 551, {}, [ undefined ] ]
[2016-10-19 20:26:27.312] [INFO] console - [ 16,
  7870808739282944,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.druzhinaChange',
  [],
  { action: 'remove', KOPNIK: 84 } ]
[2016-10-19 20:26:27.350] [INFO] console - [ 16,
  8053356922667008,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 1 } ]
[2016-10-19 20:26:27.359] [DEBUG] Server - #promiseModel() [] { model: 'Kopa', id: 3 }
[2016-10-19 20:26:27.367] [INFO] console - Executing (2e5ba4b0-86f1-4d07-9522-e224f2118d3a): START TRANSACTION;
[2016-10-19 20:26:27.373] [INFO] console - Executing (2e5ba4b0-86f1-4d07-9522-e224f2118d3a): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:26:27.387] [INFO] console - Executing (default): SELECT "Kopa"."id", "Kopa"."question", "Kopa"."invited", "Kopa"."note", "Kopa"."created_at", "Kopa"."updated_at", "Kopa"."deleted_at", "Kopa"."place_id", "Kopa"."inviter_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopa" AS "Kopa" LEFT OUTER JOIN "File" AS "attachments" ON "Kopa"."id" = "attachments"."kopa_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopa"."deleted_at" IS NULL AND "Kopa"."id" = 3);
[2016-10-19 20:26:27.397] [INFO] console - Executing (2e5ba4b0-86f1-4d07-9522-e224f2118d3a): COMMIT;
[2016-10-19 20:26:27.399] [INFO] console - [ 70,
  552,
  {},
  [ { id: '3',
      question: 'CHE',
      invited: Thu Sep 01 2016 00:00:00 GMT+0500 (YEKT),
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      place_id: '2',
      inviter_id: '2',
      attachments: [] } ] ]
[2016-10-19 20:26:27.442] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 20:26:27.453] [INFO] console - Executing (7152f00c-f502-4271-b190-c8350406b11a): START TRANSACTION;
[2016-10-19 20:26:27.457] [INFO] console - Executing (7152f00c-f502-4271-b190-c8350406b11a): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:26:27.472] [INFO] console - Executing (7152f00c-f502-4271-b190-c8350406b11a): INSERT INTO "Predlozhenie" ("id","value","totalZa","totalProtiv","created_at","updated_at","author_id","place_id") VALUES (DEFAULT,'temp Wed Oct 19 2016 20:26:27 GMT+0500 (YEKT)',0,0,'2016-10-19 15:26:27.462 +00:00','2016-10-19 15:26:27.462 +00:00',2,3) RETURNING *;
[2016-10-19 20:26:27.480] [INFO] console - Executing (7152f00c-f502-4271-b190-c8350406b11a): COMMIT;
[2016-10-19 20:26:27.485] [INFO] console - [ 70, 553, {}, [ '21' ] ]
[2016-10-19 20:26:27.494] [INFO] console - [ 16,
  1146460049506304,
  { acknowledge: true },
  'ru.kopa.model.Kopa.id3.predlozhenieAdd',
  [ '21' ] ]
[2016-10-19 20:26:27.523] [INFO] console - Executing (838af4af-8f44-459c-9154-2d19a9514cf1): START TRANSACTION;
[2016-10-19 20:26:27.525] [INFO] console - Executing (838af4af-8f44-459c-9154-2d19a9514cf1): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:26:27.537] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 20:26:27.549] [INFO] console - Executing (default): SELECT "id", "value", "totalZa", "totalProtiv", "state", "note", "created_at", "updated_at", "deleted_at", "author_id", "place_id" FROM "Predlozhenie" AS "Predlozhenie" WHERE ("Predlozhenie"."deleted_at" IS NULL AND "Predlozhenie"."id" = 21);
[2016-10-19 20:26:27.562] [INFO] console - Executing (default): SELECT "id", "question", "invited", "note", "created_at", "updated_at", "deleted_at", "place_id", "inviter_id" FROM "Kopa" AS "Kopa" WHERE ("Kopa"."deleted_at" IS NULL AND "Kopa"."id" = '3');
[2016-10-19 20:26:27.572] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:26:27.581] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:26:27.588] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 20:26:27.599] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:26:27.608] [INFO] console - Executing (default): SELECT "id", "value", "reason", "note", "created_at", "updated_at", "deleted_at", "subject_id", "owner_id", "parent_id" FROM "Golos" AS "Golos" WHERE ("Golos"."deleted_at" IS NULL AND ("Golos"."subject_id" = '21' AND "Golos"."owner_id" = '2')) LIMIT 1;
[2016-10-19 20:26:27.623] [INFO] console - Executing (default): INSERT INTO "Golos" ("id","value","created_at","updated_at","subject_id","owner_id") VALUES (DEFAULT,1,'2016-10-19 15:26:27.613 +00:00','2016-10-19 15:26:27.613 +00:00','21','2') RETURNING *;
[2016-10-19 20:26:27.635] [INFO] console - Executing (default): insert into "Golos" (subject_id, value, owner_id, parent_id, created_at, updated_at)
                            (
                                select 21, 1, k.id, 63, current_timestamp, current_timestamp
                                from 
                                    "Kopnik" k
                                     join "Zemla" d on d.id= k.dom_id
                                where
                                    k.path like '/2/%'
                                    and d.path||d.id||'/' like '/1/2/%' 
                            )
[2016-10-19 20:26:27.639] [INFO] console - Executing (default): select
                            (select count(*) from "Golos" g where subject_id= 21 and value=1) "za",
                            (select count(*) from "Golos" g where subject_id= 21 and value=-1) "protiv"
[2016-10-19 20:26:27.652] [INFO] console - Executing (default): UPDATE "Predlozhenie" SET "totalZa"=2,"updated_at"='2016-10-19 15:26:27.644 +00:00' WHERE "id" = '21'
[2016-10-19 20:26:27.658] [INFO] console - Executing (838af4af-8f44-459c-9154-2d19a9514cf1): COMMIT;
[2016-10-19 20:26:27.662] [INFO] console - [ 70, 554, {}, [ undefined ] ]
[2016-10-19 20:26:27.669] [INFO] console - [ 16,
  92721750474752,
  { acknowledge: true },
  'ru.kopa.model.Predlozhenie.id21.rebalance',
  [],
  { totalZa: 2,
    totalProtiv: 0,
    GOLOS: '63',
    action: 'add',
    value: 1 } ]
[2016-10-19 20:26:27.684] [INFO] console - Executing (51abeda2-c6fa-4ddd-962b-d1f37fc2730a): START TRANSACTION;
[2016-10-19 20:26:27.688] [INFO] console - Executing (51abeda2-c6fa-4ddd-962b-d1f37fc2730a): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:26:27.700] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 20:26:27.724] [INFO] console - Executing (default): SELECT "id", "value", "totalZa", "totalProtiv", "state", "note", "created_at", "updated_at", "deleted_at", "author_id", "place_id" FROM "Predlozhenie" AS "Predlozhenie" WHERE ("Predlozhenie"."deleted_at" IS NULL AND "Predlozhenie"."id" = 21);
[2016-10-19 20:26:27.737] [INFO] console - Executing (default): SELECT "id", "question", "invited", "note", "created_at", "updated_at", "deleted_at", "place_id", "inviter_id" FROM "Kopa" AS "Kopa" WHERE ("Kopa"."deleted_at" IS NULL AND "Kopa"."id" = '3');
[2016-10-19 20:26:27.756] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:26:27.779] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:26:27.789] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 20:26:27.809] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:26:27.829] [INFO] console - Executing (default): SELECT "id", "value", "reason", "note", "created_at", "updated_at", "deleted_at", "subject_id", "owner_id", "parent_id" FROM "Golos" AS "Golos" WHERE ("Golos"."deleted_at" IS NULL AND ("Golos"."subject_id" = '21' AND "Golos"."owner_id" = '2')) LIMIT 1;
[2016-10-19 20:26:27.836] [INFO] console - Executing (default): delete from "Golos" 
                            where
                                subject_id= 21
                                and (
                                    id= 63
                                    or parent_id = 63
                                )
[2016-10-19 20:26:27.843] [INFO] console - Executing (default): select
                            (select count(*) from "Golos" g where subject_id= 21 and value=1) "za",
                            (select count(*) from "Golos" g where subject_id= 21 and value=-1) "protiv"
[2016-10-19 20:26:27.858] [INFO] console - Executing (default): UPDATE "Predlozhenie" SET "totalZa"=0,"updated_at"='2016-10-19 15:26:27.848 +00:00' WHERE "id" = '21'
[2016-10-19 20:26:27.866] [INFO] console - Executing (51abeda2-c6fa-4ddd-962b-d1f37fc2730a): COMMIT;
[2016-10-19 20:26:27.870] [INFO] console - [ 70, 555, {}, [ undefined ] ]
[2016-10-19 20:26:27.899] [INFO] console - [ 16,
  4188348488876032,
  { acknowledge: true },
  'ru.kopa.model.Predlozhenie.id21.rebalance',
  [],
  { totalZa: 0,
    totalProtiv: 0,
    GOLOS: '63',
    action: 'remove',
    value: 1 } ]
[2016-10-19 20:27:28.923] [INFO] console - Executing (756b48fe-4835-4dfe-a952-3673554e1ac9): START TRANSACTION;
[2016-10-19 20:27:28.927] [INFO] console - Executing (756b48fe-4835-4dfe-a952-3673554e1ac9): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:27:28.970] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 20:27:29.005] [INFO] console - Executing (default): SELECT "id", "value", "totalZa", "totalProtiv", "state", "note", "created_at", "updated_at", "deleted_at", "author_id", "place_id" FROM "Predlozhenie" AS "Predlozhenie" WHERE ("Predlozhenie"."deleted_at" IS NULL AND "Predlozhenie"."id" = 21);
[2016-10-19 20:27:29.025] [INFO] console - Executing (default): SELECT "id", "question", "invited", "note", "created_at", "updated_at", "deleted_at", "place_id", "inviter_id" FROM "Kopa" AS "Kopa" WHERE ("Kopa"."deleted_at" IS NULL AND "Kopa"."id" = '3');
[2016-10-19 20:27:29.045] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:27:29.056] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:27:29.064] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 20:27:29.080] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:27:29.092] [INFO] console - Executing (default): SELECT "id", "value", "reason", "note", "created_at", "updated_at", "deleted_at", "subject_id", "owner_id", "parent_id" FROM "Golos" AS "Golos" WHERE ("Golos"."deleted_at" IS NULL AND ("Golos"."subject_id" = '21' AND "Golos"."owner_id" = '2')) LIMIT 1;
[2016-10-19 20:27:29.117] [INFO] console - Executing (default): INSERT INTO "Golos" ("id","value","created_at","updated_at","subject_id","owner_id") VALUES (DEFAULT,-1,'2016-10-19 15:27:29.096 +00:00','2016-10-19 15:27:29.096 +00:00','21','2') RETURNING *;
[2016-10-19 20:27:29.128] [INFO] console - Executing (default): insert into "Golos" (subject_id, value, owner_id, parent_id, created_at, updated_at)
                            (
                                select 21, -1, k.id, 65, current_timestamp, current_timestamp
                                from 
                                    "Kopnik" k
                                     join "Zemla" d on d.id= k.dom_id
                                where
                                    k.path like '/2/%'
                                    and d.path||d.id||'/' like '/1/2/%' 
                            )
[2016-10-19 20:27:29.133] [INFO] console - Executing (default): select
                            (select count(*) from "Golos" g where subject_id= 21 and value=1) "za",
                            (select count(*) from "Golos" g where subject_id= 21 and value=-1) "protiv"
[2016-10-19 20:27:29.147] [INFO] console - Executing (default): UPDATE "Predlozhenie" SET "totalProtiv"=2,"updated_at"='2016-10-19 15:27:29.137 +00:00' WHERE "id" = '21'
[2016-10-19 20:27:29.154] [INFO] console - Executing (756b48fe-4835-4dfe-a952-3673554e1ac9): COMMIT;
[2016-10-19 20:27:29.157] [INFO] console - [ 70, 556, {}, [ undefined ] ]
[2016-10-19 20:27:29.163] [INFO] console - [ 16,
  8675803986395136,
  { acknowledge: true },
  'ru.kopa.model.Predlozhenie.id21.rebalance',
  [],
  { totalZa: 0,
    totalProtiv: 2,
    GOLOS: '65',
    action: 'add',
    value: -1 } ]
[2016-10-19 20:27:39.101] [INFO] console - [ 70, 558, {}, [ undefined ] ]
[2016-10-19 20:27:39.120] [INFO] console - Executing (default): delete from "Kopnik"
                where
                    name like '%temp'
                    or name like 'temp%'
[2016-10-19 20:27:39.135] [INFO] console - Executing (default): update "Kopnik"
                set 
                    "voiskoSize"= case when id=2 then 1 ELSE 0 END
                where
                    id>1 
                    and id<=5
[2016-10-19 20:27:39.141] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 2 }
[2016-10-19 20:27:39.146] [INFO] console - Executing (63871c59-9688-4f52-b75e-fdadceb17ba1): START TRANSACTION;
[2016-10-19 20:27:39.151] [INFO] console - Executing (63871c59-9688-4f52-b75e-fdadceb17ba1): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:27:39.167] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 20:27:39.177] [INFO] console - Executing (63871c59-9688-4f52-b75e-fdadceb17ba1): COMMIT;
[2016-10-19 20:27:39.179] [INFO] console - [ 70,
  559,
  {},
  [ { fullName: 'Unit Test',
      fullPath: '/2/',
      id: '2',
      email: 'unittest2@domain.ru',
      name: 'Unit',
      surname: 'Test',
      patronymic: '1',
      voiskoSize: 1,
      birth: 1983,
      path: '/',
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: null,
      attachments: [] } ] ]
[2016-10-19 20:27:39.225] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."starshina_id" = 2) ORDER BY "Kopnik"."surname" asc, "Kopnik"."name" asc, "Kopnik"."patronymic" asc;
[2016-10-19 20:27:39.235] [INFO] console - [ 70, 560, {}, [ [ [Object], [Object] ] ] ]
[2016-10-19 20:27:39.277] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 20:27:39.285] [INFO] console - Executing (d4dbb15f-f499-4487-9249-9258f661762f): START TRANSACTION;
[2016-10-19 20:27:39.291] [INFO] console - Executing (d4dbb15f-f499-4487-9249-9258f661762f): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:27:39.318] [INFO] console - Executing (d4dbb15f-f499-4487-9249-9258f661762f): INSERT INTO "Kopnik" ("id","name","surname","patronymic","voiskoSize","birth","path","created_at","updated_at","dom_id","starshina_id") VALUES (DEFAULT,'temp','temp','temp',0,1900,'/','2016-10-19 15:27:39.295 +00:00','2016-10-19 15:27:39.295 +00:00',2,NULL) RETURNING *;
[2016-10-19 20:27:39.330] [INFO] console - Executing (d4dbb15f-f499-4487-9249-9258f661762f): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:27:39.342] [INFO] console - Executing (d4dbb15f-f499-4487-9249-9258f661762f): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:27:39.349] [INFO] console - Executing (d4dbb15f-f499-4487-9249-9258f661762f): update "Zemla"
                                    set "obshinaSize"= "obshinaSize"+ 1
                                where
                                    '/1/' like path||id||'/%'
                                    or (
                                        true 
                                        and id= 2
                                    )
[2016-10-19 20:27:39.355] [INFO] console - Executing (d4dbb15f-f499-4487-9249-9258f661762f): COMMIT;
[2016-10-19 20:27:39.358] [INFO] console - [ 70, 561, {}, [ '85' ] ]
[2016-10-19 20:27:39.376] [INFO] console - Executing (e69968f1-c3bc-4d89-8310-f9d3c48c13e9): START TRANSACTION;
[2016-10-19 20:27:39.383] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:27:39.391] [INFO] console - Executing (e69968f1-c3bc-4d89-8310-f9d3c48c13e9): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:27:39.396] [INFO] console - Executing (default): select z.*
                                    from "Zemla" as z
                                where
                                    '/1/' like z.path||z.id||'/%'
[2016-10-19 20:27:39.406] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 85);
[2016-10-19 20:27:39.421] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" IN ('1')) ORDER BY "Zemla"."path" desc;
[2016-10-19 20:27:39.440] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 20:27:39.443] [INFO] console - [ 16,
  5295449405652992,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id2.obshinaChange',
  [],
  { obshinaSize: 83 } ]
[2016-10-19 20:27:39.457] [INFO] console - [ 16,
  2697476794482688,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id1.obshinaChange',
  [],
  { obshinaSize: 85 } ]
[2016-10-19 20:27:39.470] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 20:27:39.484] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:27:39.490] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:27:39.504] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='2',"updated_at"='2016-10-19 15:27:39.493 +00:00' WHERE "id" = '85'
[2016-10-19 20:27:39.511] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/', '/2/')
                                where
                                    id = '85'
                                    or path like '/85/'||'%'
[2016-10-19 20:27:39.516] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 20:27:39.524] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 20:27:39.535] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:27:39.542] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/2/85/'||'%'
[2016-10-19 20:27:39.547] [INFO] console - Executing (e69968f1-c3bc-4d89-8310-f9d3c48c13e9): COMMIT;
[2016-10-19 20:27:39.550] [INFO] console - [ 70, 562, {}, [ undefined ] ]
[2016-10-19 20:27:39.556] [INFO] console - [ 16,
  4798278734446592,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.druzhinaChange',
  [],
  { action: 'add',
    kopnik: 
     { fullName: 'temp temp',
       fullPath: '/2/85/',
       id: '85',
       email: null,
       password: null,
       name: 'temp',
       surname: 'temp',
       patronymic: 'temp',
       voiskoSize: 0,
       birth: 1900,
       path: '/2/',
       note: null,
       created_at: Wed Oct 19 2016 20:27:39 GMT+0500 (YEKT),
       updated_at: Wed Oct 19 2016 20:27:39 GMT+0500 (YEKT),
       deleted_at: null,
       dom_id: '2',
       starshina_id: '2' } } ]
[2016-10-19 20:27:39.575] [INFO] console - [ 16,
  3449794852814848,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 2 } ]
[2016-10-19 20:27:39.591] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 20:27:39.600] [INFO] console - Executing (6578106c-eb0e-4ec2-b9cc-fa56aead263c): START TRANSACTION;
[2016-10-19 20:27:39.605] [INFO] console - Executing (6578106c-eb0e-4ec2-b9cc-fa56aead263c): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:27:39.619] [INFO] console - Executing (6578106c-eb0e-4ec2-b9cc-fa56aead263c): INSERT INTO "Kopnik" ("id","name","surname","patronymic","voiskoSize","birth","path","created_at","updated_at","dom_id","starshina_id") VALUES (DEFAULT,'temp','temp','temp',0,1900,'/','2016-10-19 15:27:39.608 +00:00','2016-10-19 15:27:39.608 +00:00',2,NULL) RETURNING *;
[2016-10-19 20:27:39.625] [INFO] console - Executing (6578106c-eb0e-4ec2-b9cc-fa56aead263c): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:27:39.633] [INFO] console - Executing (6578106c-eb0e-4ec2-b9cc-fa56aead263c): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:27:39.640] [INFO] console - Executing (6578106c-eb0e-4ec2-b9cc-fa56aead263c): update "Zemla"
                                    set "obshinaSize"= "obshinaSize"+ 1
                                where
                                    '/1/' like path||id||'/%'
                                    or (
                                        true 
                                        and id= 2
                                    )
[2016-10-19 20:27:39.645] [INFO] console - Executing (6578106c-eb0e-4ec2-b9cc-fa56aead263c): COMMIT;
[2016-10-19 20:27:39.649] [INFO] console - [ 70, 563, {}, [ '86' ] ]
[2016-10-19 20:27:39.670] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:27:39.679] [INFO] console - Executing (9de97ff6-7202-4ad4-92e5-ae0e12e70349): START TRANSACTION;
[2016-10-19 20:27:39.684] [INFO] console - Executing (default): select z.*
                                    from "Zemla" as z
                                where
                                    '/1/' like z.path||z.id||'/%'
[2016-10-19 20:27:39.688] [INFO] console - Executing (9de97ff6-7202-4ad4-92e5-ae0e12e70349): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:27:39.707] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" IN ('1')) ORDER BY "Zemla"."path" desc;
[2016-10-19 20:27:39.715] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 86);
[2016-10-19 20:27:39.717] [INFO] console - [ 16,
  5367092148699136,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id2.obshinaChange',
  [],
  { obshinaSize: 84 } ]
[2016-10-19 20:27:39.729] [INFO] console - [ 16,
  886821712035840,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id1.obshinaChange',
  [],
  { obshinaSize: 86 } ]
[2016-10-19 20:27:39.747] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 85);
[2016-10-19 20:27:39.757] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 20:27:39.767] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:27:39.778] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:27:39.792] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='85',"updated_at"='2016-10-19 15:27:39.781 +00:00' WHERE "id" = '86'
[2016-10-19 20:27:39.803] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/', '/2/85/')
                                where
                                    id = '86'
                                    or path like '/86/'||'%'
[2016-10-19 20:27:39.806] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/2/85/' like path||id||'/%'
[2016-10-19 20:27:39.812] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/85/' like k.path||k.id||'/%'
[2016-10-19 20:27:39.823] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('85', '2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:27:39.832] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/2/85/86/'||'%'
[2016-10-19 20:27:39.836] [INFO] console - Executing (9de97ff6-7202-4ad4-92e5-ae0e12e70349): COMMIT;
[2016-10-19 20:27:39.839] [INFO] console - [ 70, 564, {}, [ undefined ] ]
[2016-10-19 20:27:39.846] [INFO] console - [ 16,
  6367432111292416,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id85.druzhinaChange',
  [],
  { action: 'add',
    kopnik: 
     { fullName: 'temp temp',
       fullPath: '/2/85/86/',
       id: '86',
       email: null,
       password: null,
       name: 'temp',
       surname: 'temp',
       patronymic: 'temp',
       voiskoSize: 0,
       birth: 1900,
       path: '/2/85/',
       note: null,
       created_at: Wed Oct 19 2016 20:27:39 GMT+0500 (YEKT),
       updated_at: Wed Oct 19 2016 20:27:39 GMT+0500 (YEKT),
       deleted_at: null,
       dom_id: '2',
       starshina_id: '85' } } ]
[2016-10-19 20:27:39.863] [INFO] console - [ 16,
  8785338336018432,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id85.voiskoChange',
  [],
  { voiskoSize: 1 } ]
[2016-10-19 20:27:39.874] [INFO] console - [ 16,
  8315342080180224,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 3 } ]
[2016-10-19 20:27:39.888] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 4 }
[2016-10-19 20:27:39.894] [INFO] console - Executing (3b0dc8f0-bb60-4c2c-8bc0-b81c21cbe6ed): START TRANSACTION;
[2016-10-19 20:27:39.898] [INFO] console - Executing (3b0dc8f0-bb60-4c2c-8bc0-b81c21cbe6ed): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:27:39.915] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 4);
[2016-10-19 20:27:39.925] [INFO] console - Executing (3b0dc8f0-bb60-4c2c-8bc0-b81c21cbe6ed): COMMIT;
[2016-10-19 20:27:39.927] [INFO] console - [ 70,
  565,
  {},
  [ { fullName: 'Unit Test',
      fullPath: '/4/',
      id: '4',
      email: 'unittest4@domain.ru',
      name: 'Unit',
      surname: 'Test',
      patronymic: '4',
      voiskoSize: 0,
      birth: 1983,
      path: '/',
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: null,
      attachments: [] } ] ]
[2016-10-19 20:27:39.950] [INFO] console - Executing (b6961697-d7fc-43da-9e07-6519b85b1e17): START TRANSACTION;
[2016-10-19 20:27:39.953] [INFO] console - Executing (b6961697-d7fc-43da-9e07-6519b85b1e17): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:27:39.967] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 85);
[2016-10-19 20:27:39.979] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 4);
[2016-10-19 20:27:39.988] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 20:27:40.005] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:27:40.016] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-2
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 20:27:40.032] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='4',"updated_at"='2016-10-19 15:27:40.020 +00:00' WHERE "id" = '85'
[2016-10-19 20:27:40.041] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/2/', '/4/')
                                where
                                    id = '85'
                                    or path like '/2/85/'||'%'
[2016-10-19 20:27:40.050] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+2
                                where
                                    '/4/' like path||id||'/%'
[2016-10-19 20:27:40.056] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/4/' like k.path||k.id||'/%'
[2016-10-19 20:27:40.069] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('4')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:27:40.077] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/4/85/'||'%'
[2016-10-19 20:27:40.083] [INFO] console - Executing (b6961697-d7fc-43da-9e07-6519b85b1e17): COMMIT;
[2016-10-19 20:27:40.087] [INFO] console - [ 70, 566, {}, [ undefined ] ]
[2016-10-19 20:27:40.094] [INFO] console - [ 16,
  2453063036043264,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.druzhinaChange',
  [],
  { action: 'remove', KOPNIK: 85 } ]
[2016-10-19 20:27:40.108] [INFO] console - [ 16,
  3934251384832000,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id4.druzhinaChange',
  [],
  { action: 'add',
    kopnik: 
     { fullName: 'temp temp',
       fullPath: '/4/85/',
       id: '85',
       email: null,
       password: null,
       name: 'temp',
       surname: 'temp',
       patronymic: 'temp',
       voiskoSize: 1,
       birth: 1900,
       path: '/4/',
       note: null,
       created_at: Wed Oct 19 2016 20:27:39 GMT+0500 (YEKT),
       updated_at: Wed Oct 19 2016 20:27:40 GMT+0500 (YEKT),
       deleted_at: null,
       dom_id: '2',
       starshina_id: '4' } } ]
[2016-10-19 20:27:40.128] [INFO] console - [ 16,
  2688940238700544,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 1 } ]
[2016-10-19 20:27:40.137] [INFO] console - [ 16,
  1242940340961280,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id4.voiskoChange',
  [],
  { voiskoSize: 2 } ]
[2016-10-19 20:27:40.151] [INFO] console - [ 16,
  4872495914024960,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id86.starshinaChange',
  [],
  {} ]
[2016-10-19 20:27:40.162] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 86 }
[2016-10-19 20:27:40.168] [INFO] console - Executing (69f15908-ee57-41f7-a26e-978af806cc95): START TRANSACTION;
[2016-10-19 20:27:40.172] [INFO] console - Executing (69f15908-ee57-41f7-a26e-978af806cc95): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:27:40.185] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 86);
[2016-10-19 20:27:40.194] [INFO] console - Executing (69f15908-ee57-41f7-a26e-978af806cc95): COMMIT;
[2016-10-19 20:27:40.197] [INFO] console - [ 70,
  567,
  {},
  [ { fullName: 'temp temp',
      fullPath: '/4/85/86/',
      id: '86',
      email: null,
      name: 'temp',
      surname: 'temp',
      patronymic: 'temp',
      voiskoSize: 0,
      birth: 1900,
      path: '/4/85/',
      note: null,
      created_at: Wed Oct 19 2016 20:27:39 GMT+0500 (YEKT),
      updated_at: Wed Oct 19 2016 20:27:39 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: '85',
      attachments: [] } ] ]
[2016-10-19 20:27:40.217] [DEBUG] Server - #promiseModel() [] { model: 'Kopnik', id: 85 }
[2016-10-19 20:27:40.222] [INFO] console - Executing (0753287e-64fc-4974-8b2f-aa9ed1da074b): START TRANSACTION;
[2016-10-19 20:27:40.227] [INFO] console - Executing (0753287e-64fc-4974-8b2f-aa9ed1da074b): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:27:40.248] [INFO] console - Executing (default): SELECT "Kopnik"."id", "Kopnik"."email", "Kopnik"."password", "Kopnik"."name", "Kopnik"."surname", "Kopnik"."patronymic", "Kopnik"."voiskoSize", "Kopnik"."birth", "Kopnik"."path", "Kopnik"."note", "Kopnik"."created_at", "Kopnik"."updated_at", "Kopnik"."deleted_at", "Kopnik"."dom_id", "Kopnik"."starshina_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopnik" AS "Kopnik" LEFT OUTER JOIN "File" AS "attachments" ON "Kopnik"."id" = "attachments"."kopnik_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 85);
[2016-10-19 20:27:40.261] [INFO] console - Executing (0753287e-64fc-4974-8b2f-aa9ed1da074b): COMMIT;
[2016-10-19 20:27:40.263] [INFO] console - [ 70,
  568,
  {},
  [ { fullName: 'temp temp',
      fullPath: '/4/85/',
      id: '85',
      email: null,
      name: 'temp',
      surname: 'temp',
      patronymic: 'temp',
      voiskoSize: 1,
      birth: 1900,
      path: '/4/',
      note: null,
      created_at: Wed Oct 19 2016 20:27:39 GMT+0500 (YEKT),
      updated_at: Wed Oct 19 2016 20:27:40 GMT+0500 (YEKT),
      deleted_at: null,
      dom_id: '2',
      starshina_id: '4',
      attachments: [] } ] ]
[2016-10-19 20:27:40.305] [INFO] console - Executing (3889512d-b5b5-4de9-98ea-fbfd2a241355): START TRANSACTION;
[2016-10-19 20:27:40.316] [INFO] console - Executing (3889512d-b5b5-4de9-98ea-fbfd2a241355): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:27:40.327] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 85);
[2016-10-19 20:27:40.338] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/4/' like k.path||k.id||'/%'
[2016-10-19 20:27:40.355] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('4')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:27:40.369] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-2
                                where
                                    '/4/' like path||id||'/%'
[2016-10-19 20:27:40.392] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"=NULL,"updated_at"='2016-10-19 15:27:40.375 +00:00' WHERE "id" = '85'
[2016-10-19 20:27:40.401] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/4/', '/')
                                where
                                    id = '85'
                                    or path like '/4/85/'||'%'
[2016-10-19 20:27:40.410] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+2
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:27:40.416] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 20:27:40.433] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:27:40.439] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/85/'||'%'
[2016-10-19 20:27:40.449] [INFO] console - Executing (3889512d-b5b5-4de9-98ea-fbfd2a241355): COMMIT;
[2016-10-19 20:27:40.453] [INFO] console - [ 70, 569, {}, [ undefined ] ]
[2016-10-19 20:27:40.463] [INFO] console - [ 16,
  6194279959494656,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id4.druzhinaChange',
  [],
  { action: 'remove', KOPNIK: 85 } ]
[2016-10-19 20:27:40.474] [INFO] console - [ 16,
  3020483968630784,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id4.voiskoChange',
  [],
  { voiskoSize: 0 } ]
[2016-10-19 20:27:40.496] [INFO] console - [ 16,
  8118397130768384,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id86.starshinaChange',
  [],
  {} ]
[2016-10-19 20:27:40.513] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 20:27:40.524] [INFO] console - Executing (bf7ebe4d-39c6-4bff-b2d0-7352f3527ed6): START TRANSACTION;
[2016-10-19 20:27:40.528] [INFO] console - Executing (bf7ebe4d-39c6-4bff-b2d0-7352f3527ed6): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:27:40.549] [INFO] console - Executing (bf7ebe4d-39c6-4bff-b2d0-7352f3527ed6): INSERT INTO "Kopnik" ("id","name","surname","patronymic","voiskoSize","birth","path","created_at","updated_at","dom_id","starshina_id") VALUES (DEFAULT,'temp','temp','temp',0,1900,'/','2016-10-19 15:27:40.534 +00:00','2016-10-19 15:27:40.534 +00:00',2,NULL) RETURNING *;
[2016-10-19 20:27:40.558] [INFO] console - Executing (bf7ebe4d-39c6-4bff-b2d0-7352f3527ed6): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:27:40.569] [INFO] console - Executing (bf7ebe4d-39c6-4bff-b2d0-7352f3527ed6): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:27:40.584] [INFO] console - Executing (bf7ebe4d-39c6-4bff-b2d0-7352f3527ed6): update "Zemla"
                                    set "obshinaSize"= "obshinaSize"+ 1
                                where
                                    '/1/' like path||id||'/%'
                                    or (
                                        true 
                                        and id= 2
                                    )
[2016-10-19 20:27:40.590] [INFO] console - Executing (bf7ebe4d-39c6-4bff-b2d0-7352f3527ed6): COMMIT;
[2016-10-19 20:27:40.595] [INFO] console - [ 70, 570, {}, [ '87' ] ]
[2016-10-19 20:27:40.623] [INFO] console - Executing (6292378a-a537-4f03-9483-530a413c350f): START TRANSACTION;
[2016-10-19 20:27:40.628] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:27:40.637] [INFO] console - Executing (6292378a-a537-4f03-9483-530a413c350f): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:27:40.642] [INFO] console - Executing (default): select z.*
                                    from "Zemla" as z
                                where
                                    '/1/' like z.path||z.id||'/%'
[2016-10-19 20:27:40.653] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 87);
[2016-10-19 20:27:40.675] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" IN ('1')) ORDER BY "Zemla"."path" desc;
[2016-10-19 20:27:40.686] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 2);
[2016-10-19 20:27:40.687] [INFO] console - [ 16,
  2432371622150144,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id2.obshinaChange',
  [],
  { obshinaSize: 85 } ]
[2016-10-19 20:27:40.699] [INFO] console - [ 16,
  5418500774428672,
  { acknowledge: true },
  'ru.kopa.model.Zemla.id1.obshinaChange',
  [],
  { obshinaSize: 87 } ]
[2016-10-19 20:27:40.712] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 20:27:40.723] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:27:40.730] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:27:40.742] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"='2',"updated_at"='2016-10-19 15:27:40.732 +00:00' WHERE "id" = '87'
[2016-10-19 20:27:40.748] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/', '/2/')
                                where
                                    id = '87'
                                    or path like '/87/'||'%'
[2016-10-19 20:27:40.754] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 20:27:40.760] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 20:27:40.773] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:27:40.781] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/2/87/'||'%'
[2016-10-19 20:27:40.784] [INFO] console - Executing (6292378a-a537-4f03-9483-530a413c350f): COMMIT;
[2016-10-19 20:27:40.790] [INFO] console - [ 70, 571, {}, [ undefined ] ]
[2016-10-19 20:27:40.802] [INFO] console - [ 16,
  7095924276854784,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.druzhinaChange',
  [],
  { action: 'add',
    kopnik: 
     { fullName: 'temp temp',
       fullPath: '/2/87/',
       id: '87',
       email: null,
       password: null,
       name: 'temp',
       surname: 'temp',
       patronymic: 'temp',
       voiskoSize: 0,
       birth: 1900,
       path: '/2/',
       note: null,
       created_at: Wed Oct 19 2016 20:27:40 GMT+0500 (YEKT),
       updated_at: Wed Oct 19 2016 20:27:40 GMT+0500 (YEKT),
       deleted_at: null,
       dom_id: '2',
       starshina_id: '2' } } ]
[2016-10-19 20:27:40.825] [INFO] console - Executing (f8413063-2763-4463-86a1-26171183ac26): START TRANSACTION;
[2016-10-19 20:27:40.828] [INFO] console - [ 16,
  5571076520148992,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 2 } ]
[2016-10-19 20:27:40.839] [INFO] console - Executing (f8413063-2763-4463-86a1-26171183ac26): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:27:40.852] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" = 87);
[2016-10-19 20:27:40.859] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/2/' like k.path||k.id||'/%'
[2016-10-19 20:27:40.869] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN ('2')) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:27:40.880] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"-1
                                where
                                    '/2/' like path||id||'/%'
[2016-10-19 20:27:40.892] [INFO] console - Executing (default): UPDATE "Kopnik" SET "starshina_id"=NULL,"updated_at"='2016-10-19 15:27:40.883 +00:00' WHERE "id" = '87'
[2016-10-19 20:27:40.897] [INFO] console - Executing (default): update "Kopnik"
                                set
                                    path= replace(path, '/2/', '/')
                                where
                                    id = '87'
                                    or path like '/2/87/'||'%'
[2016-10-19 20:27:40.902] [INFO] console - Executing (default): update "Kopnik"
                                    set "voiskoSize"= "voiskoSize"+1
                                where
                                    '/' like path||id||'/%'
[2016-10-19 20:27:40.905] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 20:27:40.915] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:27:40.919] [INFO] console - Executing (default): select id
                                from
                                    "Kopnik"
                                where
                                    path like '/87/'||'%'
[2016-10-19 20:27:40.923] [INFO] console - Executing (f8413063-2763-4463-86a1-26171183ac26): COMMIT;
[2016-10-19 20:27:40.927] [INFO] console - [ 70, 572, {}, [ undefined ] ]
[2016-10-19 20:27:40.932] [INFO] console - [ 16,
  876084241367040,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.druzhinaChange',
  [],
  { action: 'remove', KOPNIK: 87 } ]
[2016-10-19 20:27:40.948] [DEBUG] Server - #promiseModel() [] { model: 'Kopa', id: 3 }
[2016-10-19 20:27:40.951] [INFO] console - [ 16,
  665359879241728,
  { acknowledge: true },
  'ru.kopa.model.Kopnik.id2.voiskoChange',
  [],
  { voiskoSize: 1 } ]
[2016-10-19 20:27:40.968] [INFO] console - Executing (a71c3e9c-4952-4773-8334-0d15fc293743): START TRANSACTION;
[2016-10-19 20:27:40.987] [INFO] console - Executing (a71c3e9c-4952-4773-8334-0d15fc293743): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:27:41.009] [INFO] console - Executing (default): SELECT "Kopa"."id", "Kopa"."question", "Kopa"."invited", "Kopa"."note", "Kopa"."created_at", "Kopa"."updated_at", "Kopa"."deleted_at", "Kopa"."place_id", "Kopa"."inviter_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Kopa" AS "Kopa" LEFT OUTER JOIN "File" AS "attachments" ON "Kopa"."id" = "attachments"."kopa_id" AND "attachments"."deleted_at" IS NULL WHERE ("Kopa"."deleted_at" IS NULL AND "Kopa"."id" = 3);
[2016-10-19 20:27:41.024] [INFO] console - Executing (a71c3e9c-4952-4773-8334-0d15fc293743): COMMIT;
[2016-10-19 20:27:41.029] [INFO] console - [ 70,
  573,
  {},
  [ { id: '3',
      question: 'CHE',
      invited: Thu Sep 01 2016 00:00:00 GMT+0500 (YEKT),
      note: null,
      created_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      updated_at: Mon Oct 10 2016 17:44:11 GMT+0500 (YEKT),
      deleted_at: null,
      place_id: '2',
      inviter_id: '2',
      attachments: [] } ] ]
[2016-10-19 20:27:41.061] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 20:27:41.073] [INFO] console - Executing (a398c45d-b8db-4e15-82f0-5064402a99bc): START TRANSACTION;
[2016-10-19 20:27:41.076] [INFO] console - Executing (a398c45d-b8db-4e15-82f0-5064402a99bc): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:27:41.092] [INFO] console - Executing (a398c45d-b8db-4e15-82f0-5064402a99bc): INSERT INTO "Predlozhenie" ("id","value","totalZa","totalProtiv","created_at","updated_at","author_id","place_id") VALUES (DEFAULT,'temp Wed Oct 19 2016 20:27:41 GMT+0500 (YEKT)',0,0,'2016-10-19 15:27:41.080 +00:00','2016-10-19 15:27:41.080 +00:00',2,3) RETURNING *;
[2016-10-19 20:27:41.100] [INFO] console - Executing (a398c45d-b8db-4e15-82f0-5064402a99bc): COMMIT;
[2016-10-19 20:27:41.103] [INFO] console - [ 70, 574, {}, [ '22' ] ]
[2016-10-19 20:27:41.117] [INFO] console - [ 16,
  5329961539862528,
  { acknowledge: true },
  'ru.kopa.model.Kopa.id3.predlozhenieAdd',
  [ '22' ] ]
[2016-10-19 20:27:41.142] [INFO] console - Executing (7f40d6eb-d49a-4874-a8a7-da99d2d83f0f): START TRANSACTION;
[2016-10-19 20:27:41.146] [INFO] console - Executing (7f40d6eb-d49a-4874-a8a7-da99d2d83f0f): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:27:41.153] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 20:27:41.170] [INFO] console - Executing (default): SELECT "id", "value", "totalZa", "totalProtiv", "state", "note", "created_at", "updated_at", "deleted_at", "author_id", "place_id" FROM "Predlozhenie" AS "Predlozhenie" WHERE ("Predlozhenie"."deleted_at" IS NULL AND "Predlozhenie"."id" = 22);
[2016-10-19 20:27:41.182] [INFO] console - Executing (default): SELECT "id", "question", "invited", "note", "created_at", "updated_at", "deleted_at", "place_id", "inviter_id" FROM "Kopa" AS "Kopa" WHERE ("Kopa"."deleted_at" IS NULL AND "Kopa"."id" = '3');
[2016-10-19 20:27:41.194] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:27:41.206] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:27:41.216] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 20:27:41.225] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:27:41.238] [INFO] console - Executing (default): SELECT "id", "value", "reason", "note", "created_at", "updated_at", "deleted_at", "subject_id", "owner_id", "parent_id" FROM "Golos" AS "Golos" WHERE ("Golos"."deleted_at" IS NULL AND ("Golos"."subject_id" = '22' AND "Golos"."owner_id" = '2')) LIMIT 1;
[2016-10-19 20:27:41.251] [INFO] console - Executing (default): INSERT INTO "Golos" ("id","value","created_at","updated_at","subject_id","owner_id") VALUES (DEFAULT,1,'2016-10-19 15:27:41.243 +00:00','2016-10-19 15:27:41.243 +00:00','22','2') RETURNING *;
[2016-10-19 20:27:41.264] [INFO] console - Executing (default): insert into "Golos" (subject_id, value, owner_id, parent_id, created_at, updated_at)
                            (
                                select 22, 1, k.id, 67, current_timestamp, current_timestamp
                                from 
                                    "Kopnik" k
                                     join "Zemla" d on d.id= k.dom_id
                                where
                                    k.path like '/2/%'
                                    and d.path||d.id||'/' like '/1/2/%' 
                            )
[2016-10-19 20:27:41.268] [INFO] console - Executing (default): select
                            (select count(*) from "Golos" g where subject_id= 22 and value=1) "za",
                            (select count(*) from "Golos" g where subject_id= 22 and value=-1) "protiv"
[2016-10-19 20:27:41.283] [INFO] console - Executing (default): UPDATE "Predlozhenie" SET "totalZa"=2,"updated_at"='2016-10-19 15:27:41.273 +00:00' WHERE "id" = '22'
[2016-10-19 20:27:41.288] [INFO] console - Executing (7f40d6eb-d49a-4874-a8a7-da99d2d83f0f): COMMIT;
[2016-10-19 20:27:41.292] [INFO] console - [ 70, 575, {}, [ undefined ] ]
[2016-10-19 20:27:41.297] [INFO] console - [ 16,
  795914914496512,
  { acknowledge: true },
  'ru.kopa.model.Predlozhenie.id22.rebalance',
  [],
  { totalZa: 2,
    totalProtiv: 0,
    GOLOS: '67',
    action: 'add',
    value: 1 } ]
[2016-10-19 20:27:41.308] [INFO] console - Executing (e927b55d-4a11-4b8e-98a6-15e10286aca1): START TRANSACTION;
[2016-10-19 20:27:41.314] [INFO] console - Executing (e927b55d-4a11-4b8e-98a6-15e10286aca1): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:27:41.326] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 20:27:41.329] [DEBUG] Server - #promiseModel() [] { model: 'Golos', id: 67 }
[2016-10-19 20:27:41.337] [INFO] console - Executing (953fbef0-1b95-49a1-a9fd-2095a39d22ed): START TRANSACTION;
[2016-10-19 20:27:41.343] [INFO] console - Executing (953fbef0-1b95-49a1-a9fd-2095a39d22ed): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:27:41.349] [INFO] console - Executing (default): SELECT "id", "value", "totalZa", "totalProtiv", "state", "note", "created_at", "updated_at", "deleted_at", "author_id", "place_id" FROM "Predlozhenie" AS "Predlozhenie" WHERE ("Predlozhenie"."deleted_at" IS NULL AND "Predlozhenie"."id" = 22);
[2016-10-19 20:27:41.372] [INFO] console - Executing (default): SELECT "Golos"."id", "Golos"."value", "Golos"."reason", "Golos"."note", "Golos"."created_at", "Golos"."updated_at", "Golos"."deleted_at", "Golos"."subject_id", "Golos"."owner_id", "Golos"."parent_id", "attachments"."id" AS "attachments.id", "attachments"."path" AS "attachments.path", "attachments"."note" AS "attachments.note", "attachments"."created_at" AS "attachments.created_at", "attachments"."updated_at" AS "attachments.updated_at", "attachments"."deleted_at" AS "attachments.deleted_at", "attachments"."zemla_id" AS "attachments.zemla_id", "attachments"."kopnik_id" AS "attachments.kopnik_id", "attachments"."kopa_id" AS "attachments.kopa_id", "attachments"."slovo_id" AS "attachments.slovo_id", "attachments"."predlozhenie_id" AS "attachments.predlozhenie_id", "attachments"."golos_id" AS "attachments.golos_id" FROM "Golos" AS "Golos" LEFT OUTER JOIN "File" AS "attachments" ON "Golos"."id" = "attachments"."golos_id" AND "attachments"."deleted_at" IS NULL WHERE ("Golos"."deleted_at" IS NULL AND "Golos"."id" = 67);
[2016-10-19 20:27:41.384] [INFO] console - Executing (default): SELECT "id", "question", "invited", "note", "created_at", "updated_at", "deleted_at", "place_id", "inviter_id" FROM "Kopa" AS "Kopa" WHERE ("Kopa"."deleted_at" IS NULL AND "Kopa"."id" = '3');
[2016-10-19 20:27:41.390] [INFO] console - Executing (953fbef0-1b95-49a1-a9fd-2095a39d22ed): COMMIT;
[2016-10-19 20:27:41.400] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:27:41.402] [INFO] console - [ 70,
  577,
  {},
  [ { id: '67',
      value: 1,
      reason: null,
      note: null,
      created_at: Wed Oct 19 2016 20:27:41 GMT+0500 (YEKT),
      updated_at: Wed Oct 19 2016 20:27:41 GMT+0500 (YEKT),
      deleted_at: null,
      subject_id: '22',
      owner_id: '2',
      parent_id: null,
      attachments: [] } ] ]
[2016-10-19 20:27:41.420] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:27:41.428] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 20:27:41.446] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:27:41.461] [INFO] console - Executing (default): SELECT "id", "value", "reason", "note", "created_at", "updated_at", "deleted_at", "subject_id", "owner_id", "parent_id" FROM "Golos" AS "Golos" WHERE ("Golos"."deleted_at" IS NULL AND ("Golos"."subject_id" = '22' AND "Golos"."owner_id" = '2')) LIMIT 1;
[2016-10-19 20:27:41.467] [INFO] console - Executing (default): delete from "Golos" 
                            where
                                subject_id= 22
                                and (
                                    id= 67
                                    or parent_id = 67
                                )
[2016-10-19 20:27:41.478] [INFO] console - Executing (default): select
                            (select count(*) from "Golos" g where subject_id= 22 and value=1) "za",
                            (select count(*) from "Golos" g where subject_id= 22 and value=-1) "protiv"
[2016-10-19 20:27:41.509] [INFO] console - Executing (default): UPDATE "Predlozhenie" SET "totalZa"=0,"updated_at"='2016-10-19 15:27:41.482 +00:00' WHERE "id" = '22'
[2016-10-19 20:27:41.514] [INFO] console - Executing (e927b55d-4a11-4b8e-98a6-15e10286aca1): COMMIT;
[2016-10-19 20:27:41.519] [INFO] console - [ 70, 576, {}, [ undefined ] ]
[2016-10-19 20:27:41.524] [INFO] console - [ 16,
  8514684701376512,
  { acknowledge: true },
  'ru.kopa.model.Predlozhenie.id22.rebalance',
  [],
  { totalZa: 0,
    totalProtiv: 0,
    GOLOS: '67',
    action: 'remove',
    value: 1 } ]
[2016-10-19 20:27:45.810] [INFO] console - Executing (aff7ed26-5883-4fac-807d-21aaa1f619f1): START TRANSACTION;
[2016-10-19 20:27:45.820] [INFO] console - Executing (aff7ed26-5883-4fac-807d-21aaa1f619f1): SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
[2016-10-19 20:27:45.834] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."email" = 'unittest2@domain.ru') LIMIT 1;
[2016-10-19 20:27:45.845] [INFO] console - Executing (default): SELECT "id", "value", "totalZa", "totalProtiv", "state", "note", "created_at", "updated_at", "deleted_at", "author_id", "place_id" FROM "Predlozhenie" AS "Predlozhenie" WHERE ("Predlozhenie"."deleted_at" IS NULL AND "Predlozhenie"."id" = 22);
[2016-10-19 20:27:45.861] [INFO] console - Executing (default): SELECT "id", "question", "invited", "note", "created_at", "updated_at", "deleted_at", "place_id", "inviter_id" FROM "Kopa" AS "Kopa" WHERE ("Kopa"."deleted_at" IS NULL AND "Kopa"."id" = '3');
[2016-10-19 20:27:45.872] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:27:45.884] [INFO] console - Executing (default): SELECT "id", "name", "intensity", "obshinaSize", "path", "note", "created_at", "updated_at", "deleted_at", "parent_id" FROM "Zemla" AS "Zemla" WHERE ("Zemla"."deleted_at" IS NULL AND "Zemla"."id" = '2');
[2016-10-19 20:27:45.891] [INFO] console - Executing (default): select k.*
                                    from "Kopnik" as k
                                where
                                    '/' like k.path||k.id||'/%'
[2016-10-19 20:27:45.902] [INFO] console - Executing (default): SELECT "id", "email", "password", "name", "surname", "patronymic", "voiskoSize", "birth", "path", "note", "created_at", "updated_at", "deleted_at", "dom_id", "starshina_id" FROM "Kopnik" AS "Kopnik" WHERE ("Kopnik"."deleted_at" IS NULL AND "Kopnik"."id" IN (NULL)) ORDER BY "Kopnik"."path" desc;
[2016-10-19 20:27:45.914] [INFO] console - Executing (default): SELECT "id", "value", "reason", "note", "created_at", "updated_at", "deleted_at", "subject_id", "owner_id", "parent_id" FROM "Golos" AS "Golos" WHERE ("Golos"."deleted_at" IS NULL AND ("Golos"."subject_id" = '22' AND "Golos"."owner_id" = '2')) LIMIT 1;
[2016-10-19 20:27:45.930] [INFO] console - Executing (default): INSERT INTO "Golos" ("id","value","created_at","updated_at","subject_id","owner_id") VALUES (DEFAULT,-1,'2016-10-19 15:27:45.920 +00:00','2016-10-19 15:27:45.920 +00:00','22','2') RETURNING *;
[2016-10-19 20:27:45.941] [INFO] console - Executing (default): insert into "Golos" (subject_id, value, owner_id, parent_id, created_at, updated_at)
                            (
                                select 22, -1, k.id, 69, current_timestamp, current_timestamp
                                from 
                                    "Kopnik" k
                                     join "Zemla" d on d.id= k.dom_id
                                where
                                    k.path like '/2/%'
                                    and d.path||d.id||'/' like '/1/2/%' 
                            )
[2016-10-19 20:27:45.949] [INFO] console - Executing (default): select
                            (select count(*) from "Golos" g where subject_id= 22 and value=1) "za",
                            (select count(*) from "Golos" g where subject_id= 22 and value=-1) "protiv"
[2016-10-19 20:27:45.972] [INFO] console - Executing (default): UPDATE "Predlozhenie" SET "totalProtiv"=2,"updated_at"='2016-10-19 15:27:45.957 +00:00' WHERE "id" = '22'
[2016-10-19 20:27:45.980] [INFO] console - Executing (aff7ed26-5883-4fac-807d-21aaa1f619f1): COMMIT;
[2016-10-19 20:27:45.985] [INFO] console - [ 70, 578, {}, [ undefined ] ]
[2016-10-19 20:27:45.991] [INFO] console - [ 16,
  8949057663795200,
  { acknowledge: true },
  'ru.kopa.model.Predlozhenie.id22.rebalance',
  [],
  { totalZa: 0,
    totalProtiv: 2,
    GOLOS: '69',
    action: 'add',
    value: -1 } ]
